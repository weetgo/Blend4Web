/**
 * Blend4Web CE 17_08
 * Copyright (C) 2014-2017 Triumph LLC
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
var b4w="object"===typeof b4w?b4w:function(a){var t={};a.module=t;var e={};a.cleanup=function(a,b){var c=t[a];c&&(c.Fn=null);e[b||"__b4w_default"]=null};a.register=function(a,b){t[a]||(t[a]=b)};a.require=function(a,b){if(!t[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";e[b]||(e[b]=function(a){return function(b){var c=t[b];if(!c)throw Error('Module "'+b+'" not found');c.Fn||(c.Fn={});c.Fn[a]||(c.Fn[a]={},c(c.Fn[a],e[a]));return c.Fn[a]}}(b));return e[b](a)};a.module_check=function(a){return t[a]?
!0:!1};a.get_namespace=function(a){for(var b in e)if(e[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.__version=function(a){var t=new Date(2017,7,31,18,45,38),e=[17,8];a.version=function(){return e};a.version_str=function(){for(var a="",b=0;b<e.length;b++)a=1==b?a+(10>e[b]?"0"+e[b]:e[b]):a+e[b],b!=e.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return t};a.date_str=function(){var a=t.getDate(),a=10>a?"0"+String(a):String(a),b=t.getMonth()+1,b=10>b?"0"+String(b):String(b),e=String(t.getFullYear()),k=t.getHours(),k=10>k?"0"+String(k):String(k),q=t.getMinutes(),
q=10>q?"0"+String(q):String(q),h=t.getSeconds(),h=10>h?"0"+String(h):String(h);return a+"."+b+"."+e+" "+k+":"+q+":"+h};a.get_build_version=function(){return"_b4w_ver_17_08_"}};b4w.module.__config=function(a,t){function e(){return b4w.module_check(a.Ze.Ot)}function c(){for(var c=a.Ze,e=null,f=document.getElementsByTagName("script"),u=0;u<f.length;u++){for(var y=f[u].src,g=0;g<c.zG.length;g++)if(0<=y.indexOf(c.zG[g])){e=y;break}if(null!==e)break}e||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),e=document.location.href);c=e.indexOf("?");0<=c&&(e=e.substring(0,c));return e.substring(0,e.lastIndexOf("/"))}var b=t("__print"),
f=t("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.P_AUTO=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.LE=f.V(a.context);a.K={alpha_sort:!0,alpha_sort_threshold:.1,Nm:[6,3],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,enable_texture_cache:!0,sF:1,aQ:5,background_color:[0,0,0,0],canvas_resolution_factor:1,dk:3,allow_cors:!1,rF:!1,Oy:!0,anisotropic_filtering:!0,iC:!1,show_hud_debug_info:!1,ru:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,
ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,SJ:!1,io:!0,Bw:!0,Lc:!0,water_dynamic:!0,shore_smoothing:!0,bp:!0,vJ:!0,precision:"highp",quality:a.P_HIGH,st:!0,lod_leap_smooth_threshold:3,assets_gzip_available:!1,PS:!1,OB:!1,Ez:!1,JJ:!1,is_mobile_device:!1,qA:!1,jz:!1,LZ:!1,os:!1,allow_hidpi:!1,vI:!1,QA:!1,kG:!1,enable_selectable:!0,enable_outlining:!0,lod_smooth_transitions:!0,glow_materials:!0,zv:!1,oF:!1,EA:[0,0],CH:!0,ex:!1,url_params:null,
Hb:!0,Zb:4,Hq:!1,SH:!1,XT:!1,hs:!1,NH:!1,sE:!1,fG:!1,eG:!1,media_auto_activation:!0,VG:4,$v:!1,gl_debug:!1,mE:!1,CD:!1,Ly:!1,cm:"dds",shadow_blur_samples:"",reflection_quality:"",srgb_type:"SRGB_SIMPLE",Dv:!1,ks:!1,debug_loading:!1,SG:!1,RG:!1};a.bF=f.V(a.K);a.Sl={Tu:-1,tF:!1,rm:1};a.controls={JS:1/120};a.ae={path:"",cT:"B4W_ASSETS_PATH=__JS__/../../assets/",sT:"B4W_PROJ_ASSETS_PATH=__JS__/../../../projects/__NAME__/assets/",DS:15,prevent_caching:!0,PA:!1,Bz:!1,Kw:!1};a.HD=f.V(a.ae);a.Ze={shaders_path:"",
NU:"../shaders/",tI:"include/",JZ:"postprocessing/",Ot:"built_in_data",zG:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js B4W_MAIN_MODULE".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};a.cG={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{gF:.8,Gh:.064,di:.035,ls:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],Hl:.11,yi:.062,ei:.004}};a.L=
{enabled:!0,max_fps:60,Ms:"",Vx:"",Wx:"B4W_URANIUM_PATH=./",GD:"uranium.js",RJ:"uranium_wasm.js",YG:"uranium.js.mem",QJ:"uranium_wasm.wasm",uJ:"../deploy/apps/common/",az:!1,ping:!1,qn:!0,Ss:!0};a.tH=f.V(a.L);a.ap={qr:1024,ku:256,UE:32,jP:128,iP:256,vH:.25,kT:.5,jT:1};a.WH=f.V(a.ap);a.ea={FC:!0,hw:!1,LD:!1,vE:!1,eF:!1};a.rI=f.V(a.ea);a.Yc={outlining_overview_mode:!1,Mh:[1,.4,.05],al:.2,bl:3.8,cl:1};a.im={enabled:!1,zs:39,nV:0,QU:"COLOR"};a.$E=f.V(a.im);a.xh={CS:8,IA:64,MA:8,dw:8,NA:15,XG:0,ew:128,
og:1024,JA:4096,Yb:4096,OA:[4096,4096],Xn:24};a.KE=f.V(a.xh);a.apply_quality=function(){var b=a.K,c=a.L,e=a.ap;switch(b.quality){case a.P_ULTRA:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.io=!0;b.Bw=!0;b.Lc=!0;e.qr=2048;e.ku=512;b.dk=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.water_dynamic=!0;b.bp=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.glow_materials=!0;b.Zb=
16;b.srgb_type="SRGB_PROPER";c.max_fps=120;b.lod_smooth_transitions=!0;break;case a.P_HIGH:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.io=!0;b.Bw=!0;b.Lc=!0;e.qr=1024;e.ku=256;b.dk=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.water_dynamic=!0;b.bp=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.glow_materials=!0;b.srgb_type="SRGB_SIMPLE";b.Zb=4;c.max_fps=60;b.lod_smooth_transitions=
!0;break;case a.P_LOW:b.shadows=!1;b.shore_smoothing=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.io=!1;b.Bw=!1;b.Lc=!1;e.qr=512;e.ku=256;b.dk=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.water_dynamic=!1;b.bp=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.glow_materials=!1;b.srgb_type="SRGB_SIMPLE";b.Zb=1;c.max_fps=60;b.lod_smooth_transitions=!1;break;case a.P_AUTO:f.I("Direct AUTO quality profile setting is forbidden")}};
a.set=function(c,e){switch(c){case "allow_cors":a.K.allow_cors=e;break;case "allow_hidpi":a.K.allow_hidpi=e;break;case "alpha":a.context.alpha=e;break;case "alpha_sort":a.K.alpha_sort=e;break;case "alpha_sort_threshold":a.K.alpha_sort_threshold=e;break;case "anaglyph_use":b.Hu("anaglyph_use","stereo");a.K.stereo=e?"ANAGLYPH":a.K.stereo;break;case "animation_framerate":a.Sl.Tu=e;break;case "anisotropic_filtering":a.K.anisotropic_filtering=e;break;case "antialiasing":a.K.antialiasing=e;break;case "assets_dir":case "assets_path":a.ae.path=
e;break;case "assets_dds_available":a.ae.Bz=e;break;case "assets_pvr_available":a.ae.Kw=e;break;case "assets_min50_available":a.ae.PA=e;break;case "audio":a.ea.FC=e;break;case "background_color":a.K.background_color=e;break;case "bloom":a.K.bloom=e;break;case "built_in_module_name":a.Ze.Ot=e;break;case "canvas_resolution_factor":a.K.canvas_resolution_factor=e;break;case "console_verbose":a.K.console_verbose=e;break;case "compositing":a.K.compositing=e;break;case "dof":a.K.dof=e;break;case "do_not_load_resources":a.K.do_not_load_resources=
e;break;case "god_rays":a.K.god_rays=e;break;case "stereo":a.K.stereo=e;break;case "lod_leap_smooth_threshold":a.K.lod_leap_smooth_threshold=e;break;case "lod_smooth_transitions":a.K.lod_smooth_transitions=e;break;case "max_fps":a.K.max_fps=e;break;case "max_fps_physics":a.L.max_fps=e;break;case "media_auto_activation":a.K.media_auto_activation=e;break;case "motion_blur":a.K.motion_blur=e;break;case "physics_enabled":a.L.enabled=e;break;case "physics_uranium_path":a.L.Ss&&window.WebAssembly?(a.L.Ms=
e+a.L.RJ,a.L.Vx=e+a.L.QJ):(a.L.Ms=e+a.L.GD,a.L.Vx=e+a.L.YG);a.L.uJ=e;break;case "physics_use_wasm":a.L.Ss=e;break;case "physics_calc_fps":a.L.az=e;break;case "physics_use_workers":a.L.qn=e;break;case "precision":a.K.precision=e;break;case "prevent_caching":a.ae.prevent_caching=e;break;case "quality":a.K.quality=e;break;case "reflections":a.K.reflections=e;break;case "refractions":a.K.refractions=e;break;case "sfx_mix_mode":a.ea.hw=e;break;case "shaders_dir":case "shaders_path":a.Ze.shaders_path=e;
break;case "shadows":a.K.shadows=e;break;case "show_hud_debug_info":a.K.show_hud_debug_info=e;break;case "smaa":b.Hu("smaa");a.K.smaa=e;break;case "smaa_search_texture_path":b.Hu("smaa_search_texture_path");a.Ze.smaa_search_texture_path=e;break;case "smaa_area_texture_path":b.Hu("smaa_area_texture_path");a.Ze.smaa_area_texture_path=e;break;case "ssao":a.K.ssao=e;break;case "debug_view":a.K.debug_view=e;break;case "enable_selectable":a.K.enable_selectable=e;break;case "enable_outlining":a.K.enable_outlining=
e;break;case "outlining_overview_mode":a.Yc.outlining_overview_mode=e;break;case "glow_materials":a.K.glow_materials=e;break;case "url_params":a.K.url_params=e;break;case "use_min50":a.K.use_min50=e;break;case "enable_texture_cache":a.K.enable_texture_cache=e;break;case "gl_debug":a.K.gl_debug=e;break;case "srgb_type":a.K.srgb_type=e;break;case "shadow_blur_samples":a.K.shadow_blur_samples=e;break;case "reflection_quality":a.K.reflection_quality=e;break;case "assets_gzip_available":a.K.assets_gzip_available=
e;break;case "debug_loading":a.K.debug_loading=e;break;case "msaa_samples":a.K.Zb=e;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.K.allow_cors;case "allow_hidpi":return a.K.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.K.alpha_sort;case "alpha_sort_threshold":return a.K.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.K.stereo;case "animation_framerate":return a.Sl.Tu;case "anisotropic_filtering":return a.K.anisotropic_filtering;
case "antialiasing":return a.K.antialiasing;case "assets_dir":case "assets_path":return a.ae.path;case "assets_dds_available":return a.ae.Bz;case "assets_pvr_available":return a.ae.Kw;case "assets_min50_available":return a.ae.PA;case "audio":return a.ea.FC;case "background_color":return a.K.background_color;case "bloom":return a.K.bloom;case "built_in_module_name":return a.Ze.Ot;case "canvas_resolution_factor":return a.K.canvas_resolution_factor;case "console_verbose":return a.K.console_verbose;case "compositing":return a.K.compositing;
case "dof":return a.K.dof;case "do_not_load_resources":return a.K.do_not_load_resources;case "is_mobile_device":return a.K.is_mobile_device;case "god_rays":return a.K.god_rays;case "stereo":return a.K.stereo;case "lod_leap_smooth_threshold":return a.K.lod_leap_smooth_threshold;case "lod_smooth_transitions":return a.K.lod_smooth_transitions;case "max_fps":return a.K.max_fps;case "max_fps_physics":return a.L.max_fps;case "media_auto_activation":return a.K.media_auto_activation;case "motion_blur":return a.K.motion_blur;
case "physics_enabled":return a.L.enabled;case "physics_uranium_path":return a.L.uJ;case "physics_uranium_bin":return a.L.Vx;case "physics_use_wasm":return a.L.Ss;case "physics_calc_fps":return a.L.az;case "physics_use_workers":return a.L.qn;case "precision":return a.K.precision;case "prevent_caching":return a.ae.prevent_caching;case "quality":return a.K.quality;case "reflections":return a.K.reflections;case "refractions":return a.K.refractions;case "sfx_mix_mode":return a.ea.hw;case "shaders_dir":case "shaders_path":return a.Ze.shaders_path;
case "shadows":return a.K.shadows;case "show_hud_debug_info":return a.K.show_hud_debug_info;case "smaa":return a.K.smaa;case "smaa_search_texture_path":return a.Ze.smaa_search_texture_path;case "smaa_area_texture_path":return a.Ze.smaa_area_texture_path;case "ssao":return a.K.ssao;case "debug_view":return a.K.debug_view;case "enable_selectable":return a.K.enable_selectable;case "enable_outlining":return a.K.enable_outlining;case "outlining_overview_mode":return a.Yc.outlining_overview_mode;case "glow_materials":return a.K.glow_materials;
case "url_params":return a.K.url_params;case "use_min50":return a.K.use_min50;case "enable_texture_cache":return a.K.enable_texture_cache;case "gl_debug":return a.K.gl_debug;case "srgb_type":return a.K.srgb_type;case "shadow_blur_samples":return a.K.shadow_blur_samples;case "reflection_quality":return a.K.reflection_quality;case "assets_gzip_available":return a.K.assets_gzip_available;case "debug_loading":return a.K.debug_loading;case "msaa_samples":return a.K.Zb;default:b.error("Unknown config property: "+
c)}};a.reset=function(){for(var b in a.LE)a.context[b]=a.LE[b];for(b in a.bF)a.K[b]=a.bF[b];for(b in a.HD)a.ae[b]=a.HD[b];for(b in a.tH)a.L[b]=a.tH[b];for(b in a.WH)a.ap[b]=a.WH[b];for(b in a.rI)a.ea[b]=a.rI[b];for(b in a.$E)a.im[b]=a.$E[b]};a.reset_limits=function(){var b=a.xh.Xn,c;for(c in a.KE)a.xh[c]=a.KE[c];a.xh.Xn=b};a.oG=e;a.xU=function(){var b=a.Ze,f=a.L;e()||""!=b.shaders_path||(b.shaders_path=c()+"/"+b.NU);if(a.L.Ss&&window.WebAssembly)var b=f.Wx+f.RJ,h=f.Wx+f.QJ;else b=f.Wx+f.GD,h=f.Wx+
f.YG;f.enabled&&""==f.Ms&&(f.Ms=c()+"/"+b.replace("B4W_URANIUM_PATH=",""),f.Vx=c()+"/"+h.replace("B4W_URANIUM_PATH=",""))};a.get_assets_path=function(b){var e=a.ae;if(e.path)return e.path;var k=e.cT,f="B4W_ASSETS_PATH=";b&&(k=e.sT,f="B4W_PROJ_ASSETS_PATH=",k=k.replace("__NAME__",b));k=k.replace(f,"");return k=k.replace("__JS__",c())}};b4w.module.__anchors=function(a,t){function e(){if(!A&&!I){var a=x;if(a)if("visible"==a.lastElementChild.style.visibility)c(),x=null;else if(1==a.style.opacity){var b=a.lastElementChild,a=a.firstElementChild,m=b.firstElementChild,d=Math.ceil(b.getBoundingClientRect().width),C=Math.ceil(b.getBoundingClientRect().height),H=Math.ceil(a.getBoundingClientRect().width),e=Math.ceil(a.getBoundingClientRect().height);b.style.position="absolute";b.style.visibility="visible";var g=!0,l=!0;a.style.display="none";
A=!0;H!=d?G.animate(H,d,200,function(a){a==d&&(g=!1,l||(A=!1,m.style.visibility="visible"));b.style.width=a+"px"}):(g=!1,l||(A=!1));e!=C?G.animate(e,C,200,function(a){a==C&&(l=!1,g||(A=!1,m.style.visibility="visible"));b.style.height=a+"px"}):(l=!1,g||(A=!1))}}}function c(){var a=x.lastElementChild;x.firstElementChild.style.display="";a.style.visibility="hidden";a.style.position="relative";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}
function f(a,m,d){var C=document.createElement("div"),H=document.createElement("span");d&&(C.style.maxWidth=d+"px");C.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;";b(H);H.innerHTML=
a;C.style.visibility="hidden";H.style.visibility="hidden";C.appendChild(H);m.appendChild(C);p.add_click_listener(m,function(){A||m==x||1!=m.style.opacity||I||(x&&"visible"==x.lastElementChild.style.visibility&&c(),x=m)})}function k(){for(var a=0,b=0;b<N.length;b++)N[b].Yn&&a++;C=new Float32Array(3*a)}function q(a,b){return b.depth-a.depth}function h(a,b,m){a=a.element;n.fG&&(b=Math.floor(b),m=Math.floor(m));"transform"in a.style?a.style.transform="translate3d("+b+"px, "+m+"px, 0px)":"webkitTransform"in
a.style?a.style.webkitTransform="translate3d("+b+"px, "+m+"px, 0px)":(a.style.left=b+"px",a.style.top=m+"px")}function u(a){for(var b=0;b<N.length;b++)if(N[b].obj==a)return!0;return!1}var y=t("__batch"),g=t("__camera"),d=t("__config"),r=t("__container"),p=t("__input"),M=t("__objects"),E=t("__obj_util"),z=t("__print"),l=t("__renderer"),B=t("__scenes"),w=t("__subscene"),G=t("__time"),v=t("__transform"),D=t("__tsr"),F=t("__vec3"),n=d.K,N=[],I=!1,x=null,J=!1,A=!1,C=new Float32Array(0),R=new Uint8Array(16),
m=new Float32Array(2),H=new Float32Array(3),U=new Float32Array(3);a.append=function(a){if(!u(a)){var m=a.anchor.Yn&&!!B.Pb(B.Fh(),w.zn),m={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Tl:"out",Yn:m,element:null,Go:null,mM:a.anchor.ES,Ek:a.anchor.Ek};switch(m.type){case "ANNOTATION":var d=m.obj;a=r.get_container();var C=M.get_meta_tags(d),d=d.name,c="",H=document.createElement("div"),g=H.cloneNode(!1),l=document.createElement("span");H.style.cssText+="position:        absolute;height:          0;top:             0;left:            0;transform-style: preserve-3d;";
g.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;";H.style.visibility="hidden";C&&(c=C.description||c,d=C.title||d);l.innerHTML=d;l.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(l);l.style.whiteSpace="nowrap";g.appendChild(l);H.appendChild(g);c&&f(c,H,m.mM);a.appendChild(H);m.element=H;break;case "ELEMENT":if(m.element=document.getElementById(a.anchor.Ek),m.element)for(C=0;C<N.length;C++)"ELEMENT"==N[C].type&&N[C].Ek==a.anchor.Ek&&(z.warn("Anchor with the id '"+a.anchor.Ek+"' already exists, making the new anchor generic."),m.type="GENERIC");else z.warn("Anchor HTML element with the id '"+a.anchor.Ek+"' was not found, making it generic."),m.type="GENERIC"}N.push(m);k();
J||(J=!0,r.get_container().addEventListener("mouseup",e))}};a.remove=function(a){for(var b=0;b<N.length;b++){var m=N[b];if(m.obj==a){"ANNOTATION"==m.type&&(a=m,r.get_container().removeChild(a.element));N.splice(b,1);k();break}}};a.update=function(a){for(var b=0,m=N.length;m--;){var d=N[m];if(d.Yn){var c=D.get_trans_view(d.obj.v.C);C.set(c,3*b++)}var e;e=d;var c=H,l=B.Jk(B.Fh());e=D.get_trans_view(e.obj.v.C);g.project_point(l,e,c);e=c;c=e[0];l=e[1];e=e[2];if(a||c!=d.x||l!=d.y||e!=d.depth){switch(d.type){case "ANNOTATION":var A=
c,n=l;h(d,A,n);break;case "ELEMENT":n=d.element.getBoundingClientRect(),A=c-n.width/2,n=l-n.height/2,h(d,A,n)}d.x=c;d.y=l;d.depth=e;d.Go&&d.Go(c,l,d.Tl,d.obj,d.element)}}N.sort(q);for(m=0;m<N.length;m++)d=N[m],"GENERIC"!=d.type&&(d.element.style.zIndex=x==d.element?N.length:m);0<b&&(a=B.Pb(B.Fh(),w.zn),b=a.Xa[0].Ia[0],y.zV(b.ya,C),w.Rc(a,b))};a.sJ=function(){for(var a=r.get_container(),b=B.get_active(),b=B.Pb(b,w.Eg),b=!(!b||!b.enable_hmd_stereo),d=N.length;d--;){var C=N[d],e=C.obj,g=e.v,A=C.x,n=
C.y,J=C.depth,k=B.Jk(B.Fh()),f=v.get_translation(e,H),k=v.get_translation(k,U),f=F.dist(f,k);(J=0>A||0>n||0>J||1<J||B.is_hidden(e)||A>=a.clientWidth||n>=a.clientHeight)||(g.Dj?(J=g.mg,g=f<g.ng?!1:J==E.By||f<J?!0:!1):g=!0,J=!g);g=J?"out":"visible";C.Yn&&"out"!=g&&(g=C,J=B.Pb(B.Fh(),w.zn).F,f=r.wq(g.x,g.y,m,J),l.Nw(J.Ve,f[0],J.height-f[1],2,2,R),g=255<=R[0]+R[4]+R[8]+R[12]?"visible":"out"!=g.Tl&&R[0]+R[4]+R[8]+R[12]?g.Tl:"covered");b&&(g="out");if(g!=C.Tl){switch(C.type){case "ANNOTATION":case "ELEMENT":var p=
C.element;p&&("out"==g?(p.style.visibility="hidden",p.children.length&&(p.children[0].style.visibility="hidden")):"visible"==g?(p.style.visibility="visible",p.children.length&&(p.children[0].style.visibility="visible"),p.style.opacity=1):(p.style.visibility="visible",p.style.opacity=.1,p.children.length&&(p.children[0].style.visibility="visible"),"ANNOTATION"==C.type&&1<p.children.length&&"visible"==p.lastElementChild.style.visibility&&(c(),p==x&&(x=null))))}C.Tl=g;C.Go&&C.Go(A,n,C.Tl,e,p)}}};a.attach_move_cb=
function(a,b){for(var m=0;m<N.length;m++)N[m].obj==a&&(N[m].Go=b)};a.detach_move_cb=function(a){for(var b=0;b<N.length;b++)N[b].obj==a&&(N[b].Go=null)};a.cleanup=function(){for(var a=0;a<N.length;a++){var b=N[a];"ANNOTATION"==b.type&&r.get_container().removeChild(b.element)}N.length=0};a.is_anchor=u;a.get_element_id=function(a){for(var b=0;b<N.length;b++)if(N[b].obj==a)return N[b].Ek;return!1};a.pause=function(){I=!0};a.resume=function(){I=!1};a.dT=function(a,b){for(var m=-1,d=0;d<N.length;d++){var C;
if(C="visible"==N[d].Tl){var c=N[d];if(c.element){C=Math.round(c.element.offsetWidth)||0;var H=Math.round(c.element.offsetHeight)||0}else H=C=0;var e=c.x,c=c.y;C=a>=e&&a<=e+C&&b<c&&b>=c-H?!0:!1}if(C)if(0>m)var g=N[d].depth,m=d;else N[d].depth<g&&(m=d,g=N[d].depth)}return 0>m?null:N[m].obj}};b4w.module.__armature=function(a,t){function e(a){a=a.v;for(var b=a.fp,d=a.fw,c=0;c<b.length;c++){for(var e=b[c],g=d[c],k=0;k<g.length;k+=2)for(var f=g[k],v=g[k+1],p=0;4>p;p++)e.Pd[f+p]=a.Pd[v+p],e.Fe[f+p]=a.Fe[v+p],e.Wd[f+p]=a.Wd[v+p],e.Ke[f+p]=a.Ke[v+p];e.Af=a.Af}}function c(a,b,d,e){var g=a.uC,k=a.Xh,w=a.Hs,p=a.Vm;p?(p=p.Hs,b?f.multiply(p,g,w):(b=y,f.invert(p,b),f.multiply(b,w,g))):b?f.copy(g,w):f.copy(w,g);g=u;f.invert(k,g);f.multiply(w,g,g);k=a.gi;d[4*k]=g[0];d[4*k+1]=g[1];d[4*k+2]=g[2];d[4*
k+3]=g[3];e[4*k]=g[4];e[4*k+1]=g[5];e[4*k+2]=g[6];e[4*k+3]=g[7];a=a.su;for(k=0;k<a.length;k++)w=a[k],w.qc||c(w,!0,d,e)}var b=t("__util"),f=t("__tsr"),k=t("__quat"),q=t("__mat4"),h=t("__vec3"),u=f.create(),y=f.create(),g=new Float32Array(4),d=new Float32Array(4),r=new Float32Array(4);a.Ap=function(a,d){for(var c=a.data.bones,g=a.pose.bones,e={},k=0;k<g.length;k++){var w=g[k],p=w.bone,v=p.name,r=e[v]={gi:0,KJ:-1,Vm:null,su:[],St:[],qc:null,yp:f.create(),uC:f.create(),Xh:f.create(),wC:f.create(),Hs:f.create(),
Sx:f.create(),Rx:f.create(),Gs:f.create(),vC:f.create(),Qx:!1,UI:new Float32Array(3)},v=new Float32Array(p.matrix_local),F=new Float32Array(16);q.invert(v,F);var w=new Float32Array(w.matrix_basis),n=r.UI;h.subtract(b.f32(p.tail_local),b.f32(p.head_local),n);b.tW(n,F,n);f.from_mat4(v,r.Xh);f.from_mat4(w,r.Gs);f.copy(r.Xh,r.Hs);f.invert(r.Xh,r.wC)}for(k=0;k<c.length;k++){v=c[k].name;w=b.keysearch("name",v,g);r=e[v];p=w.parent_recursive;r.St.push(r);for(F=0;F<p.length;F++)w=p[F],w=w.name,w=e[w],r.St.push(w);
p.length?(w=p[0],w=w.name,w=e[w],r.Vm=w,f.invert(w.Xh,u),f.multiply(u,r.Xh,r.yp),w.su.push(r)):f.copy(r.Xh,r.yp);r.gi=k;r.name=v;f.multiply(r.yp,r.Gs,r.uC)}d.v.Kg=e};a.get_bone_tsr=function(a,b,c,e,l){var p=a.v,w=p.Af;b=p.Kg[b];var h=b.gi;a=b.Xh;var v=p.Wd,M=p.Ke,F=p.Pd,p=p.Fe,n=v[4*h+1],z=v[4*h+2],q=v[4*h+3],x=M[4*h+1],J=M[4*h+2],A=M[4*h+3];g[0]=(1-w)*v[4*h]+w*M[4*h];g[1]=(1-w)*n+w*x;g[2]=(1-w)*z+w*J;g[3]=(1-w)*q+w*A;d[0]=F[4*h];d[1]=F[4*h+1];d[2]=F[4*h+2];d[3]=F[4*h+3];r[0]=p[4*h];r[1]=p[4*h+1];
r[2]=p[4*h+2];r[3]=p[4*h+3];k.slerp(d,r,w,d);w=u;f.set_transcale(g,w);f.set_quat(d,w);c?(c=y,f.translate(a,b.UI,c),f.multiply(w,c,w)):f.multiply(w,a,w);if(e){if(e=b.Vm)c=y,f.invert(e.Hs,c),f.multiply(c,w,w);e=y;f.invert(b.yp,e);f.multiply(e,w,w)}f.copy(w,l)};a.set_bone_tsr=function(a,b,d,g){var l=a.v;b=l.Kg[b];var k=l.Wd,w=l.Pd;g?f.multiply(b.yp,d,b.uC):f.copy(d,b.Hs);c(b,g,k,w);l.Af=0;e(a)};a.eW=e;a.GV=c;a.Tt=function(a,b){return b in a.v.Kg}};b4w.module.__boundings=function(a,t){function e(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function b(){return{S:new Float32Array(3),Qa:new Float32Array(3),Ra:new Float32Array(3),Sa:new Float32Array(3)}}function f(a,b){var d=a.max_y,c=a.max_z,m=a.min_x,H=a.min_y,g=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,d);a.max_z=Math.max(b.max_z,c);a.min_x=
Math.min(b.min_x,m);a.min_y=Math.min(b.min_y,H);a.min_z=Math.min(b.min_z,g);return a}function k(a,b,d,c){var m=a[b],C=a[b+1],g=a[b+2],e=a[b],l=a[b+1],A=a[b+2];for(b+=3;b<d;b+=3)var n=a[b],k=a[b+1],w=a[b+2],m=Math.max(m,n),C=Math.max(C,k),g=Math.max(g,w),e=Math.min(e,n),l=Math.min(l,k),A=Math.min(A,w);c.max_x=m;c.max_y=C;c.max_z=g;c.min_x=e;c.min_y=l;c.min_z=A;return c}function q(a,b){b||(b=new Float32Array(24));var d=a.max_x,c=a.max_y,m=a.max_z,H=a.min_x,g=a.min_y,e=a.min_z;b[0]=H;b[1]=g;b[2]=e;b[3]=
d;b[4]=g;b[5]=e;b[6]=d;b[7]=c;b[8]=e;b[9]=H;b[10]=c;b[11]=e;b[12]=H;b[13]=g;b[14]=m;b[15]=d;b[16]=g;b[17]=m;b[18]=d;b[19]=c;b[20]=m;b[21]=H;b[22]=c;b[23]=m;return b}function h(){return{S:new Float32Array(3),ib:0}}function u(a,b){b.S[0]=a.S[0];b.S[1]=a.S[1];b.S[2]=a.S[2];b.ib=a.ib;return b}function y(){return{Qa:new Float32Array(3),Ra:new Float32Array(3),Sa:new Float32Array(3),S:new Float32Array(3)}}function g(a,b){l.copy(a.Qa,b.Qa);l.copy(a.Ra,b.Ra);l.copy(a.Sa,b.Sa);l.copy(a.S,b.S);return b}function d(a,
b,d,c){return{Qa:new Float32Array(a),Ra:new Float32Array(b),Sa:new Float32Array(d),S:new Float32Array([c[0],c[1],c[2]])}}function r(a,b){var C=B.nN(a,n),C=b?B.kN(a,C,I):w.identity(I),C=B.UP(C,N);l.copy(a,v);l.transformMat3(v,C,v);for(var c=v[0],m=c,g=v[1],e=g,k=v[2],A=k,f,p,J,r,h=3;h<a.length;h+=3)v[0]=a[h],v[1]=a[h+1],v[2]=a[h+2],l.transformMat3(v,C,v),f=v[0],p=v[1],J=v[2],f>c&&(c=f),f<m&&(m=f),p>g&&(g=p),p<e&&(e=p),J>k&&(k=J),J<A&&(A=J);c=Math.max(c-m,.001);g=Math.max(g-e,.001);k=Math.max(k-A,.001);
A=w.identity(I);A[0]=c?1/c:2E3;A[4]=g?1/g:2E3;A[8]=k?1/k:2E3;w.transpose(C,x);v[0]=a[0];v[1]=a[1];v[2]=a[2];l.transformMat3(v,C,v);l.transformMat3(v,A,v);l.transformMat3(v,x,v);e=v[0];m=v[0];f=v[1];p=v[1];J=v[2];r=v[2];for(h=3;h<a.length;h+=3)v[0]=a[h],v[1]=a[h+1],v[2]=a[h+2],l.transformMat3(v,C,v),l.transformMat3(v,A,v),l.transformMat3(v,x,v),e=Math.max(e,v[0]),m=Math.min(m,v[0]),f=Math.max(f,v[1]),p=Math.min(p,v[1]),J=Math.max(J,v[2]),r=Math.min(r,v[2]);h=Math.sqrt((e-m)*(e-m)+(f-p)*(f-p)+(J-r)*
(J-r))/2;h=Math.min(h,1);F[0]=(e+m)/2;F[1]=(f+p)/2;F[2]=(J+r)/2;e=F;A=w.identity(I);A[0]=c;A[4]=g;A[8]=k;l.transformMat3(e,C,e);l.transformMat3(e,A,e);l.transformMat3(e,x,e);A=[C[0],C[3],C[6]];m=[C[1],C[4],C[7]];C=[C[2],C[5],C[8]];l.scale(A,c*h,A);l.scale(m,g*h,m);l.scale(C,k*h,C);return d(A,m,C,e)}function p(){return{ib:0,height:0,S:new Float32Array(3)}}function M(a,b,d){l.add(b,d,a.S);l.scale(a.S,.5,a.S);a.ib=l.distance(a.S,b);return a}var E=t("__tsr"),z=t("__util"),l=t("__vec3"),B=t("__math"),
w=t("__mat3"),G=new Float32Array(24),v=new Float32Array(3),D=new Float32Array(3),F=new Float32Array(3),n=new Float32Array(3),N=new Float32Array(9),I=new Float32Array(9),x=new Float32Array(9);a.hG=function(){return{Pe:e(),nf:y(),rf:h()}};a.ME=function(a,b){c(a.Pe,b.Pe);g(a.nf,b.nf);u(a.rf,b.rf)};a.Re=e;a.ni=c;a.hu=b;a.ZN=function(a,b){l.copy(a.S,b.S);l.copy(a.Qa,b.Qa);l.copy(a.Ra,b.Ra);l.copy(a.Sa,b.Sa)};a.RX=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};
a.KW=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Vt=function(a){var b=e();c(a,b);return b};a.lN=function(a){var b=a.max_x-a.min_x,d=a.max_y-a.min_y;d<b&&(b=d);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.Iu=f;a.Sy=k;a.On=function(a,b,d){d||(d=e());a=q(a,G);E.transform_vectors(a,b,a);return k(a,0,a.length,d)};a.mF=q;a.KZ=function(a,b,d){d||(d=e());var c=b.min_x,m=b.max_x,C=b.min_y,g=b.max_y,l=b.min_z;b=b.max_z;if(c>=a.max_x||m<=a.min_x||C>=a.max_y||g<=a.min_y||l>=a.max_z||
b<=a.min_z)return d.min_x=-.1,d.max_x=.1,d.min_y=-.1,d.max_y=.1,d.min_z=-.2,d.max_z=-.1,d;d.min_x=Math.max(a.min_x,c);d.max_x=Math.min(a.max_x,m);d.min_y=Math.max(a.min_y,C);d.max_y=Math.min(a.max_y,g);d.min_z=Math.max(a.min_z,l);d.max_z=Math.min(a.max_z,b);return d};a.PZ=function(a,b,d){d||(d=e());var c=a.max_x-a.min_x,m=a.max_y-a.min_y,C=a.max_z-a.min_z;d.min_x=a.min_x-.5*(b-1)*c;d.max_x=a.max_x+.5*(b-1)*c;d.min_y=a.min_y-.5*(b-1)*m;d.max_y=a.max_y+.5*(b-1)*m;d.min_z=a.min_z-.5*(b-1)*C;d.max_z=
a.max_z+.5*(b-1)*C;return d};a.Kt=function(a,b,d){d||(d=h());E.transform_vec3(a.S,b,d.S);b=E.get_scale(b);d.ib=a.ib*(0>b?-b:b);return d};a.Zy=function(a,b,d){d||(d=y());E.transform_vec3(a.S,b,d.S);l.copy(a.Qa,d.Qa);l.copy(a.Ra,d.Ra);l.copy(a.Sa,d.Sa);E.transform_dir_vec3(d.Qa,b,d.Qa);E.transform_dir_vec3(d.Ra,b,d.Ra);E.transform_dir_vec3(d.Sa,b,d.Sa);return d};a.$y=function(a,d,c){c||(c=b());E.transform_vec3(a.S,d,c.S);l.copy(a.Qa,c.Qa);l.copy(a.Ra,c.Ra);l.copy(a.Sa,c.Sa);E.transform_dir_vec3(c.Qa,
d,c.Qa);E.transform_dir_vec3(c.Ra,d,c.Ra);E.transform_dir_vec3(c.Sa,d,c.Sa);return c};a.bE=function(a,b){var d=h();l.copy(b,d.S);d.ib=a;return d};a.QT=function(a,d,c,e,m){var C=b();l.copy(a,C.S);l.copy(d,C.Qa);l.copy(c,C.Ra);l.copy(e,C.Sa);l.scale(C.Qa,m[0],C.Qa);l.scale(C.Ra,m[1],C.Ra);l.scale(C.Sa,m[2],C.Sa);return C};a.du=h;a.zk=u;a.Nq=y;a.Pn=g;a.ZX=function(a){var b=y();g(a,b);return b};a.$X=function(a){var b=h();u(a,b);return b};a.Ty=d;a.VM=function(){var a;a||(a=h());l.set(0,0,0,a.S);a.ib=1E12;
return a};a.JP=function(a,b){var d=l.subtract(b.S,a.S,l.create());0==l.length(d)&&l.set(1,0,0,d);var c=l.normalize(d,l.create()),d=l.scale(c,a.ib,l.create());l.add(d,a.S,d);var m=l.scale(c,-a.ib,l.create());l.add(m,a.S,m);var e=l.scale(c,b.ib,l.create());l.add(e,b.S,e);var g=l.scale(c,-b.ib,l.create());l.add(g,b.S,g);d=[d,m,e,g];c=l.normalize(c,l.create());m=d[0];e=d[0];for(g=1;g<d.length;g++){var n=l.dot(d[g],c);n<l.dot(m,c)&&(m=d[g]);n>l.dot(e,c)&&(e=d[g])}c=[m,e];d=c[0];c=c[1];a.S=l.scale(l.add(d,
c,l.create()),.5,l.create());a.ib=l.length(l.subtract(c,d,l.create()))/2};a.Nz=function(a,b){l.add(a.S,a.Ra,v);l.add(v,a.Qa,v);l.add(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.add(a.S,a.Ra,v);l.add(v,a.Qa,v);l.subtract(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.add(a.S,a.Ra,v);l.subtract(v,a.Qa,v);l.add(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.add(a.S,a.Ra,v);l.subtract(v,a.Qa,v);l.subtract(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.subtract(a.S,a.Ra,v);l.add(v,a.Qa,v);l.add(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.subtract(a.S,a.Ra,
v);l.add(v,a.Qa,v);l.subtract(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.subtract(a.S,a.Ra,v);l.subtract(v,a.Qa,v);l.add(v,a.Sa,v);b.push(v[0],v[1],v[2]);l.subtract(a.S,a.Ra,v);l.subtract(v,a.Qa,v);l.subtract(v,a.Sa,v);b.push(v[0],v[1],v[2])};a.cu=r;a.eO=function(a){var d=b();l.copy(a.Qa,d.Qa);l.copy(a.Ra,d.Ra);l.copy(a.Sa,d.Sa);l.copy(a.S,d.S);return d};a.eu=function(a){var b=h(),d;d=l.length(a.Qa);var c=l.length(a.Ra),m=l.length(a.Sa);d=d>c?d:c;b.S=a.S;b.ib=m>d?m:d;return b};a.lG=function(a,b){var d=l.length(a.Qa),
c=l.length(a.Ra),m=l.length(a.Sa);return.75*b.ib*b.ib*b.ib>d*c*m};a.yR=a.AR=a.zR=p;a.PD=function(a,b){var d=b.max_z,c=b.min_z,m=Math.max(0,d-c-2*a),e=p();e.ib=a;e.height=m;e.S[0]=0;e.S[1]=0;e.S[2]=(d+c)/2;return e};a.RD=function(a,b){var d=b.max_z,c=b.min_z,m=Math.max(0,d-c),e=p();e.ib=a;e.height=m;e.S[0]=0;e.S[1]=0;e.S[2]=(d+c)/2;return e};a.QD=function(a,b){var d=b.max_z,c=b.min_z,m=Math.max(0,d-c),e=p();e.ib=a;e.height=m;e.S[0]=0;e.S[1]=0;e.S[2]=(d+c)/2;return e};a.WN=a.YN=a.XN=function(a,b){b.ib=
a.ib;b.height=a.height;b.S.set(a.S);return b};a.WX=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.xT=function(a){for(var b=0,d=0,g=e(),m=0;m<a.submeshes.length;m++){for(var H=a.submeshes[m],l=H.position,n=0;n<l.length/3;n++)var w=l[3*n],v=l[3*n+1],p=l[3*n+2],b=Math.max(Math.sqrt(w*w+v*v+p*p),b),d=Math.max(Math.sqrt(w*w+v*v),d);n=H.boundings.bb;l=k(l,0,l.length,e());n.max_x=l.max_x;n.min_x=l.min_x;n.max_y=l.max_y;
n.min_y=l.min_y;n.max_z=l.max_z;n.min_z=l.min_z;n=q(l,G);n=r(n,!1);H.boundings.be_cen=n.S;H.boundings.be_ax=[n.Qa[0],n.Ra[1],n.Sa[2]];m?f(g,l):c(l,g)}m=a.b4w_boundings.bb;m.max_x=g.max_x;m.min_x=g.min_x;m.max_y=g.max_y;m.min_y=g.min_y;m.max_z=g.max_z;m.min_z=g.min_z;m=a.b4w_boundings.bb_src;m.max_x=g.max_x;m.min_x=g.min_x;m.max_y=g.max_y;m.min_y=g.min_y;m.max_z=g.max_z;m.min_z=g.min_z;a.b4w_boundings.bs_rad=b;a.b4w_boundings.bc_rad=d;n=q(g,G);n=r(n,!1);a.b4w_boundings.be_cen=n.S;a.b4w_boundings.be_ax=
[n.Qa[0],n.Ra[1],n.Sa[2]]};a.SQ=function(a){var b=a.subarray(0,3),d=a.subarray(6,9),c=a.subarray(12,15),m=a.subarray(18,21);a=l.subtract(d,b,v);l.normalize(a,a);var e=z.dR(b,d,c,D),e=l.cross(e,a,e);l.normalize(e,e);var g=l.create(),n=l.create();l.subtract(d,b,F);n[0]=l.dot(F,a);n[1]=l.dot(F,e);d=l.create();l.subtract(c,b,F);d[0]=l.dot(F,a);d[1]=l.dot(F,e);c=l.create();l.subtract(m,b,F);c[0]=l.dot(F,a);c[1]=l.dot(F,e);m=h();c=[g,n,d,c];g=M(m,c[0],c[1]);for(m=2;m<c.length;m++)if(l.distance(g.S,c[m])>
g.ib){for(var k=g,g=c,n=c[m],d=m-1,k=M(k,n,g[0]),w=1;w<=d;w++)if(l.distance(k.S,g[w])>k.ib){for(var f=k,k=g,p=n,r=g[w],x=w-1,f=M(f,p,r),u=0;u<=x;u++)if(l.distance(f.S,k[u])>f.ib){var J=p,aa=r,G=k[u],q=l.subtract(aa,G,F),q=l.squaredLength(q),E=l.subtract(J,G,F),I=l.squaredLength(E),E=l.subtract(J,aa,F),y=l.squaredLength(E),E=q*(I+y-q),B=I*(y+q-I),q=y*(q+I-y),I=E+B+q;l.copy(J,f.S);l.scale(f.S,E/I,f.S);l.scaleAndAdd(f.S,aa,B/I,f.S);l.scaleAndAdd(f.S,G,q/I,f.S);f.ib=l.distance(f.S,J)}k=f}g=k}m=g;a=l.scale(a,
m.S[0],F);l.scaleAndAdd(a,e,m.S[1],a);l.add(a,b,m.S);return m}};b4w.module.__compat=function(a,t){function e(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var f=t("__config"),k=t("__debug"),q=t("__extensions"),
h=t("__print"),u=t("__renderer"),y="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.eD=256;var g=f.Sl,d=f.K,r=f.im,p=f.context,M=f.xh,E=f.ea,z=f.L,l=f.ae;a.rP=function(a){a.getError()==a.INVALID_ENUM&&h.warn("Possible Tegra invalid enum issue detected, ignoring")};a.fI=function(B,w){function G(a){w&&h.warn(a)}M.CS=B.getParameter(B.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
M.IA=B.getParameter(B.MAX_FRAGMENT_UNIFORM_VECTORS);M.MA=B.getParameter(B.MAX_TEXTURE_IMAGE_UNITS);M.dw=B.getParameter(B.MAX_VARYING_VECTORS);M.NA=B.getParameter(B.MAX_VERTEX_ATTRIBS);M.XG=B.getParameter(B.MAX_VERTEX_TEXTURE_IMAGE_UNITS);M.ew=B.getParameter(B.MAX_VERTEX_UNIFORM_VECTORS);M.og=B.getParameter(B.MAX_CUBE_MAP_TEXTURE_SIZE);M.JA=B.getParameter(B.MAX_RENDERBUFFER_SIZE);M.Yb=B.getParameter(B.MAX_TEXTURE_SIZE);M.OA=B.getParameter(B.MAX_VIEWPORT_DIMS);var v=q.get_renderer_info();if(v){var D=
B.getParameter(v.UNMASKED_VENDOR_WEBGL),F=B.getParameter(v.UNMASKED_RENDERER_WEBGL);-1<D.indexOf("Qualcomm")&&-1<F.indexOf("330")&&e("Chrome")&&(G("Chrome and Qualcomm 330 detected, force enable WebGL 1."),d.Hb=!1)}M.Xn=d.Hb?24:16;d.Hb&&!r.enabled&&(d.Hq=!0);d.Hb?(d.Zb=Math.min(d.Zb,B.getParameter(B.MAX_SAMPLES)),e("Firefox")&&(G("Firefox and WebGL 2 detected, applying framebuffer hack."),d.mE=!0),e("Windows")&&e("Chrome")&&(G("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),
d.Zb=1)):d.Zb=1;e("Firefox")&&"NONE"!==d.stereo&&(G("Firefox and Stereo rendering detected, disable texture reusage"),d.oF=!0);if(d.Hb&&k.FN()||e("Firefox"))G("Firefox detected, disabling multisample"),d.Zb=1;e("Mac OS X")&&e("Chrome/60")&&(G("macOS and Chrome 60 detected, disabling multisample"),d.Zb=1);u.mU();var n=!!q.JQ();e("Firefox/28.0")&&(e("Linux")||e("Macintosh"))&&(G("Firefox 28 detected, applying depth hack"),n=!1);e("Windows Phone")||(e("iPad")||e("iPhone")?(G("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),
p.alpha||(d.background_color[3]=1),d.Dv=!0,d.JJ=!0,d.smaa=!1,d.ssao=!1,d.qA=!0,q.OF()&&l.Kw&&(d.cm="pvr")):e("Mac OS X")&&e("Safari")&&!e("Chrome")&&(G("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),d.SH=!0,E.LD=!0,E.vE=!0));e("Windows")&&(e("Chrome/40")||e("Firefox/33")||e("Firefox/34")||e("Firefox/35")||e("Firefox/36"))&&(G("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),
d.jz=!0);e("Chrome")&&!c()&&f.oG()&&(G('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),d.sE=!0);e("Mac OS X")&&(d.$v=!0,G("OS X detected, applying shadows hack."));c()&&(G("Mobile detected, applying various hacks for video textures."),d.is_mobile_device=!0,e("iPad")||e("iPhone")||e("Windows Phone")||(G("Mobile (not iOS) detected, disable playback rate for video textures."),E.eF=!0));e("iPad")&&(G('iPad detected, use "autoplay" hack for video textures.'),
d.kG=!0);(e("Firefox/35.0")||e("Firefox/36.0"))&&e("Windows")&&(G("Windows/Firefox 35/36 detected, applying shadows slink hack"),d.vI=!0);if(e("iPhone")||b())G("iPhone or IE11 detected. Enable sequential video fallback for video textures."),d.os=!0;10>M.dw&&(G("Not enough varyings, disable shadows on blend objects"),d.Ez=!0);e("Windows Phone")&&(G("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),d.debug_view=!1,d.glow_materials=!1,
d.ssao=!1,d.smaa=!1,d.shadows=!1,d.reflections=!1,d.refractions=!1,d.CH=!1);if(e("UCBrowser")||e("Chrome")&&e("Nexus")&&d.is_mobile_device)G("Mobile Nexus Chrome or UCBrowser detected, disable workers."),z.qn=!1;e("Firefox")&&(G("Firefox detected, disabling workers"),z.qn=!1);if(b()||e("Edge"))G("IE11 or Edge detected, disabling workers"),z.qn=!1;e("Chrome")&&e("Linux")&&(G("Chrome and Linux detected, disabling wasm physics."),z.Ss=!1);if(v){D=B.getParameter(v.UNMASKED_VENDOR_WEBGL);F=B.getParameter(v.UNMASKED_RENDERER_WEBGL);
v=/\b4\d{2}\b/;e("Chrome")&&-1<F.indexOf("Mali-T720")&&(G('Chrome and ARM Mali-T720 detected, changing "Alpha Anti-Aliasing" materials to "Alpha Clip".'),d.SG=!0);-1<F.indexOf("AMD")&&e("Windows")&&e("Firefox")&&(G("AMD, Windows and Firefox detected, disabling depth textures."),n=!1);-1<D.indexOf("ARM")&&v.test(F)&&(G("ARM Mali-400 series detected, applying lamps, depth and frames blending hacks"),n=!1,g.tF=!0,d.RG=!0);-1<D.indexOf("ARM")&&-1<F.indexOf("Mali-T604")&&(G("ARM Mali-T604 detected, disabling shadows."),
d.shadows=!1);-1<D.indexOf("ARM")&&-1<F.indexOf("Mali-T760")&&(G("ARM Mali-T760 detected, disabling SSAO."),d.ssao=!1,d.ex=!0,d.Hb&&(d.Zb=1,G("ARM Mali-T760 and WebGL 2 detected, switching MSAA samples to 1.")));-1<D.indexOf("ARM")&&-1<F.indexOf("Mali-T720")&&(G("ARM Mali-T720 detected, disabling depth textures."),n=!1,d.Hb&&(d.Zb=1,G("ARM Mali-T720 and WebGL 2 detected, switching MSAA samples to 1.")));-1<D.indexOf("Qualcomm")&&-1<F.indexOf("Adreno")&&(G("Qualcomm Adreno detected, applying shader constants hack."),
d.OB=!0,-1<F.indexOf("420")&&(G("Qualcomm Adreno420 detected, setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),M.Yb=Math.min(M.Yb,4096),M.og=Math.min(M.og,4096)),e("Chrome")&&(F.match(/4../)||F.match(/5../))&&(G("Qualcomm Adreno 4xx or 5xx detected, switch MSAA samples to 1."),d.Zb=1));-1<D.indexOf("NVIDIA")&&-1<F.indexOf("Tegra 3")&&(G("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.rF=!0);e("Windows")&&e("Chrome")&&!e("Edge")&&(F.match(/NVIDIA GeForce 8..0/)||
F.match(/NVIDIA GeForce 9..0/)||F.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(G("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 768x512, use canvas for resizing."),M.og=a.eD,d.hs=!0);-1<F.indexOf("PowerVR")&&-1<F.indexOf("SGX")&&(G("PowerVR SGX series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),d.hs=!0,d.ex=!0,d.shadows=!1);e("Windows")&&-1<F.indexOf("Direct3D9")&&(G("DirectX 9.0 detected, using canvas for resizing textures/cubemap textures."),
d.XE=!0,d.hs=!0,d.NH=!0);D="";for(v=0;v<y.length;v++)if(-1<F.indexOf(y[v])){D=y[v];break}D&&(G("Architecture "+D+" detected. Blending between frames and shadows on blend objects will be disabled."),d.ex=!0,d.Ez=!0)}0==M.XG&&(G("Vertex textures are not allowed. Disabling vertex textures"),d.st=!1);n||(d.io=!1,d.Lc=!1,d.water_dynamic=!1,d.shore_smoothing=!1,d.bp=!1,d.smaa=!1,d.ssao=!1,d.ks=!0);d.vJ=!!q.PF()||"pvr"==d.cm;d.ru=n;if(B.getShaderPrecisionFormat)var N=B.getShaderPrecisionFormat(B.FRAGMENT_SHADER,
B.HIGH_FLOAT);B.getShaderPrecisionFormat&&0!==N.precision||(d.precision="mediump");if(b()&&e("Touch")||e("Edge"))G("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),d.zv=!0;if(b()||e("Edge"))d.fG=!0,d.eG=!0,d.hs=!0;c()&&e("Firefox")&&(h.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),d.QA=!0,M.Yb=Math.min(M.Yb,4096),M.og=Math.min(M.og,4096));F=!!q.Tz();d.Oy=F;F=!!q.RF();
d.iC=F};a.hz=e;a.detect_mobile=c;a.FM=function(){e("Firefox/35.0")&&e("Windows")&&(h.warn("Windows/Firefox 35 detected, forcing context's alpha"),f.context.alpha=!0)};a.is_ie11=b};b4w.module.__constraints=function(a,t){function e(a){return{type:a,Ma:null,target:null,Ep:!1,pd:null,Ea:null,vi:null,axes:null,ZI:null,oe:null,DJ:!1,influence:0,uk:"",AI:0,uE:0,wE:0,xE:0,tE:0,Fz:0,dist_max:0,Rv:!1,Er:0,Nx:!1,Ds:0,distance:0,hor_units:"",vert_units:""}}function c(a,d){a.qc&&a.qc.Ma&&b(a.qc.Ma,a);if(d.Ma){var c=d.Ma;-1==c.ue.indexOf(a)?c.ue.push(a):B.I("Descendant object override is forbidden")}a.qc=d}function b(a,b){var d=a.ue.indexOf(b);-1!=d?a.ue.splice(d,1):B.I("No descendant object")}
function f(a,b,g,m,l,n){var C=e(3);C.Ma=b;C.ZI=new Float32Array(g);C.oe=new Float32Array(m);C.DJ=l;C.pd=new Float32Array(a.v.C);C.influence=n;c(a,C);d(a,C,0)}function k(a,b,g,m,n,k){var C=e(8);C.Ma=b;C.Ea=l.create();l.set_trans(g,C.Ea);C.axes=new Float32Array(m);C.influence=k;C.Ep=n;C.pd=new Float32Array(a.v.C);c(a,C);d(a,C,0)}function q(a,b,g,m,n){var C=e(9);C.Ma=b;b=l.tb(a.v.C,I);C.vi=B.quat_to_euler(b,new Float32Array(3));C.axes=new Float32Array(g);C.influence=n;C.Ep=m;C.pd=new Float32Array(a.v.C);
c(a,C);d(a,C,0)}function h(a,b,g){var m=e(11);m.Ma=b;m.Ea=l.create();l.copy(a.v.C,m.Ea);m.pd=new Float32Array(a.v.C);m.influence=g;c(a,m);d(a,m,0)}function u(a,b,g){var m=e(13);m.Ma=b;m.Ea=new Float32Array(g);c(a,m);d(a,m,0)}function y(a,b,g,m){var C=e(14);C.Ma=b;C.uk=g;C.Ea=new Float32Array(m);c(a,C);d(a,C,0)}function g(a,b,g){var m=e(17);m.Ma=b;m.pd=new Float32Array(a.v.C);m.Ea=l.create();B.ge(g.right)?(m.Rv=!1,m.Er=g.right):B.ge(g.left)?(m.Rv=!0,m.Er=g.left):(m.Rv=!0,m.Er=0);B.ge(g.bottom)?(m.Nx=
!1,m.Ds=g.bottom):B.ge(g.top)?(m.Nx=!0,m.Ds=g.top):(m.Nx=!0,m.Ds=0);B.ge(g.distance)?m.distance=g.distance:m.distance=0;b=B.ge(g.rotation)?new Float32Array(g.rotation):w.create();l.set_quat(b,m.Ea);B.ge(g.hor_units)?m.hor_units=g.hor_units:m.hor_units="widths";B.ge(g.vert_units)?m.vert_units=g.vert_units:m.vert_units="heights";c(a,m);d(a,m,0)}function d(a,b,d){switch(b.type){case 1:l.multiply(b.Ma.v.C,b.Ea,a.v.C);break;case 12:var m=l.get_trans_view(a.v.C),c=l.get_quat_view(a.v.C),g=l.Qb(b.Ea,F),
e=b.Ma.v.C;d=l.get_quat_view(b.Ma.v.C);w.multiply(w.invert(b.kB,b.kB),c,c);w.multiply(d,c,c);l.transform_vec3(g,e,m);w.copy(d,b.kB);m=l.get_quat_view(a.v.C);c=l.get_quat_view(b.Ma.v.C);e=l.tb(b.Ea,I);c=w.multiply(c,e,N);c=z.Uz(c,v);e=z.Uz(m,D);B.TT(m,a.v.oe,B.Zl(e[0],c[0]+b.wE,c[0]+b.uE),B.Zl(e[1],c[1]+b.tE,c[1]+b.xE),m);break;case 15:var m=l.get_trans_view(a.v.C),c=l.get_quat_view(a.v.C),e=b.Ma.v.C,C=l.get_trans_view(e),k=b.AI,f=F,p=w.copy(c,N),g=l.Qb(b.Ea,n);l.transform_vec3(g,e,f);B.smooth_v(f,
m,d,k,m);B.Mw(m,p,C,B.AXIS_MZ);B.zI(p,c,d,.16*k,c);break;case 2:c=l.get_quat_view(a.v.C);e=x;g=l.Qb(b.Ea,n);C=l.get_scale(b.Ea);m=l.tb(b.Ea,N);E.get_bone_tsr(b.Ma,b.uk,!0,!1,e);l.multiply(b.Ma.v.C,e,e);c[0]=e[4];c[1]=e[5];c[2]=e[6];c[3]=e[7];w.multiply(c,m,c);l.set_scale(C*e[3],a.v.C);m=l.get_trans_view(a.v.C);l.transform_vec3(g,e,m);break;case 3:m=l.get_trans_view(a.v.C);c=l.get_quat_view(a.v.C);g=l.get_trans_view(b.Ma.v.C);e=b.influence;b.DJ?(C=l.tb(b.Ma.v.C,N),C=G.transformQuat(B.AXIS_Z,C,F)):
C=B.AXIS_Z;B.Mw(m,c,g,b.ZI);g=G.subtract(g,m,n);G.normalize(g,g);B.tT(c,b.oe,C,g);g=l.tb(b.pd,N);w.slerp(g,c,e,c);l.set_trans(m,b.pd);break;case 5:m=l.get_trans_view(a.v.C);c=l.get_quat_view(a.v.C);g=l.get_trans_view(b.Ma.v.C);B.Mw(m,c,g,B.AXIS_MZ);c=G.dist(m,g);if(c=c>b.dist_max?c-b.dist_max:c<b.Fz?c-b.Fz:0)G.sub(g,m,F),G.normalize(F,F),G.scale(F,c,F),G.add(m,F,m);break;case 7:e=b.Ma.v.C;m=l.get_trans_view(a.v.C);g=l.Qb(b.Ea,F);l.transform_vec3(g,e,m);l.set_quat(l.get_quat_view(a.v.C),b.pd);break;
case 8:C=l.get_trans_view(b.Ma.v.C);m=l.get_trans_view(a.v.C);c=b.axes;d=l.Qb(b.Ea,F);g=G.set(0,0,0,n);b.Ep&&G.add(g,d,g);e=b.influence;c[0]&&(m[0]=(1-e)*d[0]+e*(B.sign(c[0])*C[0]+g[0]));c[1]&&(m[1]=(1-e)*d[1]+e*(B.sign(c[1])*C[1]+g[1]));c[2]&&(m[2]=(1-e)*d[2]+e*(B.sign(c[2])*C[2]+g[2]));l.set_quat(l.get_quat_view(a.v.C),b.pd);break;case 9:c=b.axes;d=l.tb(b.Ma.v.C,N);m=B.uT(d,b.vi,n);B.DE(m,b.vi);c[0]?(b.Ep&&(e=G.set(b.vi[0],0,0,F),B.DB(m,e,m)),m[0]*=B.sign(c[0])):m[0]=b.vi[0];c[1]?(b.Ep&&(e=G.set(0,
b.vi[1],0,F),B.DB(m,e,m)),m[1]*=B.sign(c[1])):m[1]=b.vi[1];c[2]?(b.Ep&&(e=G.set(0,0,b.vi[2],F),B.DB(m,e,m)),m[2]*=B.sign(c[2])):m[2]=b.vi[2];B.DE(m,b.vi);e=b.influence;m=B.euler_to_quat(m,N);g=l.tb(b.pd,I);w.slerp(g,m,e,l.get_quat_view(a.v.C));l.set_trans(l.get_trans_view(a.v.C),b.pd);break;case 11:e=b.influence;C=l.Qb(b.Ma.v.C,F);d=l.tb(b.Ma.v.C,N);m=l.Qb(b.Ea,n);g=l.tb(b.Ea,I);B.Ht(m,C,e,l.get_trans_view(a.v.C));w.slerp(g,d,e,l.get_quat_view(a.v.C));l.set_trans(l.get_trans_view(a.v.C),b.pd);break;
case 16:c=l.get_quat_view(a.v.C);e=b.Ma.v.C;d=l.get_quat_view(b.Ma.v.C);g=l.Qb(b.Ea,n);m=l.tb(b.Ea,N);w.multiply(d,m,c);m=l.get_trans_view(a.v.C);l.transform_vec3(g,e,m);break;case 13:l.multiply(b.Ma.v.C,b.Ea,a.v.C);break;case 14:m=b.Ea;e=x;E.get_bone_tsr(b.Ma,b.uk,!0,!1,e);l.multiply(b.Ma.v.C,e,e);l.multiply(e,m,a.v.C);break;case 17:c=b.Ma,e=z.MQ(c),m=l.get_trans_view(a.v.C),d=z.Zu(e,"LEFT"),k=z.Zu(e,"RIGHT"),g=z.Zu(e,"TOP"),C=z.Zu(e,"BOTTOM"),f="heights"==b.hor_units?g-C:k-d,m[0]=b.Rv?d+f*b.Er:
k-f*b.Er,d="heights"==b.vert_units?g-C:k-d,m[1]=b.Nx?g-d*b.Ds:C+d*b.Ds,z.QR(e)?m[2]=-b.distance:(m[2]=-1,G.normalize(m,m),G.scale(m,b.distance/Math.abs(m[2]),m)),l.transform_dir_vec3(m,c.v.C,m),e=l.get_trans_view(c.v.C),G.add(e,m,m),g=l.get_quat_view(a.v.C),c=l.get_quat_view(c.v.C),m=l.tb(b.Ea,I),w.multiply(c,m,g)}"CAMERA"==a.v.type&&a.v.nb!=z.MS_STATIC&&(m=a.v.oe,12==b.type&&(d=l.get_quat_view(b.Ma.v.C),m=G.transformQuat(m,d,J)),z.jJ(a),z.correct_up(a,m))}function r(a,b){switch(b.type){case 18:var d=
b.target.v.C,c=x;l.invert(a.v.C,c);l.multiply(c,d,c);E.set_bone_tsr(a,b.uk,c,!1)}a.ZA=!0}function p(a,b){for(var d=0;d<a.length;d++){var c=a[d];if(!p(c.ue,b)||c.name==b.name)return!1}return!0}var M=t("__physics"),E=t("__armature"),z=t("__camera"),l=t("__tsr"),B=t("__util"),w=t("__quat"),G=t("__vec3");a.TW=1;a.SW=2;a.XW=3;a.PW=5;a.UW=7;a.OW=8;a.RW=12;a.MW=13;a.NW=14;a.QW=15;a.VW=16;a.WW=17;a.LW=18;var v=new Float32Array(2),D=new Float32Array(2),F=new Float32Array(3),n=new Float32Array(3),N=new Float32Array(4),
I=new Float32Array(4),x=l.create(),J=new Float32Array(3);a.ED=function(a,b,g,m,n){var C=e(1);C.Ma=b;C.Ea=l.create();m=m?m:w.create();l.set_trans(g,C.Ea);l.set_scale(n,C.Ea);l.set_quat(m,C.Ea);C.pd=new Float32Array(a.v.C);c(a,C);d(a,C,0)};a.zM=function(a,b,g,m,n,k){var C=e(2);C.Ma=b;C.uk=g;C.pd=new Float32Array(a.v.C);C.Ea=l.create();l.set_trans(new Float32Array(m),C.Ea);l.set_quat(new Float32Array(n),C.Ea);l.set_scale(k,C.Ea);c(a,C);d(a,C,0)};a.xM=function(a,b,g,m,n,k,f,v){var C=e(12),H=l.get_quat_view(a.v.C),
p=l.get_quat_view(b.v.C);m?(w.copy(m,H),w.multiply(p,H,H)):m=w.create();C.Ma=b;C.Ea=l.create();l.set_trans(g,C.Ea);l.set_quat(m,C.Ea);C.kB=new Float32Array(p);C.uE=B.angle_wrap_0_2pi(n);C.wE=B.angle_wrap_0_2pi(k);C.xE=B.angle_wrap_periodic(f,-Math.PI,Math.PI);C.tE=B.angle_wrap_periodic(v,-Math.PI,Math.PI);C.pd=new Float32Array(a.v.C);c(a,C);d(a,C,0)};a.wM=function(a,b,g,m){var C=e(15);C.Ma=b;C.AI=m;C.pd=new Float32Array(a.v.C);C.Ea=l.create();l.set_trans(new Float32Array(g),C.Ea);c(a,C);d(a,C,0)};
a.BM=function(a,b,g,m){var C=e(16);C.Ma=b;C.pd=new Float32Array(a.v.C);C.Ea=l.create();l.set_trans(new Float32Array(g),C.Ea);l.set_quat(new Float32Array(m),C.Ea);l.set_scale(1,C.Ea);c(a,C);d(a,C,0)};a.uZ=b;a.CM=f;a.tM=function(a,b,g,m){var C=e(5);C.Ma=b;C.Fz=g;C.dist_max=m;C.pd=new Float32Array(a.v.C);c(a,C);d(a,C,0)};a.AM=function(a,b,g){var m=e(7);m.Ma=b;m.Ea=l.create();m.pd=new Float32Array(a.v.C);l.set_trans(new Float32Array(g),m.Ea);c(a,m);d(a,m,0)};a.oM=k;a.pM=q;a.qM=h;a.HX=u;a.IX=y;a.append_stiff_viewport=
g;a.KV=function(a,b){a.qc&&d(a,a.qc,b)};a.FV=function(a,b){var d=a.v.Kg[b];d.qc&&r(a,d.qc)};a.zN=function(a){return a.qc?!0:!1};a.remove=function(a,d){a.qc.Ma&&b(a.qc.Ma,a);d&&l.copy(a.qc.pd,a.v.C);a.qc=null};a.LY=function(a){return a.qc?a.qc.type:null};a.Vg=function(a){a=a.qc;return!a||13!=a.type&&14!=a.type?!1:!0};a.Yu=function(a){if((a=a.qc)&&13==a.type)return a.Ma.v.C;if(a&&14==a.type){var b=x;E.get_bone_tsr(a.Ma,a.uk,!0,!1,b);l.multiply(a.Ma.v.C,b,b);return b}return null};a.Tg=function(a){a=
a.qc;return!a||13!=a.type&&14!=a.type?null:a.Ea};a.pT=function(a,b){for(var d=b.v,c=0;c<a.constraints.length;c++){var C=a.constraints[c],n=C.type;if(C.target){var w=C.target.Fa;if("COPY_LOCATION"==n){var n=new Float32Array(l.get_trans_view(b.v.C)),v=new Float32Array(C.axes);k(b,w,n,v,C.use_offset,C.influence)}else if("COPY_ROTATION"==n)v=new Float32Array(C.axes),q(b,w,v,C.use_offset,C.influence);else if("COPY_TRANSFORMS"==n)h(b,w,C.influence);else if("TRACK_TO"==n){n=C.track_axis;if("TRACK_Y"==n)var p=
B.AXIS_Y;else"TRACK_NEGATIVE_Y"==n?p=B.AXIS_MY:"TRACK_X"==n?p=B.AXIS_X:"TRACK_NEGATIVE_X"==n?p=B.AXIS_MX:"TRACK_Z"==n?p=B.AXIS_Z:"TRACK_NEGATIVE_Z"==n&&(p=B.AXIS_MZ);n=C.up_axis;if("UP_X"==n)var F=B.AXIS_X;else"UP_Y"==n?F=B.AXIS_Y:"UP_Z"==n&&(F=B.AXIS_Z);f(b,w,p,F,C.use_target_z,C.influence)}}}if(b.parent){!b.fl&&b.nd.Ns&&b.parent.nd.Ns&&(b.Dp=!1);C=!1;for(c=0;c<b.O.length;c++)if(b.O[c].jb.zc){C=!0;break}if(C&&M.qR(b))c=b.fl?l.copy(d.C,l.create()):d.C,l.multiply(b.parent.v.C,c,d.C);else if(b.fl||
!b.Qr)if(c=l.copy(d.C,l.create()),b.hy&&"CAMERA"==b.parent.type){c={distance:b.hy.distance,rotation:l.get_quat_view(c)};switch(b.hy.jM){case "TOP_LEFT":c.top=0;c.left=0;break;case "TOP":c.top=0;c.left=.5;break;case "TOP_RIGHT":c.top=0;c.right=0;break;case "LEFT":c.top=.5;c.left=0;break;case "CENTER":c.top=.5;c.left=.5;break;case "RIGHT":c.top=.5;c.right=0;break;case "BOTTOM_LEFT":c.bottom=0;c.left=0;break;case "BOTTOM":c.bottom=0;c.left=.5;break;case "BOTTOM_RIGHT":c.bottom=0,c.right=0}g(b,b.parent,
c)}else u(b,b.parent,c);else c=l.copy(d.C,l.create()),y(b,b.parent,b.Qr,c)}if("ARMATURE"==b.type)for(d=a.pose.bones,c=0;c<d.length;c++)if(C=d[c],p=C.constraints)for(F=0;F<p.length;F++)if(n=p[F],"COPY_TRANSFORMS"==n.type&&!n.subtarget&&!n.mute){var w=n.target.Fa,n=b,v=w,x=B.Gy,J=B.et,w=e(18);w.uk=C.name;w.target=v;w.Ea=l.create();l.set_trans(new Float32Array(x),w.Ea);l.set_quat(new Float32Array(J),w.Ea);l.set_scale(1,w.Ea);for(var v=n,x=w,J=x.target,G=x.uk,A=v.v.Kg[G],z=J.pz,aa=0;aa<z;aa++){var E=
z[aa];if(E[0]==v&&E[1]==G){z.splice(aa,1);break}}J.pz.push([v,G]);A.qc=x;r(n,w)}};a.vh=function(a,b){return p(a.ue,b)};a.wh=function(a,b){return a.name!=b.name}};b4w.module.__container=function(a,t){var e,c,b;function f(){v.getBoundingClientRect()}function k(a,b,d,c){B.eG?(d=d.getBoundingClientRect(),c[0]=a-d.left,c[1]=b-d.top):(n.clientX=a,n.clientY=b,n.view=window,a=new MouseEvent("b4w_convert",n),d.dispatchEvent(a),c[0]=a.offsetX,c[1]=a.offsetY);return c}function q(a,b,d,c){a.style.width=d+"px";a.style.height=c+"px";b&&(b.style.width=d+"px",b.style.height=c+"px")}function h(a,b,c){var e=v,n=D;c&&q(e,n,a,b);n&&(n.width=a,n.height=b,d.kn());c=a*B.canvas_resolution_factor;
b*=B.canvas_resolution_factor;e.width=c;e.height=b;var n=Math.min(G.drawingBufferWidth,w.JA,w.OA[0]),C=Math.min(G.drawingBufferHeight,w.JA,w.OA[1]);if(c>n||b>C)r.warn("Canvas size exceeds platform limits, downscaling"),n=Math.min(n/c,n/b),c*=n,b*=n;e.width=Math.floor(c);e.height=Math.floor(b);p.nI(e.width,e.height,a?c/a:1);p.La()&&z.T(p.get_active().bj);g.TV(e.width,e.height);g.is_primary_loaded()&&(u.update(),p.update(E.get_timeline(),0),u.sJ())}var u=t("__anchors"),y=t("__config"),g=t("__data"),
d=t("__hud"),r=t("__print"),p=t("__scenes"),M=t("__subscene"),E=t("__time"),z=t("__transform"),l=t("__util"),B=y.K,w=y.xh,G=null,v=null,D=null,F=null,n={clientX:0,clientY:0};c=e=0;b=1;a.ug=function(a){G=a};a.get_canvas=function(){return v};a.get_canvas_hud=function(){return D};a.get_container=function(){return F};a.init=function(a,b){a&&a.parentNode?(v=a,D=b,F=a.parentNode):l.I("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":F.insertBefore(a,
F.firstElementChild);break;case "JUST_BEFORE_CANVAS":F.insertBefore(a,v);break;case "JUST_AFTER_CANVAS":v.nextElementSibling?F.insertBefore(a,v.nextElementSibling):F.appendChild(a,v);break;case "LAST":F.appendChild(a,v);break;default:r.error(b+" invalid stack order")}};a.UF=function(){return e};a.TF=function(){return c};a.set_canvas_offsets=function(){};a.update_canvas_offsets=f;a.LU=function(a,d,g){e=a;c=d;b=g;f()};a.force_offsets_updating=function(){};a.client_to_canvas_coords=function(a,b,d){return k(a,
b,v,d)};a.get_coords_target_space=function(a,b,d){a.constructor==MouseEvent?(d[0]=a.offsetX,d[1]=a.offsetY):a.constructor==TouchEvent?(b="touchend"==a.type?a.changedTouches:b?a.targetTouches:a.touches,k(b[0].clientX,b[0].clientY,a.target,d)):(d[0]=-1,d[1]=-1);return d};a.client_to_element_coords=k;a.wq=function(a,d,c,g){c||(c=new Float32Array(2));c[0]=a*b;c[1]=d*b;g&&(a=g.width/e,c[0]*=a,c[1]*=a);return c};a.xW=function(a,d,c,g){c||(c=new Float32Array(2));c[0]=a/b;c[1]=d/b;g&&(a=g.width/e,c[0]/=a,
c[1]/=a)};a.pG=function(b){return b&&b.parentNode?b.parentNode==F?!0:a.pG(b.parentNode):!1};a.uG=function(){return B.allow_hidpi&&2<=window.devicePixelRatio?!0:!1};a.XP=function(a){var b=document.getElementsByTagName("script");a=l.Ji(a);for(var d=0;d<b.length;d++)if(b[d].src==a)return b[d];return null};a.resize=h;a.resize_to_container=function(a){var b=F,d=v,c=b.clientWidth,b=b.clientHeight;if(a||c!=d.clientWidth||b!=d.clientHeight){a=d.width;d=d.height;q(v,D,c,b);if(p.La()){var g=p.get_active();
if((g=p.Pb(g,M.Eg))&&g.enable_hmd_stereo){h(a,d,!1);return}}h(c,b,!1)}};a.reset=function(){F=D=v=G=null}};b4w.module.__controls=function(a,t){function e(a,b){b||(b=r.get_container());return{type:a,value:0,aa:null,element:b,Ta:!1,key:0,Jb:"",ji:!1,nz:null,mz:function(){},lz:null,CE:function(){},Qi:null,from:new Float32Array(3),to:new Float32Array(3),mG:!1,Av:!1,cs:0,FH:function(){},axis:"",Ag:0,xp:new Float32Array(3),Lw:new Float32Array(4),threshold:0,DH:new Float32Array(4),Ct:0,Bt:0,QH:0,Dt:0,sg:0,repeat:!1,jF:!1,gamepad_id:0,position:v.create(),orientation:l.create(),callback:function(){}}}function c(a){function b(){return{yk:new Float32Array(2),
Hm:!0,obj:null,identifier:-1,Jv:!0}}a||(a=r.get_container());for(var d=0;d<J.length;d++){var c=J[d];if(a==c.element)return c}c={element:a,yr:!0,Cf:0,Lv:!0,jw:0,kw:0,Pm:0,Qm:0,Vr:0,Wr:0,Vh:new Float32Array(2),Je:new Float32Array(2),Wh:new Float32Array(2),bf:new Float32Array(2),Ox:0,sC:0,YI:0,yf:new Uint8Array(256),ny:0,eA:null,Hi:b(),hn:Array(10),wA:!1,WF:l.create(),qv:0,pv:0,ov:0,hA:0,gA:0,nv:Infinity,gB:null,fB:null,VA:null,RA:null,TA:null,qC:null,pC:null,UA:null,SA:null,pB:null,jZ:null,rC:null,
oC:null,nC:null,Sj:{}};for(d=0;10>d;++d)c.hn[d]=b();c.gB=function(a){c.wA||(p.mR(a,c.WF),c.wA=!0)};c.fB=function(a){a=v.copy(a,R);c.ov=a[0];c.pv=a[1];c.qv=a[2];Infinity==c.nv&&(c.nv=a[0],c.gA=a[1],c.hA=a[2])};c.VA=function(a){c.ny+=a*D.JS};c.RA=function(a){var b=p.get_device_by_type_element(p.DEVICE_MOUSE,c.element),b=p.get_vector_param(b,p.MOUSE_LOCATION,A);c.jw=b[0];c.kw=b[1];c.Pm=b[0];c.Qm=b[1];if(3==c.Cf||0==c.Cf)c.Cf=1;c.which=a};c.TA=function(){var a=p.get_device_by_type_element(p.DEVICE_MOUSE,
c.element),a=p.get_vector_param(a,p.MOUSE_LOCATION,A),a=r.client_to_canvas_coords(a[0],a[1],A);c.Hi.Hm=!1;c.Hi.yk[0]=a[0];c.Hi.yk[1]=a[1]};c.qC=function(a){for(var b=0;b<a.length;++b){for(var d=a[b],m=null,g=null,e=0;e<c.hn.length;e++){var C=c.hn[e];if(C.identifier==d.identifier){C.Jv&&(g=C);break}else!m&&C.Jv&&(m=C,m.identifier=d.identifier)}if(d=g||m)m=r.client_to_canvas_coords(a[b].clientX,a[b].clientY,A),d.Hm=!1,d.Jv=!1,d.yk[0]=m[0],d.yk[1]=m[1]}};c.pC=function(a){for(var b=0;b<c.hn.length;++b){for(var d=
c.hn[b],m=!1,g=0;g<a.length;++g)if(a[g].identifier==d.identifier){m=!0;break}m||(d.Hm=!0,d.Jv=!0,d.obj=null)}};c.UA=function(a){var b=p.get_device_by_type_element(p.DEVICE_MOUSE,c.element),b=p.get_vector_param(b,p.MOUSE_LOCATION,A);c.jw=b[0];c.kw=b[1];c.Pm=b[0];c.Qm=b[1];0<c.Cf&&(c.Cf=3);c.which=a};c.SA=function(a){if(!F.zv||c.Cf)c.Pm=a[0],c.Qm=a[1]};c.pB=function(a){c.Vr+=a[0];c.Wr+=a[1]};c.AG=function(a){2!=c.yf[a]&&(c.yf[a]=1,c.yr=!1)};c.CG=function(){for(var a=0;a<c.yf.length;a++)0!=c.yf[a]&&
(c.yf[a]=3,c.yr=!1)};c.DG=function(a){c.yr=!1;c.yf[a]=3};c.rC=function(a){c.Lv=!1;if(1==a.length)c.Vh[0]=a[0].clientX,c.Vh[1]=-1,c.Wh[0]=a[0].clientY,c.Wh[1]=-1;else if(1<a.length){c.Ox=c.sC=y(a);c.Vh[0]=a[0].clientX;c.Vh[1]=a[1].clientX;c.Wh[0]=a[0].clientY;c.Wh[1]=a[1].clientY;var b=a[0];a=a[1];c.YI=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}c.Je.set(c.Vh);c.bf.set(c.Wh)};c.oC=function(a){1===a.length?(c.Je[0]=a[0].clientX,c.Je[1]=-1,c.bf[0]=a[0].clientY,c.bf[1]=-1):1<a.length&&(c.Je[0]=
a[0].clientX,c.Je[1]=a[1].clientX,c.bf[0]=a[0].clientY,c.bf[1]=a[1].clientY,c.Ox=y(a))};c.nC=function(a){0==a.length&&(c.Lv=!0)};J.push(c);return c}function b(a,b){if(b in a.Sj&&0<a.Sj[b])a.Sj[b]+=1;else switch(a.Sj[b]=1,b){case "orientation_quat":var c=p.get_device_by_type_element(p.DEVICE_GYRO);c&&p.attach_param_cb(c,p.GYRO_ORIENTATION_ANGLES,a.gB);break;case "orientation_angles":(c=p.get_device_by_type_element(p.DEVICE_GYRO))&&p.attach_param_cb(c,p.GYRO_ORIENTATION_ANGLES,a.fB);break;case "mouse_wheel":(c=
p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_WHEEL,a.VA);break;case "mouse_down_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_DOWN_WHICH,a.RA);break;case "mouse_select":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_DOWN_WHICH,a.TA);break;case "touch_select":if(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))p.attach_param_cb(c,p.TOUCH_START,a.qC),p.attach_param_cb(c,
p.TOUCH_END,a.pC);break;case "mouse_up_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_UP_WHICH,a.UA);break;case "mouse_location":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_LOCATION,a.SA);break;case "mouse_pointerlock":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.YC,a.pB);break;case "keyboard_downed_keys":if(c=p.get_device_by_type_element(p.DEVICE_KEYBOARD,a.element))p.attach_param_cb(c,
p.KEYBOARD_DOWN,a.AG),p.attach_param_cb(c,p.XC,a.CG),p.attach_param_cb(c,p.KEYBOARD_UP,a.DG);break;case "touch_start":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.attach_param_cb(c,p.TOUCH_START,a.rC);break;case "touch_move":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.attach_param_cb(c,p.TOUCH_MOVE,a.oC);break;case "touch_end":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.attach_param_cb(c,p.TOUCH_END,a.nC)}}function f(a,b){if(b in a.Sj&&0<a.Sj[b]&&
(--a.Sj[b],!a.Sj[b]))switch(b){case "orientation_quat":var c=p.get_device_by_type_element(p.DEVICE_GYRO);c&&p.detach_param_cb(c,p.GYRO_ORIENTATION_QUAT,a.gB);break;case "orientation_angles":(c=p.get_device_by_type_element(p.DEVICE_GYRO))&&p.detach_param_cb(c,p.GYRO_ORIENTATION_ANGLES,a.fB);break;case "mouse_wheel":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_WHEEL,a.VA);break;case "mouse_down_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&
p.detach_param_cb(c,p.MOUSE_DOWN_WHICH,a.RA);break;case "mouse_select":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_DOWN_WHICH,a.TA);break;case "touch_select":if(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))p.detach_param_cb(c,p.TOUCH_START,a.qC),p.detach_param_cb(c,p.TOUCH_END,a.pC);break;case "mouse_up_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_UP_WHICH,a.UA);break;case "mouse_location":(c=
p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_LOCATION,a.SA);break;case "mouse_pointerlock":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.YC,a.pB);break;case "keyboard_downed_keys":if(c=p.get_device_by_type_element(p.DEVICE_KEYBOARD,a.element))p.detach_param_cb(c,p.KEYBOARD_DOWN,a.AG),p.detach_param_cb(c,p.XC,a.CG),p.detach_param_cb(c,p.KEYBOARD_UP,a.DG);break;case "touch_start":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,
a.element))&&p.detach_param_cb(c,p.TOUCH_START,a.rC);break;case "touch_move":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.detach_param_cb(c,p.TOUCH_MOVE,a.oC);break;case "touch_end":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.detach_param_cb(c,p.TOUCH_END,a.nC)}}function k(a,b){a.value=Number(b)}function q(a){for(var b=a.Vj,c=a.bU,d=0;d<b.length;d++)c[d]=b[d].value;return a.wS(c)}function h(a,b){a=a||N;var c=a.Uh;if(c){var d=a.bn;if(b){var m=c[b];if(m){for(var g=
m.Vj,e=0;e<g.length;e++){var C=g[e],l;l=I.indexOf(C);l=-1<l?x[l]:[];1==l.length?(u(C),C=I.indexOf(C),-1<C?(I.splice(C,1),x.splice(C,1)):G.I("Sensors cache is corrupted")):1<l.length&&l.splice(l.indexOf(m),1)}delete c[b];e=d.indexOf(m);-1<e?d.splice(e,1):G.I("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=n.indexOf(a),-1<c?n.splice(c,1):E.error("Wrong object"))}}else{d=[];for(e in c)d.push(e);for(e=0;e<d.length;e++)h(a,d[e])}H=!0}}function u(a){switch(a.type){case 90:z.remove_collision_test(a.nz,
a.Jb,a.mz);a.Ta=!0;break;case 100:z.clear_collision_impulse_test(a.lz);a.Ta=!0;break;case 110:z.remove_ray_test(a.cs);a.Ta=!0;break;case 140:a.Ta=!0;break;case 20:var b=c(a.element);f(b,"keyboard_downed_keys");a.Ta=!0;break;case 30:b=c(a.element);f(b,"mouse_wheel");a.Ta=!0;break;case 40:b=c(a.element);f(b,"mouse_down_which");f(b,"mouse_up_which");f(b,"mouse_location");a.Ta=!0;break;case 280:b=c(a.element);f(b,"mouse_pointerlock");a.Ta=!0;break;case 50:b=c(a.element);f(b,"mouse_down_which");f(b,"mouse_up_which");
a.Ta=!0;break;case 60:b=c(a.element);f(b,"touch_start");f(b,"touch_move");f(b,"touch_end");a.Ta=!0;break;case 70:b=c(a.element);f(b,"touch_start");f(b,"touch_move");a.Ta=!0;break;case 75:b=c(a.element);f(b,"touch_start");f(b,"touch_move");a.Ta=!0;break;case 80:b=c(a.element);f(b,"touch_start");f(b,"touch_end");a.Ta=!0;break;case 170:b=c(a.element);f(b,"mouse_select");f(b,"touch_select");f(b,"touch_start");f(b,"touch_end");f(b,"mouse_down_which");f(b,"mouse_up_which");a.Ta=!0;break;case 180:case 190:b=
c(a.element);f(b,"orientation_angles");a.Ta=!0;break;case 200:b=c(a.element);f(b,"orientation_quat");a.Ta=!0;break;case 210:case 220:a.Ta=!0}}function y(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function g(a){return 0==a?p.get_device_by_type_element(p.$s):1==a?p.get_device_by_type_element(p.vy):2==a?p.get_device_by_type_element(p.wy):p.get_device_by_type_element(p.xy)}var d=t("__config"),r=t("__container"),p=t("__input"),M=t("__objects"),E=t("__print"),
z=t("__physics"),l=t("__quat"),B=t("__time"),w=t("__tsr"),G=t("__util"),v=t("__vec3"),D=d.controls,F=d.K,n=[],N={},I=[],x=[],J=[],A=new Float32Array(2),C=new Float32Array(2),R=v.create(),m=l.create(),H=!1,U=0;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;var O=1;a.update=function(b,d){for(var e=0;e<J.length;e++){var f=J[e];f.Hi.Hm||(f.Hi.obj=
M.pick_object(f.Hi.yk[0],f.Hi.yk[1]),f.Hi.Hm=!0,f.eA=f.Hi.obj);for(var r=0;10>r;++r){var h=f.hn[r];h.Hm||(h.obj=M.pick_object(h.yk[0],h.yk[1]),h.Hm=!0,f.eA=h.obj)}}for(e=0;e<I.length;e++)if(f=I[e],h=b,r=d)switch(f.type){case 120:var x=f.Qi,V=w.Qb(x.v.C,R),x=w.tb(x.v.C,m),aa=v.dist(f.xp,V),u=f.DH;l.invert(f.Lw,u);l.multiply(x,u,u);l.normalize(u,u);u=Math.abs(2*Math.acos(u[3]));aa/=r;f.Ct=G.smooth(aa,f.Ct,r,.3);f.aa[0]=aa;aa=u/r;f.Bt=G.smooth(aa,f.Bt,r,.3);f.aa[1]=aa;f.Ct>=f.threshold||f.Bt>=f.QH?k(f,
1):k(f,0);v.copy(V,f.xp);l.copy(x,f.Lw);f.Ag=h;break;case 130:x=f.Qi;V=w.Qb(x.v.C,R);x=Math.abs(V[1]-f.xp[1])/r;f.Dt=G.smooth(x,f.Dt,r,.3);f.aa=x;f.Dt>=f.threshold?k(f,1):k(f,0);v.copy(V,f.xp);f.Ag=h;break;case 140:!f.Ta&&0<=f.sg&&h-f.Ag>=f.sg&&(k(f,1),f.repeat?f.Ag=h:f.sg=-f.sg);break;case 150:f.Ag||(f.Ag=h);k(f,h-f.Ag);f.Ag=h;break;case 160:k(f,h);break;case 180:h=c(f.element);f.aa[0]=h.qv-h.hA;f.aa[1]=h.pv-h.gA;f.aa[2]=h.ov-h.nv;break;case 190:h=c(f.element);f.aa[0]=h.qv;f.aa[1]=h.pv;f.aa[2]=h.ov;
break;case 200:h=c(f.element);l.copy(h.WF,f.aa);break;case 210:r=p.get_device_by_type_element(p.DEVICE_HMD);p.get_vector_param(r,p.HMD_ORIENTATION_QUAT,f.aa);break;case 220:r=p.get_device_by_type_element(p.DEVICE_HMD);p.get_vector_param(r,p.HMD_POSITION,f.aa);break;case 240:r=g(f.gamepad_id);f.value=p.UQ(r,f.key);break;case 250:r=g(f.gamepad_id);f.value=p.TQ(r,f.key);break;case 260:r=g(f.gamepad_id);p.get_gamepad_position(r,f.aa);k(f,1);break;case 270:r=g(f.gamepad_id);p.get_gamepad_orientation(r,
f.aa);k(f,1);break;case 230:k(f,f.callback());break;case 30:h=c(f.element);k(f,h.ny);break;case 40:h=c(f.element);if(!F.zv||1==h.Cf||2==h.Cf)switch(V=h.Pm-h.jw,x=h.Qm-h.kw,f.aa.coords[0]=h.Pm,f.aa.coords[1]=h.Qm,f.axis){case "X":k(f,V);break;case "Y":k(f,x);break;case "XY":r=Math.sqrt(V*V+x*x),k(f,r)}break;case 280:h=c(f.element);V=h.Vr;x=h.Wr;aa=G.smooth(V,0,r,.1*O);r=G.smooth(x,0,r,.1*O);.01<Math.abs(V)||.01<Math.abs(x)?(h.Vr-=aa,h.Wr-=r,f.aa.coords[0]=aa,f.aa.coords[1]=r):(f.aa.coords[0]=0,f.aa.coords[1]=
0);k(f,Math.sqrt(V*V+x*x));break;case 50:h=c(f.element);k(f,0<h.Cf|0);f.aa.which=h.which;f.aa.coords[0]=h.Pm;f.aa.coords[1]=h.Qm;break;case 170:h=c(f.element);k(f,0);if(f.jF)h.eA==f.Qi&&k(f,1);else if(h.Cf&&h.Hi.obj==f.Qi)k(f,1);else if(!h.Lv)for(r=0;10>r;++r)if(h.hn[r].obj==f.Qi){k(f,1);break}break;case 20:h=c(f.element);f.aa=h.yf[f.key];1==f.aa||h.yf[0]&&16==f.key?k(f,1):f.aa||k(f,0);break;case 60:h=c(f.element);if(-1==h.Je[1]&&-1==h.bf[1]){V=h.Je[0]-h.Vh[0];x=h.bf[0]-h.Wh[0];r=Math.sqrt(V*V+x*
x);if(-1!=h.Vh[1]&&-1!=h.Wh[1]){var aa=h.Je[0]-h.Vh[1],u=h.bf[0]-h.Wh[1],z=Math.sqrt(aa*aa+u*u);z<r&&(V=aa,x=u,r=z)}f.aa.gesture=a.PL_SINGLE_TOUCH_MOVE}else r=A,r[0]=(h.Je[0]+h.Je[1])/2,r[1]=(h.bf[0]+h.bf[1])/2,x=C,x[0]=(h.Vh[0]+h.Vh[1])/2,x[1]=(h.Wh[0]+h.Wh[1])/2,V=r[0]-x[0],x=r[1]-x[1],r=Math.sqrt(V*V+x*x),f.aa.gesture=a.PL_MULTITOUCH_MOVE_PAN;f.aa.coords[0]=h.Je[0];f.aa.coords[1]=h.bf[0];switch(f.axis){case "X":k(f,V);break;case "Y":k(f,x);break;case "XY":k(f,r)}break;case 70:h=c(f.element);r=
h.Ox-h.sC;f.aa=a.PL_MULTITOUCH_MOVE_ZOOM;k(f,r);break;case 75:h=c(f.element);-1!=h.Je[1]&&(r=Math.atan2(h.bf[0]-h.bf[1],h.Je[0]-h.Je[1]),f.aa=a.PL_MULTITOUCH_MOVE_ROTATE,k(f,r-h.YI));break;case 80:h=c(f.element),f.aa.coords[0]=h.Je[0],f.aa.coords[1]=h.bf[0],h.Lv?k(f,0):k(f,1)}for(e=0;e<n.length;e++)for(h=n[e],f=h.bn,r=0;r<f.length;r++)if(V=f[r],V.Al!=U){V.Al=U;u=V;x=0;switch(u.type){case a.CT_POSITIVE:x=(aa=q(u))?1:0;break;case a.CT_CONTINUOUS:x=u.Gj;(aa=q(u))?(x=1,u.Gj=1):1==x?(x=-1,u.Gj=-1):x=0;
break;case a.CT_TRIGGER:x=u.Gj;(aa=q(u))&&-1==x?(x=1,u.Gj=1):aa||1!=x?x=0:(x=-1,u.Gj=-1);break;case a.CT_SHOT:x=u.Gj;(aa=q(u))&&-1==x?(x=1,u.Gj=1):aa||1!=x?x=0:(x=0,u.Gj=-1);break;case a.CT_LEVEL:aa=q(u);u.FG!=aa?(x=1,u.FG=aa):x=0;break;case a.CT_CHANGE:aa=u.Vj;u=u.YR;for(z=0;z<aa.length;z++){var E=aa[z].value;x||E==u[z]||(x=1);u[z]=E}break;default:G.I("Wrong sensor manifold type: "+u.type)}if(x&&(aa=h==N?null:h,H=!1,V.callback(aa,V.id,x,V.oN),H)){e=-1;break}}for(e=0;e<n.length;e++)for(h=n[e],f=h.bn,
r=0;r<f.length;r++)for(V=f[r],h=V.Vj,V=0;V<h.length;V++)switch(x=h[V],x.type){case 30:k(x,0);break;case 40:k(x,0);break;case 60:k(x,0);break;case 70:k(x,0);break;case 75:k(x,0);break;case 80:k(x,0);break;case 140:k(x,0)}for(e=0;e<J.length;e++){f=J[e];if(!f.yr){for(r=0;r<f.yf.length;r++)1==f.yf[r]?f.yf[r]=2:3==f.yf[r]&&(f.yf[r]=0);f.yr=!0}1==f.Cf?f.Cf=2:3==f.Cf&&(f.Cf=0);f.ny=0;f.jw=f.Pm;f.kw=f.Qm;f.yf[0]=0;f.Vh.set(f.Je);f.Wh.set(f.bf);f.sC=f.Ox;f.hA=f.qv;f.gA=f.pv;f.nv=f.ov;f.wA=!1}U++};a.create_custom_sensor=
function(a){var b=e(10);k(b,a);return b};a.create_keyboard_sensor=function(a){var b=e(20,document);b.key=a;b.Ta=!0;return b};a.create_gamepad_btn_sensor=function(a,b){var c=e(240,document);b=b||p.av();c.gamepad_id=b;c.key=a;c.Ta=!0;return c};a.create_gamepad_axis_sensor=function(a,b){var c=e(250,document);b=void 0==b?p.av():b;c.gamepad_id=b;c.key=a;c.Ta=!0;return c};a.create_gamepad_position_sensor=function(a){var b=e(260,document);a=void 0===a?p.av():a;b.gamepad_id=a;b.Ta=!0;b.aa=v.create();return b};
a.create_gamepad_orientation_sensor=function(a){var b=e(270,document);a=void 0===a?p.av():a;b.gamepad_id=a;b.Ta=!0;b.aa=l.create();return b};a.create_collision_sensor=function(a,b,c){if(!a||!z.va(a))return E.error("Wrong collision object"),null;var d=e(90);d.nz=a;d.Jb=b;d.ji=c;d.aa={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.mz=function(a,b,c,m,e){k(d,a);a=d.aa;a.coll_obj=b;d.ji&&(a.coll_pos.set(c),a.coll_norm.set(m),a.coll_dist=e)};d.Ta=
!0;return d};a.create_collision_impulse_sensor=function(a){if(!a||!a.L)return E.error("Wrong collision impulse object"),null;var b=e(100);b.lz=a;b.CE=function(a){k(b,a)};b.Ta=!0;return b};a.create_ray_sensor=function(a,b,c,d,m,g,f){var C=e(110);C.Qi=a;C.from=b;C.to=c;C.Jb=d;C.mG=m;C.ji=g;C.Av=f;C.aa={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),cs:0};C.FH=function(a,b,c,d,m,e){C.mG?k(C,-1==b?0:1):k(C,b);C.aa.hit_fract=b;C.aa.obj_hit=c;C.aa.hit_time=
d;C.ji&&(C.aa.hit_pos.set(m),C.aa.hit_norm.set(e))};C.Ta=!0;return C};a.create_mouse_click_sensor=function(a){a=e(50,a);a.Ta=!0;a.aa={coords:new Float32Array(2),which:null};return a};a.create_mouse_wheel_sensor=function(a){a=e(30,a);a.Ta=!0;return a};a.create_mouse_move_sensor=function(a,b){var c=e(40,b);c.axis=a||"XY";c.aa={coords:new Float32Array(2)};c.Ta=!0;return c};a.create_touch_move_sensor=function(a,b){var c=e(60,b);c.axis=a||"XY";c.aa={coords:new Float32Array(2),gesture:0};c.Ta=!0;return c};
a.create_touch_zoom_sensor=function(a){a=e(70,a);a.aa=0;a.Ta=!0;return a};a.create_touch_rotate_sensor=function(a){a=e(75,a);a.aa=0;a.Ta=!0;return a};a.create_touch_click_sensor=function(a){a=e(80,a);a.aa={coords:new Float32Array(2)};a.Ta=!0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return E.error("Wrong collision object"),null;var d=e(120);d.Qi=a;var m=w.get_trans_view(a.v.C);a=w.get_quat_view(a.v.C);d.DH=new Float32Array(4);d.xp=new Float32Array(m);d.Lw=new Float32Array(a);d.Ct=0;d.Bt=
0;d.threshold=b||.1;d.QH=c||.1;d.Ag=0;d.aa=new Float32Array([0,0]);return d};a.create_vertical_velocity_sensor=function(a,b){if(!a)return E.error("Wrong collision object"),null;var c=e(130);c.Qi=a;var d=w.get_trans_view(a.v.C),m=w.get_quat_view(a.v.C);c.xp=new Float32Array(d);c.Lw=new Float32Array(m);c.Dt=0;c.threshold=b||1;c.Ag=0;c.aa=0;return c};a.create_timer_sensor=function(a,b){var c=e(140);c.sg=a;c.repeat=b;c.Ta=!0;return c};a.reset_timer_sensor=function(a,b,c,d){a=a||N;a=a.Uh;if(!a||!a[b])return E.error("reset_timer_sensor(): wrong object"),
null;b=a[b].Vj[c];if(!b)return E.error("reset_timer_sensor(): sensor not found"),null;b.Ag=B.get_timeline();b.sg=d};a.create_elapsed_sensor=function(){var a=e(150);a.Ag=0;return a};a.create_gyro_delta_sensor=function(){var a=e(180,window);a.aa=new Float32Array(3);p.get_device_by_type_element(p.DEVICE_GYRO)?k(a,1):k(a,0);a.Ta=!0;return a};a.create_gyro_angles_sensor=function(){var a=e(190,window);a.aa=new Float32Array(3);p.get_device_by_type_element(p.DEVICE_GYRO)?k(a,1):k(a,0);a.Ta=!0;return a};a.create_gyro_quat_sensor=
function(){var a=e(200,window);a.aa=l.create();p.get_device_by_type_element(p.DEVICE_GYRO)?k(a,1):k(a,0);a.Ta=!0;return a};a.create_hmd_quat_sensor=function(){var a=e(210,window);a.aa=l.create();p.get_device_by_type_element(p.DEVICE_HMD)?k(a,1):k(a,0);a.Ta=!0;return a};a.create_hmd_position_sensor=function(){var a=e(220,window);a.aa=v.create();p.get_device_by_type_element(p.DEVICE_HMD)?k(a,1):k(a,0);a.Ta=!0;return a};a.create_timeline_sensor=function(){return e(160)};a.create_selection_sensor=function(a,
b){var c=e(170);c.Qi=a;c.jF=b;c.Ta=!0;return c};a.create_callback_sensor=function(a,b){var c=e(230);c.callback=a;k(c,b);return c};a.create_plock_mouse_sensor=function(a){a=e(280,a);a.aa={coords:new Float32Array(2)};a.Ta=!0;return a};a.create_plock_sensor=function(a){a=e(290,a);a.Ta=!0;return a};a.aU=k;a.get_sensor_value=function(a,b,c){a=a||N;a=a.Uh;if(!a||!a[b])return E.error("get_sensor_value(): wrong object"),null;b=a[b].Vj[c];return b?b.value:(E.error("get_sensor_value(): sensor not found"),null)};
a.get_sensor_payload=function(a,b,c){a=a||N;a=a.Uh;if(!a||!a[b])return E.error("get_sensor_payload(): wrong object"),null;b=a[b].Vj[c];return b?b.aa:(E.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){n=[];N={};for(var a=0;a<I.length;a++)u(I[a]);I.length=0;x.length=0};a.check_sensor_manifold=function(a,b){a=a||N;if(!a.Uh)return!1;if(b&&a.Uh[b])return!0;if(!b)for(var c in a.Uh)return!0;return!1};a.create_sensor_manifold=function(a,d,m,e,g,C,f){a=a||N;a.bn=a.bn||[];a.Uh=a.Uh||
{};var l=a.Uh,k=a.bn;l[d]&&h(a,d);m={id:d,type:m,Vj:e.slice(0),wS:g,bU:Array(e.length),callback:C,oN:f,Gj:-1,FG:0,YR:Array(e.length),Al:-1};l[d]=m;k.push(m);-1==n.indexOf(a)&&n.push(a);for(a=0;a<m.Vj.length;a++){l=d=m.Vj[a];if(l.Ta){switch(l.type){case 90:z.append_collision_test(l.nz,l.Jb,l.mz,l.ji);break;case 100:z.apply_collision_impulse_test(l.lz,l.CE);break;case 110:l.cs=z.append_ray_test(l.Qi,l.from,l.to,l.Jb,l.FH,!1,!1,l.ji,l.Av);l.aa.cs=l.cs;break;case 140:l.Ag=B.get_timeline();0>l.sg&&(l.sg=
-l.sg);break;case 20:k=c(l.element);b(k,"keyboard_downed_keys");break;case 30:k=c(l.element);b(k,"mouse_wheel");break;case 40:k=c(l.element);b(k,"mouse_down_which");b(k,"mouse_up_which");b(k,"mouse_location");break;case 280:k=c(l.element);b(k,"mouse_pointerlock");break;case 290:p.iM(l);break;case 50:k=c(l.element);b(k,"mouse_down_which");b(k,"mouse_up_which");break;case 60:k=c(l.element);b(k,"touch_start");b(k,"touch_move");b(k,"touch_end");break;case 70:k=c(l.element);b(k,"touch_start");b(k,"touch_move");
break;case 75:k=c(l.element);b(k,"touch_start");b(k,"touch_move");break;case 80:k=c(l.element);b(k,"touch_start");b(k,"touch_end");break;case 170:k=c(l.element);b(k,"mouse_select");b(k,"touch_select");b(k,"touch_start");b(k,"touch_end");b(k,"mouse_down_which");b(k,"mouse_up_which");break;case 180:case 190:k=c(l.element);b(k,"orientation_angles");break;case 200:k=c(l.element);b(k,"orientation_quat");break;case 240:case 260:case 270:0==l.gamepad_id?p.get_device_by_type_element(p.$s):1==l.gamepad_id?
p.get_device_by_type_element(p.vy):2==l.gamepad_id?p.get_device_by_type_element(p.wy):p.get_device_by_type_element(p.xy)}l.Ta=!1}l=I.indexOf(d);-1==l?(I.push(d),x.push([m])):x[l].push(m)}H=!0};a.default_AND_logic_fun=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.default_OR_logic_fun=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.remove_sensor_manifold=h;a.reset=function(){for(var a=0;a<n.length;a++){var b=n[a],c=b.Uh,b=b.bn,
d;for(d in c)delete c[d];b.length=0}for(a=0;a<I.length;a++)u(I[a]);n.length=0;I.length=0;x.length=0};a.debug=function(){E.log(String(n.length)+" objects with manifolds",n);E.log(String(I.length)+" sensors",I);for(var a=[],b=[],c=0;c<I.length;c++){var d=I[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}E.log(String(a.length)+" collision sensors",a);E.log(String(b.length)+" ray sensors",b)};a.set_plock_smooth_factor=function(a){O=a}};b4w.module.__curve=function(a,t){function e(a,b,c,d,e){var g=d.length;e||(e=new Float32Array(g));for(var f=g+a,k=new Float32Array(f),h=1;h<=f-1;h++)k[h-1]=b>=c[h-1]&&b<c[h+1-1]?1:0;for(var l=2;l<=a;l++)for(h=1;h<=f-l;h++)k[h-1]=(k[h-1]?(b-c[h-1])*k[h-1]/(c[h+l-1-1]-c[h-1]):0)+(k[h+1-1]?(c[h+l-1]-b)*k[h+1-1]/(c[h+l-1]-c[h+1-1]):0);b==c[f-1]&&(k[g-1]=1);a=0;for(h=1;h<=g;h++)a+=k[h-1]*d[h-1];for(h=1;h<=g;h++)e[h-1]=a?k[h-1]*d[h-1]/a:0;return e}function c(a){a=a.Ov;return a[a.length-1]}function b(a){a=
a.VE;return a[a.length-1]}function f(a,b,c,d,e,h,M,q){var g=a+(b-a)/2,l=k(g,d,e,h,M)-c;q=q?q:.01;return Math.abs(l)<q?g:0<l?f(a,g,c,d,e,h,M,q):f(g,b,c,d,e,h,M,q)}function k(a,b,c,d,e){var g=1-a;return b*g*g*g+3*c*g*g*a+3*d*g*a*a+e*a*a*a}var q=t("__util"),h=t("__vec3");a.EO=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var d=a.order_u;b.order=d;a=a.points;var f=a.length/5,k=[],h=f+d,f=f+2;k[0]=0;for(var u=2;u<=h;u++)k[u-1]=u>d&&u<f?k[u-2]+1:k[u-
2];b.Ov=k;"2D"==c.dimensions?b.Pk=!1:"3D"==c.dimensions?b.Pk=!0:q.I("Wrong curve dimensions");d=[];k=[];for(c=0;c<a.length;c+=5)d.push(a[c]),d.push(a[c+1]),d.push(a[c+2]),b.Pk&&d.push(a[c+3]),k.push(a[c+4]);b.qz=d;b.GC=k;a=[];for(var c=b.qz,d=b.Pk?4:3,k=b.GC,h=b.Ov,f=b.order,u=c.length/d,z=u+f,l=0,B=h[z-1]/999,w=0;1E3>w;w++){5E-6>h[z-1]-l&&(l=h[z-1]);for(var G=e(f,l,h,k),v=0;v<d;v++)for(var D=a[d*w+v]=0;D<u;D++)a[d*w+v]+=G[D]*c[d*D+v];l+=B}d=b.Pk?4:3;k=new Float32Array(1E3);k[0]=0;for(c=1;1E3>c;c+=
1)h=a[(c-1)*d],f=a[(c-1)*d+1],u=a[(c-1)*d+2],z=a[c*d],l=a[c*d+1],B=a[c*d+2],k[c]=k[c-1]+Math.sqrt((z-h)*(z-h)+(l-f)*(l-f)+(B-u)*(B-u));b.VE=k;return b};a.eV=function(a,b,g){g||(g=[]);b=Math.min(b,c(a));var d=a.qz,f=a.Pk?4:3,k=a.GC,h=a.Ov,u=a.order;a=d.length/f;var z=a+u;5E-6>h[z-1]-b&&(b=h[z-1]);z=new Float32Array(a);e(u,b,h,k,z);for(b=0;b<f;b++)for(k=g[b]=0;k<a;k++)g[b]+=z[k]*d[f*k+b]};a.bV=function(a,b,c){c||(c=[]);var d=a.qz,e=a.Pk?4:3,g=a.GC,f=a.Ov,k=a.order;a=d.length/e;var h=a+k;5E-6>f[h-1]-
b&&(b=f[h-1]);var h=new Float32Array(a),l=b;b=h;var u=g.length;b||(b=new Float32Array(u));var w=new Float32Array(u),G=new Float32Array(u),v=w,q=G;v||(v=new Float32Array(u));q||(q=new Float32Array(u));for(var F=u+k,n=new Float32Array(F),y=new Float32Array(F),I=1;I<=F-1;I++)n[I-1]=l>=f[I-1]&&l<f[I+1-1]?1:0;l==f[F-1]&&(n[u-1]=1);for(var x=2;x<=k;x++)for(I=1;I<=F-x;I++){var J=n[I-1]?n[I-1]/(f[I+x-1-1]-f[I-1]):0,A=n[I+1-1]?-n[I+1-1]/(f[I+x-1]-f[I+1-1]):0,C=y[I-1]?(l-f[I-1])*y[I-1]/(f[I+x-1-1]-f[I-1]):
0,R=y[I+1-1]?(f[I+x-1]-l)*y[I+1-1]/(f[I+x-1]-f[I+1-1]):0;n[I-1]=(n[I-1]?(l-f[I-1])*n[I-1]/(f[I+x-1-1]-f[I-1]):0)+(n[I+1-1]?(f[I+x-1]-l)*n[I+1-1]/(f[I+x-1]-f[I+1-1]):0);y[I-1]=J+A+C+R}for(I=1;I<=u;I++)v[I-1]=n[I-1],q[I-1]=y[I-1];f=0;for(k=1;k<=u;k++)f+=w[k-1]*g[k-1];l=0;for(k=1;k<=u;k++)l+=G[k-1]*g[k-1];for(k=1;k<=u;k++)b[k-1]=f?G[k-1]*g[k-1]/f+w[k-1]*g[k-1]*l/(f*f):0;for(g=0;g<e;g++)for(f=c[g]=0;f<a;f++)c[g]+=h[f]*d[e*f+g]};a.MZ=c;a.dV=b;a.cV=function(a,e){if(0>=e)return 0;var g=c(a);if(e>=b(a))return g;
var d=a.VE,f=q.Gt(d,e,0,d.length-1);return g*(f+(e-d[f])/(d[f+1]-d[f]))/1E3};a.Uv=function(a,b,c,d,e){return c+(e-d)*(a-c)/(b-d)};a.IG=function(a,b,c){var d=b[0];b=b[1];c=(c[1]-b)/(c[0]-d);return c*a+(b-c*d)};a.SD=function(a,b,c,d,e,h){return k(f(0,1,a,b[0],c[0],d[0],e[0],h),b[1],c[1],d[1],e[1])};a.dz=function(a,b,c,d,e){var g=new Float32Array(3),f=new Float32Array(3),k=new Float32Array(3),r=new Float32Array(3),l=new Float32Array(3),u=new Float32Array(3);h.copy(a[1],f);null==b?(h.copy(c[1],k),g[0]=
2*f[0]-k[0],g[1]=2*f[1]-k[1]):h.copy(b[1],g);null==c?(h.copy(b[1],g),k[0]=2*f[0]-g[0],k[1]=2*f[1]-g[1]):h.copy(c[1],k);h.subtract(f,g,r);h.subtract(k,f,l);b=h.length(r);c=h.length(l);0==b&&(b=1);0==c&&(c=1);if("AUTO"==d||"AUTO"==e)if(u[0]=l[0]/c+r[0]/b,u[1]=l[1]/c+r[1]/b,g=2.5614*h.length(u))"AUTO"==d&&h.scaleAndAdd(f,u,-(b/g),a[0]),"AUTO"==e&&h.scaleAndAdd(f,u,c/g,a[2]);"VECTOR"==d&&h.scaleAndAdd(f,r,-1/3,a[0]);"VECTOR"==e&&h.scaleAndAdd(f,l,1/3,a[2])};a.$N=function(a,b,c,d){var e=[],g=[],f,k,h;
e[0]=a[0]-b[0];e[1]=a[1]-b[1];g[0]=d[0]-c[0];g[1]=d[1]-c[1];h=d[0]-a[0];f=Math.abs(e[0]);k=Math.abs(g[0]);f+k&&f+k>h&&(f=h/(f+k),b[0]=a[0]-f*e[0],b[1]=a[1]-f*e[1],c[0]=d[0]-f*g[0],c[1]=d[1]-f*g[1])}};b4w.module.__debug=function(a,t){function e(a,b,d){var m=[],e;for(e in a)1<v.Aj(a[e])&&m.push([e,a[e]]);m.sort(function(a,b){var c=v.Aj(a[1]),d=v.Aj(b[1]);return d!=c?d-c:a<b?-1:b<a?1:0});if(m.length){z.groupCollapsed(b+" "+d);z.ld("Property different variants (>1) | Property name");for(a=0;a<m.length;a++)z.groupCollapsed(v.Aj(m[a][1]),m[a][0]),c(m[a][1]);z.groupEnd()}}function c(a){z.ld("Batches count for this property value | Property value");var b=[],c;for(c in a)b.push([c,a[c]]);b.sort(function(a,
b){return b[1]!=a[1]?b[1]-a[1]:a[0]<b[0]?-1:b[0]<a[0]?1:0});for(a=0;a<b.length;a++)z.ld(b[a][1],b[a][0]);z.groupEnd()}function b(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function f(){var a=p.Xz();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function k(){var b=A;return b&&b.debug_view_mode==a.DV_RENDER_TIME}function q(a,b,c){var d=p.Xz(),m=0;if(d)for(c&&d.endQuery(),c=0;c<a.length;c++){var e=a[c],g=d.EF(e),f=n.getParameter(d.DF());
g&&!f&&(m=d.FF(e)/1E6,b&&(m=v.smooth(m,b,1,10)),a.splice(c,1),c--)}else m=performance.now()-a.pop(),b&&(m=v.smooth(m,b,1,10));return m}function h(a,b){u(a)||v.I("Structure assertion failed: invalid first object value");u(b)||v.I("Structure assertion failed: invalid second object value");y(a,b)||v.I("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||v.uA(a)||a instanceof Array)){for(var c in a)u(a[c])||v.I("Structure assertion failed: invalid value for key in the first object: "+
c),c in b||v.I("Structure assertion failed: missing key in the first object: "+c);for(c in b)u(b[c])||v.I("Structure assertion failed: invalid value for key in the second object: "+c),c in a||v.I("Structure assertion failed: missing key in the second object: "+c),y(a[c],b[c])||v.I("Structure assertion failed: incompatible types for key "+c)}}function u(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function y(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==
typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;c=v.uA(a);d=v.uA(b);if(c&&!d||!c&&d)return!1}return!0}var g=t("__batch"),d=t("__compat"),r=t("__config"),p=t("__extensions"),M=t("__graph"),E=t("__objects"),z=t("__print"),l=t("__scenes"),B=t("__subscene"),w=t("__textures"),G=t("__time"),v=t("__util"),D=r.K,F={},n=null,N={},I=[],x=-1,J=-1,A=null,C=null,R=!1,m={};a.DV_NONE=0;a.DV_OPAQUE_WIREFRAME=1;a.DV_TRANSPARENT_WIREFRAME=2;a.DV_FRONT_BACK_VIEW=3;a.DV_BOUNDINGS=4;a.DV_CLUSTERS_VIEW=
5;a.DV_BATCHES_VIEW=6;a.DV_RENDER_TIME=7;a.ug=function(a){for(var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c=0;c<b.length;c++){var d=b[c];d in a&&(F[a[d]]=d)}n=a};a.jU=function(a){A=a};a.DY=function(){return A};a.TP=function(a,b,c,d,e){m[a]||(m[a]={MU:b,mf:{}});c in m[a].mf||(m[a].mf[c]=d);e&&(m[a].mf[c]=0)};a.calc_vbo_garbage_byte_size=function(){var a=0,b;for(b in m)for(var c in m[b].mf)a+=m[b].mf[c];return a};a.show_vbo_garbage_info=
function(){var a={},b;for(b in m)for(var c in m[b].mf){var d=m[b].mf[c];if(d){var e=m[b].MU;e in a||(a[e]={mC:0,mf:{}});c in a[e].mf||(a[e].mf[c]=0);a[e].mf[c]+=d;a[e].mC+=d}}for(e in a){z.groupCollapsed(e,a[e].mC);for(c in a[e].mf)z.ld(c,a[e].mf[c]);z.groupEnd()}};a.print_batches_stat=function(){for(var a={},b="bounds_local bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),c=0,d=0,m=E.Ob(l.Fh(),"MESH",E.DATA_ID_ALL),f=0;f<m.length;f++)for(var C=
0;C<m[f].O.length;C++)for(var k=0;k<m[f].O[C].Y.length;k++){var n=g.PN(m[f].O[C].Y[k]),h=n.Za.Of+"/"+n.Za.xe;n["shaders_info.directives"]=n.Za.yh;n["shaders_info.node_elements"]=n.Za.Ye;delete n.Za;for(var w=0;w<b.length;w++)delete n[b[w]];if(m[f].is_dynamic)d++;else{c++;n.type in a||(a[n.type]={});h in a[n.type]||(a[n.type][h]={});for(var v in n)v in a[n.type][h]||(a[n.type][h][v]={}),w=JSON.stringify(n[v]),w in a[n.type][h][v]||(a[n.type][h][v][w]=0),a[n.type][h][v][w]++}}z.group("Batches statistics:");
z.ld("STATIC/DYNAMIC count:",c+"/"+d);z.group("STATIC batches diversity:");for(var H in a)for(h in a[H])e(a[H][h],H,h);z.groupEnd();z.groupEnd()};a.gz=function(a){if(D.gl_debug){var b=n.getError();b!=n.NO_ERROR&&(b in F?v.I("GL Error: "+b+", gl."+F[b]+" ("+a+")"):v.I("Unknown GL error: "+b+" ("+a+")"))}};a.wN=function(){if(D.gl_debug||D.mE)switch(n.checkFramebufferStatus(n.FRAMEBUFFER)){case n.FRAMEBUFFER_COMPLETE:break;case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:z.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:z.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:z.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case n.FRAMEBUFFER_UNSUPPORTED:z.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case n.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:z.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:z.error("FRAMEBUFFER CHECK FAILED")}};
a.AN=function(){if(-1!=x)return x;var a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a);var b=w.Bk(w.Kl,!1);w.resize(b,1,1);n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,b.ub,b.Gb,0);n.checkFramebufferStatus(n.FRAMEBUFFER)!=n.FRAMEBUFFER_COMPLETE?(x=!0,z.warn("depth-only issue was found")):x=!1;n.bindFramebuffer(n.FRAMEBUFFER,null);n.deleteFramebuffer(a);return x};a.FN=function(){if(1==D.Zb)return!1;if(-1!=J)return J;n.bindRenderbuffer(n.RENDERBUFFER,n.createRenderbuffer());n.renderbufferStorageMultisample(n.RENDERBUFFER,
D.Zb,n.RGBA8,1,1);var a=n.getRenderbufferParameter(n.RENDERBUFFER,n.RENDERBUFFER_SAMPLES);a!=D.Zb?(J=!0,z.warn("multisample issue was found: requested "+D.Zb+", got "+a),n.getError()==n.INVALID_OPERATION&&z.warn("the error from multisample issue detected, ignoring")):J=!1;n.bindRenderbuffer(n.RENDERBUFFER,null);return J};a.CN=function(){return d.hz("Firefox")&&n.getError()==n.OUT_OF_MEMORY?(z.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.LH=function(a,c,d){D.gl_debug&&(d=b(d),z.error("shader compilation failed:\n"+
d+"\n"+n.getShaderInfoLog(a)+" ("+c+")"))};a.LT=function(a,c,d,m){D.gl_debug&&(d=b(d),m=b(m),z.error("shader linking failed:\n"+d+"\n\n\n"+m+"\n"+n.getProgramInfoLog(a)+" ("+c+")"))};a.xB=function(a){if(D.show_hud_debug_info||a.type==B.Wp)a.Wq||a.Dk.push(f())};a.GT=function(a){"MAIN"==a.type&&k()&&a.Dk.push(f())};a.yB=function(a){if((D.show_hud_debug_info||a.type==B.Wp)&&!a.Wq){var b=q(a.Dk,a.uf,!0);b&&(a.uf=b)}};a.HT=function(a){if("MAIN"==a.type&&k()){var b=q(a.Dk,a.uf,!0);b&&(a.uf=b)}};a.sG=k;
a.rT=function(a){var b=q(a.Dk,a.uf,!1);b&&(a.uf=b)};a.nY=function(a){N[a]=a in N?N[a]+1:1};a.update=function(){for(var a in N)z.log(a,N[a]),N[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(v.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}I.push(a)};a.msg=function(){for(var a=1,b=0;b<I.length;b++){var c=I[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],v.is_vector(a))for(var d=
0;d<a.length;d++)c.push(a[d]);else c.push(arguments[b]);I.push(c)};var H=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),m=0;m<I.length;m++){var e=I[m];a=e[0];if(!(a<d)){var g=String(e[1]);c[g]||(c[g]=H[b++%H.length]);a=["%c"+(a/1E3).toFixed(6),c[g],g];for(g=2;g<e.length;g++)a.push(e[g]);z.log.apply(this,a)}}I.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b=
{},c=Math.max(0,performance.now()-1E3*a),d=0;d<I.length;d++){var m=I[d];a=m[0];if(!(a<c))for(var e=2;e<m.length;e++){var g=String(m[1]);3<m.length&&(g+="_"+String(e-2));b[g]||(b[g]=g+"\n");b[g]+=String(a)+" "+m[e]+"\n"}}a="";for(g in b)a+=b[g]+"\n\n";z.log(a);I.splice(0)};a.XX=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&
b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(v.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return!!a.length}return isFinite(a)?!0:!1};a.MX=function(a,b){a.constructor!=b&&v.I("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.NX=h;a.OX=function(a){R?
h(a,C):R=!0;C=null!=a&&"object"==typeof a?v.Dq(a):a};a.fake_load=function(a,b,c,d,m){(a=a||null)||v.I("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&v.I("Max percentage must be less than 100");0>c&&v.I("Min percentage must be greater than 0");c>d&&v.I("Max percentage must be greater than min percentage");var e=G.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(G.clear_animation(e),m&&m())})};a.SS=function(a){return M.ZE(a,function(a,b){var c=b.type+"("+b.name+")",d=b.inputs,
c=c+"\n\nINPUTS:";if(d.length)for(var m=0;m<d.length;m++)c+="\n"+d[m].identifier+": ",c=d[m].Ja?c+"linked":c+d[m].Ga;else c+="\n---";d=b.outputs;c+="\n\nOUTPUTS:";if(d.length)for(m=0;m<d.length;m++)c+="\n"+d[m].identifier+": ",c=d[m].Ja?c+("linked(default "+d[m].Ga+")"):c+"not used";else c+="\n---";m="";switch(b.type){case "GEOMETRY_UV":m="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":m="\ntexture: "+b.data.value.name+"\n("+b.data.value.uo+")"}""==m&&(m="\n---");return c+
"\n\nDATA:"+m},function(b,c,d){b=M.Ya(a,b);c=M.Ya(a,c);return b.outputs[d[0]].identifier+"\n==>\n"+c.inputs[d[1]].identifier})};a.bv=function(){return n};a.cleanup=function(){A=null;m={}};a.reset=function(){n=null}};b4w.module.__extensions=function(a,t){function e(a){if(a in h)return h[a];var b=q.getExtension(a)||null;h[a]=b;f.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in h)return h[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":case "EXT_shader_texture_lod":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=q;break;default:b=q.getExtension(a)||null}h[a]=b;f.log("%cGET EXTENSION (WebGL 2)","color: #"+
(b?"0a0":"a00"),a);return b}var b=t("__config"),f=t("__print"),k=b.K,q=null,h={};a.ug=function(a){q=a};a.PF=function(){return e("WEBGL_compressed_texture_s3tc")||e("WEBKIT_WEBGL_compressed_texture_s3tc")};a.OF=function(){return e("WEBKIT_WEBGL_compressed_texture_pvrtc")||e("WEBGL_compressed_texture_pvrtc")};a.JQ=function(){return k.Hb?c("WEBGL_depth_texture"):e("WEBGL_depth_texture")||e("WEBKIT_WEBGL_depth_texture")};a.Tz=function(){return e("EXT_texture_filter_anisotropic")||e("WEBKIT_EXT_texture_filter_anisotropic")};
a.RF=function(){return k.Hb?c("EXT_shader_texture_lod"):e("EXT_shader_texture_lod")};a.HQ=function(){return e("WEBGL_debug_shaders")};a.get_renderer_info=function(){return e("WEBGL_debug_renderer_info")};a.KF=function(){return k.Hb?c("OES_element_index_uint"):e("OES_element_index_uint")};a.aA=function(){return k.Hb?c("OES_standard_derivatives"):e("OES_standard_derivatives")};a.Xz=function(){var a=k.Hb?c("EXT_disjoint_timer_query_webgl2"):e("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?
{createQuery:function(){return a.createQueryEXT()},beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},EF:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},FF:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},DF:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return q.createQuery()},beginQuery:function(b){q.beginQuery(a.TIME_ELAPSED_EXT,b)},endQuery:function(){q.endQuery(a.TIME_ELAPSED_EXT)},
EF:function(a){return q.getQueryParameter(a,q.QUERY_RESULT_AVAILABLE)},FF:function(a){return q.getQueryParameter(a,q.QUERY_RESULT)},DF:function(){return a.GPU_DISJOINT_EXT}}};a.YQ=function(){if(k.Hb)return c("ANGLE_instanced_arrays");var a=e("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,c,d,e,f){a.drawElementsInstancedANGLE(b,c,d,e,f)},vertexAttribDivisor:function(b,c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,c,d,e){a.drawArraysInstancedANGLE(b,
c,d,e)}}};a.cA=function(){if(k.Hb)return c("OES_vertex_array_object");var a=e("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.cleanup=function(){h={}};a.reset=function(){q=null}};b4w.module.__graph=function(a,t){function e(a,b,d){d||(d=null);c(a,b)?J.I("Graph already has node with given ID"):a.Z.push(b,d)}function c(a,b){for(var c=a.Z,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,d,e){e||(e=null);c(a,b)&&c(a,d)?a.Ca.push(b,d,e):J.I("Wrong node IDs")}function f(a,b){c(a,b)||J.I("Node not found");for(var d=a.Z,e=0;e<d.length;e+=2)d[e]==b&&(d.splice(e,2),e-=2)}function k(a,b,c,d){n(a,b,c)||J.I("Edge not found");a=a.Ca;for(var m=0,e=0;e<a.length;e+=3)if(a[e]==
b&&a[e+1]==c){if(-1==d)a.splice(e,3);else{if(d==m){a.splice(e,3);break}m++}e-=3}}function q(a){a=a.Z;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function h(a,b){for(var c=a.Z,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function u(a){var b=[],c={};y(a,c);for(var d=a.Z,e=0;e<d.length;e+=2)0==v(a,d[e])&&g(a,d[e],c,b);return{Z:b,Ca:a.Ca.slice(0)}}function y(a,b){for(var c=a.Z,d=0;d<c.length;d+=2)b[c[d]]=!1}function g(a,b,c,d){if(!c[b]){c[b]=!0;for(var e=0;e<G(a,b);e++)g(a,
D(a,b,e),c,d);d.unshift(b,w(a,b))}}function d(a,b,c,e){if(!c[b]){c[b]=!0;if(10==e||30==e)for(var m=0;m<G(a,b);m++){var g=D(a,b,m);d(a,g,c,e)}if(20==e||30==e)for(m=0;m<v(a,b);m++)g=F(a,b,m),d(a,g,c,e)}}function r(a){for(var b=a.Ca,d=0;d<b.length;d+=3){var e=b[d+1];c(a,b[d])&&c(a,e)||(b.splice(d,3),d-=3)}}function p(a){for(var b=[],c=a.Z,d=0;d<c.length;d+=2){var e=c[d];G(a,e)||b.push(e)}return b}function M(a){var b=a.Z;a=a.Ca;for(var c=[],d=[],e=[],g=0;g<b.length;g++)e[b[2*g]]=g,c.push(g,b[2*g+1]);
for(g=0;g<a.length;g+=3)d.push(e[a[g]],e[a[g+1]],a[g+2]);return{Z:c,Ca:d}}function E(a,b,c){if(c.oi==c.Xk){for(var d=0,e=0;d<c.Xk;d++)-1!=c.qj[d]&&(a[e]=d,b[e]=c.qj[d],e++);return!0}if(c.Xk>c.Ho||c.ul>c.vl||c.tp>c.wp||c.sp>c.vp)return!1;for(var e=d=-1,m=!1;!m&&z(c,A,d,e);)if(d=A[0],e=A[1],l(c,d,e)){var g;g=c;m={};m.jr=g.jr;m.kr=g.kr;m.$A=g.$A;m.Cu=g.Cu;m.Xk=g.Xk;m.Ho=g.Ho;m.order=g.order;m.oi=m.uw=g.oi;m.sp=g.sp;m.tp=g.tp;m.ul=g.ul;m.vp=g.vp;m.wp=g.wp;m.vl=g.vl;m.bq=-1;m.qj=g.qj;m.em=g.em;m.zm=g.zm;
m.Am=g.Am;m.Sm=g.Sm;m.Tm=g.Tm;m.ax=g.ax;g.ax[0]+=1;var m=g=m,f=d,k=e,n=m.jr,C=m.kr,h=m.Xk,w=m.Ho,r=m.qj,p=m.em,x=m.zm,J=m.Am,q=m.Sm,u=m.Tm;B(f<h);B(k<w);B(m.oi<h);B(m.oi<w);h=++m.oi;m.bq=f;x[f]||(x[f]=h,m.sp++,q[f]&&m.ul++);q[f]||(q[f]=h,m.tp++,x[f]&&m.ul++);J[k]||(J[k]=h,m.vp++,u[k]&&m.vl++);u[k]||(u[k]=h,m.wp++,J[k]&&m.vl++);r[f]=k;p[k]=f;for(r=0;r<v(n,f);r++)p=F(n,f,r),x[p]||(x[p]=h,m.sp++,q[p]&&m.ul++);for(r=0;r<G(n,f);r++)p=D(n,f,r),q[p]||(q[p]=h,m.tp++,x[p]&&m.ul++);for(r=0;r<v(C,k);r++)p=F(C,
k,r),J[p]||(J[p]=h,m.vp++,u[p]&&m.vl++);for(r=0;r<G(C,k);r++)p=D(C,k,r),u[p]||(u[p]=h,m.wp++,J[p]&&m.vl++);m=E(a,b,g);B(1>=g.oi-g.uw);B(-1!=g.bq);p=g.jr;f=g.kr;k=g.oi;n=g.bq;C=g.qj;x=g.em;h=g.zm;J=g.Am;w=g.Sm;q=g.Tm;if(g.uw<k){h[n]==k&&(h[n]=0);for(u=0;u<v(p,n);u++)r=F(p,n,u),h[r]==k&&(h[r]=0);w[n]==k&&(w[n]=0);for(u=0;u<G(p,n);u++)r=D(p,n,u),w[r]==k&&(w[r]=0);p=C[n];J[p]==k&&(J[p]=0);for(u=0;u<v(f,p);u++)r=F(f,p,u),J[r]==k&&(J[r]=0);q[p]==k&&(q[p]=0);for(u=0;u<G(f,p);u++)r=D(f,p,u),q[r]==k&&(q[r]=
0);C[n]=-1;x[p]=-1;g.oi=g.uw;g.bq=-1}}return m}function z(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var e=a.ul,m=a.vl,g=a.tp,f=a.wp,k=a.sp,n=a.vp,l=a.oi,C=a.Xk,h=a.Ho,w=a.qj,v=a.em,r=a.zm,p=a.Am,F=a.Sm,H=a.Tm;if(e>l&&m>l)for(;c<C&&(-1!=w[c]||0==F[c]||0==r[c]);)c++,d=0;else if(g>l&&f>l)for(;c<C&&(-1!=w[c]||0==F[c]);)c++,d=0;else if(k>l&&n>l)for(;c<C&&(-1!=w[c]||0==r[c]);)c++,d=0;else if(0==c&&0!=a.order){for(r=0;r<C&&-1!=w[c=a.order[r]];)r++;r==C&&(c=C)}else for(;c<C&&-1!=w[c];)c++,d=0;if(e>l&&m>l)for(;d<
h&&(-1!=v[d]||0==H[d]||0==p[d]);)d++;else if(g>l&&f>l)for(;d<h&&(-1!=v[d]||0==H[d]);)d++;else if(k>l&&n>l)for(;d<h&&(-1!=v[d]||0==p[d]);)d++;else for(;d<h&&-1!=v[d];)d++;return c<C&&d<h?(b[0]=c,b[1]=d,!0):!1}function l(a,b,c){var d=a.jr,e=a.kr,m=a.Ho,g=a.qj,f=a.em,k=a.zm,l=a.Am,C=a.Sm,h=a.Tm;B(b<a.Xk);B(c<m);B(-1==g[b]);B(-1==f[c]);if(!(0,a.$A)(w(d,b),w(e,c)))return!1;for(var r=m=0,p=0,x=0,J=0,A=0,u=0;u<G(d,b);u++){var q=D(d,b,u);if(-1!=g[q]){var z=g[q];if(!n(e,c,z)||!N(a.Cu,d,b,q,e,c,z))return!1}else k[q]&&
p++,C[q]&&m++,k[q]||C[q]||J++}for(u=0;u<v(d,b);u++)if(q=F(d,b,u),-1!=g[q]){if(z=g[q],!n(e,z,c)||!N(a.Cu,d,q,b,e,z,c))return!1}else k[q]&&p++,C[q]&&m++,k[q]||C[q]||J++;for(u=0;u<G(e,c);u++)if(z=D(e,c,u),-1!=f[z]){if(q=f[z],!n(d,b,q))return!1}else l[z]&&x++,h[z]&&r++,l[z]||h[z]||A++;for(u=0;u<v(e,c);u++)if(z=F(e,c,u),-1!=f[z]){if(q=f[z],!n(d,q,b))return!1}else l[z]&&x++,h[z]&&r++,l[z]||h[z]||A++;return p<=x&&m<=r&&J<=A}function B(a){a||J.I("Assertion failed")}function w(a,b){for(var c=a.Z,d=0;d<c.length;d+=
2)if(c[d]==b)return c[d+1];return null}function G(a,b){for(var c=a.Ca,d=0,e=0;e<c.length;e+=3)c[e]==b&&d++;return d}function v(a,b){for(var c=a.Ca,d=0,e=0;e<c.length;e+=3)c[e+1]==b&&d++;return d}function D(a,b,c){a=a.Ca;for(var d=0,e=0;e<a.length;e+=3)if(a[e]==b){if(d==c)return a[e+1];d++}return-1}function F(a,b,c){a=a.Ca;for(var d=0,e=0;e<a.length;e+=3)if(a[e+1]==b){if(d==c)return a[e];d++}return-1}function n(a,b,c){a=a.Ca;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function N(a,
b,c,d,e,g,f){for(var m=I(b,c,d),k=I(e,g,f),n=0;n<m;n++){for(var l=!1,C=0;C<k;C++)if(a(x(b,c,d,n),x(e,g,f,C))){l=!0;break}if(!l)return!1}return!0}function I(a,b,c){var d=0;a=a.Ca;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&d++;return d}function x(a,b,c,d){a=a.Ca;for(var e=0,m=0;m<a.length;m+=3)if(a[m]==b&&a[m+1]==c){if(e==d)return a[m+2];e++}return null}var J=t("__util"),A=[-1,-1];a.Cy=-1;a.YW=10;a.nk=20;a.gX=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var e=a[d];switch(e.length){case 2:b.push(e[0],
e[1]);break;case 3:c.push(e[0],e[1],e[2]);break;default:J.I("Wrong graph constructor params")}}return{Z:b,Ca:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.Z.length),e=0;e<a.Z.length;e+=2)d[e]=a.Z[e],d[e+1]=b(a.Z[e+1]);else d=J.V(a.Z);if(c)for(b=Array(a.Ca.length),e=0;e<a.Ca.length;e+=3)b[e]=a.Ca[e],b[e+1]=a.Ca[e+1],b[e+2]=c(a.Ca[e+2]);else b=J.V(a.Ca);return a={Z:d,Ca:b}};a.fY=function(a,b){for(var c=[],d=[],e=0;e<a.length;e++)c.push(a[e][0],a[e][1]);for(e=0;e<b.length;e++)d.push(b[e][0],b[e][1],
b[e][2]);return{Z:c,Ca:d}};a.th=e;a.QY=c;a.Ec=b;a.Hf=f;a.kl=k;a.Sh=function(a,b,c,d){n(a,b,c)||J.I("Edge not found");a=a.Ca;for(var e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c&&a[e+2][0]==d[0]&&a[e+2][1]==d[1]){a.splice(e,3);break}};a.X=function(a,b){if(-1==h(a,b)){var c=q(a);e(a,c,b);return c}J.I("Non-unique attribute")};a.JT=function(a,b,c,d,e){a=a.Ca;for(var m=0;m<a.length;m+=3)a[m]==b&&a[m+1]==c&&a[m+2]==d&&(a[m+2]=e)};a.FD=function(a,c,d,g){d=d||[];g=g||[];for(var m={},f=0;f<a.Z.length;f+=2){var k=
a.Z[f],n=q(c);e(c,n,a.Z[f+1]);m[k]=n}for(f=0;f<a.Ca.length;f+=3){var n=m[a.Ca[f]],l=m[a.Ca[f+1]],k=a.Ca[f+2];b(c,n,l,k)}for(f=0;f<d.length;f+=3)n=m[d[f]],a=d[f+1],k=d[f+2],b(c,n,a,k);for(f=0;f<g.length;f+=3)d=g[f],l=m[g[f+1]],k=g[f+2],b(c,d,l,k)};a.zj=q;a.Oj=h;a.H=function(a,c,d,e){c=h(a,c);d=h(a,d);-1!=c&&-1!=d?b(a,c,d,e):J.I("Attributes not found")};a.ba=function(a,b){for(var c=a.Z,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.mh=function(a,b){for(var c=a.Ca,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=
3);};a.hk=function(a,b,c){for(var d=a.Ca,e=0;e<d.length;e+=3)if(d[e+1]==b){var g=d[e];if(c(g,w(a,g),d[e+2]))break}};a.xl=function(a,b,c){for(var d=a.Ca,e=0;e<d.length;e+=3)if(d[e]==b){var g=d[e+1];if(c(g,w(a,g),d[e+2]))break}};a.kC=u;a.qV=function(a){a=u(a).Z;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.dZ=function(){};a.sl=function(a,b,e){c(a,b)||J.I("No such node");var g={};y(a,g);d(a,b,g,e);b=[];for(var m in g)g[m]&&(m=Number(m),b.push(m,w(a,m)));a={Z:b,Ca:a.Ca.slice(0)};r(a);return a};
a.iz=r;a.eR=function(a){for(var b=[],c=a.Z,d=0;d<c.length;d+=2){var e=c[d];v(a,e)||b.push(e)}return b};a.pr=p;a.match=function(a,b,c,d){var e={};e.jr=M(a);e.kr=M(b);e.$A=c||function(a,b){return a==b};e.Cu=d||function(a,b){return a==b};d=a.Z.length/2;var g=b.Z.length/2;e.Xk=d;e.Ho=g;e.order=0;e.oi=e.uw=0;e.ul=e.sp=e.tp=0;e.vl=e.vp=e.wp=0;e.bq=-1;e.qj=Array(d);e.em=Array(g);e.zm=Array(d);e.Am=Array(g);e.Sm=Array(d);e.Tm=Array(g);e.ax=[1];for(c=0;c<d;c++)e.qj[c]=-1,e.zm[c]=0,e.Sm[c]=0;for(c=0;c<g;c++)e.em[c]=
-1,e.Am[c]=0,e.Tm[c]=0;g=Array(d);d=Array(d);if(E(g,d,e)){for(c=0;c<g.length;c++)g[c]=a.Z[2*g[c]],d[c]=b.Z[2*d[c]];return[g,d]}return null};a.aR=function(a,b){for(var c=a.Z,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Ya=w;a.rg=G;a.zi=v;a.Ug=D;a.jg=F;a.EY=I;a.Mc=x;a.replace=function(a,b,c){for(var d=a.Ca,g=q(a),m=0;m<b.length;m++){var k=b[m];f(a,k);for(var n=0;n<d.length;n+=3)d[n]==k&&(d[n]=g),d[n+1]==k&&(d[n+1]=g),d[n]==d[n+1]&&(d.splice(n,3),n-=3)}e(a,g,c)};a.yT=function(a,b,c,d,
e){n(a,b,c)||J.I("Edge not found");a=a.Ca;for(var g=0;g<a.length;g+=3)a[g]==b&&a[g+1]==c&&(a[g]=d,a[g+1]=e)};a.HP=function(a,b){function c(a,b){if(-1!=n.indexOf(a)){var d=n.slice(n.indexOf(a));if(-1!=e[d[d.length-1]].indexOf(d[0])){l.push([a,d[d.length-1]]);return}}n.push(a);for(d=0;d<b.length;d++)b[d]in e&&c(b[d],e[b[d]])}b||(b=p(a)[0]);var d=a.Ca;if(d.length&&-1!=d.indexOf(b)){for(var e={},g=0,f=0;f<d.length;f+=3)d[f+1]in e?e[d[f+1]].push(d[f]):e[d[f+1]]=[d[f]],g++;var n=[],l=[];c(b,e[b]);for(f=
0;f<l.length;f++)for(var h=g=0;h<d.length;h+=3)l[f][1]==d[h+1]&&l[f][0]==d[h]&&k(a,d[h],d[h+1],g),g++}};a.ZE=function(a,b,c){var d=a.Z;a=a.Ca;var e;e="digraph debug {\n    node [shape=box];\n";for(var g=0;g<d.length;g+=2){var f=d[g],m=d[g+1],m=b?b(f,m):String(f);e+="    ";e+=String(f)+' [label="'+m.replace(/\"/g,'\\"')+'"];\n'}for(g=0;g<a.length;g+=3)b=a[g],d=a[g+1],m=a[g+2],e+="    ",e+=String(b)+" -> "+String(d),c&&(e+=' [label="'+c(b,d,m)+'"]'),e+=";\n";return e+"}"}};b4w.module.__ipc=function(a,t){function e(a,b,c){for(var e=0;e<r.length;e+=2)r[e+1]==a&&(d[e+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,e;for(e in c){var g=c[e];switch(g.constructor){case Float32Array:d+=g.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.nK=0;a.SC=1;a.TC=2;a.hK=3;a.jK=4;a.kK=5;a.lK=6;a.oK=7;a.UC=8;a.Ay=9;a.VC=10;a.qK=11;a.WC=12;a.rK=13;a.pK=14;a.mK=15;a.iK=16;var f=a.SC,k=a.TC,q=a.UC,h=a.Ay,u=a.VC,y=a.WC;a.DL=100;a.eL=101;a.fL=102;a.gL=103;a.hL=
104;a.jL=105;a.iL=106;a.kL=107;a.lL=108;a.mL=109;a.nL=110;a.oL=111;a.pL=112;a.rL=113;a.sL=114;a.GL=115;a.tL=116;a.uL=117;a.vL=118;a.xL=119;a.yL=120;a.zL=121;a.BL=122;a.CL=123;a.EL=124;a.qL=125;a.IL=126;a.wL=127;a.gD=128;a.HL=129;a.JL=130;a.LL=131;a.ML=132;a.NL=133;a.OL=134;a.PL=135;a.QL=136;a.RL=137;a.SL=138;a.TL=139;a.hD=140;a.Vp=141;a.UL=142;a.fD=143;a.VL=144;a.WL=145;a.FL=146;a.AL=147;a.XL=148;a.KL=149;var g=a.Vp,d=b4w.worker_listeners,r=b4w.worker_namespaces,p={pg:y,ga:0,time:0,trans:new Float32Array(3),
quat:new Float32Array(4),Fi:new Float32Array(3),ci:new Float32Array(3),len:0},M={pg:q,fz:0,rB:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},E={pg:h,id:0,Nn:0,hit_fract:0,hit_time:0,len:0},z={pg:u,id:0,Nn:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},l={pg:f,Xl:0,Yl:0,result:0,len:0},B={pg:k,Xl:0,Yl:0,result:0,bm:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},w={pg:g,ga:0,trans:new Float32Array(3),quat:new Float32Array(4),
len:0},G=[p,M,E,z,l,B,w];a.fP=function(a,c){var g={Iv:a?!0:!1,lk:null,ii:[],Pg:""};if(c){var f=t("__util"),k=t("__container");g.lk={addEventListener:function(a,b){"message"!=a&&f.I("Wrong web worker event");e(g.Pg,g.Iv,b)},removeEventListener:function(a){"message"!=a&&f.I("Wrong web worker event");e(g.Pg,g.Iv,null)},postMessage:function(a){var b;a:{for(b=0;b<r.length;b+=2)if(r[b+1]==g.Pg){b=d[b+Number(!!g.Iv)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<r.length;a+=2)if(r[a+1]==
g.Pg){d.splice(a,2);r.splice(a,2);break}}};if(g.Iv){var l=b4w.get_namespace(t),h=f.Is(l+"_worker");r.push(l);r.push(h);d.push(null);d.push(null);g.Pg=h;(k=k.XP(a))?b?k.addEventListener("load",function(){b4w.require("__bindings",g.Pg)},!1):(b4w.cleanup("__bindings",g.Pg),b4w.cleanup("__ipc",g.Pg),b4w.require("__bindings",g.Pg)):(k=document.createElement("script"),k.src=a,k.defer="defer",k.async="async",k.addEventListener("load",function(){b=!1;b4w.require("__bindings",g.Pg)},!1),document.head.appendChild(k))}else g.Pg=
b4w.get_namespace(t)}else a?g.lk=new Worker(a):g.lk=self;return g};a.OM=function(a,b){function d(c){if(c.constructor==ArrayBuffer)c=new Float32Array(c);else if(c[0].constructor==ArrayBuffer){for(var e=0;e<c.length;e++)d(c[e]);return}e=c[0]|0;switch(e){case y:var n=p;n.ga=c[1]|0;n.time=c[2];n.trans[0]=c[3];n.trans[1]=c[4];n.trans[2]=c[5];n.quat[0]=c[6];n.quat[1]=c[7];n.quat[2]=c[8];n.quat[3]=c[9];n.Fi[0]=c[10];n.Fi[1]=c[11];n.Fi[2]=c[12];n.ci[0]=c[13];n.ci[1]=c[14];n.ci[2]=c[15];break;case q:n=M;n.fz=
c[1]|0;n.rB=c[2]|0;n.trans[0]=c[3];n.trans[1]=c[4];n.trans[2]=c[5];n.quat[0]=c[6];n.quat[1]=c[7];n.quat[2]=c[8];n.quat[3]=c[9];break;case h:n=E;n.id=c[1]|0;n.Nn=c[2]|0;n.hit_fract=c[3];n.hit_time=c[4];break;case u:n=z;n.id=c[1]|0;n.Nn=c[2]|0;n.hit_fract=c[3];n.hit_time=c[4];n.hit_pos[0]=c[5];n.hit_pos[1]=c[6];n.hit_pos[2]=c[7];n.hit_norm[0]=c[8];n.hit_norm[1]=c[9];n.hit_norm[2]=c[10];break;case f:n=l;n.Xl=c[1]|0;n.Yl=c[2]|0;n.result=!!c[3];break;case k:n=B;n.Xl=c[1]|0;n.Yl=c[2]|0;n.result=!!c[3];
n.bm[0]=c[4];n.bm[1]=c[5];n.bm[2]=c[6];n.coll_norm[0]=c[7];n.coll_norm[1]=c[8];n.coll_norm[2]=c[9];n.coll_dist=c[10];break;case g:n=w;n.ga=c[1]|0;n.trans[0]=c[2];n.trans[1]=c[3];n.trans[2]=c[4];n.quat[0]=c[5];n.quat[1]=c[6];n.quat[2]=c[7];n.quat[3]=c[8];break;default:n=c}b(a,e,n)}c(G);a.lk.addEventListener("message",function(a){d(a.data)},!1)};a.cleanup=function(){};a.oa=function(a,b){if(a)switch(b){case y:var c=p,d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.ga;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];
d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Fi[0];d[11]=c.Fi[1];d[12]=c.Fi[2];d[13]=c.ci[0];d[14]=c.ci[1];d[15]=c.ci[2];a.ii.push(d.buffer);break;case q:c=M;d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.fz;d[2]=c.rB;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.ii.push(d.buffer);break;case h:c=E;d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.id;d[2]=c.Nn;d[3]=c.hit_fract;d[4]=c.hit_time;a.ii.push(d.buffer);
break;case u:c=z;d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.id;d[2]=c.Nn;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.ii.push(d.buffer);break;case f:c=l;d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.Xl;d[2]=c.Yl;d[3]=c.result;a.ii.push(d.buffer);break;case k:c=B;d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.Xl;d[2]=c.Yl;d[3]=c.result;d[4]=c.bm[0];d[5]=c.bm[1];d[6]=c.bm[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];
d[9]=c.coll_norm[2];d[10]=c.coll_dist;a.ii.push(d.buffer);break;case g:c=w;d=new Float32Array(c.len);d[0]=c.pg;d[1]=c.ga;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.ii.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.lk.postMessage(d)}};a.nT=function(a){a&&a.ii.length&&(a.lk.postMessage(a.ii),a.ii.length=0)};a.NF=function(a){switch(a){case y:return p;case q:return M;case h:return E;case u:return z;
case f:return l;case k:return B;case g:return w;default:return null}};a.terminate=function(a){a.lk.terminate();a.lk=null};a.Ev=function(a){return!!a.lk};a.tG=function(a){return!!a.Pg}};b4w.module.__hud=function(a,t){function e(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.J){var c=0,d=0,e=0;h.ba(a.J.Aa,function(a,g){if(g.type!=u.$i){for(var f=Math.round(g.F.width)+"x"+Math.round(g.F.height),k=0,l=0;l<g.Xa.length;l++)k+=g.Xa[l].Ia.length;l=g.Un;if(g.type==u.ud||g.type==u.gf)k*=6;var h=g.dc&&!g.qm,r=h?g.uf:0;g.enqueue||
(g.uf=0);var p=h?" (\u2713)":" (\u2715)",n=u.Cx(g);b(p,n,g.Po,f,l,"of",k,"  ",r.toFixed(3));g.Un=0;c+=k;h&&(d+=l,e+=r)}});return[c,d,e]}b("No INFO")}function b(){for(var a=80+20*d[0],b=arguments[0],c=1;c<arguments.length;c++){for(var e="",f=0;f<y[c]-String(arguments[c]).length;f++)e+=" ";b+=e+arguments[c]}d[0]++;g.fillText(b,30,a)}function f(a,b,c){b=a.yc*b;c.x=a.x+b;c.y=a.y;c.yc=a.yc-2*b;c.Rb=a.Rb}function k(a){return a.x+a.yc/2}function q(a){var b=g,c={x:0,y:0,yc:0,Rb:0},d=b.canvas.width,b=b.canvas.height;
c.x=0;c.y=0;c.yc=d;c.Rb=b;f(c,.01,c);d=.02*c.Rb;c.x=c.x;c.y+=d;c.yc=c.yc;c.Rb=c.Rb-2*d;d=c.yc/8;c.x+=d*a;c.y=c.y;c.yc=d;c.Rb=c.Rb;f(c,.02,c);return c}var h=t("__graph"),u=t("__subscene"),y=[5,30,4,10,5,3,5],g=null,d=[0,0];a.init=function(a){a=a.getContext("2d");e(a);return g=a};a.kn=function(){g&&e(g)};a.reset=function(){var a=g;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),d[0]=0,d[1]=0)};a.PU=function(a,e){var f=
g;if(f){f.textAlign="left";f.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/e).toFixed(2));d[0]++;for(var k=f=0,h=0,l=0;l<a.length;l++){var p=c(a[l]),f=f+p[0],k=k+p[1],h=h+p[2];d[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",k,"of",f,"  ",h.toFixed(3))}};a.print=function(){var a=g;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,f,h){var l=g;if(l){b=q(b);var r=b.Rb/5;b.x=b.x;b.y+=
4*r;b.yc=b.yc;b.Rb=r;l.textAlign="center";l.fillStyle="#00FF00";g.fillText(a,k(b),b.y-10);l.strokeStyle="#00FF00";l.lineWidth=.5;l.beginPath();l.moveTo(b.x,b.y);l.lineTo(b.x+b.yc,b.y);l.lineTo(b.x+b.yc,b.y+b.Rb);l.lineTo(b.x,b.y+b.Rb);l.closePath();l.stroke();if(!f&&!h)for(f=1E6,h=-1E6,a=0;a<c.length;a++)f=Math.min(f,c[a]),h=Math.max(h,c[a]);l.textAlign="right";g.fillText(String(f),b.x-10,b.y+b.Rb);g.fillText(String(h),b.x-10,b.y);l.textAlign="center";g.fillText(String(d),b.x,b.y+b.Rb+15);g.fillText(String(e),
b.x+b.yc,b.y+b.Rb+15);l.strokeStyle="#FF0000";l.lineWidth=1.5;l.beginPath();d=b.yc/(c.length-1);h=b.Rb/(h-f);for(a=0;a<c.length;a++)e=b.x+d*a,r=b.y+b.Rb-(c[a]-f)*h,a?l.lineTo(e,r):l.moveTo(e,r);l.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,f,h){var l=g;if(l)for(l.textAlign="center",l.fillStyle="#00FF00",l.font="bold 12px Courier",c=q(c),g.fillText(b?"["+a+"]":a,k(c),c.y),0<=f&&g.fillText(f?"[M]":"[ ]",k(c)-15,c.y+30),0<=h&&g.fillText(h?"[S]":"[ ]",k(c)+15,c.y+30),a={x:0,y:0,yc:0,Rb:0},b=0;b<
d.length;b++){f=d[b];var r="VOLUME"==f[0];if(r){h=c.y+350;var v=c.yc,p=a;p.x=c.x;p.y=h;p.yc=v;p.Rb=250}else{h=c.y+50+50*b;var v=c.yc,p=c.Rb,F=a;F.x=c.x;F.y=h;F.yc=v;F.Rb=p}h=l;var v=a,F=b==e,n=f[0],p=f[1],u=f[2],z=f[3],x=(z-u)/f[4],x=1>x?Math.floor(1/x-1E-5).toFixed(0).length:0;f=f[5]?Math.log(p/u)/Math.log(z/u):(p-u)/(z-u);h.textAlign="center";F?h.fillText("["+n+"]",k(v),v.y):h.fillText(n,k(v),v.y);h.strokeStyle="#00FF00";h.lineWidth=r?3:1;r?(h.textAlign="right",h.fillText(z.toFixed(x),k(v)-10,v.y+
15),h.textAlign="right",h.fillText(u.toFixed(x),k(v)-10,v.y+v.Rb-15)):(h.textAlign="right",h.fillText(u.toFixed(x),v.x+28,v.y+15),h.textAlign="left",h.fillText(z.toFixed(x),v.x+v.yc-28,v.y+15));h.beginPath();if(r){var J=v.y+15+(v.Rb-30)*(1-f);h.moveTo(k(v),v.y+15);h.lineTo(k(v),v.y+v.Rb-15);h.moveTo(k(v)-5,v.y+15);h.lineTo(k(v)+5,v.y+15);h.moveTo(k(v)-5,v.y+v.Rb-15);h.lineTo(k(v)+5,v.y+v.Rb-15);h.moveTo(k(v)-5,J);h.lineTo(k(v)+5,J)}else{var A=v.x+30+(v.yc-60)*f;h.moveTo(v.x+30,v.y+15);h.lineTo(v.x+
v.yc-30,v.y+15);h.moveTo(v.x+30,v.y+15-5);h.lineTo(v.x+30,v.y+15+5);h.moveTo(v.x+v.yc-30,v.y+15-5);h.lineTo(v.x+v.yc-30,v.y+15+5);h.moveTo(A,v.y+15-5);h.lineTo(A,v.y+15+5)}h.stroke();"EQ_Q"==n?(f=Math.log(1+1/(2*p*p)+Math.sqrt((2+1/(p*p))*(2+1/(p*p))/4-1))/Math.log(2),r?(h.textAlign="left",h.fillText(p.toFixed(x),k(v)+10,J),h.textAlign="left",h.fillText("("+f.toFixed(x+1)+")",k(v)+10,J+10)):(h.textAlign="right",h.fillText(p.toFixed(x),A,v.y+30),h.textAlign="left",h.fillText("("+f.toFixed(x+1)+")",
A,v.y+30))):r?(h.textAlign="left",h.fillText(p.toFixed(x),k(v)+10,J)):(h.textAlign="center",h.fillText(p.toFixed(x),A,v.y+30))}}};b4w.module.__material=function(a,t){function e(){return{name:"",type:"",Nc:"",Bg:!1,Md:null,yg:[],lb:"",xc:!1,Zx:!1,Oa:!1,ne:!1,Yx:!1,Rs:!1,Cp:!1,ve:!1,Tj:!1,Bi:!1,zr:!1,Gm:!1,gh:0,Li:0,md:0,Te:"",ic:new Float32Array(3),ee:0,wu:0,xu:0,Rw:0,uu:0,vu:0,nu:0,alpha:0,af:"",me:new Float32Array(3),vs:0,tx:0,ux:0,dn:0,rx:0,sx:0,If:0,Ad:0,xd:0,da:{Di:!1,shore_smoothing:!1,absorb_factor:0,foam_factor:0,Zw:new Float32Array(3),bx:new Float32Array(3),$w:0,cx:0,pm:new Float32Array(3),Ru:0,sss_strength:0,sss_width:0,
norm_uv_velocity:0,is_dynamic:!1,waves_height:0,waves_length:0,dst_noise_scale0:0,dst_noise_scale1:0,dst_noise_freq0:0,dst_noise_freq1:0,dir_min_shore_fac:0,dir_freq:0,dir_noise_scale:0,dir_noise_freq:0,dir_min_noise_fac:0,dst_min_fac:0,waves_hor_fac:0,Gv:!1,rw:0,sw:0,tu:0,Eu:!1,mj:0,lj:0},Si:{zo:!1,ar:"",$q:""},Zm:{reflect_factor:0,fresnel:0,fresnel_factor:0},po:{size:0,sr:0,Qw:new Float32Array(3),Vv:new Float32Array(3),Pw:0,Tv:0,xx:0,Kv:!1,yx:0,zx:0},nd:{Bp:!1,Ui:!1,Sg:0,Ng:0,Jb:"",li:0,ki:0,mi:0}}}
var c=t("__util");a.DR=e;a.kO=function(){var a=e();a.name="DEFAULT";a.type="SURFACE";a.Nc=c.Xu();a.Bg=!1;a.Md=null;a.yg=[];a.lb="OPAQUE";a.xc=!1;a.Zx=!1;a.Oa=!0;a.Rs=!1;a.Cp=!1;a.Tj=!1;a.Gm=!1;a.gh=0;a.Li=0;a.md=0;a.Te="LAMBERT";a.ic.set([.8,.8,.8]);a.ee=.8;a.alpha=1;a.af="COOKTORR";a.me.set([1,1,1]);a.vs=.5;a.dn=50;a.If=1;a.Ad=0;a.xd=1;a.da.Di=!1;a.Si.zo=!1;a.Zm.reflect_factor=0;a.Zm.fresnel=0;a.Zm.fresnel_factor=1.25;a.nd.Bp=!1;return a};a.SV=function(a,c){c.name=a.name;c.type=a.type;c.Nc=a.uuid;
c.Bg=a.use_nodes;c.Md=a.node_tree;c.yg=a.texture_slots;c.lb=a.game_settings.alpha_blend;c.xc=a.use_shadeless;c.Zx=a.use_transparency;c.Oa=a.game_settings.use_backface_culling;c.ne=a.use_tangent_shading;c.Yx=a.use_orco_tex_coord;c.Rs=a.use_vertex_color_paint;c.Cp=a.b4w_double_sided_lighting;c.ve=a.b4w_do_not_render;c.Tj=a.b4w_render_above_all;c.Bi=a.b4w_lens_flares;c.zr=a.b4w_wettable;c.Gm=a.b4w_refractive;c.gh=a.b4w_refr_bump;c.Li=a.pass_index;c.md=a.offset_z;c.Te=a.diffuse_shader;c.ic.set(a.diffuse_color);
c.ee=a.diffuse_intensity;c.wu=a.diffuse_toon_size;c.xu=a.diffuse_toon_smooth;c.Rw=a.roughness;c.uu=a.diffuse_fresnel;c.vu=a.diffuse_fresnel_factor;c.nu=a.darkness;c.alpha=a.alpha;c.af=a.specular_shader;c.me.set(a.specular_color);c.vs=a.specular_intensity;c.tx=a.specular_toon_size;c.ux=a.specular_toon_smooth;c.dn=a.specular_hardness;c.rx=a.specular_ior;c.sx=a.specular_slope;c.If=a.specular_alpha;c.Ad=a.emit;c.xd=a.ambient;var b=c.da;b.Di=a.b4w_water;b.shore_smoothing=a.b4w_water_shore_smoothing;b.absorb_factor=
a.b4w_water_absorb_factor;b.foam_factor=a.b4w_foam_factor;b.Zw.set(a.b4w_shallow_water_col);b.bx.set(a.b4w_shore_water_col);b.$w=a.b4w_shallow_water_col_fac;b.cx=a.b4w_shore_water_col_fac;b.pm.set(a.b4w_water_fog_color);b.Ru=a.b4w_water_fog_density;b.sss_strength=a.b4w_water_sss_strength;b.sss_width=a.b4w_water_sss_width;b.norm_uv_velocity=a.b4w_water_norm_uv_velocity;b.is_dynamic=a.b4w_water_dynamic;b.waves_height=a.b4w_waves_height;b.waves_length=a.b4w_waves_length;b.dst_noise_scale0=a.b4w_water_dst_noise_scale0;
b.dst_noise_scale1=a.b4w_water_dst_noise_scale1;b.dst_noise_freq0=a.b4w_water_dst_noise_freq0;b.dst_noise_freq1=a.b4w_water_dst_noise_freq1;b.dir_min_shore_fac=a.b4w_water_dir_min_shore_fac;b.dir_freq=a.b4w_water_dir_freq;b.dir_noise_scale=a.b4w_water_dir_noise_scale;b.dir_noise_freq=a.b4w_water_dir_noise_freq;b.dir_min_noise_fac=a.b4w_water_dir_min_noise_fac;b.dst_min_fac=a.b4w_water_dst_min_fac;b.waves_hor_fac=a.b4w_water_waves_hor_fac;b.Gv=a.b4w_generated_mesh;b.rw=a.b4w_water_num_cascads;b.sw=
a.b4w_water_subdivs;b.tu=a.b4w_water_detailed_dist;b.Eu=a.b4w_water_enable_caust;b.mj=a.b4w_water_caust_scale;b.lj=a.b4w_water_caust_brightness;b=c.Si;b.zo=a.b4w_terrain;b.ar=a.b4w_dynamic_grass_size;b.$q=a.b4w_dynamic_grass_color;b=c.Zm;b.reflect_factor=a.raytrace_mirror.reflect_factor;b.fresnel=a.raytrace_mirror.fresnel;b.fresnel_factor=a.raytrace_mirror.fresnel_factor;b=c.po;b.size=a.halo.size;b.sr=a.halo.hardness;b.Qw.set(a.halo.b4w_halo_rings_color);b.Vv.set(a.halo.b4w_halo_lines_color);b.Pw=
a.halo.ring_count;b.Tv=a.halo.line_count;b.xx=a.halo.star_tip_count;b.Kv=a.b4w_halo_sky_stars;b.yx=a.b4w_halo_stars_blend_height;b.zx=a.b4w_halo_stars_min_height;b=c.nd;b.Bp=a.b4w_collision;b.Ui=a.b4w_use_ghost;b.Sg=a.physics.friction;b.Ng=a.physics.elasticity;b.Jb=a.b4w_collision_id;b.li=a.b4w_collision_margin;b.ki=a.b4w_collision_group;b.mi=a.b4w_collision_mask};a.RN=function(a){a.name=a.name;a.type=a.type;a.Nc=a.Nc;a.Bg=a.Bg;a.Md=a.Md;a.yg=a.yg.slice();a.lb=a.lb;a.xc=a.xc;a.Zx=a.Zx;a.Oa=a.Oa;a.ne=
a.ne;a.Yx=a.Yx;a.Rs=a.Rs;a.Cp=a.Cp;a.ve=a.ve;a.Tj=a.Tj;a.Bi=a.Bi;a.zr=a.zr;a.Gm=a.Gm;a.gh=a.gh;a.Li=a.Li;a.md=a.md;a.Te=a.Te;a.ic.set(a.ic);a.ee=a.ee;a.wu=a.wu;a.xu=a.xu;a.Rw=a.Rw;a.uu=a.uu;a.vu=a.vu;a.nu=a.nu;a.alpha=a.alpha;a.af=a.af;a.me.set(a.me);a.vs=a.vs;a.tx=a.tx;a.ux=a.ux;a.dn=a.dn;a.rx=a.rx;a.sx=a.sx;a.If=a.If;a.Ad=a.Ad;a.xd=a.xd;var b=a.da,c=a.da;c.Di=b.Di;c.shore_smoothing=b.shore_smoothing;c.absorb_factor=b.absorb_factor;c.foam_factor=b.foam_factor;c.Zw.set(b.Zw);c.bx.set(b.bx);c.$w=b.$w;
c.cx=b.cx;c.pm=b.pm;c.Ru=b.Ru;c.sss_strength=b.sss_strength;c.sss_width=b.sss_width;c.norm_uv_velocity=b.norm_uv_velocity;c.is_dynamic=b.is_dynamic;c.waves_height=b.waves_height;c.waves_length=b.waves_length;c.dst_noise_scale0=b.dst_noise_scale0;c.dst_noise_scale1=b.dst_noise_scale1;c.dst_noise_freq0=b.dst_noise_freq0;c.dst_noise_freq1=b.dst_noise_freq1;c.dir_min_shore_fac=b.dir_min_shore_fac;c.dir_freq=b.dir_freq;c.dir_noise_scale=b.dir_noise_scale;c.dir_noise_freq=b.dir_noise_freq;c.dir_min_noise_fac=
b.dir_min_noise_fac;c.dst_min_fac=b.dst_min_fac;c.waves_hor_fac=b.waves_hor_fac;c.Gv=b.Gv;c.rw=b.rw;c.sw=b.sw;c.tu=b.tu;c.Eu=b.Eu;c.mj=b.mj;c.lj=b.lj;c=b=a.Si;c.zo=b.zo;c.ar=b.ar;c.$q=b.$q;c=b=a.Zm;c.reflect_factor=b.reflect_factor;c.fresnel=b.fresnel;c.fresnel_factor=b.fresnel_factor;c=b=a.po;c.size=b.size;c.sr=b.sr;c.Qw.set(b.Qw);c.Vv.set(b.Vv);c.Pw=b.Pw;c.Tv=b.Tv;c.xx=b.xx;c.Kv=b.Kv;c.yx=b.yx;c.zx=b.zx;c=b=a.nd;c.Bp=b.Bp;c.Ui=b.Ui;c.Sg=b.Sg;c.Ng=b.Ng;c.Jb=b.Jb;c.li=b.li;c.ki=b.ki;c.mi=b.mi;return a}};b4w.module.__renderer=function(a,t){function e(a){for(var c=a.F,e=a.Xa,g=null,f=E.Qb(c.C,C),l=0;l<e.length;l++){var h=e[l];if(h.dc){var w=h.pb,v=h.Ia;if(w.Oi!=g){n.useProgram(w.Oi);for(var g=a,r=c,x=w,u=x.cJ,G=u.length;G--;){var J=u[G];J.ko(n,J.Be,g,r)}if(x.Ko&&!x.qw)for(x.mB.length||k(x),x=x.mB,u=x.length;u--;)J=x[u],J.ko(n,J.Be,g,r);g=w.Oi}h.kf?(n.enable(n.SAMPLE_ALPHA_TO_COVERAGE),a.rb||n.enable(n.BLEND)):(n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),a.rb||n.disable(n.BLEND));for(h=0;h<v.length;h++)if(u=
v[h],u.dc){x=u.qg;r=u.ya;y.GT(r);y.sG()&&"DEBUG_VIEW"==r.type&&(r.Rq=z.smooth(q.RM(r.Tn),r.Rq,1,15));if(H.alpha_sort&&r.ff){var J=x,u=u.Bv,G=f,D=r.la;if(B.dist(G,u.YJ)>H.alpha_sort_threshold*Math.min(u.UM,1)||J.gr)d.HV(D,u,J.C,G),B.copy(G,u.YJ),J.gr=!1}for(var J=a,u=r,G=w,I=G.dJ,t=I.length;t--;)D=I[t],D.ko(n,D.Be,x,u);if(G.Ko&&!G.qw){G.Sr.length||k(G);I=G.Sr;for(t=I.length;t--;)D=I[t],D.ko(n,D.Be,x,u);G.Ko=!1}n.depthMask(u.fb);u.Oa?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE);D=u.ka;I=n;for(t=0;t<
D.length;t++){var P=D[t];I.activeTexture(I.TEXTURE0+t);I.bindTexture(P.ub,P.Gb);P.nh&&I.generateMipmap(P.ub)}if(J.type==p.qe){x=J;G=G.jn;I=x.F.hc;D=I.Gb;I=I.ub;t=x.sj;for(P=0;6>P;P++){var N=b(P);H.jz?(n.bindTexture(n.TEXTURE_CUBE_MAP,D),n.texImage2D(N,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,F)):(n.uniformMatrix4fv(G.u_cube_view_matrix,!1,t[P]),n.uniform4fv(G.u_sky_tex_fac,x.ip),n.uniform3fv(G.u_sky_tex_color,x.gp),n.uniform1f(G.u_sky_tex_dvar,x.hp),n.uniform3fv(G.u_horizon_color,x.Ld),n.uniform3fv(G.u_zenith_color,
x.Yd),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,N,D,0),A(u,0));if(x.Jo&&5!=P){var N=x,U=P,R=m;H.jz?R.set(F):(n.readPixels(191,191,1,1,n.RGBA,n.UNSIGNED_BYTE,R),255!=R[0]&&255!=R[1]&&255!=R[2]||n.readPixels(191,220,1,1,n.RGBA,n.UNSIGNED_BYTE,R));var W=R[0],sa=R[1],R=R[2],W=W/255,sa=sa/255,R=R/255;4===U?(N.tf[3]=W,N.tf[7]=sa,N.tf[11]=R):(N.tf[4*U]=W,N.tf[4*U+1]=sa,N.tf[4*U+2]=R)}}H.iC&&(n.bindTexture(I,D),n.generateMipmap(I),n.texParameteri(I,n.TEXTURE_MIN_FILTER,M.Zp));J.Un+=6}else A(u,
x.$x),J.Un++;y.HT(r);y.sG()&&"MAIN"==r.type&&q.SM(r.id,r.uf)}}}}function c(a){if(a){var b=(a.yb?n.COLOR_BUFFER_BIT:0)|(a.Bb?n.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case p.Zd:a=D;break;case p.wd:a=w;break;case p.Wf:a=G;break;case p.Ne:case p.oh:case p.zn:a=v;break;case p.qh:case p.Yp:case p.gt:a=D;break;default:a=H.background_color}}else b=n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT,a=H.background_color;n.colorMask(!0,!0,!0,!0);n.depthMask(!0);n.clearColor(a[0],a[1],a[2],a[3]);n.clear(b)}function b(a){switch(a){case 0:return n.TEXTURE_CUBE_MAP_POSITIVE_X;
case 1:return n.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return n.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return n.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return n.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return n.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function f(a){var b=g.cA(),c=a.jq,d=a.la,e=d.Eb;a.df.length=0;var m=1,f;for(f in e)m=Math.max(m,e[f].frames);for(e=0;e<m;e++){f=b.createVertexArray();J(f);d.Xg&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,d.Xg);for(var l=0;l<d.qd.length;l++){n.bindBuffer(n.ARRAY_BUFFER,d.qd[l].jk);for(var h=
0;h<c.length;h++){var k=c[h];k.by==d.qd[l].type&&(n.enableVertexAttribArray(k.Be),n.vertexAttribPointer(k.Be,k.lc,k.oo,k.oo==n.FLOAT?!1:!0,0,k.Et+k.Su*e),I(k.Be,k.lm))}}J(null);a.df.push(f)}}function k(a){var b=a.jn,c=a.dJ,d=a.Sr,e=a.cJ,g=a.mB;c.length=0;d.length=0;e.length=0;g.length=0;for(var m in b){var f=!1,l=null,h=null;switch(m){case "u_proj_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.wb)};f=!0;break;case "u_view_refl_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.fy)};f=!0;
break;case "u_view_tsr":case "u_view_tsr_frag":l=function(a,b,c,d){d.wc?a.uniformMatrix3fv(b,!1,d.ds):a.uniformMatrix3fv(b,!1,d.Pf)};f=!0;break;case "u_view_tsr_inverse":l=function(a,b,c,d){d.wc?a.uniformMatrix3fv(b,!1,d.Ow):a.uniformMatrix3fv(b,!1,d.gy)};f=!0;break;case "u_shadow_cast_billboard_view_tsr":l=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.qs)};f=!0;break;case "u_view_proj_prev":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.qB)};f=!0;break;case "u_view_proj_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,
!1,d.rd)};f=!0;break;case "u_view_proj_inverse":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ey)};f=!0;break;case "u_sky_vp_inverse":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.hh)};f=!0;break;case "u_camera_eye":case "u_camera_eye_frag":l=function(a,b,c,d){a.uniform3fv(b,E.Qb(d.C,C))};f=!0;break;case "u_camera_quat":l=function(a,b,c,d){a.uniform4fv(b,E.tb(d.C,R))};f=!0;break;case "u_view_max_depth":l=function(a,b,c,d){a.uniform1f(b,d.far)};f=!0;break;case "u_camera_range":l=function(a,b,c,d){a.uniform2f(b,
d.near,d.far)};f=!0;break;case "u_csm_center_dists":l=function(a,b,c,d){a.uniform4fv(b,d.ju)};break;case "u_height":l=function(a,b,c,d){a.uniform1f(b,d.height)};f=!0;break;case "u_pcf_blur_radii":l=function(a,b,c,d){a.uniform4fv(b,d.Uo)};break;case "u_dof_dist":l=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};f=!0;break;case "u_dof_front_start":l=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};f=!0;break;case "u_dof_front_end":l=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};
f=!0;break;case "u_dof_rear_start":l=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};f=!0;break;case "u_dof_rear_end":l=function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};f=!0;break;case "u_dof_bokeh_intensity":l=function(a,b,c,d){a.uniform1f(b,d.dof_bokeh_intensity)};f=!0;break;case "u_camera_direction":l=function(a,b,c,d){a.uniform3fv(b,d.direction)};f=!0;break;case "u_cam_water_depth":l=function(a,b,c){a.uniform1f(b,c.vq)};f=!0;break;case "u_fog_color_density":l=function(a,b,c){a.uniform4fv(b,
c.Kd)};break;case "u_fog_params":l=function(a,b,c){a.uniform4fv(b,c.zf)};break;case "u_underwater_fog_color_density":l=function(a,b,c){a.uniform4fv(b,c.Yh)};break;case "u_bloom_key":l=function(a,b,c){a.uniform1f(b,c.Mn)};break;case "u_average_lum_val":l=function(a,b,c){a.uniform1f(b,c.average_luminance)};break;case "u_mipmap_1x1":l=function(a,b,c){a.uniform1f(b,c.Qv)};break;case "u_bloom_edge_lum":l=function(a,b,c){a.uniform1f(b,c.Ln)};break;case "u_time":l=function(a,b,c){a.uniform1f(b,c.time)};
f=!0;break;case "u_wind":l=function(a,b,c){a.uniform3fv(b,c.Zh)};f=!0;break;case "u_sky_tex_dvar":l=function(a,b,c){a.uniform1f(b,c.hp)};break;case "u_sky_tex_fac":l=function(a,b,c){a.uniform4fv(b,c.ip)};break;case "u_sky_tex_color":l=function(a,b,c){a.uniform3fv(b,c.gp)};break;case "u_horizon_color":l=function(a,b,c){a.uniform3fv(b,c.Ld)};break;case "u_zenith_color":l=function(a,b,c){a.uniform3fv(b,c.Yd)};break;case "u_environment_energy":l=function(a,b,c){a.uniform1f(b,c.gg)};break;case "u_bsdf_cube_sky_dim":l=
function(a,b,c){a.uniform1f(b,c.Mt)};f=!0;break;case "u_sky_color":l=function(a,b,c){a.uniform3fv(b,c.pl)};break;case "u_rayleigh_brightness":l=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":l=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":l=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":l=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":l=function(a,b,c){a.uniform1f(b,
c.rayleigh_strength)};break;case "u_mie_strength":l=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":l=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":l=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":l=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":l=function(a,b,c){a.uniform4fv(b,c.Km)};break;case "u_light_directions":l=function(a,b,c){a.uniform3fv(b,
c.Gr)};break;case "u_light_color_intensities":l=function(a,b,c){a.uniform4fv(b,c.Jm)};break;case "u_sun_quaternion":l=function(a,b,c){a.uniform4fv(b,c.Fx)};break;case "u_sun_intensity":l=function(a,b,c){a.uniform3fv(b,c.Ex)};break;case "u_sun_direction":l=function(a,b,c){a.uniform3fv(b,c.Dx)};break;case "u_debug_view_mode":l=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":l=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":l=
function(a,b,c){a.uniform1f(b,c.pu)};break;case "u_subpixel_jitter":l=function(a,b,c){a.uniform2fv(b,c.zA)};f=!0;break;case "u_subsample_indices":l=function(a,b,c){a.uniform4fv(b,c.SR)};f=!0;break;case "u_radial_blur_step":l=function(a,b,c){a.uniform1f(b,c.Xo)};break;case "u_god_rays_intensity":l=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":l=function(a,b,c){a.uniform1f(b,c.op)};break;case "u_ssao_blur_discard_value":l=function(a,b,c){a.uniform1f(b,c.kp)};
f=!0;break;case "u_ssao_influence":l=function(a,b,c){a.uniform1f(b,c.np)};break;case "u_ssao_dist_factor":l=function(a,b,c){a.uniform1f(b,c.lp)};break;case "u_texel_size":l=function(a,b,c){a.uniform2fv(b,c.Bs)};f=!0;break;case "u_normal_offset":l=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":l=function(a,b,c){a.uniform4fv(b,c.Hp)};f=!0;break;case "u_v_light_r":l=function(a,b,c){a.uniform4fv(b,c.Gp)};f=!0;break;case "u_v_light_tsr":l=function(a,b,c){a.uniformMatrix3fv(b,
!1,c.Ts)};f=!0;break;case "u_p_light_matrix0":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qj[0])};f=!0;break;case "u_p_light_matrix1":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qj[1])};f=!0;break;case "u_p_light_matrix2":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qj[2])};f=!0;break;case "u_p_light_matrix3":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Qj[3])};f=!0;break;case "u_outline_color":l=function(a,b,c){a.uniform3fv(b,c.Mh)};break;case "u_draw_outline":l=function(a,b,c){a.uniform1f(b,c.Xq)};
f=!0;break;case "u_glow_mask_small_coeff":l=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};f=!0;break;case "u_glow_mask_large_coeff":l=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};f=!0;break;case "u_brightness":l=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":l=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":l=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":l=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":l=
function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":l=function(a,b,c){a.uniform4fv(b,c.uj)};break;case "u_chromatic_aberration_coefs":l=function(a,b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":l=function(a,b,c){a.uniform1f(b,c.iw)};f=!0;break;case "u_motion_blur_decay_threshold":l=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};f=!0;break;case "u_model_tsr":h=function(a,b,c){a.uniformMatrix3fv(b,!1,c.C)};f=!0;break;case "u_model_tsr_inverse":h=
function(a,b,c){a.uniformMatrix3fv(b,!1,c.py)};f=!0;break;case "u_transb":h=function(a,b,c){a.uniform4fv(b,c.Wd)};f=!0;break;case "u_transa":h=function(a,b,c){a.uniform4fv(b,c.Ke)};f=!0;break;case "u_arm_rel_trans":h=function(a,b,c){a.uniform4fv(b,c.gq)};f=!0;break;case "u_arm_rel_quat":h=function(a,b,c){a.uniform4fv(b,c.fq)};f=!0;break;case "u_quat":h=function(a,b,c){a.uniform4fv(b,E.tb(c.C,R))};f=!0;break;case "u_quatsb":h=function(a,b,c){a.uniform4fv(b,c.Pd)};f=!0;break;case "u_quatsa":h=function(a,
b,c){a.uniform4fv(b,c.Fe)};f=!0;break;case "u_frame_factor":h=function(a,b,c){a.uniform1f(b,c.Af)};f=!0;break;case "au_center_pos":h=function(a,b,c){a.uniform3fv(b,c.Rt)};f=!0;break;case "au_wind_bending_amp":h=function(a,b,c){a.uniform1f(b,c.Rf)};f=!0;break;case "au_wind_bending_freq":h=function(a,b,c){a.uniform1f(b,c.Sf)};f=!0;break;case "au_detail_bending_freq":h=function(a,b,c){a.uniform1f(b,c.xf)};f=!0;break;case "au_detail_bending_amp":h=function(a,b,c){a.uniform1f(b,c.wf)};f=!0;break;case "au_branch_bending_amp":h=
function(a,b,c){a.uniform1f(b,c.qf)};f=!0;break;case "u_node_values":h=function(a,b,c,d){a.uniform4fv(b,d.Kh)};f=!0;break;case "u_node_rgbs":h=function(a,b,c,d){a.uniform3fv(b,d.je)};f=!0;break;case "u_lod_coverage":h=function(a,b,c,d){a.uniform1f(b,d.Uk.Qe)};f=!0;break;case "u_lod_cmp_logic":h=function(a,b,c,d){a.uniform1f(b,d.Uk.Wt)};f=!0;break;case "u_diffuse_color":h=function(a,b,c,d){a.uniform4fv(b,d.ic)};f=!0;break;case "u_diffuse_intensity":h=function(a,b,c,d){a.uniform1f(b,d.ee)};f=!0;break;
case "u_diffuse_params":h=function(a,b,c,d){a.uniform2fv(b,d.zd)};f=!0;break;case "u_emit":h=function(a,b,c,d){a.uniform1f(b,d.Ad)};f=!0;break;case "u_ambient":h=function(a,b,c,d){a.uniform1f(b,d.xd)};f=!0;break;case "u_specular_color":h=function(a,b,c,d){a.uniform3fv(b,d.me)};f=!0;break;case "u_specular_alpha":h=function(a,b,c,d){a.uniform1f(b,d.If)};f=!0;break;case "u_specular_params":h=function(a,b,c,d){a.uniform3fv(b,d.He)};f=!0;break;case "u_reflect_factor":h=function(a,b,c,d){a.uniform1f(b,
d.reflect_factor)};f=!0;break;case "u_mirror_factor":h=function(a,b,c,d){a.uniform1f(b,d.Om)};f=!0;break;case "u_grass_map_dim":h=function(a,b,c,d){a.uniform3fv(b,d.jd)};f=!0;break;case "u_grass_size":h=function(a,b,c,d){a.uniform1f(b,d.Bj)};f=!0;break;case "u_scale_threshold":h=function(a,b,c,d){a.uniform1f(b,d.lv)};f=!0;break;case "u_cube_fog":h=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.tf)};break;case "u_jitter_amp":h=function(a,b,c,d){a.uniform1f(b,d.Mv)};f=!0;break;case "u_jitter_freq":h=function(a,
b,c,d){a.uniform1f(b,d.Nv)};f=!0;break;case "u_wireframe_edge_color":h=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":h=function(a,b,c,d){a.uniform1f(b,d.Eq)};f=!0;break;case "u_batch_debug_id_color":h=function(a,b,c,d){a.uniform1f(b,d.ou)};f=!0;break;case "u_batch_debug_main_render_time":h=function(a,b,c,d){a.uniform1f(b,d.Rq)};f=!0;break;case "u_refr_bump":h=function(a,b,c,d){a.uniform1f(b,d.gh)};f=!0;break;case "u_line_width":h=function(a,b,c,d){a.uniform1f(b,
d.Lm)};f=!0;break;case "u_lamp_light_positions":h=function(a,b,c,d){a.uniform3fv(b,d.Bo)};break;case "u_lamp_light_directions":h=function(a,b,c,d){a.uniform3fv(b,d.Cr)};break;case "u_lamp_light_color_intensities":h=function(a,b,c,d){a.uniform3fv(b,d.Br)};break;case "u_halo_size":h=function(a,b,c,d){a.uniform1f(b,d.vv)};f=!0;break;case "u_halo_hardness":h=function(a,b,c,d){a.uniform1f(b,d.sv)};f=!0;break;case "u_halo_rings_color":h=function(a,b,c,d){a.uniform3fv(b,d.uv)};f=!0;break;case "u_halo_lines_color":h=
function(a,b,c,d){a.uniform3fv(b,d.tv)};f=!0;break;case "u_halo_stars_blend":h=function(a,b,c,d){a.uniform1f(b,d.wv)};f=!0;break;case "u_halo_stars_height":h=function(a,b,c,d){a.uniform1f(b,d.xv)};f=!0;break;case "u_fresnel_params":h=function(a,b,c,d){a.uniform2fv(b,d.Dh)};f=!0;break;case "u_texture_scale":h=function(a,b,c,d){a.uniform3fv(b,d.kh)};f=!0;break;case "u_parallax_scale":h=function(a,b,c,d){a.uniform1f(b,d.parallax_scale)};f=!0;break;case "u_color_id":h=function(a,b,c){a.uniform3fv(b,c.xk)};
f=!0;break;case "u_diffuse_color_factor":h=function(a,b,c,d){a.uniform1f(b,d.ui)};f=!0;break;case "u_alpha_factor":h=function(a,b,c,d){a.uniform1f(b,d.Hg)};f=!0;break;case "u_specular_color_factor":h=function(a,b,c,d){a.uniform1f(b,d.ak)};f=!0;break;case "u_normal_factor":h=function(a,b,c,d){a.uniform1f(b,d.Oo)};f=!0;break;case "u_normalmap0_scale":h=function(a,b,c,d){a.uniform2fv(b,d.Pj[0])};f=!0;break;case "u_normalmap1_scale":h=function(a,b,c,d){a.uniform2fv(b,d.Pj[1])};f=!0;break;case "u_normalmap2_scale":h=
function(a,b,c,d){a.uniform2fv(b,d.Pj[2])};f=!0;break;case "u_normalmap3_scale":h=function(a,b,c,d){a.uniform2fv(b,d.Pj[3])};f=!0;break;case "u_foam_factor":h=function(a,b,c,d){a.uniform1f(b,d.foam_factor)};f=!0;break;case "u_foam_uv_freq":h=function(a,b,c,d){a.uniform2fv(b,d.Qu)};f=!0;break;case "u_foam_mag":h=function(a,b,c,d){a.uniform2fv(b,d.Pu)};f=!0;break;case "u_foam_scale":h=function(a,b,c,d){a.uniform2fv(b,d.er)};f=!0;break;case "u_water_norm_uv_velocity":h=function(a,b,c,d){a.uniform1f(b,
d.Gl)};f=!0;break;case "u_shallow_water_col":h=function(a,b,c,d){a.uniform3fv(b,d.shallow_water_col)};f=!0;break;case "u_shore_water_col":h=function(a,b,c,d){a.uniform3fv(b,d.shore_water_col)};f=!0;break;case "u_water_shallow_col_fac":h=function(a,b,c,d){a.uniform1f(b,d.shallow_water_col_fac)};f=!0;break;case "u_water_shore_col_fac":h=function(a,b,c,d){a.uniform1f(b,d.shore_water_col_fac)};f=!0;break;case "u_p_length":h=function(a,b,c,d){a.uniform1f(b,d.Ha.Kx)};f=!0;break;case "u_p_cyclic":h=function(a,
b,c,d){a.uniform1i(b,d.Ha.cyclic)};f=!0;break;case "u_p_max_lifetime":h=function(a,b,c,d){a.uniform1f(b,d.Ha.Sv)};f=!0;break;case "u_p_fade_in":h=function(a,b,c,d){a.uniform1f(b,d.Ha.wj)};f=!0;break;case "u_p_fade_out":h=function(a,b,c,d){a.uniform1f(b,d.Ha.Ue)};f=!0;break;case "u_p_size":h=function(a,b,c,d){a.uniform1f(b,d.Ha.size)};f=!0;break;case "u_p_alpha_start":h=function(a,b,c,d){a.uniform1f(b,d.Ha.ut)};f=!0;break;case "u_p_alpha_end":h=function(a,b,c,d){a.uniform1f(b,d.Ha.tt)};f=!0;break;
case "u_p_nfactor":h=function(a,b,c,d){a.uniform1f(b,d.Ha.Lo)};f=!0;break;case "u_p_gravity":h=function(a,b,c,d){a.uniform1f(b,d.Ha.mv)};f=!0;break;case "u_p_mass":h=function(a,b,c,d){a.uniform1f(b,d.Ha.$g)};f=!0;break;case "u_p_color_ramp":h=function(a,b,c,d){a.uniform4fv(b,d.Ha.Zt)};f=!0;break;case "u_p_wind_fac":h=function(a,b,c,d){a.uniform1f(b,d.Ha.oy)};f=!0;break;case "u_p_time":h=function(a,b,c,d){a.uniform1f(b,d.Ha.time)};f=!0;break;case "u_p_tilt":h=function(a,b,c,d){a.uniform1f(b,d.Ha.Ix)};
f=!0;break;case "u_p_tilt_rand":h=function(a,b,c,d){a.uniform1f(b,d.Ha.Jx)};f=!0;break;case "u_position":h=function(a,b,c,d){a.uniform3fv(b,d.Ql)};f=!0;break;case "u_va_frame_factor":h=function(a,b,c){a.uniform1f(b,c.ay)};f=!0;break;case "u_refl_plane":h=function(a,b,c){a.uniform4fv(b,c.wc)};f=!0;break;case "u_outline_intensity":h=function(a,b,c){a.uniform1f(b,c.Nh)};f=!0;break;case "u_obj_info":h=function(a,b,c,d){a.uniform3fv(b,d.Qo)},f=!0}h&&(h={name:m,ko:h,Be:b[m]},f?c.push(h):d.push(h));l&&(h=
{name:m,ko:l,Be:b[m]},f?e.push(h):g.push(h))}if(d.length||g.length){a=a.nB;for(var k in a)delete a[k];for(k=0;k<d.length;k++)h=d[k],a[h.name]=h;for(k=0;k<g.length;k++)h=g[k],a[h.name]=h}else a.qw=!0}var q=t("__batch"),h=t("__camera"),u=t("__config"),y=t("__debug"),g=t("__extensions"),d=t("__geometry"),r=t("__quat"),p=t("__subscene"),M=t("__textures"),E=t("__tsr"),z=t("__util"),l=t("__version"),B=t("__vec3"),w=[1,0,0,1],G=[1,1,1,1],v=[0,0,0,1],D=[0,0,0,0],F=new Uint8Array([91.8,142.8,.96*255,255]),
n=null,N=null,I=null,x=null,J=null,A=null,C=new Float32Array(3),R=r.create(),m=new Uint8Array(4),H=u.K;a.ug=function(a){var b=H.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);n=a};a.ao=function(a){if(a.dc&&!a.qm)if(a.type==p.ft){y.xB(a);var d=a.F;n.bindFramebuffer(n.READ_FRAMEBUFFER,d.hr);n.bindFramebuffer(n.DRAW_FRAMEBUFFER,
d.Ve);var g=0;d.hc&&(g|=n.COLOR_BUFFER_BIT);d.vf&&(g|=n.DEPTH_BUFFER_BIT);n.blitFramebuffer(0,0,d.width,d.height,0,0,d.width,d.height,g,n.NEAREST);y.yB(a);y.gz("draw resolve")}else if(a.type==p.uy)y.xB(a),d=a.F,n.bindFramebuffer(n.FRAMEBUFFER,d.hr),n.bindTexture(n.TEXTURE_2D,d.hc.Gb),n.copyTexSubImage2D(n.TEXTURE_2D,0,0,0,0,0,d.width,d.height,0),y.yB(a),y.gz("draw copy");else{y.xB(a);d=a.F;n.bindFramebuffer(n.FRAMEBUFFER,d.Ve);a.iq&&(g=d.hc,n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,
g.ub,g.Gb,0));n.viewport(0,0,d.width,d.height);a.type!=p.ud&&a.type!=p.gf&&c(a);a.rb?n.enable(n.BLEND):n.disable(n.BLEND);a.Id?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST);switch(a.type){case p.wd:n.enable(n.POLYGON_OFFSET_FILL);n.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);n.cullFace(n.BACK);break;case p.$d:case p.Vf:n.disable(n.POLYGON_OFFSET_FILL);n.cullFace(n.FRONT);break;case p.ph:n.enable(n.POLYGON_OFFSET_FILL);n.polygonOffset(-4,-4);n.cullFace(n.BACK);break;case p.Zd:if(1<
H.Zb||H.XT){n.enable(n.POLYGON_OFFSET_FILL);n.polygonOffset(-2,-2);break}default:n.disable(n.POLYGON_OFFSET_FILL),n.cullFace(n.BACK)}if(a.type==p.ud||a.type==p.gf)for(var d=a.F,g=d.hc.Gb,f=0;6>f;f++){var m=b(f);d.Ub=a.sj[f];E.from_mat4(d.Ub,d.Pf);h.cz(d);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,m,g,0);c(a);for(var m=a.Xa,l=0;l<m.length;l++)for(var k=0;k<m[l].Ia.length;k++){var w=m[l].Ia[k];w.dc=w.Gz[f]}e(a)}else e(a);y.yB(a);y.gz("draw subscene: "+p.Cx(a))}};a.clear=function(a){n.bindFramebuffer(n.FRAMEBUFFER,
a.F.Ve);c(a)};a.zt=function(a){var b=a.jq;b.length=0;var c=a.la,e=c.Eb,g=a.pb.attributes,m;for(m in g){var h=e[m],k=d.no(m),n=d.VQ(m),w=d.SF(m);b.push({by:k,oo:n,Be:g[m],Et:h.offset*w,Su:1<h.frames?h.length*w:0,lc:h.lc,lm:h.lm})}if("DEBUG"==l.type())for(m in e)k=d.no(m),b=d.$T(c.qd,k),b=c.qd[b],h=a.Za.Of+" | "+a.Za.xe,k=e[m].length*e[m].frames*d.SF(m),y.TP(b.mP,h,m,k,m in g);H.Ly&&f(a)};a.NM=f;a.MN=function(a){for(var b=g.cA(),c=0;c<a.df.length;c++)b.deleteVertexArray(a.df[c]);a.df.length=0};a.ON=
function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({by:d.by,oo:d.oo,Be:d.Be,Et:d.Et,Su:d.Su,lc:d.lc,lm:d.lm})}return b};a.MM=k;a.KD=function(a){var b=a.pb,c=a.ka;a=a.Lf;n.useProgram(b.Oi);for(var d=0;d<c.length;d++)n.uniform1i(b.jn[a[d]],d)};a.Nw=function(a,b,c,d,e,g){n.bindFramebuffer(n.FRAMEBUFFER,a);n.readPixels(b,c,d,e,n.RGBA,n.UNSIGNED_BYTE,g);n.bindFramebuffer(n.FRAMEBUFFER,null);return g};a.EV=function(a){var b=a.pb;b.qw||(n.useProgram(b.Oi),b.Sr.length||k(b),b=b.nB.u_cube_fog,
b.ko(n,b.Be,null,a))};a.FT=function(a,b){var c=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,c);if(M.yo(a)){var d=a.ef;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,d)}else if(M.Ao(a)){var e=a,d=e.Gb,e=e.ub==n.TEXTURE_CUBE_MAP?n.TEXTURE_CUBE_MAP_NEGATIVE_Z:e.ub;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,e,d,0)}M.yo(b)?(d=b.ef,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,d)):M.Ao(b)&&(e=b,d=e.Gb,e=e.ub,n.framebufferTexture2D(n.FRAMEBUFFER,
n.DEPTH_ATTACHMENT,e,d,0));y.wN();n.bindFramebuffer(n.FRAMEBUFFER,null);return c};a.ET=function(a,b,c,d,e){null==a?(n.bindFramebuffer(n.FRAMEBUFFER,a),n.viewport(0,0,d,e),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)):(M.yo(b)?n.deleteRenderbuffer(b.ef):M.Ao(b)&&n.deleteTexture(b.Gb),M.yo(c)?n.deleteRenderbuffer(c.ef):M.Ao(c)&&n.deleteTexture(c.Gb),n.deleteFramebuffer(a))};a.UY=function(){};a.xP=function(a,b,c,d,e,g){a=a.Gb;n.viewport(0,0,c,c);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,
b,a,0);b=q.gu("FLIP_CUBEMAP_COORDS");a=b.pb;n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,e);var f=e=0;c!=d&&(e=1/(6*d),f=1/(4*d));n.uniform1i(a.jn.u_tex_number,g);n.uniform2fv(a.jn.u_delta,[e,f]);n.useProgram(a.Oi);A(b,0);n.bindTexture(n.TEXTURE_2D,null)};a.yP=function(a,b,c,d,e){n.bindFramebuffer(n.FRAMEBUFFER,d);d=a.Gb;a=a.ub;n.bindTexture(a,d);n.viewport(0,0,b,c);n.texImage2D(a,0,n.RGBA,b,c,0,n.RGBA,n.UNSIGNED_BYTE,null);n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,a,d,0);
b=q.gu("NONE");c=b.pb;n.activeTexture(n.TEXTURE0);n.bindTexture(a,e);n.useProgram(c.Oi);A(b,0);n.bindFramebuffer(n.FRAMEBUFFER,null);n.bindTexture(a,null)};a.cleanup=function(){};a.mU=function(){var a=g.YQ(),b=g.cA();H.CD=a?!0:!1;H.Ly=b?!0:!1;a?(N=function(b,c,d,e){a.drawElementsInstanced(n.TRIANGLES,b,c,d,e)},I=function(b,c){a.vertexAttribDivisor(b,c)},x=function(b,c,d){a.drawArraysInstanced(n.TRIANGLES,b,c,d)}):(N=function(a,b,c){n.drawElements(n.TRIANGLES,a,b,c)},I=function(){},x=function(a,b){n.drawArrays(n.TRIANGLES,
a,b)});b?(J=function(a){b.bindVertexArray(a)},A=function(a,b){var c=a.la;J(a.df[b]);c.Xg?N(c.count,c.xm,0,c.Bm):x(0,c.count,c.Bm);J(null)}):A=function(a,b){for(var c=a.la,d=a.jq,e=0;e<c.qd.length;e++){n.bindBuffer(n.ARRAY_BUFFER,c.qd[e].jk);for(var g=0;g<d.length;g++){var f=d[g];f.by==c.qd[e].type&&(n.enableVertexAttribArray(f.Be),n.vertexAttribPointer(f.Be,f.lc,f.oo,f.oo==n.FLOAT?!1:!0,0,f.Et+f.Su*b),I(f.Be,f.lm))}}c.Xg?(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,c.Xg),N(c.count,c.xm,0,c.Bm)):x(0,c.count,
c.Bm);for(e=0;e<d.length;e++)f=d[e],n.disableVertexAttribArray(f.Be)}};a.reset=function(){J=x=I=N=n=null}};b4w.module.__shaders=function(a,t){function e(){return{Of:"",xe:"",yh:[],Ye:[],status:0,At:0,Hx:0}}function c(a){var b=e();b.Of=a.Of;b.xe=a.xe;b.yh=J.V(a.yh);b.Ye=J.V(a.Ye);b.status=a.status;b.At=a.At;b.Hx=a.Hx;return b}function b(a,b,c){var d=a.yh;"string"==typeof c?(a=f(a,c))&&(c=a[1]):c=String(c);for(a=0;a<d.length;a++)if(d[a][0]==b){d[a][1]=c;break}}function f(a,b){for(var c=a.yh,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function k(a,b){var c=a+b;if(!(c in O)){var d=E(R.shaders_path,
a),e=E(R.shaders_path,b),d=l(d),e=l(e),g;for(g in e)d[g]=e[g];e=[];for(g in d)e.push([g,d[g]]);O[c]=e}return O[c]}function q(a,b){return a+b}function h(a,b){return(a.split(";").map(function(a){return(a=a.match(b))&&(a[3]?parseInt(a[3],10):1)}).filter(function(a){return a})||[]).reduce(q,0)}function u(a,b){var c=M(a.type),d=M(b.type),e=a.Vl,g=b.Vl;return c>d?-1:c<d?1:e>g?-1:e<g?1:0}function y(a){if(A.Hb){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=T}else b=ja;a=a.split(";").map(function(a){return(a=
a.match(b))&&{type:a[2],Vl:a[4]?parseInt(a[4],10):1}}).filter(function(a){return a});return d(a,Z,C.dw)}function g(a,b,c){a=a.split(";");for(var e=[],g=0;g<a.length;g++){var f=a[g].match(na);f&&e.push({type:f[2],Vl:f[4]?parseInt(f[4],10):1})}return d(e,b,c)}function d(a,b,c){function d(){for(var c=0;h<a.length;){var d=a[h];if(3!=M(d.type))break;c+=p(d.type)*d.Vl;h++}m=l+c;if(m>Ca)return!1;r(b,l,c,0,3);return!0}function e(){for(var c=Ca-m,d=c,e=c;h<a.length;){var g=a[h];if(2!=M(g.type))break;g=p(g.type)*
g.Vl;if(g<=d)d-=g;else if(g<=e)e-=g;else return!1;h++}e=c-e;r(b,m,c-d,0,2);r(b,Ca-e,e,2,2);return!0}function g(){for(;h<a.length;){for(var d=a[h],d=p(d.type)*d.Vl,e=-1,g=c+1,f=-1,m=0;4>m;m++){var l=qa;l[0]=0;l[1]=1;var k;k=b;for(var n=m,w=d,C=l;fa<k.length&&15===k[fa];)fa++;for(;0<Ca&&15===k[Ca];)Ca--;if(Ca-fa<w)k=!1;else{for(var n=1<<n,v=0,x=-1,F=k.length+1,Q=!1,ga=fa;ga<=Ca;ga++)ga<Ca&&!(k[ga]&n)?Q||(v=ga,Q=!0):(Q&&(Q=ga-v,Q>=w&&Q<F&&(F=Q,x=v)),Q=!1);0>x?k=!1:(C[0]=x,C[1]=F,k=!0)}k&&l[1]<g&&(f=
l[0],g=l[1],e=m)}if(0>e)return!1;r(b,f,d,e,1);h++}return!0}if(!a.length)return!0;for(var f=0;f<c;f++)b[f]=0;Ca=c;a.sort(u);var m=0,l=0,h=0;return function(){for(;h<a.length;){var c=a[h];if(4!=M(c.type))break;l+=p(c.type)*c.Vl;h++}if(l>Ca)return!1;fa=l;r(b,0,l,0,4);return!0}()&&d()&&e()&&g()}function r(a,b,c,d,e){for(var g=0,f=0;f<e;f++)g|=1<<d+f;for(f=0;f<c;f++)a[b+f]|=g}function p(a){switch(a){case "mat4":a=4;break;case "mat3":a=3;break;case "mat2":a=2;break;default:a=1}return a}function M(a){switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":a=
4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":a=3;break;case "vec2":case "ivec2":case "bvec2":a=2;break;default:a=1}return a}function E(a,b){var c=a+b;if(H[c])return H[c];if(U){var d=U[b];if(!d)return null;d=t("__gpp_parser").rZ.parse(d)}else if(d=t("shader_texts")[b],!d)return null;return H[c]=d}function z(a,b){for(var c={},d=b.yh||[],e=0;e<d.length;e++)c[d[e][0]]=[d[e][1]];for(e=0;e<b.Ye.length;e++)c["USE_NODE_"+b.Ye[e].id]=["1"];A.Hb?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],
c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],c.GLSL_TEXTURE_PROJ=["textureProj"],c.GLSL_TEXTURE_LOD=["textureLod"],c.GLSL_TEXTURE_CUBE_LOD=["textureLod"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=
["texture2DProj"],c.GLSL_TEXTURE_LOD=["textureLod"],A.iC?(c.GLSL_TEXTURE_LOD=["texture2DLodEXT"],c.GLSL_TEXTURE_CUBE_LOD=["textureCubeLodEXT"]):(c.GLSL_TEXTURE_LOD=["texture2D"],c.GLSL_TEXTURE_CUBE_LOD=["textureCube"]));c.GLSL_SMPLR2D_SHDW=A.Hq&&!A.ks?["sampler2DShadow"]:["sampler2D"];for(var g in c)c[g][0].constructor!=String&&x.warn("Warning! The value of a directive '"+g+"' is not of type string.");return c}function l(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=E(R.shaders_path,
R.tI+a.D),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var e=0;e<a.length;e++)c(a[e],b,d);else if(a instanceof Object&&a){b&&b(a);for(e in a)c(a[e],b,d);d&&d(a)}}var d={};c(a,b);return d}function B(a,b,c){function d(b){b=b.f;for(var c=0;c<b.length;c++){var h=b[c];switch(h.a){case "cond":a:for(var h=h.f,r=0;r<h.length;r++){var L=h[r];switch(L.a){case "if":case "elif":if(e(L.j)){d(L.l);break a}break;case "else":d(L.l);break a;case "ifdef":L.c in w&&d(L.l);break;case "ifndef":L.c in w||d(L.l)}}break;
case "include":h=h.D;r=E(R.shaders_path,R.tI+h);v.push("include/"+h);d(r);v.pop();break;case "var":break;case "define":w[h.c]=h.b;break;case "error":J.I("Shader error: #error "+h.b.join(" "));break;case "line":break;case "pragma":n.push("#pragma "+h.c+" "+h.b.join(" "));break;case "undef":delete w[h.c];break;case "warning":x.warn("Shader warning: #warning "+h.b.join(" "));break;case "extension":h=l(h.b,w,C,!1);n.push("#extension "+h.join(" "));break;case "version":h=l(h.b,w,C,!1),n.push("#version "+
h.join(" "));case "#":break;case "node":p[h.c]=h;break;case "nodes_global":h=k;for(r=0;r<h.length;r++){var L=h[r],ha=p[L.id];if(ha)for(var ga=0,G=0;G<ha.A.length;G++){var ma=ha.A[G];if("node_param"==ma.a){var aa;if("PARTICLE_INFO"==L.id&&ma.g)if(1==w.PARTICLE_BATCH)switch(aa=!1,ga){case 0:aa=F(L.Wa,"PART_INFO_IND")||F(L.Wa,"PART_INFO_AGE")||F(L.Wa,"PART_INFO_LT")||F(L.Wa,"PART_INFO_SIZE");break;case 1:aa=F(L.Wa,"PART_INFO_LOC");break;case 2:aa=F(L.Wa,"PART_INFO_VEL");break;case 3:aa=F(L.Wa,"PART_INFO_A_VEL");
break;case 4:aa=F(L.Wa,"PART_INFO_IND")}else aa=!1;else aa=!0;aa&&(ma=ma.i.join(" ")+" ","vert"==a?ma+=L.Le[ga]:"frag"==a&&(ma+=L.$[ga],null!==L.So[ga]&&(ma+="="+L.So[ga])),ma+=";",m(f(ma)));ga++}}}break;case "nodes_main":h=k;for(r=0;r<h.length;r++)if(L=h[r],ha=p[L.id]){ga={};Q=H=q=0;G=ha;ma=L;aa=G;for(var A={},z=0;z<aa.B.length;z++){var ua=aa.B[z];A[ua.c]=[ua.b.join("")]}aa=A;for(A=0;A<ma.Wa.length;A++)z=ma.Wa[A][0],z in aa&&(aa[z]=[ma.Wa[A][1]]);for(A=z=0;A<G.A.length;A++)ua=G.A[A],"node_out"==
ua.a&&(aa["USE_OUT_"+ua.c]=[-1<u.indexOf(ma.outputs[z])|0],z++);G=aa;ma=L;aa=ha.A;A=ga;z=G;for(ua=0;ua<aa.length;ua++){var La=aa[ua];switch(La.a){case "node_in":var da=ma.inputs[q];if(null!==ma.rA[q]){if(("MATERIAL_BEGIN"==ma.id&&3===q||!z.MATERIAL_EXT&&("MATERIAL_BEGIN"==ma.id&&4===q||"MATERIAL_END"==ma.id&&3===q||"MATERIAL_END"==ma.id&&4===q||"MATERIAL_END"==ma.id&&5===q)||"TEXTURE_COLOR"==ma.id||"TEXTURE_NORMAL"==ma.id)&&La.g){A[La.c]=ma.rA[q];q++;continue}var M=La.i.join(" ")+" ",M=M+(da+"="+
ma.rA[q]+";");m(f(M))}A[La.c]=da;q++;break;case "node_out":da=ma.outputs[H];if(!La.g||-1<u.indexOf(da))M=La.i.join(" ")+" ",M+=da+";",m(f(M)),A[La.c]=da;H++;break;case "node_param":"vert"==a?da=ma.Le[Q]:"frag"==a&&(da=ma.$[Q]),A[La.c]=da,Q++}}n.push("{");g(L,ha.u,ga,G);n.push("}")}break;case "txt":m(h.b);break;default:J.I("Unknown element type: "+h.a)}}}function e(a,b){var c;c=l(a,w,C,!0,b);for(var d=[],e=0;e<c.length;e++)if(c[e]instanceof Object)switch(c[e].a){case "conditional_expr":var g=d.pop(),
f=d.pop();d.pop()?d.push(f):d.push(g);break;case "logical_or_expr":for(var f=d.pop(),m=0;m<c[e].o-1;m++)g=d.pop(),f=f||g;d.push(f);break;case "logical_and_expr":f=d.pop();for(m=0;m<c[e].o-1;m++)g=d.pop(),f=f&&g;d.push(f);break;case "logical_bitor_expr":f=d.pop();for(m=0;m<c[e].o-1;m++)f|=d.pop();d.push(f);break;case "logical_bitxor_expr":f=d.pop();for(m=0;m<c[e].o-1;m++)f^=d.pop();d.push(f);break;case "logical_bitand_expr":f=d.pop();for(m=0;m<c[e].o-1;m++)f&=d.pop();d.push(f);break;case "equal_expr":g=
d.pop();f=d.pop();d.push(f==g);break;case "non_equal_expr":g=d.pop();f=d.pop();d.push(f!=g);break;case "le_expr":g=d.pop();f=d.pop();d.push(f<=g);break;case "ge_expr":g=d.pop();f=d.pop();d.push(f>=g);break;case "l_expr":g=d.pop();f=d.pop();d.push(f<g);break;case "g_expr":g=d.pop();f=d.pop();d.push(f>g);break;case "left_shift_expr":f=d.pop();g=d.pop();d.push(f<<g);break;case "right_shift_expr":f=d.pop();g=d.pop();d.push(f>>g);break;case "add_expr":f=d.pop();g=d.pop();d.push(f+g);break;case "sub_expr":f=
d.pop();g=d.pop();d.push(f-g);break;case "mul_expr":f=d.pop();g=d.pop();d.push(f*g);break;case "div_expr":f=d.pop();g=d.pop();d.push(f/g);break;case "mod_expr":f=d.pop();g=d.pop();d.push(f%g);break;case "pre_inc_expr":case "post_inc_expr":g=d.pop();d.push(++g);break;case "pre_dec_expr":case "post_dec_expr":g=d.pop();d.push(--g);break;case "positive_expr":g=d.pop();d.push(+g);break;case "negative_expr":g=d.pop();d.push(-g);break;case "one_compl_expr":g=d.pop();d.push(~g);break;case "logic_negative_expr":g=
d.pop();d.push(!g);break;default:J.I("Unknown operation type: "+c[e].a)}else g=c[e],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(g)?(d.push(0),0!=g.indexOf("USE_NODE_")&&(f=v[v.length-1],f in r||(r[f]=[]),-1==r[f].indexOf(g)&&(r[f].push(g),x.error("Undefined directive '"+g+"' in shader '"+f+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[e]));1==d.length?c=d[0]:(J.I("Incorrect expression: "+c.join(" ")),c=void 0);return c}function g(a,b,c,d){for(var f=0;f<b.length;f++){var h=
b[f];switch(h.a){case "node_cond":a:for(var l=a,h=h.f,k=c,n=d,Q=0;Q<h.length;Q++){var C=h[Q];switch(C.a){case "node_if":case "node_elif":if(e(C.j,n)){g(l,C.u,k,n);break a}break;case "node_else":g(l,C.u,k,n);break a;case "node_ifdef":(C.c in w||C.c in n)&&g(l,C.u,k,n);break;case "node_ifndef":C.c in w||C.c in n||g(l,C.u,k,n)}}break;case "txt":l=[];for(k=0;k<h.b.length;k++)n=h.b[k],n in c?l.push(c[n]):l.push(n);m(l,d)}}}function f(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function m(b,c){var d=
b;if(!A.Hb&&"frag"==a){var e=d.join(" ");L&&(e.match(/[^;]*;/)?(e=e.replace(/[^;]*;/,""),L=!1):e="");e=e.replace(/GLSL_OUT [^;]*;/g,"");e.match(/GLSL_OUT(?:$| [^;]*)/)&&(e=e.replace(/GLSL_OUT(?:$| [^;]*)/,""),L=!0);e=e.replace(/ {2,}/g," ");(e=e.trim())?d=e.split(" "):d=[]}b=d;b.length&&(d=l(b,w,C,!1,c),n.push(d.join(" ")))}function l(a,b,c,d,e){var g=[];h(a,b,c,d,g,e);return g}function h(a,b,c,d,e,g){for(var f=0;f<a.length;f++){var m=a[f];if(g&&m in g)m=g[m];else if(m in b)m=b[m];else{e.push(m);
continue}0==m.length&&d?e.push(0):h(m,b,c,d,e,g)}}var k=c.Ye,n=[],w=z(a,c),C={},v=[c[a]],r={},p={},u=[],ha;for(ha in k)for(var G in k[ha].inputs)u.push(k[ha].inputs[G]);var L=!1;d(b);var q=0,H=0,Q=0;return n.join("\n")}function w(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function G(a){Y.deleteProgram(a.Oi);Y.deleteShader(a.iy);Y.deleteShader(a.Uu);delete m[a.PB]}function v(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return D(a);case 2:return"vec2("+D(a[0])+
","+D(a[1])+")";case 3:return"vec3("+D(a[0])+","+D(a[1])+","+D(a[2])+")";case 4:return"vec4("+D(a[0])+","+D(a[1])+","+D(a[2])+","+D(a[3])+")";case 9:return"mat3("+D(a[0])+","+D(a[1])+","+D(a[2])+","+D(a[3])+","+D(a[4])+","+D(a[5])+","+D(a[6])+","+D(a[7])+","+D(a[8])+")";case 16:return"mat4("+D(a[0])+","+D(a[1])+","+D(a[2])+","+D(a[3])+","+D(a[4])+","+D(a[5])+","+D(a[6])+","+D(a[7])+","+D(a[8])+","+D(a[9])+","+D(a[10])+","+D(a[11])+","+D(a[12])+","+D(a[13])+","+D(a[14])+","+D(a[15])+")";default:J.I("Wrong glsl value dimension")}}
function D(a){return a%1?String(a):String(a)+".0"}function F(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var n=t("__assets"),N=t("__config"),I=t("__debug"),x=t("__print"),J=t("__util"),A=N.K,C=N.xh,R=N.Ze,m={},H={},U=null,O={},V="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv node_skybox.glslf postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_truncated.glslf postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/coverage.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.lD=0;a.cK=1;a.bK=2;a.fK=4;a.eK=8;a.dK=16;a.$J=32;var ia=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,na=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,T=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,ja=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
ea=/(?:\W|^)discard(\W|$)/,qa=new Int16Array(2),Z=null,aa=null,X=null,fa=0,Ca=0,ca=[],Y=null,za=!1;a.ug=function(a){Y=a};a.FR=e;a.SN=c;a.pa=b;a.KQ=f;a.kU=function(a){a.yh=J.V(k(a.Of,a.xe));b(a,"PRECISION",N.K.precision);"highp"==N.K.precision?b(a,"EPSILON",v(1E-6)):b(a,"EPSILON",v(1E-4));b(a,"CONSTANTS_HACK",A.OB|0);b(a,"SRGB",A.srgb_type);b(a,"COMPARED_MODE",A.Hq|0)};a.NY=function(a){return a.Of};a.GY=function(a){return a.xe};a.DQ=function(a){var b=JSON.stringify(a.Of)+JSON.stringify(a.xe)+JSON.stringify(a.yh)+
JSON.stringify(a.Ye),d=m[b];if(d)return d;var e=a.xe,f=E(R.shaders_path,a.Of),e=E(R.shaders_path,e);if(!f||!e)return null;var f=B("vert",f,a),e=B("frag",e,a),d=0,l=h(e,ia);a.Hx=l;l>C.MA&&(d|=1);Z||(Z=new Uint32Array(C.dw));aa||(aa=new Uint32Array(C.IA));X||(X=new Uint32Array(C.ew));g(e,aa,C.IA)||(d|=2);g(f,X,C.ew)||(d|=4);l=A.Hb?(f.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(f.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.At=l;l>C.NA&&(d|=8);
y(e)||(d|=16);a.status=d;if(0===a.status){var d=Y,k=w(d,f,d.VERTEX_SHADER),n=w(d,e,d.FRAGMENT_SHADER),l=d.createProgram();d.attachShader(l,k);d.attachShader(l,n);d.linkProgram(l);for(var k={iy:k,Uu:n,Oi:l,attributes:{},jn:{},Sr:J.Ak(),mB:J.Ak(),nB:{},Ko:!0,qw:!1,dJ:J.Ak(),cJ:J.Ak(),Za:c(a),PB:b,ZF:!!e.match(ea),Mg:!0},v=d.getProgramParameter(l,d.ACTIVE_ATTRIBUTES),n=0;n<v;n++){var r=d.getActiveAttrib(l,n).name;k.attributes[r]=d.getAttribLocation(l,r)}v=d.getProgramParameter(l,d.ACTIVE_UNIFORMS);for(n=
0;n<v;n++)r=d.getActiveUniform(l,n).name.split("[0]").join(""),k.jn[r]=d.getUniformLocation(l,r);m[b]=d=k;l=!Y.getShaderParameter(d.Uu,Y.COMPILE_STATUS);k=!Y.getShaderParameter(d.iy,Y.COMPILE_STATUS);n=!Y.getProgramParameter(d.Oi,Y.LINK_STATUS);l?I.LH(d.Uu,b,e):k?I.LH(d.iy,b,f):n&&I.LT(d.Oi,b,f,e);if(l||k||n)a.status|=32,d=null}else d=null;return d};a.oS=function(){za=!1;if(b4w.module_check("shader_texts"))za=!0;else{for(var a=[],b=n.AT_TEXT,c=0;c<V.length;c++){var d=J.Ji(R.shaders_path+V[c]);a.push({id:V[c],
type:b,url:d})}b=function(a,b){U||(U={});U[b]=a};a.length?n.enqueue(a,b,function(){za=!0}):x.error("Shaders have not been found.")}};a.qE=function(){return za};a.jY=function(){return ca};a.JF=function(){return m};a.cleanup=function(){for(var a in m)G(m[a]);for(var b in H)delete H[b];for(var c in ca)delete ca[c];X=aa=Z=null;O={}};a.LN=G;a.kY=function(a){var b=a.yh;x.log("Shader: "+a.Of+" "+a.xe+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)x.log("  "+b[a][0],b[a][1])};a.W=v;a.rE=function(a,
b){return b in a.jn?!0:!1};a.reset=function(){Y=null}};b4w.module.__geometry=function(a,t){function e(){return{length:0,frames:1,lc:0,offset:0,lm:0}}function c(a,b){for(var c=b.a_tbn,d=b.a_position,e=d.length,g=1;g<a.kb.length;g++)for(var f=a.kb[g].ur,m=a.kb[g].ig.a_position,l=0;l<e;l++)d[l]+=f*m[l];d=Z.ev(c);for(g=0;g<d;g++){e=Z.identity(Ca);for(l=1;l<a.kb.length;l++)if(m=a.kb[l].ig.a_tbn,f=a.kb[l].ur)m=Z.wm(m,g,ca),f=Z.slerp(Z.identity(Y),m,f,ca),Z.nw(f,e,e);l=Z.wm(c,g,ca);l=Z.nw(e,l,ca);Z.Pi(c,l,g)}}function b(a){return 65536<a.Va?ja.KF()?!1:!0:!1}
function f(a){return 0<a.xa.length?!0:!1}function k(a,b,c){if(!f(a))return a;c||ea.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Va*(b||1)+", will use drawArrays","color: #aa0");b=a.xa;c=a.Va;var d=a.wa,e=a.fa,g;for(g in d){var m=d[g],l=v(m,c);d[g]=q(b,m,l)}for(d=0;d<e.length;d++){var h=e[d];for(g in h)m=h[g],l=v(m,c),h[g]=q(b,m,l)}for(d=0;d<a.kb.length;d++){g=a.kb[d].ig;for(var k in g)m=g[k],l=v(m,c),g[k]=q(b,m,l)}a.Va=b.length;a.xa=new Uint16Array(0);return a}function q(a,
b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),e=0;e<a.length;e++)for(var g=a[e],f=0;f<c;f++)d[c*e+f]=b[c*g+f];return d}function h(){return{fe:null,gc:A(),xm:0,count:0,Eb:{},usage:0,Sn:0,Vn:0,qd:[],Xg:null,kb:null,Bm:1,Mg:!0}}function u(a,b,c,d){if("a_normal"==b)return d=Z.tm(d),u(a,"a_tbn",c,d);var g=a.Eb,f=g[b],m=O(b);if(f)c&&f.lc!=c&&X.I('invalid num_comp for "'+b+'"'),V(a.gc,b,d,f.offset);else{f=R(a.gc,m);-1==f&&(a.gc.push(C(m,0)),f=a.gc.length-1);var m=
a.gc[f].Dl,l=new m.constructor(m.length+d.length);l.set(m);a.gc[f].Dl=l;V(a.gc,b,d,m.length);b=g[b]=e();b.lc=c;b.offset=m.length;b.length=d.length}r(a);return a}function y(a,b){if("a_normal"==b){for(var c=y(a,"a_tbn"),d=Z.ev(c),e=new Float32Array(3*d),g=0;g<d;g++){var f=Z.bR(c,g,za);e.set(f,3*g)}return e}if(c=a.Eb[b])return d=O(b),ia(b,H(a.gc,d).subarray(c.offset,c.offset+c.length),new Float32Array(c.length));X.I("extract_array_float() failed; invalid name: "+b)}function g(b,c){var d;switch(c){case a.An:case a.Sp:d=
W.STATIC_DRAW;break;case a.at:d=W.DYNAMIC_DRAW;break;default:X.I("Wrong draw_mode")}b.usage=d}function d(a,b,c){function d(a,b){e[a]||(e[a]=0);e[a]+=b}var e={},g;for(g in a[0]){var f=a[0][g],m=O(g);d(m,f.length*a.length)}for(g in b)f=b[g],m=O(g),d(m,f.length);if(c){a=c.Fs.length;m=O("a_part_ts");d(m,4*a);m=O("a_part_r");d(m,4*a);b=c.To;for(g in b)m=O(g),d(m,b[g].lc*a);c=c.Bx;for(g in c)m=O(g),d(m,a)}return e}function r(a){a.fe?(a.Xg||(a.Xg=W.createBuffer()),W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,a.Xg),
W.bufferData(W.ELEMENT_ARRAY_BUFFER,a.fe,a.usage),a.Sn=a.fe.byteLength):a.Sn=0;for(var b=a.Vn=0;b<a.gc.length;b++){var c=a.gc[b].type,d=R(a.qd,c);-1==d&&(a.qd.push({jk:null,type:c,mP:X.gJ()}),d=a.qd.length-1);c=a.qd[d];c.jk||(c.jk=W.createBuffer());W.bindBuffer(W.ARRAY_BUFFER,c.jk);W.bufferData(W.ARRAY_BUFFER,a.gc[b].Dl,a.usage);a.Vn+=a.gc[b].Dl.byteLength}}function p(a,b){a.ra=T.On(a.ra,b);a.Ab=T.Zy(a.Ab,b);a.pc=T.Kt(a.pc,b);a.cd=T.$y(a.cd,b)}function M(a){for(var b=a[0],c=a[0],d=J("JOIN_"+a.length+
"_SUBMESHES"),e=0,g=0;g<a.length;g++)e+=a[g].xa.length;d.xa=new Uint32Array(e);var f=e=0;if(0<a[0].kb.length)for(var m=0;m<a[0].kb.length;m++){for(g=0;g<a.length;g++)e+=a[g].kb[m].ig.a_position.length,f+=Z.ev(a[g].kb[m].ig.a_tbn);g={a_position:new Float32Array(e),a_tbn:Z.create(f)};d.kb.push({ur:a[0].kb[m].ur,ig:g})}for(g=e=0;g<a.length;g++)e+=a[g].Va;d.Va=e;for(var l in c.wa){for(g=e=0;g<a.length;g++)e+=a[g].wa[l].length;d.wa[l]=new Float32Array(e)}for(l in c.fa[0]){for(g=e=0;g<a.length;g++)e+=a[g].fa[0][l].length;
for(g=0;g<c.fa.length;g++)d.fa[g]=d.fa[g]||{},d.fa[g][l]=new Float32Array(e)}g=d.$c;g.ra=T.Vt(b.$c.ra);f=e=0;m=[];for(c=0;c<a.length;c++){var h=a[c],k=h.xa,n=h.Va,w=h.wa;l=h.$c.pc;T.Iu(g.ra,h.$c.ra);T.JP(g.pc,l);T.Nz(h.$c.cd,m);for(l=0;l<k.length;l++)d.xa[e+l]=k[l]+f;var e=e+k.length,C;for(C in w){var k=w[C],r=f*v(k,n);d.wa[C].set(k,r)}for(l=0;l<h.fa.length;l++){var w=h.fa[l],p=d.fa[l];for(C in w)k=w[C],r=f*v(k,n),p[C].set(k,r)}f+=n}g.Ab=T.cu(X.f32(m),!0);if(0<d.kb.length)for(c=0;c<d.kb.length;c++)for(C=
d.kb[c].ig,l=e=g=0;l<a.length;l++)f=a[l].kb[c].ig,C.a_position.set(f.a_position,g),C.a_tbn.set(f.a_tbn,e),g+=f.a_position.length,e+=f.a_tbn.length;a[0].We&&(d.We={Fs:b.We.Fs,ZB:b.We.ZB,GI:!0,Bx:b.We.Bx,To:b.We.To,Bu:b.We.Bu});return d}function E(a,b,c){b=b.$c;for(var d=T.Re(),e=T.hu(),g=[],f=0;f<c.length;f++)T.On(a.$c.ra,c[f],d),T.Iu(b.ra,d),T.$y(a.$c.cd,c[f],e),T.Nz(e,g);b.Ab=T.cu(X.f32(g),!0);b.cd=T.eO(b.Ab);b.pc=T.eu(b.Ab)}function z(a,b,c,d,e,g){var f=a.submeshes[b],m=f.base_length,h=J("SUBMESH_"+
a.name+"_"+a.materials[b].name);h.Va=m;var n=!1;if(w(c,"a_texcoord")){var C=null,v=a.materials[b];b=a.submeshes[b];if(v.yg.length)switch(v=v.yg[0],v.texture_coords){case "UV":C=B(b,v.uv_layer,a.name);break;case "ORCO":for(var r=a.b4w_boundings.bb_src,C=new Float32Array(2*b.base_length),v=(r.max_x+r.min_x)/2,p=(r.max_y+r.min_y)/2,x=r.max_x-r.min_x,r=r.max_y-r.min_y,L=0,F=0;F<b.position.length;F+=3)C[L++]=(b.position[F]-v)/x+.5,C[L++]=(b.position[F+1]-p)/r+.5}null===C&&(C=new Float32Array(2*b.base_length));
b=C}else b=new Float32Array(0);if(w(c,"a_orco_tex_coord")){for(var C=a.b4w_boundings.bb_src,v=new Float32Array(3*f.base_length),p=f.position,x=C.max_x-C.min_x,r=C.max_y-C.min_y,L=C.max_z-C.min_z,u=F=0;u<p.length;u+=3)x?v[F++]=X.clamp(parseFloat(((p[u]-C.min_x)/x).toFixed(5)),0,1):v[F++]=.5,r?v[F++]=X.clamp(parseFloat(((p[u+1]-C.min_y)/r).toFixed(5)),0,1):v[F++]=.5,L?v[F++]=X.clamp(parseFloat(((p[u+2]-C.min_z)/L).toFixed(5)),0,1):v[F++]=.5;C=v}else C=new Float32Array(0);v=f.group;if(w(c,"a_influence")&&
d){p=new Float32Array(4*m);x=v.length/m;r=new Float32Array(x);for(L=0;L<x;L++){r[L]=-1;for(var Q in d)if(F=d[Q],F.KJ===L){r[L]=F.Cz;break}}u=3<x?x:4;d=new Float32Array(u);Q=new Uint32Array(u);for(var L=new Float32Array(4),F=new Float32Array(u),u=new Uint32Array(u),q=new Float32Array(4),aa=0;aa<m;aa++)d.set(F),Q.set(u),L.set(q),p.set(G(v,x,aa,m,r,d,Q,L),4*aa)}else p=new Float32Array(0);d=p;e=e?X.V(e):{};e.a_color={vm:!0};e.a_color.src=w(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,Zg:7}]:
[];h.wa.a_texcoord=b;h.wa.a_influence=d;h.wa.a_orco_tex_coord=C;d=h.wa;Q=f.vertex_colors;b=f.color;C=a.name;v=[];for(p=0;p<Q.length;p++)v.push(Q[p].name);for(var A in e)if(p=e[A].src,p.length){for(r=x=0;r<p.length;r++)x+=X.$m(p[r].Zg);d[A]=new Float32Array(x*m);for(r=L=0;r<p.length;r++){var H=p[r].name,F=p[r].Zg,u=X.OH(F),q=v.indexOf(H);if(-1==q)ea.warn('vertex color "'+H+'" for mesh "'+C+'" not found'),aa=7;else{for(var aa=Q[q].mask,z,ga=z=0;ga<q;ga++)z+=X.$m(Q[ga].mask);z*=m}ga=X.$m(aa);(F&aa)!==
F&&ea.error("Wrong color extraction from "+H+" to "+A+' for the mesh "'+C+'".');for(H=0;H<m;H++)for(var M=0;3>M;M++)if(u[M]){var D=X.Zo(aa,M);d[A][H*x+(L+X.Zo(F,M))]=-1==q?0:b[z+H*ga+D]}L+=ga}}else d[A]=new Float32Array(0);A=a.name;z=h.wa;if(g)for(var E in g)z[g[E]]=B(f,E,A);h.xa=new Uint32Array(f.indices);E=f.position.length/m/3;A=w(c,"a_tbn")&&f.tbn.length?!0:!1;z=w(c,"a_shade_tangs")&&f.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(n=!0);for(e=0;e<E;e++){g=l(f,m,A,z,e);if(n)if(d={},d.name=
a.b4w_shape_keys[e].name,h.kb.push(d),e){d.ig=g;d.ur=a.b4w_shape_keys[e].value;continue}else d.ig=l(f,m,A,z,e),d.ur=1;h.fa.push(g)}if(1<E&&!n){a=h.fa[0];g={};for(var I in a)g[I]=new Float32Array(a[I]);h.fa.push(g)}w(c,"a_polyindex")&&(k(h,1,!0),h.wa.a_polyindex=N(h));f=f.boundings;c=h.$c;c.ra=T.Re();c.ra.max_x=f.bb.max_x;c.ra.max_y=f.bb.max_y;c.ra.max_z=f.bb.max_z;c.ra.min_x=f.bb.min_x;c.ra.min_y=f.bb.min_y;c.ra.min_z=f.bb.min_z;I=f.rbb;a=f.caxis_x;m=f.caxis_y;n=f.caxis_z;g=f.be_ax;c.Ab=T.Ty(a,m,
n,f.be_cen);fa.scale(c.Ab.Qa,g[0],c.Ab.Qa);fa.scale(c.Ab.Ra,g[1],c.Ab.Ra);fa.scale(c.Ab.Sa,g[2],c.Ab.Sa);c.pc=T.eu(c.Ab);fa.copy(I.rbb_c,c.cd.S);fa.copy(a,c.cd.Qa);fa.copy(m,c.cd.Ra);fa.copy(n,c.cd.Sa);f=I.rbb_s;fa.scale(c.cd.Qa,f[0],c.cd.Qa);fa.scale(c.cd.Ra,f[1],c.cd.Ra);fa.scale(c.cd.Sa,f[2],c.cd.Sa);return h}function l(a,b,c,d,e){var g={},f=new Float32Array(3*b),m=Z.create(c?b:0),l=e*b*3;f.set(a.position.subarray(l,l+3*b),0);c&&Z.copy(a.tbn,e*b,b,m);d&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,
3*b),0),g.a_shade_tangs=c);g.a_position=f;g.a_tbn=m;return g}function B(a,b,c){var d=2*a.base_length,e=a.uv_layers.indexOf(b);if(-1==e)return ea.warn('uv layer "'+b+'" for mesh "'+c+'" not found'),new Float32Array(d);b=e*d;return a.texcoord.subarray(b,b+d)}function w(a,b){return-1<a.indexOf(b)?!0:!1}function G(b,c,d,e,g,f,m,l){for(var h=!0,k=0;k<c;k++){var n=b[k*e+d];if(-1!==n){var w=g[k];-1!==w&&(f[k]=n,m[k]=w,h=!1)}}if(h)return l;D(f,m,a.Ey,!1);for(k=b=0;4>k;k++)b+=f[k];if(.01>b)return l;for(k=
0;4>k;k++)f[k]/=b;if(.01>Math.abs(f[0]-1))l[0]=m[0]+1;else for(k=0;4>k;k++)l[k]=m[k]+f[k];return l}function v(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&X.I("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function D(b,c,d,e){for(var g=b.length,f=g,m=!1,l=e?-1:1;1<f||m;){1<f&&(f=Math.floor(f/1.247330950103979));for(var m=!1,h=0;f+h<g;h++)if(d==a.Ey?0>l*(b[h]-b[h+f]):b[h]<b[h+f]&&e)m=b[h],b[h]=b[h+f],b[h+f]=m,m=c[h],c[h]=c[h+f],c[h+f]=
m,m=!0}}function F(a,b,c){var d=[],e=[];fa.subtract(b,a,d);fa.subtract(c,a,e);fa.normalize(d,d);fa.normalize(e,e);a=X.clamp(fa.dot(d,e),-1,1);return Math.acos(a)}function n(a,b){var c=[];if(f(b))for(var d=b.xa,e=d.length/3,g=0;g<e;g++){var m=new Float32Array(9),l=d[3*g];m[0]=a[3*l];m[1]=a[3*l+1];m[2]=a[3*l+2];l=d[3*g+1];m[3]=a[3*l];m[4]=a[3*l+1];m[5]=a[3*l+2];l=d[3*g+2];m[6]=a[3*l];m[7]=a[3*l+1];m[8]=a[3*l+2];c[g]=m}else for(g=0;g<a.length;g++)m=new Float32Array(9),m[0]=a[9*g],m[1]=a[9*g+1],m[2]=
a[9*g+2],m[3]=a[9*g+3],m[4]=a[9*g+4],m[5]=a[9*g+5],m[6]=a[9*g+6],m[7]=a[9*g+7],m[8]=a[9*g+8],c[g]=m;return c}function N(a){for(var b=new Float32Array(a.Va),c=0;c<a.Va;c++)b[c]=c%3/2;return b}function I(a,b,c){var d=fa.dist(a,b);a=fa.dist(a,c);b=fa.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function x(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function J(a){return{name:a,Va:0,xa:null,fa:[],wa:{a_influence:new Float32Array(0),a_color:new Float32Array(0),
a_texcoord:new Float32Array(0)},kb:[],$c:{ra:T.Re(),Ab:T.Nq(),pc:T.du(),cd:T.hu()},We:null}}function A(a){var b=[],c;for(c in a)b.push(C(c,a[c]));return b}function C(a,b){return{Dl:new (U(a))(b),type:a}}function R(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function m(a,b){var c=R(a,b);return-1==c?null:a[c].jk}function H(a,b){var c=R(a,b);return-1==c?null:a[c].Dl}function U(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;case "unsigned_byte":return Uint8Array;
default:return Float32Array}}function O(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";default:return"float"}}function V(a,b,c,d){var e=O(b);na(b,c,a[R(a,e)].Dl.subarray(d))}
function ia(a,b,c){switch(O(a)){case "float":c.set(b);break;case "short":for(a=0;a<b.length;a++)c[a]=X.wI(b[a]);break;case "unsigned_byte":for(a=0;a<b.length;a++)c[a]=X.eJ(b[a])}return c}function na(a,b,c){switch(O(a)){case "float":c.set(b);break;case "short":for(a=0;a<b.length;a++)c[a]=X.fo(b[a]);break;case "unsigned_byte":for(a=0;a<b.length;a++)c[a]=X.fJ(b[a])}return c}var T=t("__boundings"),ja=t("__extensions"),ea=t("__print"),qa=t("__quat"),Z=t("__tbn"),aa=t("__tsr"),X=t("__util"),fa=t("__vec3"),
Ca=Z.create(),ca=Z.create(),Y=Z.create(),za=new Float32Array(3),P=new Float32Array(3),ya=new Float32Array(3),ba=qa.create(),oa=new Float32Array(8);a.Sp=10;a.at=20;a.Ey=0;a.eX=1;a.An=a.Sp;var W=null;a.Dn="float";a.hX="short";a.iX="unsigned_byte";a.ug=function(a){W=a};a.OI=function(a,f,m){b(a)&&k(a);var l=a.xa,n=a.Va,w=a.fa,C={},p;for(p in a.wa)p in m&&!m[p].vm||(C[p]=a.wa[p]);m=h();0<a.kb.length&&c(a,w[0]);p=a.We;if(l.length){var x=l.length;if(65536>=n)var l=new Uint16Array(l),F=W.UNSIGNED_SHORT;else l=
new Uint32Array(l),F=W.UNSIGNED_INT}else x=n,l=null;for(var u=d(w,C,p),u=A(u),G={},q=0;q<u.length;q++)G[u[q].type]=0;var ha={},J;for(J in C){var L=C[J],H=L.length;if(H){var z=O(J),q=ha[J]=e();q.length=H;q.lc=v(L,n);q.offset=G[z];V(u,J,L,G[z]);G[z]+=H}}C=w.length;for(J in w[0])if(L=w[0][J],z=O(J),H=L.length,L=v(L,n),H)for(q=ha[J]=e(),q.length=H,q.frames=C,q.lc=L,q.offset=G[z],1<C&&(q=ha[J+"_next"]=e(),q.length=H,q.frames=C,q.lc=L,q.offset=G[z]+H),q=0;q<C;q++)L=w[q][J],z=O(J),V(u,J,L,G[z]),G[z]+=H;
if(p){w=p.Fs;J=p.ZB;var C=p.To,H=p.Bx,z=p.GI,n={a_part_ts:{data:[],lc:4},a_part_r:{data:[],lc:4}},Q;for(Q in C)n[Q]={data:[],lc:C[Q].lc};for(Q in H)n[Q]={data:[],lc:1};for(L=0;L<w.length;L++){q=w[L];z&&J&&!p.Bu&&(q=aa.multiply(J,w[L],oa));!z&&p.Bu&&fa.subtract(w[L],J,w[L]);n.a_part_ts.data.push(q[0],q[1],q[2],q[3]);n.a_part_r.data.push(q[4],q[5],q[6],q[7]);for(Q in C)for(var q=C[Q].lc,M=0;M<q;M++)n[Q].data.push(C[Q].data[L*q+M]);for(Q in H)n[Q].data.push(H[Q][0])}for(Q in n)w=O(Q),V(u,Q,n[Q].data,
G[w]),J=e(),J.lc=n[Q].lc,J.offset=G[w],J.lm=1,J.length=n[Q].data.length,ha[Q]=J,G[w]+=J.length;m.Bm=p.Fs.length}m.count=x;m.fe=l;m.gc=u;m.xm=F;m.Eb=ha;g(m,f);r(m);m.kb=a.kb;return m};a.mV=c;a.OR=b;a.NR=f;a.Ax=k;a.iJ=function(a,b,c){g(a,b);a.count=c.length;a.fe=c;a.xm=c instanceof Uint16Array?W.UNSIGNED_SHORT:W.UNSIGNED_INT};a.hJ=u;a.Mz=y;a.nZ=function(a){a.usage=W.STATIC_DRAW};a.xS=function(a){a.usage=W.DYNAMIC_DRAW};a.yC=r;a.Js=function(a,b,c,d){W.bindBuffer(W.ARRAY_BUFFER,a.qd[R(a.qd,b)].jk);W.bufferSubData(W.ARRAY_BUFFER,
X.Yi*d,c)};a.JN=function(a){a.Xg&&W.deleteBuffer(a.Xg);for(var b=0;b<a.qd.length;b++)a.qd[b].jk&&W.deleteBuffer(a.qd[b].jk);a.qd.length=0};a.$F=function(a,b){return a.submeshes[b].base_length?!1:!0};a.bC=function(a,b){for(var c=0;c<a.fa.length;c++){var d=a.fa[c].a_position;aa.transform_vectors(d,b,d,0);d=a.fa[c].a_tbn;Z.aH(d,b,d);(d=a.fa[c].a_shade_tangs)&&0<d.length&&aa.transform_dir_vectors(d,b,d,0)}(c=a.wa.au_center_pos)&&c.length&&aa.transform_vectors(c,b,c,0);p(a.$c,b)};a.lV=function(a,b){var c=
a.wa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);aa.transform_vectors(d,b,d,0);for(var e=0;e<a.fa.length;e++)for(var g=0;g<d.length;g++)a.fa[e].a_position[g]+=d[g]-c[g];c.set(d)}else X.I('Attribute "au_center_pos" is missing in particle submesh');p(a.$c,b)};a.bN=p;a.kV=function(a,b){var c=a.Va,d;for(d in b){var e=b[d].length;a.wa[d]=new Float32Array(e*c);for(var g=0;g<c;g++)for(var f=0;f<e;f++)a.wa[d][g*e+f]=b[d][f]}};a.NI=M;a.yS=function(a,b,c){if(!a.Va)return J("EMPTY");var d=c.length;
65536<a.Va*d&&!ja.KF()&&k(a,d);var e=a.xa,g=a.Va,f=a.wa,m=a.fa,l;for(l in b){var h=b[l].length,n=h*g;f[l]=new Float32Array(n);for(var w=0;w<g;w++)for(n=0;n<h;n++)f[l][w*h+n]=b[l][n]}b=J("CLONE_"+d+"_SUBMESHES");b.Va=g*d;b.xa=new Uint32Array(e.length*d);for(w=0;w<d;w++)for(h=e.length*w,l=g*w,n=0;n<e.length;n++)b.xa[h+n]=e[n]+l;for(var C in f)for(e=f[C],n=e.length*d,h=v(e,g),b.wa[C]=new Float32Array(n),w=0;w<d;w++)l=g*h*w,b.wa[C].set(e,l);for(C in m[0])for(w=0;w<m.length;w++)for(e=m[w][C],n=e.length*
d,h=v(e,g),b.fa[w]=b.fa[w]||{},b.fa[w][C]=new Float32Array(n),n=0;n<d;n++)switch(f=c[n],l=g*h*n,C){case "a_position":aa.transform_vectors(e,f,b.fa[w][C],l);break;case "a_tbn":aa.vV(e,f,b.fa[w][C],l);break;case "a_shade_tangs":aa.transform_tangents(e,f,b.fa[w][C],l);break;default:X.I("Wrong attribute name: "+C)}E(a,b,c);return b};a.eE=E;a.Ku=z;a.OP=function(a){var b=a.Va,c=a.fa[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.xa.length);for(var e=new Float32Array(4*b),g=0;g<b;g++){d[12*
g]=c[3*g];d[12*g+1]=c[3*g+1];d[12*g+2]=c[3*g+2];d[12*g+3]=c[3*g];d[12*g+4]=c[3*g+1];d[12*g+5]=c[3*g+2];d[12*g+6]=c[3*g];d[12*g+7]=c[3*g+1];d[12*g+8]=c[3*g+2];d[12*g+9]=c[3*g];d[12*g+10]=c[3*g+1];d[12*g+11]=c[3*g+2];a[6*g]=4*g+2;a[6*g+1]=4*g+1;a[6*g+2]=4*g;a[6*g+3]=4*g+2;a[6*g+4]=4*g;a[6*g+5]=4*g+3;var f=Math.random();e[4*g]=f;e[4*g+1]=f;e[4*g+2]=f;e[4*g+3]=f}c=J("HALO");c.fa[0]={};c.Va=4*b;c.fa[0].a_position=d;c.wa.a_halo_bb_vertex=x(b);c.wa.a_random_vals=e;c.xa=a;return c};a.nR=w;a.nF=function(a,
b,c){for(var d=[],e=0;e<a.submeshes.length;e++){var g=z(a,e,b,null,c,null);g.Va&&d.push(g)}return d.length?1==d.length?d[0]:M(d):J("EMPTY")};a.HV=function(a,b,c,d){var e=a.fe,g=y(a,"a_position"),f=b.GS,m=b.HS;b=b.uP;for(var l=e,h=l.length/3,k=0;k<h;k++){var n=l[3*k],w=l[3*k+1],C=l[3*k+2],v=g[3*n+1],r=g[3*n+2],p=g[3*w+1],x=g[3*w+2],Q=g[3*C+1],F=g[3*C+2];f[3*k]=(g[3*n]+g[3*w]+g[3*C])/3;f[3*k+1]=(v+p+Q)/3;f[3*k+2]=(r+x+F)/3}aa.transform_vectors(f,c,m);c=m.length/3;for(g=0;g<c;g++)f=m[3*g]-d[0],l=m[3*
g+1]-d[1],h=m[3*g+2]-d[2],b[g]=f*f+l*l+h*h;d=e;e=b.length;if(!(2>e))for(m=e,g=!1;1<m||g;)for(1<m&&(m=Math.floor(m/1.247330950103979)),g=!1,c=0;m+c<e;c++)0>b[c]-b[c+m]&&(g=b[c],b[c]=b[c+m],b[c+m]=g,g=d,f=c,l=c+m,h=g[3*f],k=g[3*f+1],n=g[3*f+2],g[3*f]=g[3*l],g[3*f+1]=g[3*l+1],g[3*f+2]=g[3*l+2],g[3*l]=h,g[3*l+1]=k,g[3*l+2]=n,g=!0);e=d;W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,a.Xg);W.bufferData(W.ELEMENT_ARRAY_BUFFER,e,W.DYNAMIC_DRAW)};a.VU=D;a.cE=function(a,b,c){for(var d=b.length/3,e=a.length/3,g=[],f=Array(3),
m=Array(3),l=Array(3),h=0;h<e;h++){for(var k=a[3*h],n=a[3*h+1],w=a[3*h+2],C=0;3>C;C++)f[C]=b[3*k+C],m[C]=b[3*n+C],l[C]=b[3*w+C];if(c)var C=F(f,m,l),v=F(m,l,f),r=Math.PI-C-v;else r=v=C=1;var p=g,x;x=f;var Q=l,u=[],q=[],G=[];fa.subtract(m,x,u);fa.subtract(Q,x,q);fa.cross(u,q,G);fa.normalize(G,G);x=G;for(Q=0;3>Q;Q++)u=3*n+Q,q=3*w+Q,p[3*k+Q]=C*x[Q],p[u]=v*x[Q],p[q]=r*x[Q]}if(c)for(var J in c)for(h=c[J],a=0;3>a;a++){b=3*h[0]+a;for(e=1;e<h.length;e++)f=3*h[e]+a,g[b]+=g[f];for(e=1;e<h.length;e++)f=3*h[e]+
a,g[f]=g[b]}for(h=0;h<d;h++){c=h;J=g;a=new Float32Array(3);for(b=0;3>b;b++)e=3*c+b,a[b]=J[e];fa.normalize(a,a);for(b=0;3>b;b++)e=3*c+b,J[e]=a[b]}return g};a.dE=function(a,b,c){for(var d={},e=b.length/3,g=0;g<e;g++){var f=String(b[3*g])+String(b[3*g+1])+String(b[3*g+2]);d[f]=[]}b=a.length;for(g=0;g<b;g++)e=a[g],f=String(c[3*e])+String(c[3*e+1])+String(c[3*e+2]),f in d&&d[f].push(e);return d};a.Rz=function(a,b,c,d){var e;e=n(a.fa[0].a_position,a);if(c){var g;g=a.fa[0].a_tbn;for(var f=Z.ev(g),m=new Float32Array(3*
f),l=0;l<f;l++){var h=Z.tb(g,l,ba),h=fa.transformQuat(X.AXIS_Y,h,za);m[3*l]=h[0];m[3*l+1]=h[1];m[3*l+2]=h[2]}g=n(m,a)}m=e.length;l=new Float32Array(m);f=za;for(a=0;a<m;a++){var k=e[a];f.set(k.subarray(0,3));P.set(k.subarray(3,6));ya.set(k.subarray(6));l[a]=Math.sqrt(I(f,P,ya))}f=new Float32Array(m);f[0]=l[0];for(a=1;a<m;a++)f[a]=f[a-1]+l[a];m=f[l.length-1];l=[];for(a=0;a<b;a++){var h=m*X.fh(d),h=X.Gt(f,h,0,f.length-1),k=c?g[h]:e[h],w=d;(h=za)||(h=new Float32Array(3));var C=k[0],v=k[1],r=k[2],p=k[3],
x=k[4],F=k[5],Q=k[6],u=k[7],k=k[8],q=X.fh(w),w=X.fh(w);1<q+w&&(q=1-q,w=1-w);var G=1-q-w;h[0]=G*C+q*p+w*Q;h[1]=G*v+q*x+w*u;h[2]=G*r+q*F+w*k;c?(l[a]=new Float32Array(4),fa.normalize(h,h),h=qa.rotationTo(X.AXIS_Y,h,ba),l[a][0]=h[0],l[a][1]=h[1],l[a][2]=h[2],l[a][3]=h[3]):(l[a]=new Float32Array(3),l[a][0]=h[0],l[a][1]=h[1],l[a][2]=h[2])}return l};a.Ju=N;a.UZ=I;a.vF=x;a.TH=function(a,b,c){a=a.fa[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=
(a[d+2]-c[2])*b[2]+c[2]};a.Py=function(a,b,c){var d=a.O[0].Y;a=a.v.wg;for(var e=1;e<a.length;e++)a[e].name==b&&(a[e].value=c);for(e=0;e<d.length;e++)if(!d[e].Rg&&d[e].cf&&!d[e].tj){b=d[e].la;c=O("a_position");var g=H(b.gc,c);W.bindBuffer(W.ARRAY_BUFFER,m(b.qd,c));var f=b.Eb.a_position;c=d[e];var l=a;if(f){for(var h=f.offset,f=f.length+h,k=c.la.kb[0].ig.a_position,n=h;n<f;n++)g[n]=k[n-h];for(n=1;n<c.la.kb.length;n++){var k=c.la.kb[n].ig.a_position,w=l[n].value;if(w)for(var C=h;C<f;C++)g[C]+=w*k[C-
h]}W.bufferSubData(W.ARRAY_BUFFER,X.Yi*h,g.subarray(h))}g=O("a_tbn");c=H(b.gc,g);W.bindBuffer(W.ARRAY_BUFFER,m(b.qd,g));h=b.Eb.a_tbn;b=d[e];g=a;if(h){l=h.offset;h=h.length+l;f=b.la.kb[0].ig.a_tbn;for(n=l;n<h;n+=Z.kD){k=Z.identity(Ca);w=(n-l)/Z.kD;for(C=1;C<b.la.kb.length;C++){var v=g[C].value;if(v){var r=Z.wm(b.la.kb[C].ig.a_tbn,w,ca),v=Z.slerp(Z.identity(Y),r,v,ca);Z.nw(v,k,k)}}w=Z.wm(f,w,ca);k=Z.nw(k,w,ca);c[n]=X.fo(k[0]);c[n+1]=X.fo(k[1]);c[n+2]=X.fo(k[2]);c[n+3]=X.fo(k[3])}W.bufferSubData(W.ARRAY_BUFFER,
X.Yi*l,c.subarray(l))}}};a.check_shape_keys=function(a){return a.v.cf};a.get_shape_keys_names=function(a){var b=[];if(a.v)for(var c=1;c<a.v.wg.length;c++)b.push(a.v.wg[c].name);return b};a.get_shape_key_value=function(a,b){if(a.v)for(var c=1;c<a.v.wg.length;c++)if(b==a.v.wg[c].name)return a.v.wg[c].value;return 0};a.kA=function(a,b){var c=a.v.wg;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.Cj=function(a){return a&&a.v&&a.v.we?!0:!1};a.draw_line=function(b,c,d){var e=b.la;if(e){for(var g=
d?c.length/3/2:c.length/3-1,f=new Float32Array(12*g),m=new Float32Array(12*g),l=new Uint16Array(6*g),h=0;h<g;h++){if(d)var k=6*h,n=6*h+3;else k=3*h,n=3*(h+1);var w=c[k],C=c[k+1],k=c[k+2],v=c[n],p=c[n+1],n=c[n+2],x=v-w,F=p-C,q=n-k;f[12*h]=w;f[12*h+1]=C;f[12*h+2]=k;m[12*h]=x;m[12*h+1]=F;m[12*h+2]=q;f[12*h+3]=v;f[12*h+4]=p;f[12*h+5]=n;m[12*h+3]=-x;m[12*h+4]=-F;m[12*h+5]=-q;f[12*h+6]=w;f[12*h+7]=C;f[12*h+8]=k;m[12*h+6]=-x;m[12*h+7]=-F;m[12*h+8]=-q;f[12*h+9]=v;f[12*h+10]=p;f[12*h+11]=n;m[12*h+9]=x;m[12*
h+10]=F;m[12*h+11]=q;l[6*h]=4*h;l[6*h+1]=4*h+1;l[6*h+2]=4*h+2;l[6*h+3]=4*h;l[6*h+4]=4*h+3;l[6*h+5]=4*h+1}d=0;for(var Q in e.Eb)c=e.Eb[Q],d+=f.length/3*c.lc;c={};c["float"]=d;d=e.gc=A(c);a.iJ(e,b.zh,l);b=0;for(Q in e.Eb)switch(c=e.Eb[Q],Q){case "a_position":V(d,Q,f,b);c.offset=b;c.length=f.length;b+=c.length;break;case "a_direction":V(d,Q,m,b);c.offset=b;c.length=m.length;b+=c.length;break;default:c.offset=b,c.length=f.length/3*c.lc,l=new Float32Array(c.length),V(d,Q,l,b),b+=c.length}r(e)}};a.QN=function(a){if(a){var b=
h();if(a.fe)switch(a.xm){case W.UNSIGNED_SHORT:b.fe=new Uint16Array(a.fe);break;case W.UNSIGNED_INT:b.fe=new Uint32Array(a.fe)}else b.fe=null;for(var c=b,d=a.gc,e=[],g=0;g<d.length;g++){var f=d[g].Dl,m=d[g].type;e.push({Dl:new f.constructor(f),type:m})}c.gc=e;b.xm=a.xm;b.count=a.count;b.Eb=X.V(a.Eb);b.usage=a.usage;b.Sn=a.Sn;b.Vn=a.Vn;b.Xg=null;b.Bv=X.V(a.Bv);b.kb=X.V(a.kb);b.Bm=a.Bm;b.Mg=a.Mg}else b=null;return b};a.Yg=J;a.TN=function(a){var b=J(a.name);b.Va=a.Va;b.xa=X.V(a.xa);b.fa=X.V(a.fa);b.wa=
X.V(a.wa);b.kb=X.V(a.kb);T.ni(a.$c.ra,b.$c.ra);T.Pn(a.$c.Ab,b.$c.Ab);T.zk(a.$c.pc,b.$c.pc);T.ZN(a.$c.cd,b.$c.cd);b.We=X.V(a.We);return b};a.reset=function(){W=null};a.GR=A;a.$T=R;a.MY=m;a.bA=H;a.FQ=U;a.no=O;a.SF=function(a){switch(O(a)){case "float":return X.Yi;case "short":return X.Xp;case "unsigned_byte":return X.ry;default:return X.Yi}};a.VQ=function(a){switch(O(a)){case "float":return W.FLOAT;case "short":return W.SHORT;case "unsigned_byte":return W.UNSIGNED_BYTE;default:return W.FLOAT}};a.Us=
V;a.ZZ=function(a,b){switch(O(a)){case "short":return X.wI(b);case "unsigned_byte":return X.eJ(b)}return b};a.YZ=function(a,b){switch(O(a)){case "short":return X.fo(b);case "unsigned_byte":return X.fJ(b)}return b};a.LX=ia;a.JX=na};b4w.module.__objects=function(a,t){function e(a){var b=a.O;a=a.v;for(var c=0;c<b.length;c++){var d=b[c].jb;d.J.outline&&a.Nh&&ea.MT(d)}}function c(a){a.v.Nh=0;a=va.indexOf(a);-1!=a&&va.splice(a,1)}function b(a){if(a.co)for(var b=a.O,c=0;c<b.length;c++)ea.lJ(b[c].jb,a)}function f(a,b){for(var c=a.O,d=b.O,e=0;e<c.length;e++){for(var g=!1,f=0;f<d.length;f++)if(c[e].jb==d[f].jb){g=!0;break}g||k(b,c[e].jb)&&O.vt(b,c[e].jb)}}function k(a,b){return!b.vD&&"SPEAKER"==a.type||!b.fM&&"LAMP"==a.type?!1:!0}function q(a){var b=
a.b4w_do_not_batch,c=a.b4w_collision,d=a.b4w_vehicle,e=a.b4w_floating,g=a.b4w_character,f=V.pR(a),m=H.$D(a),l=0<a.data.b4w_shape_keys.length,k=a.b4w_dynamic_geometry,n=h(a);if(!(b=F.ZD(a)||b||c||d||l||e||f||g||m||k))a:{a=a.data;for(b=0;b<a.materials.length;b++)if(c=a.materials[b],c.da.Di||c.Bi||y(c.Md)){b=!0;break a}b=!1}return b||n}function h(a){var b=!1,c=a.constraints.length;if(c){for(var d=null,c=c-1;0<=c;c--){var e=a.constraints[c];if("LOCKED_TRACK"!=e.type||"REFLECTION PLANE"!=e.name){d=e;break}}if(!d||
!d.target)return!1;a=d.target;d=a.type;if(a.parent)return d=a.parent.type,"MESH"==d?b=b||q(a.parent):"EMPTY"==d?b=b||u(a.parent):b=!0,b;"MESH"==d?b=b||q(a):"EMPTY"==d?b=b||u(a):b=!0}return b}function u(a){var b=H.$D(a),c=a.b4w_do_not_batch,d=!!a.b4w_anchor,e=h(a);return F.ZD(a)||b||c||d||e}function y(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,e=c.convert_to,g=c.outputs[0];if(!(!g.is_linked||"WORLD"==d&&"CAMERA"==e||"CAMERA"==
d&&"WORLD"==e||"OBJECT"==d&&"OBJECT"==e))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,g=c.outputs[0],g.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==c.type&&(g=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||g.is_linked||d.is_linked))return!0}return!1}function g(a){if(M(a,W.ALL,!1,-1)){for(var b=1,c;;){c="."+(3>String(b).length?("000"+String(b)).slice(-3):String(b));if(!M(a+c,W.ALL,!1,-1))break;b++}na.error('Object "'+a+'" already exists. Name was replaced by "'+
a+c+'".');return c}return""}function d(a,b,c){b=W[b]||[];for(var d=[],e=0;e<b.length;e++){var g=b[e];if(g.v.ce==c||-1==c)for(var f=g.O,m=0;m<f.length;m++)f[m].jb==a&&d.push(g)}return d}function r(a,b){var c=W[a]||[];if(-1==b)return c;for(var d=[],e=0;e<c.length;e++){var g=c[e];g.v.ce==b&&d.push(g)}return d}function p(a,b,c,d){for(var e=0;e<a.O.length;e++)for(var g=a.O[e].Y,f=0;f<g.length;f++){var m=g[f];m.la&&(m.la.Mg=b);m.Mg=b;m.pb&&(m.pb.Mg=c);""!==m.ie&&(m=U.fv(m.ie))&&(m.yE=d)}}function M(a,b,
c,d,e){for(var g=null,f=0;f<b.length;f++){var m=b[f];if(!((c?m.Ed:m.name)!=a||m.v.ce!=d&&-1!=d||e&&m.Rk||(g=m,O.get_dg_parent(g))))break}return g}function E(a){W.ALL.push(a);W[a.type]||(W[a.type]=[]);W[a.type].push(a);var b=a.v.Nd;if(null!=b)for(var c=0;c<ga.length;c++){var d=ga[c];d.v.Nd==b&&d.fs.push(a)}}function z(a,b,c){if(!b.Dj)return!0;a=a.Uk;if(a.ti!=a.Qe)if(a.Qs){var d=ca.sign(a.ti-a.Qe);a.Qe+=d*X.IQ()/.4;a.Qe=ca.clamp(a.Qe,0,1)}else a.Qe=a.ti;d="STATIC"==b.type?b.Ir:Y.add(b.te.S,b.aw,xa);
c=Y.dist(d,c);0==a.so?(d=Math.max(b.ng-a.ro/2,0),b=b.mg+a.qo/2):-1==a.so?(d=b.ng+a.ro/2,b=b.mg+a.qo/2):(d=Math.max(b.ng-a.ro/2,0),b=Math.max(b.mg-a.qo/2,0));a.so=c<d?-1:c<b?0:1;a.ti=c<d||c>b?0:1;a.Wt=a.ti?1:-1;Math.abs(c-a.Hw)>ba.lod_leap_smooth_threshold&&(0==a.Qe||1==a.Qe)&&(a.Qe=a.ti);a.Hw=c;return!!a.ti||0!=a.Qe}function l(a,b){p(a,!0,!1,!0);for(var c=r("ALL",-1),d=0;d<c.length;d++){var e=c[d];e!=a&&p(e,!1,!1,!1)}ea.JH(a,b);for(d=0;d<a.O.length;d++)for(e=a.O[d].Y.length-1;0<=e;e--){var g=a.O[d].Y[e];
0!=g.Xb.length&&-1==g.Xb.indexOf(b)||O.UH(a.O[d],e)}ia.va(a)&&ia.remove_object(a);for(d=0;d<c.length;d++)c[d]!=a&&p(c[d],!0,!0,!0);F.pP(a,b);c=a.pk.Fa;a.pk.Fa=a;return c}function B(a,b){a.pk.Fa=b;p(a,!0,!0,!0)}function w(a,b,c,d){var e=c.Xe.$k.indexOf(d);b=a.kc[a.Xe.$k.indexOf(b)];c.kc[e]=b;a=b.name;b.name=d;for(d=0;d<c.kc.length;d++)c.Xe.Cm[d]=d!=e;return a}function G(a,b,c,d){for(var e=0;e<c.kc.length;e++)c.Xe.Cm[e]=!1;a.kc[a.Xe.$k.indexOf(b)].name=d}function v(a,b,c,d,e){for(var g=1;g<a.v.wg.length;g++)C.Py(a,
a.v.wg[g].name,a.v.wg[g].value);if(F.is_animated(a))for(g=0;g<a.na.length;g++){var f=a.na[g];if(f)switch(f.type){case F.OBJ_ANIM_TYPE_PARTICLES:F.set_frame(a,F.Vz(a,g),g);break;case F.OBJ_ANIM_TYPE_MATERIAL:if(f.No)for(var m=f.No.length-1;0<=m;m--)-1!=f.No[m].Xb.indexOf(b)&&f.No.splice(m,1)}}d&&n.yA(a,b,function(b){if(b.Ha){var c=b.Ha.name;if(d[c]){var e=b.Ha.Qn!=d[c].Qn;b.Ha=V.BE(d[c]);e&&V.set_factor(a,c,b.Ha.Qn)}}},"PARTICLES");e&&(g=n.ab(a,b,"MAIN"))&&(g.ic.set(e.ic),g.ee=e.ee,g.ui=e.ui,g.zd.set(e.zd),
g.me.set(e.me),g.ak=e.ak,g.He.set(e.He),g.If=e.If,g.Ad=e.Ad,g.xd=e.xd,g.Hg=e.Hg,g.Om=e.Om,g.Oo=e.Oo,g.reflect_factor=e.reflect_factor,g.gh=e.gh,g.Dh.set(e.Dh),g.parallax_scale=e.parallax_scale,g.kh.set(e.kh),g.shallow_water_col.set(e.shallow_water_col),g.shallow_water_col_fac=e.shallow_water_col_fac,g.shore_water_col.set(e.shore_water_col),g.shore_water_col_fac=e.shore_water_col_fac,g.foam_factor=e.foam_factor,g.Gl=e.Gl,g.Kh=e.Kh.slice(),g.je=e.je.slice());n.yA(a,b,function(b){for(var d=0;d<b.pf.length;d++){var e=
b.pf[d],g=b.ka[d];if("IMAGE"==g.source||"ENVIRONMENT"==g.source){var f=aa.iv(c,e);f&&g.Mk!=f.Mk&&aa.FU(a,e,f)}}})}function D(a,b){for(var c=a[b],d=b+1;d<a.length;d++)c+="%join%"+a[d];return c}var F=t("__animation"),n=t("__batch"),N=t("__boundings"),I=t("__camera"),x=t("__config"),J=t("__constraints"),A=t("__container"),C=t("__geometry"),R=t("__lights"),m=t("__material"),H=t("__nla"),U=t("__nodemat"),O=t("__obj_util"),V=t("__particles"),ia=t("__physics"),na=t("__print"),T=t("__primitives"),ja=t("__quat"),
ea=t("__scenes"),qa=t("__subscene"),Z=t("__sfx"),aa=t("__textures"),X=t("__time"),fa=t("__transform"),Ca=t("__tsr"),ca=t("__util"),Y=t("__vec3"),za=t("__armature"),P=t("__anchors"),ya=t("__renderer"),ba=x.K,oa=x.Yc,W={ALL:[]},sa=0,pa=0,ga=[],va=[],xa=new Float32Array(3),K=new Float32Array(4);a.zy=0;a.yy=1;a.Ic=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=0;b<va.length;b++){var d=va[b],g=d,f=a,m=0,h=g.qH;0==h.Lx&&(h.Lx=f);f-=h.Lx;if(h.wB&&f/h.sg>=h.wB)c(g);else{f%=h.sg;if(f<h.hB)switch(h=f/(h.hB/
5),f=Math.floor(h),f){case 0:m=(h-f)/2;break;case 1:m=(h-f)/2+.5;break;case 2:m=1;break;case 3:m=1-(h-f)/2;break;case 4:m=.5-(h-f)/2}g.v.Nh=m}d.v.Nh&&e(d)}if(a=W.ARMATURE)for(b=0;b<a.length;b++)d=a[b],d.ZA&&(fa.T(d),d.ZA=!1)};a.set_outline_intensity=function(a,b){a.v.Nh=b;e(a)};a.apply_outline_anim=function(a,b,c,d){var e=a.qH;e.Lx=0;e.hB=b;e.sg=c;e.wB=d;-1==va.indexOf(a)&&va.push(a)};a.clear_outline_anim=c;a.OE=function(a,b){var c=O.Oq(b?"%meta_world%"+a.name:a.name,b?"WORLD":a.type,b?"%meta_world%"+
a.name:a.origin_name);if("MESH"==c.type)for(var d=0;d<a.data.materials.length;d++)c.kc.push(a.data.materials[d]);for(d=0;d<a.Hd.length;d++)O.vt(c,a.Hd[d]);a.Fa=c;if(b)c.Nc=a.uuid,c.Rk=!1,c.jm=a.Gn,c.is_dynamic=a.cj,c.v=O.Rn(c.type),c.Os=a.b4w_use_default_animation,c.Rl=F.Ny(a.b4w_anim_behavior);else{c.Nc=a.uuid;c.Rk=!1;c.jm=a.Gn;c.is_dynamic=a.cj;c.xr=a.uD||!1;c.Bf=a.b4w_vehicle;c.is_character=a.b4w_character;c.Em=a.b4w_floating;c.Dp=a.b4w_collision;c.Jb=a.b4w_collision_id;c.bu=a.b4w_correct_bounding_offset;
d=a.game;c.nd={Tr:d.physics_type,Ui:d.use_ghost,CJ:d.use_sleep,$g:d.mass,HJ:d.velocity_min,GJ:d.velocity_max,YE:d.damping,PH:d.rotation_damping,pS:d.lock_location_x,qS:d.lock_location_y,rS:d.lock_location_z,sS:d.lock_rotation_x,tS:d.lock_rotation_y,uS:d.lock_rotation_z,li:d.collision_margin,ki:d.collision_group,mi:d.collision_mask,AC:d.use_collision_bounds,Yt:d.collision_bounds_type,Ns:d.use_collision_compound};if(d=a.b4w_vehicle_settings)c.Nf={name:d.name,Gf:d.part,oV:d.suspension_rest_length,cC:d.suspension_compression,
eC:d.suspension_stiffness,dC:d.suspension_damping,HC:d.wheel_friction,CB:d.roll_influence,LA:d.max_suspension_travel_cm,fr:d.force_max,tq:d.brake_max,qp:d.steering_max,Eo:d.max_speed_angle,Tq:d.delta_tach_angle,ws:d.speed_ratio,ys:d.steering_ratio,wr:d.inverse_control,om:d.floating_factor,un:d.water_lin_damp,vn:d.water_rot_damp,RI:d.synchronize_position};if(d=a.b4w_floating_settings)c.ho={name:d.name,Gf:d.part,om:d.floating_factor,un:d.water_lin_damp,vn:d.water_rot_damp,RI:d.synchronize_position};
if(d=a.b4w_character_settings)c.lE={DW:d.walk_speed,WT:d.run_speed,hV:d.step_height,VR:d.jump_strength,GW:d.waterline};for(d=0;d<a.constraints.length;d++){var e=a.constraints[d];"RIGID_BODY_JOINT"==e.type&&c.oB.push({target:e.target.Fa,fT:e.pivot_type,gT:e.pivot_x,hT:e.pivot_y,iT:e.pivot_z,Qa:e.axis_x,Ra:e.axis_y,Sa:e.axis_z,pW:e.use_limit_x,qW:e.use_limit_y,rW:e.use_limit_z,lW:e.use_angular_limit_x,mW:e.use_angular_limit_y,nW:e.use_angular_limit_z,gS:e.limit_max_x,hS:e.limit_max_y,iS:e.limit_max_z,
jS:e.limit_min_x,kS:e.limit_min_y,lS:e.limit_min_z,aS:e.limit_angle_max_x,bS:e.limit_angle_max_y,cS:e.limit_angle_max_z,dS:e.limit_angle_min_x,eS:e.limit_angle_min_y,fS:e.limit_angle_min_z})}d=c.v=O.Rn("MESH"===c.type?c.is_dynamic?"DYNAMIC":"STATIC":c.type);a.parent?(c.parent=a.parent.Fa,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(c.Qr=a.parent_bone),a.pinverse_tsr&&(c.Ew=Ca.create(),Ca.copy(a.pinverse_tsr,c.Ew))):a.dg_parent&&(c.parent=a.dg_parent.Fa,c.fl=!0);var e=a.location,g=a.scale[0];
ca.sB(a.rotation_quaternion,K);fa.set_translation(c,e);fa.set_rotation(c,K);fa.set_scale(c,g);c.Os=a.b4w_use_default_animation;c.Rl=F.Ny(a.b4w_anim_behavior);a.b4w_object_tags&&(c.gw={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});c.mu=a.b4w_custom_prop;a.b4w_viewport_alignment&&(c.hy={jM:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});d.hide=a.b4w_hidden_on_load;d.bG=a.b4w_hide_chldr_on_load;switch(a.type){case "ARMATURE":za.Ap(a,
c);e=d.Kg;g=F.mN(e);a.b4w_animation_mixing?(d.Pd=new Float32Array(g.Mb),d.Fe=new Float32Array(g.Mb),d.Wd=new Float32Array(g.trans),d.Ke=new Float32Array(g.trans)):(d.Pd=g.Mb,d.Fe=g.Mb,d.Wd=g.trans,d.Ke=g.trans);for(var f in e){var m=e[f];1==m.St.length&&za.GV(m,!0,g.trans,g.Mb)}d.Xr=g;d.Af=0;d.fj=a.b4w_animation_mixing;break;case "MESH":d.ij=n.TM(a.data.b4w_boundings.bb);c.nG=a.data.is_boundings_overridden;d.ve=a.b4w_do_not_render;d.ll=oa.outlining_overview_mode||a.b4w_selectable;d.ww=a.b4w_selectable;
d.Yc=oa.outlining_overview_mode||a.b4w_outlining;d.vw=a.b4w_outlining;d.xw=oa.outlining_overview_mode||a.b4w_outline_on_select;d.Jg=a.b4w_billboard;d.nq=a.b4w_pres_glob_orientation;d.pq="BASIC";d.oq="SPHERICAL"==a.b4w_billboard_geometry;f=d.Ki;f.al=a.b4w_outline_settings.outline_duration;f.bl=a.b4w_outline_settings.outline_period;f.cl=a.b4w_outline_settings.outline_relapses;d.ll&&(d.xk=ca.wF(sa),sa++);for(f=0;f<a.data.b4w_vertex_anim.length;f++)e=a.data.b4w_vertex_anim[f],c.ad.push({name:e.name,za:e.frame_start,
gb:e.frame_end,PX:e.averaging,QX:e.averaging_interval,kM:e.allow_nla});c.v.ad=c.ad.length?!0:!1;"MESH"!=a.type&&ca.I("Wrong object type: "+a.name);f=c.v;if(a.data.b4w_shape_keys.length)for(f.cf=!0,e=0;e<a.data.b4w_shape_keys.length;e++)g={},g.value=a.data.b4w_shape_keys[e].value,g.name=a.data.b4w_shape_keys[e].name,f.wg.push(g);else f.cf=!1;d.$e=a.b4w_shadow_cast;d.Td=a.b4w_shadow_receive;d.Ge=a.b4w_shadow_cast_only&&d.$e;d.ke=a.b4w_reflexible;d.Rd=a.b4w_reflexible_only&&d.ke;d.Qd=a.b4w_reflective;
d.Rh=a.b4w_reflection_type;if(!d.Qd)for(f=c.kc,e=0;e<f.length;e++)g=f[e],!g.Bg||-1==g.Md.qt.indexOf("BSDF_GLOSSY")&&-1==g.Md.qt.indexOf("BSDF_DIFFUSE")||(c.v.Qd=!0,c.v.Rh="CUBE");d.cg=a.b4w_caustics;if(d.Me=a.b4w_wind_bending)d.yn=a.b4w_wind_bending_angle,f=n.TJ(ca.deg_to_rad(a.b4w_wind_bending_angle),d.ij,a.scale[0]),d.Rf=f,d.Sf=a.b4w_wind_bending_freq,d.xf=a.b4w_detail_bending_freq,d.wf=a.b4w_detail_bending_amp,d.qf=a.b4w_branch_bending_amp,d.Kj=a.b4w_main_bend_stiffness_col,f=a.b4w_detail_bend_colors,
d.Se.CA=f.leaves_stiffness_col,d.Se.BA=f.leaves_phase_col,d.Se.iB=f.overall_stiffness_col;d.we=a.b4w_dynamic_geometry;if(d.we)for(c.pk=a,f=0;f<c.kc.length;f++)c.Xe.$k.push(c.kc[f].name),c.Xe.Cm.push(!1);f=c.kc[0];d.Sg=f.nd.Sg;d.Ng=f.nd.Ng;d.ng=0;d.mg=O.By;d.Li=a.pass_index;break;case "LINE":d.ra=N.Re();d.Ab=N.Nq();d.uh=N.Re();d.tk=N.Nq();break;case "CAMERA":I.pN(a,c);I.KM(c);break;case "LAMP":R.WR(a,c);break;case "SPEAKER":c.ea=Z.BO();d=!1;for(f=0;f<c.O.length;f++)if(c.O[f].jb.Qc){d=!0;break}d&&Z.Ap(a,
c);break;case "EMPTY":f=N.Re(),d.ra=f,f=N.du(),d.pc=f,a.field&&(c.co={type:a.field.type,KI:a.field.strength}),a.b4w_anchor&&(c.anchor={type:a.b4w_anchor.type,Yn:a.b4w_anchor.detect_visibility,Ek:a.b4w_anchor.element_id,ES:a.b4w_anchor.max_width})}}E(c);return c};a.VV=function(a,b){var c=b.v;if("MESH"==b.type){var d=F.HF(a);if(d){var e=d.Fa,g=e.v.Xr,m=b.v,h=a.data;b.yt=e;h=h.vertex_groups;if(h.length){var e=e.v.Kg,l=0,k={},n;for(n in e){var w=ca.keysearch("name",n,h);w&&(k[n]={KJ:w.index,gi:e[n].gi,
Cz:l++})}m.hi=k;n=l;h=F.MF();m.Ih=n;n>2*h?(m.Sk=!1,na.error('too many bones for "'+a.name+'" / '+m.Ih+" bones (max "+h+" with blending, "+2*h+" without blending). Skinning will be disabled.")):m.Sk=!0}g=F.PP(g.trans,g.Mb,c.hi);d.b4w_animation_mixing?(c.Pd=new Float32Array(g.Mb),c.Fe=new Float32Array(g.Mb),c.Wd=new Float32Array(g.trans),c.Ke=new Float32Array(g.trans)):(c.Pd=g.Mb,c.Fe=g.Mb,c.Wd=g.trans,c.Ke=g.trans);c.gq=new Float32Array(4);c.fq=ja.create();c.Xr=g;c.Af=0}if(c.Qd)if(c=b.v,"CUBE"==c.Rh)c.be=
pa++;else if("PLANE"==c.Rh){a:{d=a.constraints;for(g=0;g<d.length;g++)if(m=d[g],"LOCKED_TRACK"==m.type&&"REFLECTION PLANE"==m.name){if(m.target&&m.target.Fa){d=m.target.Fa;break a}na.warn('Reflection plane target for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}d=null}d||(d=ca.Is("%reflection%"),d=O.Oq(d,"EMPTY"),g=O.Rn("EMPTY"),d.v=g,f(b,d),J.ED(d,b,[0,0,0],null,1),E(d));g=null;for(m=0;m<ga.length;m++)if(ga[m]==d){g=m;break}null==g&&(g=ga.length,ga.push(d));d.v.Nd=
g;c.Nd=g;d.fs.push(b)}}};a.MV=b;a.eY=f;a.yN=k;a.WV=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.v||"DYNAMIC"!=c.v.type&&"CAMERA"!=c.v.type||fa.T(c);c.Os&&F.nH(c)&&(F.apply_def(c),c.na.length&&F.play(c,null,F.SLOT_ALL))}};a.aE=function(a){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.cj||a.parent&&a.parent.cj)return!0;switch(a.type){case "MESH":return q(a);case "EMPTY":return u(a);default:return!0}};a.get_meta_tags=function(a){return ca.V(a.gw)};a.get_custom_prop=function(a){return a.mu};
a.cleanup=function(){pa=sa=0;ga.length=0;va.length=0;W={ALL:[]}};a.copy=function(a,b,c){var d=O.get_dg_parent(a),d=d?O.xF(d.name,b):b,e=g(d);b=O.Oq(d+e,a.type,b+e);b.Rk=a.Rk;b.pk=a.pk;b.Xe.$k=O.Lq(a.Xe.$k);b.Xe.Cm=O.Lq(a.Xe.Cm);b.is_dynamic=a.is_dynamic;b.xr=a.xr;b.Os=a.Os;b.jm=a.jm;b.v=O.kz(a.v);b.v.Dj=!1;b.gw=O.Mq(a.gw);b.mu=O.Mq(a.mu);f(a,b);b.Ll=O.Lq(a.Ll);b.parent=O.Lq(a.parent);b.fl=a.fl;b.Qr=a.Qr;b.ad=O.Lq(a.ad);b.Rl=a.Rl;!a.L||a.Bf||a.is_character||a.Em||(b.Dp=a.Dp,b.L=null);b.Jb=a.Jb;b.bu=
a.bu;b.nd=O.Mq(a.nd);d=[];for(e=0;e<a.O.length;e++){var h=b.O[e],l=a.O[e].Y;if(c){for(var k=h.Y,w=0;w<l.length;w++)if(!l[w].Rg){var v=O.Mq(l[w]);v.la=C.QN(l[w].la);O.Zf(b,h.jb,v);d.push(l[w].la)}for(w=0;w<l.length;w++)if(l[w].Rg){v=O.Mq(l[w]);O.Zf(b,h.jb,v);for(var r=0;r<d.length;r++)d[r]==l[w].la&&(v.la=k[r].la)}for(w=0;w<k.length;w++)k[w].la&&C.yC(k[w].la),ba.Ly&&k[w].la&&ya.NM(k[w]),k[w].Zk=n.sQ(k[w],b.v,b.Nc),n.BV(k[w]);aa.OU(k)}else for(w=0;w<l.length;w++)O.Zf(b,h.jb,l[w])}for(d=0;d<a.kc.length;d++)b.kc.push(m.RN(a.kc[d]));
O.IB(b,!1);E(b);b.v.vA=!0;b.v.Fv=c;b.v.xk=ca.wF(sa);sa++;return b};a.IF=function(a,b){var c=[],d=a.animation_data,e=a.data?a.data.animation_data:null;d&&d.action&&(d=d.action,(d.J.type==F.OBJ_ANIM_TYPE_OBJECT||d.J.type==F.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==a.type||d.J.type==F.dL&&"LAMP"==a.type||d.J.type==F.cL&&b)&&c.push(F.gG(null,d)));e&&e.action&&("SPEAKER"==a.type||"LAMP"==a.type)&&c.push(F.gG(null,e.action));"MESH"==a.type&&c.push.apply(c,F.zQ(a));b&&c.push.apply(c,F.AQ(a));return c};a.update_boundings=
function(a){for(var b=a.v,c=null,d=a.O[0].Y,e=0;e<d.length;e++){var g=d[e],f=a.O[0].bg[e];if(g.la&&f.nf&&f.Pe){var m=C.no("a_position");if(m=C.bA(g.la.gc,m)){var h=g.la.Eb.a_position.offset,l=g.la.Eb.a_position.length+h;n.PV(g,m.subarray(h,l));O.tJ(g,b.C,f);"MAIN"==g.type&&(c?N.Iu(c,g.sb.Pe):c=N.Vt(g.sb.Pe))}}}c=c||N.Re();if(b.Jg)O.oJ(a,c);else{f=[];for(e=0;e<d.length;e++)if(g=d[e],"MAIN"==g.type&&(m=C.no("a_position"),m=C.bA(g.la.gc,m)))g=d[e].la.Eb,h=g.a_position.offset,l=g.a_position.length+h,
f.push(m.subarray(h,l));O.aW(a,c,f)}if(ba.debug_view)for(e=0;e<d.length;e++)if("DEBUG_VIEW"===d[e].type&&d[e].tj){a=b.Ab;b=T.Qz(1,a.S);C.TH(b,[a.Qa[0],a.Ra[1],a.Sa[2]],a.S);C.Ax(b,1,!0);b.wa.a_polyindex=C.Ju(b);n.AV(d[e],b);break}};a.Ob=d;a.QF=function(a,b,c){b=W[b]||[];for(var d=[],e=0;e<b.length;e++){var g=b[e];if(!(g.v.ce!=c&&-1!=c||g.Rk))for(var f=g.O,m=0;m<f.length;m++)f[m].jb==a&&d.push(g)}return d};a.get_all_objects=r;a.get_first_character=function(a){var b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=
b[c];if(ia.YF(d))for(var e=d.O,g=0;g<e.length;g++)if(e[g].jb==a)return d}return null};a.Ro=p;a.get_selectable_objects=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.v.ll&&!d.Rk&&a.push(d)}return a};a.get_outlining_objects=function(){var a=[],b=W.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.v.Yc&&!d.Rk&&a.push(d)}return a};a.uc=function(b,c,d,e){var g=null,f=W.ALL;switch(b){case a.zy:g=M(c,f,!0,d,e);break;case a.yy:a:{for(b=0;b<f.length;b++)if(g=f[b],g.Ed==d&&(g.v.ce==
e||-1==e)){var m=O.get_dg_parent(g);if(m&&m.Ed==c)break a}g=null}break;case a.Ic:a:{for(e=0;e<f.length;e++){b=f[e];for(var g=c.length-1,m=b,h=!0;0<=g&&h;)h=m&&m.Ed==c[g]&&(m.v.ce==d||-1==d),m&&(m=O.get_dg_parent(m)),g--;if(h&&!m){g=b;break a}}g=null}}return g};a.get_world_by_name=function(a,b){return M("%meta_world%"+a,W.WORLD,!0,b)};a.jv=function(a){return a.Ed.replace("%meta_world%","")};a.pick_object=function(b,c){var e=ea.Fh();if(!e)return na.error("No active scene"),null;var g=ea.Pb(e,qa.Eg);
g&&g.enable_hmd_stereo&&(g=A.get_canvas(),b=g.clientHeight/2,c=g.clientWidth/2);if(g=P.dT(b,c))return g;g=ea.eT(e,b,c);if(!g)return null;for(var e=d(e,"MESH",-1),f=0;f<e.length;f++){var m=e[f].v,h=m.xk;if(h&&3>Math.abs(255*h[0]-g[0])&&3>Math.abs(255*h[1]-g[1])&&3>Math.abs(255*h[2]-g[2]))return m.Yc&&m.xw&&(oa.outlining_overview_mode?a.apply_outline_anim(e[f],oa.al,oa.bl,oa.cl):(g=m.Ki,a.apply_outline_anim(e[f],g.al,g.bl,g.cl))),e[f]}return null};a.set_wind_params=function(a,c){for(var e=d(a,"EMPTY",
-1),g=0;g<e.length;g++){var f=e[g];if(f.co&&"WIND"===f.co.type){var m=f;break}}if(!m)return na.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(e=ca.deg_to_rad(c.wind_dir),Y.set(Math.sin(e),-Math.cos(e),0,xa),ca.dir_to_quat(xa,ca.AXIS_Z,K),fa.set_rotation(m,K));"number"==typeof c.wind_strength&&(m.co.KI=c.wind_strength);b(m)};a.remove_object=function(a){J.zN(a)&&J.remove(a);var b=W.ALL,c=W[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.TS=
E;a.qZ=function(a){return W[a.type]&&-1<W[a.type].indexOf(a)};a.QV=function(a,b){if(a.v.Dj){var c=a.v,d=b.J;if(c.Dj)for(var e=fa.get_translation(b.bj,xa),g=0;g<a.O.length;g++)if(a.O[g].jb==b)for(var f=0;f<a.O[g].Y.length;f++){var m=a.O[g].Y[f],h=m.Uk;if(ba.lod_smooth_transitions){var l=d.vS;if("ALL"==l||"NON-OPAQUE"==l&&(m.rb||m.dj))h.Qs=!0}z(m,c,e);h.Qe=h.ti;h.ro=Math.min(d.MG,.6*c.Ij);h.qo=Math.min(d.MG,.6*c.Jj)}}};a.RV=z;a.qU=function(a){var b=a.v,c=b.Rf,d=b.Sf,e=b.xf,g=b.wf,f=b.qf;a=a.O;for(b=
0;b<a.length;b++)for(var m=a[b].Y,h=0;h<m.length;h++){var l=m[h].la,k=l.Eb,n=k.au_wind_bending_amp,w=k.au_wind_bending_freq,v=k.au_detail_bending_amp,r=k.au_detail_bending_freq,k=k.au_branch_bending_amp;if(w){var p=Array.apply(null,Array(w.length)).map(function(){return d});C.Js(l,C.Dn,new Float32Array(p),w.offset)}n&&(p=Array.apply(null,Array(n.length)).map(function(){return c}),C.Js(l,C.Dn,new Float32Array(p),n.offset));v&&(p=Array.apply(null,Array(v.length)).map(function(){return g}),C.Js(l,C.Dn,
new Float32Array(p),v.offset));r&&(p=Array.apply(null,Array(r.length)).map(function(){return e}),C.Js(l,C.Dn,new Float32Array(p),r.offset));k&&(p=Array.apply(null,Array(k.length)).map(function(){return f}),C.Js(l,C.Dn,new Float32Array(p),k.offset))}};a.inherit_material=function(a,b,c,e){if(a.v.we&&c.v.we){var g=n.ab(a,b,"MAIN"),f=null;n.yA(c,e,function(a){f||(f={});a.Ha&&(f[a.Ha.name]=a.Ha)},"PARTICLES");for(var m=l(c,e),h=w(a,b,c,e),k=ea.get_active(),C=0;C<c.O.length;C++){var r=c.O[C].jb;ea.set_active(r);
var p=d(r,"LAMP",0),Q=c.O[C].Y;c.O[C].Y=[];c.O[C].bg=[];n.BF(r,[c.pk],p,[]);n.fu(c,ea.cv(r),r);ea.ID(r,[c]);ea.append_object(r,c,!1,!0);for(p=0;p<Q.length;p++)O.Zf(c,r,Q[p])}G(a,b,c,h);B(c,m);v(c,e,a,f,g);ea.set_active(k)}};a.create_line=function(a){a=a||"";a+=g(a);a=O.Oq(a,"LINE");a.v=O.Rn("EMPTY");a.is_dynamic=!0;n.AF(ea.Fh(),[a]);ea.append_object(ea.Fh(),a);E(a);return a};a.rQ=function(a,b){var c=b.v,d=N.Vt(c.ij);c.Jg?O.oJ(b,d):O.$V(b,d,a.data.b4w_boundings)};a.set_nodemat_value=function(a,b,c,
d){for(var e=O.is_world(a),g=0;g<a.O.length;g++)for(var f=a.O[g].Y,m=0;m<f.length;m++){var h=f[m];if(e||-1!=h.Xb.indexOf(b))h.Kh[c]=d}e&&ea.Tx(a)};a.set_nodemat_rgb=function(a,b,c,d,e,g){for(var f=O.is_world(a),m=0;m<a.O.length;m++)for(var h=a.O[m].Y,l=0;l<h.length;l++){var k=h[l];if(f||-1!=k.Xb.indexOf(b))k.je[3*c]=d,k.je[3*c+1]=e,k.je[3*c+2]=g}f&&ea.Tx(a)};a.get_nodemat_value=function(a,b){return a.Kh[b]};a.get_nodemat_rgb=function(a,b,c){c[0]=a.je[3*b];c[1]=a.je[3*b+1];c[2]=a.je[3*b+2];return c};
a.or=function(a,b,c){b=D(b,c);for(c=0;c<a.length;c+=3)if(a[c]==b)return 4*a[c+1]+a[c+2];return null};a.nr=function(a,b,c){b=D(b,c);for(c=0;c<a.length;c+=2)if(a[c]==b)return a[c+1];return null}};b4w.module.__obj_util=function(a,t){function e(a){a={type:a,ce:0,C:M.fm(),py:M.fm(),pivot:new Float32Array(3),vc:new Float32Array(3),Nk:0,Ok:0,vA:!1,Fv:!1,xk:null,Nh:0,Ri:!1,oe:z.create(),use_panning:!1,nb:0,Jp:1,Ip:1,Kp:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,Jd:!1,dof_object:null,Ib:null,Pa:null,Cb:null,Wc:null,Vc:null,Fd:null,Og:!0,Ki:{al:1,bl:1,cl:0},be:-1,Nd:-1,wc:new Float32Array(4),Sg:0,Ng:0,Dj:!1,Ir:new Float32Array(3),
aw:new Float32Array(3),ng:0,mg:Infinity,Ij:0,Jj:0,ve:!1,$e:!1,Td:!1,Ge:!1,ke:!1,Rd:!1,Qd:!1,Rh:"",Me:!1,we:!1,Lc:!1,hide:!1,bG:!1,ll:!1,ww:!1,Yc:!1,vw:!1,xw:!1,Qk:!1,is_visible:!1,gr:!1,yn:0,Rf:0,Sf:0,xf:0,wf:0,qf:0,Kj:"",Se:{CA:"",BA:"",iB:""},Wl:!1,Rt:new Float32Array(3),Jg:!1,nq:!1,pq:"",oq:!1,Af:0,$x:0,ay:0,Ih:0,sm:!1,ad:!1,cf:!1,wg:[],Sk:!1,fj:!1,lf:1,In:0,Hn:1,ej:null,Jh:!1,fi:new Int8Array([-1,-1]),fp:[],fw:[],dx:[],Pd:null,Fe:null,Wd:null,Ke:null,wl:null,hl:null,Kg:null,hi:null,Xr:null,gq:null,
fq:null,ij:r.Re(),ra:r.Re(),uh:r.Re(),pc:r.du(),te:r.du(),Ab:r.Nq(),tk:r.Nq(),cd:r.hu(),OD:r.hu(),mq:r.AR(),kq:r.yR(),lq:r.zR(),Li:0};z.copy(E.AXIS_Z,a.oe);return a}function c(a){return{jb:a,Ev:!1,Y:[],bg:[],Mi:[],rj:null,QB:[],Hr:0,mH:!1,ha:[],uI:[]}}function b(a){if(!(a instanceof Object))return a;var c=null,d=null,e=null,g=null,f=null,h=null;a.ka&&(c=a.ka,a.ka=null);a.Lf&&(d=a.Lf,a.Lf=null);a.pf&&(e=a.pf,a.pf=null);a.kb&&(g=a.kb,a.kb=null);a.pb&&(f=a.pb,a.pb=null);a.df&&(h=a.df,a.df=null);var l;
l=a.constructor;switch(l){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:l=new l(a);break;case Array:l=new l(a.length);for(var k=0;k<a.length;k++)l[k]=b(a[k]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:l=a;break;case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:l=null;break;case Function:l=a;break;default:for(k in l=new l,a)l[k]=b(a[k])}c&&
(l.ka=c,a.ka=c);d&&(l.Lf=d,a.Lf=d);e&&(l.pf=e,a.pf=e);g&&(l.kb=g,a.kb=g);f&&(l.pb=f,a.pb=f);h&&(l.df=E.Ak(),a.df=h);return l}function f(a,b){r.ni(b,a.ra);r.On(a.ra,a.C,a.uh)}function k(a,b,c){a.pc=r.bE(b,c);r.Kt(a.pc,a.C,a.te)}function q(a,b,c,d,e,g){a.Ab=r.Ty(b,c,d,g);z.scale(a.Ab.Qa,e[0],a.Ab.Qa);z.scale(a.Ab.Ra,e[1],a.Ab.Ra);z.scale(a.Ab.Sa,e[2],a.Ab.Sa);r.Zy(a.Ab,a.C,a.tk)}function h(a,b,c,d){a.mq=r.RD(b,d);a.kq=r.PD(c,d);a.lq=r.QD(b,d)}function u(a,b,c,d,e,g){a.cd=r.QT(g,b,c,d,e);r.$y(a.cd,a.C,
a.OD)}function y(a,b,c){r.On(a.sb.Pe,b,c.Pe);a.Bl&&r.Zy(a.sb.nf,b,c.nf);r.Kt(a.sb.rf,b,c.rf)}function g(a,b){for(var c=a.O,d=0;d<c.length;d++){var e=c[d];if(e.jb==b)return e}return null}function d(a){return a.fl?a.parent:a.parent?d(a.parent):null}var r=t("__boundings"),p=t("__config"),M=t("__tsr"),E=t("__util"),z=t("__vec3"),l=t("__vec4"),B=p.K;a.By=Infinity;a.Rn=e;a.kz=function(a){var b=e(a.type);b.ce=a.ce;M.copy(a.C,b.C);M.copy(a.py,b.py);z.copy(a.pivot,b.pivot);z.copy(a.vc,b.vc);b.Nk=a.Nk;b.Ok=
a.Ok;b.vA=a.vA;b.Fv=a.Fv;a.xk&&(b.xk=z.clone(a.xk));b.Nh=a.Nh;b.Ri=a.Ri;z.copy(a.oe,b.oe);b.use_panning=a.use_panning;b.nb=a.nb;b.Jp=a.Jp;b.Ip=a.Ip;b.Kp=a.Kp;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.Jd=a.Jd;b.dof_object=a.dof_object;b.Ib=E.V(a.Ib);b.Pa=E.V(a.Pa);b.Cb=E.V(a.Cb);b.Wc=E.V(a.Wc);
b.Vc=E.V(a.Vc);b.Fd=a.Fd;b.Og=a.Og;b.Ki.al=a.Ki.al;b.Ki.bl=a.Ki.bl;b.Ki.cl=a.Ki.cl;b.be=a.be;b.Nd=a.Nd;b.wc=a.wc;b.Sg=a.Sg;b.Ng=a.Ng;b.Dj=a.Dj;z.copy(a.Ir,b.Ir);z.copy(a.aw,b.aw);b.ng=a.ng;b.mg=a.mg;b.Ij=a.Ij;b.Jj=a.Jj;b.ve=a.ve;b.$e=a.$e;b.Td=a.Td;b.Ge=a.Ge;b.ke=a.ke;b.Rd=a.Rd;b.Qd=a.Qd;b.Rh=a.Rh;b.Me=a.Me;b.we=a.we;b.Lc=a.Lc;b.hide=a.hide;b.ll=a.ll;b.ww=a.ww;b.Yc=a.Yc;b.vw=a.vw;b.xw=a.xw;b.Qk=a.Qk;b.is_visible=a.is_visible;b.gr=a.gr;b.yn=a.yn;b.Rf=a.Rf;b.Sf=a.Sf;b.xf=a.xf;b.wf=a.wf;b.qf=a.qf;b.Kj=
a.Kj;b.Se=a.Se;b.Wl=a.Wl;z.copy(a.Rt,b.Rt);b.Jg=a.Jg;b.nq=a.nq;b.pq=a.pq;b.oq=a.oq;b.Af=a.Af;b.$x=a.$x;b.ay=a.ay;b.Ih=a.Ih;b.sm=a.sm;b.ad=a.ad;b.cf=a.cf;b.wg=E.V(a.wg);b.Sk=a.Sk;b.fj=a.fj;b.lf=a.lf;b.In=a.In;b.Hn=a.Hn;b.fi.set(a.fi);b.fp=E.V(a.fp);b.fw=E.V(a.fw);b.dx=E.V(a.dx);b.Pd=E.V(a.Pd);b.Fe=E.V(a.Fe);b.Wd=E.V(a.Wd);b.Ke=E.V(a.Ke);b.Kg=E.V(a.Kg);b.hi=E.V(a.hi);b.Xr=E.V(a.Xr);b.gq=E.V(a.gq);b.fq=E.V(a.fq);r.ni(a.ij,b.ij);r.ni(a.ra,b.ra);r.ni(a.uh,b.uh);r.zk(a.pc,b.pc);r.zk(a.te,b.te);r.Pn(a.Ab,
b.Ab);r.Pn(a.tk,b.tk);r.WN(a.kq,b.kq);r.YN(a.mq,b.mq);r.XN(a.lq,b.lq);b.Li=a.Li;return b};a.Oq=function(a,b,c){c||(c=a);return{name:a,Nc:E.Xu(),Ed:c,type:b,kc:[],Rk:!0,pk:null,Xe:{$k:[],Cm:[]},is_dynamic:!1,xr:!1,Os:!1,nG:!1,v:null,qc:null,ea:null,Db:null,yt:null,anchor:null,co:null,gw:null,mu:null,O:[],ad:[],ue:E.Ak(),pz:E.Ak(),na:[],fs:[],Df:[],Ll:[],Uh:null,bn:[],parent:null,fl:!1,Qr:"",hy:null,Ew:null,Dp:!1,Jb:"",bu:"AUTO",Bf:!1,is_character:!1,Em:!1,Wy:!1,L:null,N:null,Qg:null,Nf:null,ho:null,
lE:null,oB:[],nd:{Tr:"NO_COLLISION",Ui:!1,CJ:!1,$g:0,HJ:0,GJ:0,YE:0,PH:0,pS:!1,qS:!1,rS:!1,sS:!1,tS:!1,uS:!1,li:0,ki:0,mi:0,AC:!1,Yt:"BOX",Ns:!1},qH:{Lx:0,hB:0,sg:0,wB:0},Rl:0,jm:[],ZA:!1,cH:!1,Jr:[]}};a.aZ=c;a.Lq=function(a){return a instanceof Array?a.slice():a};a.Mq=b;a.is_dynamic=function(a){return a.is_dynamic};a.mb=function(a){return"MESH"==a.type&&a.is_dynamic};a.vt=function(a,b){a.O.push(c(b))};a.Zf=function(a,b,c){var d=a.v;a=g(a,b);a.Y.push(c);b=r.hG();y(c,d.C,b);a.bg.push(b)};a.oJ=function(a,
b){var c=a.v,d=Math.max(Math.abs(b.max_x),Math.abs(b.min_x)),e=Math.max(Math.abs(b.max_y),Math.abs(b.min_y)),g=Math.max(Math.abs(b.max_z),Math.abs(b.min_z)),g=Math.sqrt(d*d+e*e+g*g),d=Math.sqrt(d*d+e*e),e=r.Re();e.max_x=e.max_y=e.max_z=g;e.min_x=e.min_y=e.min_z=-g;f(c,e);k(c,g,[0,0,0]);q(c,[1,0,0],[0,1,0],[0,0,1],[g,g,g],[0,0,0]);a.is_dynamic?h(c,d,d,e):u(c,[1,0,0],[0,1,0],[0,0,1],[g,g,g],[0,0,0])};a.$V=function(a,b,c){var d=a.v,e=c.bs_rad,g=c.bc_rad,l=c.bs_cen,r=c.be_cen,v=c.caxis_x,p=c.caxis_y,
w=c.caxis_z,C=c.be_ax,z=c.rbb.rbb_c;c=c.rbb.rbb_s;f(d,b);k(d,e,l);b=a.is_dynamic;q(d,b?v:[1,0,0],b?p:[0,1,0],b?w:[0,0,1],C,r);a.is_dynamic?h(d,g,g,d.ra):u(d,v,p,w,c,z)};a.aW=function(a,b,c){for(var d=a.v,e=b.max_x-b.min_x,g=b.max_y-b.min_y,l=b.max_z-b.min_z,r=(b.max_x+b.min_x)/2,p=(b.max_y+b.min_y)/2,v=(b.max_z+b.min_z)/2,w=r,C=v,z=Math.max(e,Math.max(g,l))/2,m=Math.max(e,l)/2,H=[r/(e?e:1),p/(g?g:1),v/(l?l:1)],M=.5,G=0;G<c.length;G++)for(var E=c[G],y=0;y<E.length;y+=3){var B=E[y],t=E[y+1],ja=E[y+
2],ea=Math.sqrt((r-B)*(r-B)+(p-t)*(p-t)+(v-ja)*(v-ja));if(ea>z)var qa=r-z*(B-r)/ea,Z=p-z*(t-p)/ea,ea=v-z*(ja-v)/ea,r=(qa+B)/2,p=(Z+t)/2,v=(ea+ja)/2,z=Math.sqrt((r-B)*(r-B)+(p-t)*(p-t)+(v-ja)*(v-ja));Z=Math.sqrt((w-B)*(w-B)+(C-ja)*(C-ja));Z>m&&(qa=w-m*(B-w)/Z,ea=C-m*(ja-C)/Z,w=(qa+B)/2,C=(ea+ja)/2,m=Math.sqrt((w-B)*(w-B)+(C-ja)*(C-ja)));B/=e?e:1;t/=g?g:1;ja/=l?l:1;ea=Math.sqrt((H[0]-B)*(H[0]-B)+(H[1]-t)*(H[1]-t)+(H[2]-ja)*(H[2]-ja));ea>M&&(qa=H[0]-M*(B-H[0])/ea,Z=H[1]-M*(t-H[1])/ea,ea=H[2]-M*(ja-H[2])/
ea,H[0]=(qa+B)/2,H[1]=(Z+t)/2,H[2]=(ea+ja)/2,M=Math.sqrt((H[0]-B)*(H[0]-B)+(H[1]-t)*(H[1]-t)+(H[2]-ja)*(H[2]-ja)))}c=e?e*H[0]:b.max_x;w=g?g*H[1]:b.max_y;H=l?l*H[2]:b.max_z;e*=M;g*=M;l*=M;f(d,b);k(d,z,[r,p,v]);q(d,[1,0,0],[0,1,0],[0,0,1],[e,g,l],[c,w,H]);a.is_dynamic?h(d,m,m,d.ra):u(d,[(d.ra.max_x-d.ra.min_x)/2,0,0],[0,(d.ra.max_y-d.ra.min_y)/2,0],[0,0,(d.ra.max_z-d.ra.min_z)/2],[1,1,1],[(d.ra.max_x+d.ra.min_x)/2,(d.ra.max_y+d.ra.min_y)/2,(d.ra.max_z+d.ra.min_z)/2])};a.tJ=y;a.vZ=function(a,b){for(var c=
a.O,d=0;d<c.length;d++)if(c[d].jb==b){c.splice(d,1);break}};a.Da=g;a.nJ=function(a,b){for(var c=0;c<a.length;c++)l.copy(b,a[c].v.wc)};a.IB=function(a,b,c){for(var d=0;d<a.O.length;d++){var e=a.O[d];c&&e.jb!=c||(e.Ev=b)}};a.UH=function(a,b){a.Y.splice(b,1);a.bg.splice(b,1)};a.hv=function(a,b){for(var c=[],d=b?B.VG-1:B.VG,e=0;e<a.length;e++){var g=a[e];g.Db.CF&&c.length<d&&c.push(g)}return c.length?c:a[0]?[a[0]]:[]};a.IS=function(a,b){M.identity(b.C);b.xk=null;a.v=b};a.oE=function(a,b){if(b.b4w_enable_soft_particles&&
0<b.b4w_particles_softness){var c=b.material-1,d=a.kc;if(0<=c&&c<d.length&&("ADD"==d[c].lb||"ALPHA"==d[c].lb||"ALPHA_SORT"==d[c].lb))return!0}return!1};a.EN=function(a){a=a.O;for(var b=0;b<a.length;b++)for(var c=a[b].Y,d=0;d<c.length;d++)for(var e=c[d].Za.yh,g=0;g<e.length;g++){var f=e[g];if("USE_MODEL_TSR_INVERSE"==f[0]&&"1"==f[1])return!0}return!1};a.xF=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.fl?null:a.parent};a.get_dg_parent=d;a.Wz=function(a,b){for(var c=[],e=0;e<b.length;e++){var g=
b[e];d(g)==a&&c.push(g)}return c};a.get_object_data_id=function(a){return a.v.ce};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,t){function e(){r.I("_rand() undefined")}function c(a,b){return{name:a,zw:b,time:0,Iw:-1,Fp:!1,Qn:1,za:0,gb:0,Kx:0,Fr:0,Sv:0,cyclic:0,$g:0,Lo:0,mv:0,wj:0,Ue:0,oy:0,size:0,ut:0,tt:0,$t:0,Zt:new Float32Array(16),ow:!1,positions:null,Yr:null,Gx:null,As:null,Wn:null,Sq:null,eg:null,yw:null,Ix:0,Jx:0}}function b(a,b,c,e,g,f){var h=a.Wn,k=a.eg,n=a.time;a=a.Iw;for(var r=0;r<h.length;r+=4){var p=h[r];if(n>a&&n>=p&&p>a||n<a&&(p>a||n>=p))for(p=0;8>p;p++)k[8*r+p]=e[p],z[p]=
e[p];else for(p=0;8>p;p++)z[p]=k[8*r+p];p=l;p[0]=b[3*r];p[1]=b[3*r+1];p[2]=b[3*r+2];d.transform_vec3(p,z,p);g[3*r]=p[0];g[3*r+1]=p[1];g[3*r+2]=p[2];var C=u.wm(c,r,E);u.aH(C,z,C);u.Pi(f,C,r);for(p=1;4>p;p++)g[3*(r+p)]=g[3*r],g[3*(r+p)+1]=g[3*r+1],g[3*(r+p)+2]=g[3*r+2],u.Pi(f,C,r+p)}}function f(a){a?(r.fV(a),e=function(){return r.wT()}):e=function(){return Math.random()}}var k=t("__config"),q=t("__batch"),h=t("__geometry"),u=t("__tbn"),y=t("__textures"),g=t("__time"),d=t("__tsr"),r=t("__util"),p=t("__vec3"),
M=k.K,E=u.create(),z=new Float32Array(8),l=new Float32Array(3),B=[];a.BE=function(a){var b=c(a.name,a.type);b.time=a.time;b.Iw=a.Iw;b.Fp=a.Fp;b.Qn=a.Qn;b.za=a.za;b.gb=a.gb;b.Kx=a.Kx;b.Fr=a.Fr;b.Sv=a.Sv;b.cyclic=a.cyclic;b.$g=a.$g;b.Lo=a.Lo;b.mv=a.mv;b.wj=a.wj;b.Ue=a.Ue;b.oy=a.oy;b.size=a.size;b.ut=a.ut;b.tt=a.tt;b.$t=a.$t;b.Zt.set(a.Zt);b.ow=a.ow;b.positions=r.V(a.positions);b.Yr=r.V(a.Yr);b.Gx=r.V(a.Gx);b.As=r.V(a.As);b.Wn=r.V(a.Wn);b.Sq=r.V(a.Sq);b.eg=r.V(a.eg);b.yw=r.V(a.yw);b.Ix=a.Ix;b.Jx=a.Jx;
return b};a.update=function(){for(var a=0;a<B.length;a++)for(var c=B[a],d=c.O,e=0;e<d.length;e++)for(var g=c,f=d[e].Y,h=0;h<f.length;h++){var l=f[h],k=l.Ha;k&&k.Fp&&!l.Rg&&(b(k,k.positions,k.Gx,g.v.C,k.Yr,k.As),k.ow=!0)}};a.bB=function(a){a=a.O;for(var b=0;b<a.length;b++)for(var c=a[b].Y,d=0;d<c.length;d++)if(c[d].Ha)return!0;return!1};a.cB=function(a,b){for(var c=a.O,d=0;d<c.length;d++)for(var e=c[d].Y,g=0;g<e.length;g++){var f=e[g].Ha;if(f&&f.name==b)return!0}return!1};a.lH=function(a){a=a.O;for(var b=
0;b<a.length;b++)for(var c=a[b].Y,d=0;d<c.length;d++){var e=c[d].Ha;if(e&&"EMITTER"==e.zw)return!0}return!1};a.dN=function(a){return 0<a.particle_systems.length};a.cN=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.pR=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.vO=function(a,b,d){var e=a.Ha=c(b.name,b.settings.type);
e.za=b.settings.frame_start;e.gb=b.settings.frame_end;e.Kx=(e.gb-e.za)/g.Dd();e.Fr=b.settings.lifetime;e.Sv=e.Fr/g.Dd();e.cyclic=b.settings.b4w_cyclic?1:0;e.$g=b.settings.mass;e.Lo=b.settings.normal_factor;e.mv=9.81*b.settings.effector_weights.gravity;e.wj=b.settings.b4w_fade_in/g.Dd();e.Ue=b.settings.b4w_fade_out/g.Dd();e.oy=b.settings.effector_weights.wind;e.Fp="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,h,l;a.rr?(f=d.po.size,h=d.po.sr,30>h?(h=.5,l=.9):40>h?(h=.1,l=1):50>h?(h=0,l=.8):
(h=0,l=.5)):(f=b.settings.particle_size,l=h=1);e.size=f;e.ut=h;e.tt=l;d.Bg&&"BILLBOARD"==b.settings.render_type&&(q.xb(a,"NODES",1),q.xb(a,"PARTICLE_BATCH",1),a.vb=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&M.st&&(b=b[0].texture,f=[],y.jN(b.color_ramp,y.iD,f),f=new Uint8Array(f.map(function(a){return r.clamp(255*a,0,255)})),f=y.NE(f,y.iD),q.rk(a,f,"u_color_ramp_tex",b.name),q.xb(a,"USE_COLOR_RAMP",1));d=d.yg;a=[-1,
0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(d[0]&&"STRAND"==d[0].texture_coords&&d[0].texture&&"BLEND"==d[0].texture.type&&d[0].texture.use_color_ramp){d=d[0].texture.color_ramp.elements;b=Math.min(4*d.length,a.length);for(f=0;f<b;f+=4)h=d[f/4],a[f]=h.position,a[f+1]=h.color[0],a[f+2]=h.color[1],a[f+3]=h.color[2];e.$t=d.length}e.Zt.set(a)};a.mQ=function(a,c,d,l){var k=a.Ha,n=l.C;l=d.settings.count;var v=d.settings.frame_start/g.Dd(),q=d.settings.frame_end/g.Dd(),x=d.settings.lifetime/g.Dd(),z=d.settings.lifetime_random,
w=d.settings.emit_from,C=d.settings.factor_random;if(d.settings.use_rotations)var M=d.settings.angular_velocity_mode,m=d.settings.angular_velocity_factor;else M="NONE",m=0;var H=d.settings.b4w_randomize_emission,y=d.settings.b4w_cyclic;k.Ix=d.settings.billboard_tilt;k.Jx=d.settings.billboard_tilt_random;f(d.seed);var D;c=h.nF(c,["a_position","a_tbn"],null);switch(w){case "VERT":var B=c.fa[0].a_position;D=c.fa[0].a_tbn;d=B.length/3;c=[];for(w=0;w<l;w++){var G=Math.round((d-1)*e());c.push(G);c.push(G);
c.push(G);c.push(G)}d=[];for(w=0;w<c.length;w++)d.push(B[3*c[w]]),d.push(B[3*c[w]+1]),d.push(B[3*c[w]+2]);B=new Float32Array(d);d=u.create(c.length);for(w=0;w<c.length;w++)G=u.wm(D,c[w],E),u.Pi(d,G,w);D=d;break;case "FACE":B=[];D=[];r.Cv(0,D);d=h.Rz(c,l,!1,D);r.Cv(0,D);c=h.Rz(c,l,!0,D);D=u.create(4*d.length);for(w=0;w<d.length;w++)B.push(d[w][0],d[w][1],d[w][2]),B.push(d[w][0],d[w][1],d[w][2]),B.push(d[w][0],d[w][1],d[w][2]),B.push(d[w][0],d[w][1],d[w][2]),u.Pi(D,c[w],4*w),u.Pi(D,c[w],4*w+1),u.Pi(D,
c[w],4*w+2),u.Pi(D,c[w],4*w+3);B=new Float32Array(B);break;case "VOLUME":r.I("Particle emission from volume is not supported");break;default:r.I("Wrong emit from option")}D=[B,D];B=D[0];D=D[1];k.positions=new Float32Array(B);k.Gx=new Float32Array(D);k.Yr=new Float32Array(B.length);k.As=new Float32Array(D.length);c=[];q=(q-v)/l;for(d=0;d<l;d++)w=H?q*d+10*q*(.5-e()):q*d,y||(w+=v),c.push(w),c.push(w),c.push(w),c.push(w);v=new Float32Array(c);k.Wn=new Float32Array(v);k.Sq=new Float32Array(v);if(k.Fp){k.eg=
new Float32Array(8*v.length);for(H=0;H<8*v.length;H++)for(y=0;8>y;y++)k.eg[8*H+y]=n[y];b(k,B,D,n,B,D)}n=h.Yg("EMITTER_PARTICLES");H=r.pi();H.a_position=B;H.a_tbn=D;n.fa[0]=H;a.zh=h.at;a=[];for(H=0;H<l;H++)a.push(4*H,4*H+2,4*H+1,4*H,4*H+3,4*H+2);a=new Uint16Array(a);n.xa=a;n.wa.a_p_bb_vertex=h.vF(l);n.Va=B.length/3;a=[];z=x*z;for(H=0;H<l;H++)y=z*e(),a.push(x-y),a.push(x-y),a.push(x-y),a.push(x-y);x=n.wa;z=[];for(H=0;H<l;H++)y=Math.random(),z.push(a[4*H],v[4*H],y),z.push(a[4*H+1],v[4*H+1],y),z.push(a[4*
H+2],v[4*H+2],y),z.push(a[4*H+3],v[4*H+3],y);z=new Float32Array(z);x.a_p_data=z;x=n.wa;z=[];for(a=0;a<l;a++){v=[e()-.5,e()-.5,e()-.5];p.normalize(v,v);z.push(C*v[0]);z.push(C*v[1]);z.push(C*v[2]);switch(M){case "NONE":z.push(0);break;case "SPIN":case "VELOCITY":z.push(m);break;case "RAND":z.push(2*m*(e()-.5));break;default:r.I("Undefined velocity factor")}v=z.slice(-4);for(H=0;12>H;H++)z.push(v[H%4])}l=new Float32Array(z);x.a_p_vels=l;k.yw=new Float32Array(n.wa.a_p_data);return n};a.GU=function(a,
b,c){a=a.O;for(var d=0;d<a.length;d++)for(var e=a[d].Y,g=0;g<e.length;g++){var f=e[g].Ha;f&&f.name==b&&!e[g].Rg&&(f.Iw=f.time,f.time=c)}};a.oT=function(a){for(var b=a.Va,c=a.fa[0].a_position,d=[],e=[],g=0;g<b;g++)e.push(c[3*g]),d.push(c[3*g+1]),e.push(c[3*g+2]);d=new Float32Array(d);e=new Float32Array(e);a.wa.a_lf_dist=d;a.wa.a_lf_bb_vertex=e;return a};a.set_size=function(a,b,c){a=a.O;for(var d=0;d<a.length;d++)for(var e=a[d].Y,g=0;g<e.length;g++){var f=e[g].Ha;f&&f.name==b&&(f.size=c)}};a.set_normal_factor=
function(a,b,c){a=a.O;for(var d=0;d<a.length;d++)for(var e=a[d].Y,g=0;g<e.length;g++){var f=e[g].Ha;f&&f.name==b&&(f.Lo=c)}};a.IY=function(a,b){for(var c=a.O,d=0;d<c.length;d++)for(var e=c[d].Y,g=0;g<e.length;g++){var f=e[g].Ha;if(f&&f.name==b)return f.Lo}return 0};a.set_factor=function(a,b,c){a=a.O;for(var d=0;d<a.length;d++)for(var e=a[d].Y,g=0;g<e.length;g++){var f=e[g],l=f.Ha;if(l&&l.name==b){l.Qn=c;var k=l.Wn;if(1==c)var r=k;else if(0==c)for(var r=l.Sq,p=0;p<r.length;p+=4)r[p]=1E4,r[p+1]=r[p],
r[p+2]=r[p],r[p+3]=r[p];else for(var C=4/c,r=l.Sq,v=0,p=0;p<r.length;p+=4)p>=v?(r[p]=k[p],v+=C):r[p]=1E4,r[p+1]=r[p],r[p+2]=r[p],r[p+3]=r[p];f=f.la;if(f.Eb.a_p_data){l=l.yw;for(p=0;p<l.length;p+=3)l[p+1]=r[Math.round(p/3)];h.hJ(f,"a_p_data",3,l)}}}};a.hW=function(a,b,c){a=a.O;for(var d=0;d<a.length;d++)for(var e=a[d].Y,g=0;g<e.length;g++){var f=e[g].Ha;if(f&&f.Fp)for(var l=0;l<8*f.Wn.length;l++)f.eg[8*l]=b[0],f.eg[8*l+1]=b[1],f.eg[8*l+2]=b[2],f.eg[8*l+3]=b[3],f.eg[8*l+4]=c[0],f.eg[8*l+5]=c[1],f.eg[8*
l+6]=c[2],f.eg[8*l+7]=c[3]}};a.ZV=function(a,b,c){a.wa.a_tbn=u.create(4*c);u.identity(a.wa.a_tbn);if(b.Rr){for(var d=[],e=0;e<c;e++)d.push(e,e,e,e);a.wa[b.Rr.name]=new Float32Array(d)}};a.YV=function(a){-1==B.indexOf(a)&&B.push(a)};a.BT=function(a){a=B.indexOf(a);-1!=a&&B.splice(a,1)};a.cleanup=function(){B.length=0}};b4w.module.__primitives=function(a,t){function e(a,b,c,e){for(var d=[],g=[],f=[],l=a*b,k=2*c/(a-1),r=2*e/(b-1),p=0;p<a;p++)for(var v=-c+p*k,y=0;y<b;y++)if(g.push(v,-e+y*r,0),f.push(p/(a-1),y/(b-1)),p&&y){var F=p*b+y,n=F-1,t=(p-1)*b+y,I=t-1;d.push(F,n,t);d.push(n,I,t)}a=u.pi();a.a_position=new Float32Array(g);a.a_tbn=h.create(l);l=q.Yg("GRID_PLANE");l.fa[0]=a;l.wa.a_texcoord=new Float32Array(f);l.xa=new Uint32Array(d);l.Va=g.length/3;return l}function c(a){var b=a.length;b%4&&u.I("Wrong array");for(var c=
[],e=[],g=0;g<b;g+=4){var k=a[g+1],z=a[g+2],l=a[g+3];f(a[g],e);f(k,e);f(z,e);f(l,e);c.push(g,g+1,g+2);c.push(g,g+2,g+3)}a=u.pi();a.a_position=new Float32Array(e);a.a_tbn=h.create(b/4);b=q.Yg("FROM_QUADS");b.fa[0]=a;b.xa=new Uint32Array(c);b.Va=e.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function f(a,b){b.push(a[0],a[1],a[2])}var k=t("__config"),q=t("__geometry"),h=t("__tbn"),u=t("__util"),y=k.K;a.qQ=function(){var a=q.Yg("LINE"),b=u.pi();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.fa[0]=b;a.xa=new Uint32Array(1);a.Va=1;return a};a.tQ=function(){var a=e(2,2,1,1);a.name="PLANE";return a};a.zY=e;a.kQ=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==l-1)||1==b%2&&(0==a||a==f-1)?!0:!1}var e=c/=Math.pow(2,a-1),g=c,f=b+1,l=b+1;b=[];c=[];for(var k=0,r=0,G=0,v=-1,D=[],F=0;F<a;F++){for(var n=2*e/(f-1),t=2*g/(l-1),I=[],x=[],J=0,A=0;A<f;A++){for(var C=-e+A*n,R=[],m=0;m<l;m++){var H=-g+m*t;if(C>-r&&C<r&&H>-G&&H<G)R.push(-1),J++;else{for(var U=
null,O=0;O<D.length;O+=3)if(C==D[O]&&H==D[O+1]){U=D[O+2];break}O=null!==U?U:v+1;d(A,m)?(R.push(-2),J++):(null==U&&(m&&m!=l-1&&A&&A!=f-1?U=n:(U=F==a-1?n:2*n,I.push(C,H,O)),c.push(C,H,U),k++,v++),R.push(O));if(A&&m)if(1==A)if(d(A-1,m)){if(1<m){var H=O-1,U=x[A-1][m+1],V=U-1;b.push(V,H,O)}else U=x[A-1][m+1],V=U-1;b.push(U,V,O)}else d(A,m)||(H=O-1,U=x[A-1][m],b.push(U,H,O));else if(A==f-1){if(!d(A,m))if(m==l-1)H=O-1,U=x[A-1][m-1],V=x[A-2][m],b.push(U,H,O),b.push(V,U,O);else{var H=O-1,U=x[A-1][m],V=U-1,
ia=U+1;b.push(V,H,O);b.push(U,V,O);b.push(ia,U,O);2==m&&(ia=x[A-2][m-2],b.push(V,ia,H))}}else 1==m?d(A,m-1)?(H=x[A-1][m],U=x[A-1][m-1],b.push(H,U,O)):(H=R[m-1],U=x[A-1][m],V=x[A-2][m-1],b.push(U,H,O),b.push(U,V,H)):m==l-1?d(A,m)||(H=R[m-1],U=x[A-1][m-1],V=x[A-2][m],b.push(U,H,O),b.push(V,U,O)):-1!=x[A-1][m]&&-1!=x[A-1][m-1]&&-1!=R[m-1]?(H=R[m-1],U=x[A-1][m],V=x[A-1][m-1],b.push(U,H,O),b.push(U,V,H),m==l-2&&d(A,m+1)&&(ia=x[A-1][m+1],b.push(ia,U,O))):m==l-2&&d(A,m+1)&&(U=x[A-1][m],ia=x[A-1][m+1],b.push(ia,
U,O))}}x.push(R)}D=I;r=e;G=g;e*=2;g*=2}2E4>r&&(a=-(2*r)/(f-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-r,-G,a),c.push(-r,G,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(r,-G,a),c.push(r,G,a),O=v+1,b.push(O+1,O+2,O+3,O+1,O+0,O+2,O+2,O+4,O+6,O+2,O+0,O+4,O+1,O+7,O+5,O+1,O+3,O+7,O+7,O+4,O+5,O+6,O+4,O+7),k+=8);a=u.pi();a.a_position=new Float32Array(c);a.a_tbn=h.create(k);h.WA(a.a_tbn,[.707,0,0,.707],a.a_tbn);e=q.Yg("MULTIGRID_PLANE");e.fa[0]=a;e.xa=new Uint32Array(b);e.Va=c.length/3;y.SJ&&(q.Ax(e,
1,!0),a.a_polyindex=q.Ju(e));return e};a.yY=function(a){var b=a.length;b%3&&u.I("Wrong array");for(var c=[],e=[],g=0;g<b;g+=3){var h=a[g+1],k=a[g+2];f(a[g],e);f(h,e);f(k,e);c.push(g,g+1,g+2)}a=u.pi();a.a_position=new Float32Array(e);b=q.Yg("FROM_TRIANGLES");b.fa[0]=a;b.xa=new Uint32Array(c);b.Va=e.length/3;return b};a.xY=c;a.nQ=function(a){a=u.uW(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);
b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.gd=function(){var a=q.Yg("FULLSCREEN_TRI"),b=u.pi();b.a_position=new Float32Array([0,0,1,0,0,1]);a.fa[0]=b;a.xa=new Uint32Array([0,1,2]);a.Va=3;return a};a.oQ=function(){var a=q.Yg("FULLSCREEN_QUAD"),b=u.pi();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.fa[0]=b;a.xa=new Uint32Array([0,2,1,1,2,3]);a.Va=4;return a};a.jQ=function(){var a=q.Yg("BILLBOARD"),b=u.pi();b.a_bb_vertex=q.vF(1);a.fa[0]=b;a.xa=new Uint32Array([0,2,1,0,3,
2]);a.Va=4;return a};a.Qz=function(a,c){var d=q.Yg("UV_SPHERE"),e,g,k=[],u=[],l=[];for(g=0;8>=g;g++)for(e=0;16>=e;e++){var y=e/16,w=g/8;u.push(-a*Math.cos(2*y*Math.PI)*Math.sin(w*Math.PI)+c[0],a*Math.cos(w*Math.PI)+c[1],a*Math.sin(2*y*Math.PI)*Math.sin(w*Math.PI)+c[2])}for(g=y=0;8>g;g++)for(e=0;16>e;e++){var w=b(u,17*g+e+1),G=b(u,17*g+e),v=b(u,17*(g+1)+e),D=b(u,17*(g+1)+e+1);Math.abs(w[1])==a+c[1]?(f(w,k),f(v,k),f(D,k),l.push(y,y+1,y+2),y+=3):Math.abs(v[1])==a+c[1]?(f(w,k),f(G,k),f(v,k),l.push(y,
y+1,y+2),y+=3):(f(w,k),f(G,k),f(v,k),f(D,k),l.push(y,y+1,y+2),l.push(y,y+2,y+3),y+=4)}e={};e.a_position=k;u=q.dE(l,u,k);u=q.cE(l,k,u);e.a_tbn=h.tm(u);d.fa[0]=e;d.xa=l;d.Va=k.length/3;return d};a.zF=function(a){var b=q.Yg("INDEX"),c=u.pi();c.a_index=new Float32Array(3*a);for(var e=new Uint16Array(3*a),g=0;g<3*a;g++)c.a_index[g]=g,e[g]=g;b.fa[0]=c;b.xa=e;b.Va=3*a;return b}};b4w.module.__prerender=function(a,t){function e(a,c){var e=a.qg;e.is_visible=!1;if(e.hide)return!1;var g=c.F,f=c.type==h.wd?g.Xv:u.Qb(g.C,d),l=a.ya;if(!k.RV(l,e,f))return!1;e.is_visible=!0;if(c.type==h.ph)l=c.debug_view_mode==b.DV_BOUNDINGS?l.tj:!l.tj;else{if(!(e=c.type==h.qh&&0==e.Nh)&&(e=!l.vj&&a.IC)){var g=g.Eh,f=a.IC.rf,e=a.IC.nf,r=l.Bl,l=f.S;if(y.aV(l,g,f.ib))e=!0;else if(r)var f=e.Qa,r=e.Ra,p=e.Sa,l=e.S,e=y.EP(l,g,f,r,p);else e=!1}l=e?!1:!0}return l}function c(a){var b=a.Ha;if(b&&b.ow){a=a.la;
f.xS(a);var c=a.Eb;f.Us(a.gc,"a_position",b.Yr,c.a_position.offset);f.Us(a.gc,"a_tbn",b.As,c.a_tbn.offset);f.yC(a)}}var b=t("__debug"),f=t("__geometry"),k=t("__objects"),q=t("__renderer"),h=t("__subscene"),u=t("__tsr"),y=t("__util"),g=[h.Nb,h.bd,h.$d,h.ud,h.Vf,h.gf,h.Zd,h.Dg,h.wd,h.Wf,h.qh,h.ph,h.Ne,h.oh],d=new Float32Array(3);a.Gw=function(a){if(-1<g.indexOf(a.type)){for(var b=!1,d=a.type==h.ud||a.type==h.gf,f=a.Xa,k=0;k<f.length;k++){for(var l=f[k],r=l.Ia,u=!1,y=0;y<r.length;y++){var v=r[y],D=v.ya;
if(d)for(var F=0;6>F;F++)a.F.Eh=a.hm[F],v.Gz[F]=e(v,a),v.Gz[F]&&(u=b=!0,c(D));else v.dc=e(v,a),v.dc&&(u=b=!0,c(D));a.Ka&&(D.pb.Ko=!0)}l.dc=u}a.Ka=!1;switch(a.type){case h.ph:break;default:a.type==h.Nb||a.type==h.Wf||a.type==h.Zd||a.type==h.$d||a.type==h.ud||b?a.dc=!0:(a.dc&&q.clear(a),a.dc=!1)}}else if(a.Ka){f=a.Xa;for(k=0;k<f.length;k++)for(r=f[k].Ia,y=0;y<r.length;y++)v=r[y],D=v.ya,D.pb.Ko=!0;a.Ka=!1}a.Mr&&h.UU(a)}};b4w.module.__print=function(a){function t(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}function e(){k++;var a=t(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in h||(h[a]=a,e([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var f=!1,k=0,q=0,h={};a.HU=function(a){f=a};a.ld=function(){console.log.apply(console,arguments)};a.log=function(){if(f){var a=t(arguments,
"B4W LOG");console.log.apply(console,a)}};a.FE=t;a.error=e;a.ia=c;a.Bd=b;a.mY=function(a,e){switch(1<e.length){case !0:c(a+"() is deprecated, use "+e.slice(0,-1).join("(), ")+"() or "+e[e.length-1]+"() instead.");break;case !1:b(a,e[0])}};a.Hu=function(a,b){void 0===b?c('Config option "'+a+'" is deprecated.'):c('Config option "'+a+'" is deprecated, use "'+b+'" instead.')};a.warn=function(){q++;var a=t(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=t(arguments,"B4W INFO");
console.info.apply(console,a)};a.KP=function(){k++;var a=t(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.LP=function(){q++;var a=t(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){f&&console.time.apply(console,arguments)};a.timeEnd=function(){f&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,
arguments)};a.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)};a.iR=function(){return q};a.LQ=function(){return k};a.clear_errors_warnings=function(){k=q=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,t){function e(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var g=d.strips[e];"action"in g||(g.action=null,b("strip",g,"action"));"action_frame_start"in g||(g.action_frame_start=0,b("strip",g,"action_frame_start"));"action_frame_end"in g||(g.action_frame_end=g.frame_end-g.frame_start,b("strip",g,"action_frame_end"));"repeat"in g||(g.repeat=1,b("strip",g,"repeat"));
"use_reverse"in g||(g.use_reverse=!1,b("strip",g,"use_reverse"));"scale"in g||(g.scale=1,b("strip",g,"scale"))}}function b(a,b,c){c=c+">>"+a;c in D||(D[c]={aC:[],MH:"undefined",type:a});D[c].aC.push(b.name)}function f(a,b,c){c=c+">>"+a;c in D||(D[c]={aC:[],MH:"deprecated",type:a});D[c].aC.push(b.name)}function k(a){r.warn(a)}function q(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=E.V(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<d.length;c++){var g=E.Dq(d[c]);e.submeshes.push(g)}return e}function h(a,b,c){if(1<c){for(var d=a.length/c,e=b.length/c,g=new Float32Array(a.length+b.length),f=0,l=0;l<c;l++)g.set(a.subarray(d*l,d*(l+1)),f),f+=d,g.set(b.subarray(e*l,e*(l+1)),f),f+=e;return g}return E.qF(a,b)}var u=t("__boundings"),y=t("__config"),g=t("__curve"),d=t("__mat4"),r=t("__print"),p=t("__quat"),M=t("__tbn"),E=t("__util"),z=t("__vec3"),l=t("__mat3"),B=t("__logic_nodes"),w=t("__animation"),G=y.K,v=
[5,4],D={},F=l.create(),n=M.create(),N=p.create();a.pE=function(a){return-1!=E.IJ(a,v)};a.xN=function(a){D={};var d=a.worlds;if(0==d.length){r.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var g={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",
use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,use_nodes:!1,node_tree:null,texture_slots:[]};d.push(g)}for(var l=0;l<d.length;l++){g=d[l];"use_sky_blend"in g||(b("world",g,"use_sky_blend"),g.use_sky_blend=!1);"use_sky_paper"in g||(b("world",g,"use_sky_paper"),g.use_sky_paper=!1);"use_sky_real"in g||(b("world",g,"use_sky_real"),g.use_sky_real=!1);"b4w_sky_settings"in g&&"rayleigh_brightness"in g.b4w_sky_settings||(b("world",g,"rayleigh_brightness"),g.b4w_sky_settings=
{render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in g||(b("world",g,"fog_settings"),g.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in g&&(g.fog_settings.use_custom_color=
!0,g.fog_settings.color=g.b4w_fog_color),"b4w_fog_density"in g&&0<g.b4w_fog_density&&(g.fog_settings.depth=1/g.b4w_fog_density));"render_sky"in g.b4w_sky_settings||(b("world",g,"render_sky"),g.b4w_sky_settings.render_sky=!1);for(var h=g.texture_slots,n=0;n<h.length;n++){var m=h[n];"blend_type"in m||(m.blend_type="MIX",b("world_texture_slot",m,"blend_type"));"use_map_blend"in m||(m.use_map_blend=!1,b("world_texture_slot",m,"use_map_blend"));"use_map_horizon"in m||(m.use_map_horizon=!0,b("world_texture_slot",
m,"use_map_horizon"));"use_map_zenith_up"in m||(m.use_map_zenith_up=!1,b("world_texture_slot",m,"use_map_zenith_up"));"use_rgb_to_intensity"in m||(m.use_rgb_to_intensity=!1,b("world_texture_slot",m,"use_rgb_to_intensity"));"invert"in m||(m.invert=!1,b("world_texture_slot",m,"invert"));"color"in m||(m.color=[1,0,1],b("world_texture_slot",m,"color"));"blend_factor"in m||(m.blend_factor=0,b("world_texture_slot",m,"blend_factor"));"horizon_factor"in m||(m.horizon_factor=1,b("world_texture_slot",m,"horizon_factor"));
"zenith_up_factor"in m||(m.zenith_up_factor=0,b("world_texture_slot",m,"zenith_up_factor"));"zenith_down_factor"in m||(m.zenith_down_factor=0,b("world_texture_slot",m,"zenith_down_factor"));"default_value"in m||(m.default_value=1,b("world_texture_slot",m,"default_value"))}"b4w_use_default_animation"in g||(b("world",g,"b4w_use_default_animation"),g.b4w_use_default_animation=!1);"b4w_anim_behavior"in g||(b("world",g,"b4w_anim_behavior"),g.b4w_anim_behavior="CYCLIC")}n=a.scenes;for(l=0;l<n.length;l++)h=
n[l],m=h.world,"timeline_markers"in h||(h.timeline_markers=null,b("scene",h,"timeline_markers")),"boolean"==typeof h.b4w_enable_physics&&(h.b4w_enable_physics="AUTO"),"b4w_reflection_quality"in h||(h.b4w_reflection_quality="MEDIUM",b("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,b("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,b("scene",h,"fps")),"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,b("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],b("scene",
h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(f("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},b("scene",h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in
h||(h.b4w_enable_bloom=!1,b("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,b("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=!1,b("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",b("scene",h,"b4w_antialiasing_quality")),"b4w_tags"in h||(h.b4w_tags={title:"",description:""},b("scene",h,"b4w_tags")),"b4w_lod_smooth_type"in h||(h.b4w_lod_smooth_type=
"OFF",b("scene",h,"b4w_lod_smooth_type")),"b4w_lod_hyst_interval"in h||(h.b4w_lod_hyst_interval=0,b("scene",h,"b4w_lod_hyst_interval")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection="AUTO",b("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",b("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in h||(h.b4w_enable_glow_materials="AUTO",b("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility=
"AUTO",b("scene",h,"b4w_enable_anchors_visibility")),"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],b("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor="b4w_glow_factor"in h?h.b4w_glow_factor:1,b("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(b("scene",h,"b4w_shadow_settings"),d=m.b4w_shadow_settings,h.b4w_shadow_settings=d?d:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,
first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),d=h.b4w_shadow_settings,"csm_resolution"in d||(b("scene",h,"b4w_shadow_settings.csm_resolution"),d.csm_resolution=2048),"blur_samples"in d||(b("scene",h,"b4w_shadow_settings.blur_samples"),d.blur_samples="16x"),"soft_shadows"in d||(b("scene",h,"b4w_shadow_settings.soft_shadows"),d.soft_shadows=!0),"self_shadow_polygon_offset"in d||(b("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),
d.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in d||(b("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),d.self_shadow_normal_offset=.01),"b4w_enable_csm"in d||(b("scene",h,"b4w_shadow_settings.b4w_enable_csm"),d.b4w_enable_csm=!1),"csm_num"in d||(b("scene",h,"b4w_shadow_settings.csm_num"),d.csm_num=1),"csm_first_cascade_border"in d||(b("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),d.csm_first_cascade_border=10),"first_cascade_blur_radius"in d||(b("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),
d.first_cascade_blur_radius=3),"csm_last_cascade_border"in d||(b("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),d.csm_last_cascade_border=100),"last_cascade_blur_radius"in d||(b("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),d.last_cascade_blur_radius=1.5),"fade_last_cascade"in d||(b("scene",h,"b4w_shadow_settings.fade_last_cascade"),d.fade_last_cascade=!0),"blend_between_cascades"in d||(b("scene",h,"b4w_shadow_settings.blend_between_cascades"),d.blend_between_cascades=!0),"b4w_ssao_settings"in
h||(b("scene",h,"b4w_ssao_settings"),d=m.b4w_ssao_settings,h.b4w_ssao_settings=d?d:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),d=h.b4w_ssao_settings,"dist_factor"in d||(b("scene",h,"b4w_ssao_settings.dist_factor"),d.dist_factor=0),"samples"in d||(b("scene",h,"b4w_ssao_settings.samples"),d.samples=16),"hemisphere"in d||(b("scene",h,"b4w_ssao_settings.hemisphere"),d.hemisphere=!1),"blur_depth"in d||(b("scene",h,"b4w_ssao_settings.blur_depth"),d.blur_depth=!1),"blur_discard_value"in
d||(b("scene",h,"b4w_ssao_settings.blur_discard_value"),d.blur_discard_value=1),"b4w_bloom_settings"in h||(b("scene",h,"b4w_bloom_settings"),d=m.b4w_bloom_settings,h.b4w_bloom_settings=d?d:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=.2),"blur"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=
1),"adaptive"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.adaptive"),h.b4w_bloom_settings.adaptive=!0),"average_luminance"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.average_luminance"),h.b4w_bloom_settings.average_luminance=.5),"b4w_motion_blur_settings"in h||(b("scene",h,"b4w_motion_blur_settings"),d=m.b4w_motion_blur_settings,h.b4w_motion_blur_settings=d?d:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(b("scene",
h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),"b4w_color_correction_settings"in h||(b("scene",h,"b4w_color_correction_settings"),d=m.b4w_color_correction_settings,h.b4w_color_correction_settings=d?d:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in
h||(b("scene",h,"b4w_god_rays_settings"),d=m.b4w_god_rays_settings,h.b4w_god_rays_settings=d?d:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(b("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=10),"b4w_glow_settings"in h||(b("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},d=h.b4w_glow_settings,
"b4w_render_glow_over_blend"in m&&(d.render_glow_over_blend=m.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in m&&(d.small_glow_mask_coeff=m.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in m&&(d.large_glow_mask_coeff=m.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in m&&(d.small_glow_mask_width=m.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in m&&(d.large_glow_mask_width=m.b4w_large_glow_mask_width)),m=h.b4w_render_shadows,"AUTO"!=m&&"OFF"!=m&&"ON"!=m&&(h.b4w_render_shadows=
m?"ON":"OFF"),m=h.b4w_render_reflections,"OFF"!=m&&"ON"!=m&&(h.b4w_render_reflections=m?"ON":"OFF"),m=h.b4w_render_refractions,"AUTO"!=m&&"OFF"!=m&&"ON"!=m&&(h.b4w_render_refractions=m?"ON":"OFF"),"b4w_render_dynamic_grass"in h||(b("scene",h,"b4w_render_dynamic_grass"),h.b4w_render_dynamic_grass="AUTO"),h.b4w_nla_script&&f("scene",h,"b4w_nla_script"),"audio_distance_model"in h||(b("scene",h,"audio_distance_model"),h.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in h||(b("scene",h,"b4w_custom_prop"),
h.b4w_custom_prop=null);h=a.meshes;for(l=0;l<h.length;l++){m=h[l];m.b4w_boundings||(b("mesh",m,"b4w_boundings"),m.b4w_boundings={},d=m.b4w_boundings,d.bb=m.b4w_bounding_box?m.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},d.bb_src=m.b4w_bounding_box_source?m.b4w_bounding_box_source:m.b4w_bounding_box,d.bs_cen=m.b4w_bounding_sphere_center?m.b4w_bounding_sphere_center:[0,0,0],d.bc_cen=m.b4w_bounding_cylinder_center?m.b4w_bounding_cylinder_center:[0,0,0],d.be_cen=m.b4w_bounding_ellipsoid_center?
m.b4w_bounding_ellipsoid_center:[0,0,0],m.b4w_bounding_ellipsoid_axes?d.be_ax=m.b4w_bounding_ellipsoid_axes:(n=d.bb,d.be_ax=[(n.max_x-n.min_x)/2,(n.max_y-n.min_y)/2,(n.max_z-n.min_z)/2]),m.b4w_rotated_bounding_box?d.rbb=m.b4w_rotated_bounding_box:(n=d.bb,d.rbb={rbb_c:[(n.max_x+n.min_x)/2,(n.max_y+n.min_y)/2,(n.max_z+n.min_z)/2],rbb_s:[1,1,1]}),d.caxis_x=m.b4w_cov_axis_x?m.b4w_cov_axis_x:[1,0,0],d.caxis_y=m.b4w_cov_axis_y?m.b4w_cov_axis_y:[0,1,0],d.caxis_z=m.b4w_cov_axis_z?m.b4w_cov_axis_z:[0,0,1]);
"is_boundings_overridden"in m||(b("mesh",m,"is_boundings_overridden"),m.is_boundings_overridden=!1);"b4w_shape_keys"in m||(m.b4w_shape_keys=[],b("mesh",m,"b4w_shape_keys"));d=!0;for(g=0;g<m.submeshes.length;g++){var p=m.submeshes[g];"boundings"in p||(d=!1,p.boundings={be_ax:m.b4w_bounding_ellipsoid_axes,be_cen:m.b4w_bounding_ellipsoid_center,bb:{max_x:m.b4w_bounding_box.max_x,max_y:m.b4w_bounding_box.max_y,max_z:m.b4w_bounding_box.max_z,min_x:m.b4w_bounding_box.min_x,min_y:m.b4w_bounding_box.min_y,
min_z:m.b4w_bounding_box.min_z}});"uv_layers"in p||(b("submesh",m,"uv_layers"),p.uv_layers=m.uv_textures);"be_ax"in p.boundings||(p.boundings.be_ax=m.b4w_bounding_ellipsoid_axes);"be_cen"in p.boundings||(p.boundings.be_cen=m.b4w_bounding_ellipsoid_center);"bb"in p.boundings||(p.boundings.bb=m.b4w_bounding_box);"rbb"in p.boundings||(n=m.b4w_bounding_box,p.boundings.rbb={rbb_c:[(n.max_x+n.min_x)/2,(n.max_y+n.min_y)/2,(n.max_z+n.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in p.boundings||(p.boundings.caxis_x=
[1,0,0]);"caxis_y"in p.boundings||(p.boundings.caxis_y=[0,1,0]);"caxis_z"in p.boundings||(p.boundings.caxis_z=[0,0,1])}d||b("mesh",m,"submesh_bd");n=m;d=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];g=null;for(p=0;p<d.length;p++)n[d[p]]&&(g?(n[d[p]]=!1,r.warn('WARNING property "'+d[p]+'" of object "'+n.name+'" has been set to "false". Foreground property "'+g+'" already exists.')):g=d[p]);for(n=0;n<m.b4w_vertex_anim.length;n++)d=
m.b4w_vertex_anim[n],"allow_nla"in d||(b('mesh["b4w_vertex_anim"]',m,"allow_nla"),d.allow_nla=!0)}n=a.cameras;for(l=0;l<n.length;l++)h=n[l],h.type||(h.type="PERSP",b("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,f("camera",h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,b("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,b("camera",h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=
1,b("camera",h,"b4w_rot_velocity")),"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,b("camera",h,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in h||(h.b4w_use_target_distance_limits=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_target_distance_limits")),"b4w_use_zooming"in h||(h.b4w_use_zooming=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_zooming")),"b4w_distance_min"in h||(h.b4w_distance_min=1,b("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,
b("camera",h,"b4w_distance_max")),"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=-100,b("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,b("camera",h,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,b("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,b("camera",h,"b4w_vertical_translation_max")),
"b4w_use_horizontal_clamping"in h||(h.b4w_use_horizontal_clamping=!1,b("camera",h,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,b("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=Math.PI,b("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",b("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=
!1,b("camera",h,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=-Math.PI/2,b("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,b("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in h||(h.b4w_vertical_clamping_type="LOCAL",b("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,b("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=
Math.PI/6,b("camera",h,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in h||(h.b4w_enable_hover_hor_rotation=!0,b("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,b("camera",h,"b4w_use_panning")),"b4w_use_pivot_limits"in h||(h.b4w_use_pivot_limits=!1,h.b4w_pivot_z_min=0,h.b4w_pivot_z_max=10,b("camera",h,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in h||(h.b4w_dof_bokeh=!1,b("camera",h,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in h||(h.b4w_dof_bokeh_intensity=
.3,b("camera",h,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in h||(h.b4w_dof_foreground_blur=!1,b("camera",h,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in h||(h.b4w_dof_front_start=0,b("camera",h,"b4w_dof_front_start")),"b4w_dof_front_end"in h||(h.b4w_dof_front_end=h.b4w_dof_front,b("camera",h,"b4w_dof_front_end")),"b4w_dof_rear_start"in h||(h.b4w_dof_rear_start=0,b("camera",h,"b4w_dof_rear_start")),"b4w_dof_rear_end"in h||(h.b4w_dof_rear_end=h.b4w_dof_rear,b("camera",h,"b4w_dof_rear_end")),
"sensor_fit"in h||(h.sensor_fit="VERTICAL",b("camera",h,"sensor_fit"));n=a.lamps;for(l=0;l<n.length;l++)if(h=n[l],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,b("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,b("lamp",h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,b("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,b("lamp",h,"use_specular")),"clip_start"in h||(h.clip_start=.1,b("lamp",h,"clip_start")),"clip_end"in
h||(h.clip_end=30,b("lamp",h,"clip_end")),"POINT"==h.type||"SPOT"==h.type)"use_sphere"in h||(h.use_sphere=!1,b("lamp",h,"use_sphere")),G.RG&&(h.type="SUN");n=a.speakers;for(l=0;l<n.length;l++)h=n[l],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in h||(h.b4w_auto_play=!1,b("speaker",h,"b4w_auto_play")),"b4w_enable_doppler"in h||(h.b4w_enable_doppler=!1,b("speaker",h,"b4w_enable_doppler")),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in
h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_start"in h||(h.b4w_loop_start=0,b("speaker",h,"b4w_loop_start")),"b4w_loop_end"in h||(h.b4w_loop_end=0,b("speaker",h,"b4w_loop_end")),h.animation_data&&c(h.animation_data);n=a.textures;for(l=0;l<n.length;l++)h=n[l],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering=
"OFF",b("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,b("texture",h,"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],b("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=[1,1],b("texture",h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,b("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,b("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in
h||(h.b4w_shore_dist_map=!1,b("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in h||(h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=100,b("texture",h,"b4w_max_shore_dist")),"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,b("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",b("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",b("texture",h,"b4w_source_id")),
"b4w_source_size"in h||(h.b4w_source_size=1024,b("texture",h,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,b("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in h||(h.b4w_nla_video=!1,b("texture",h,"b4w_nla_video"));n=a.images;for(l=0;l<n.length;l++)h=n[l],"colorspace_settings_name"in h||(h.colorspace_settings_name="sRGB",b("image",h,"colorspace_settings_name"));d=a.materials;for(l=0;l<d.length;l++){g=d[l];"ALPHA_ANTIALIASING"==g.game_settings.alpha_blend&&
(G.SG?g.game_settings.alpha_blend="CLIP":2>G.Zb&&(r.warn('Material "'+g.name+'" has the "Alpha Anti-Aliasing" transparency type, but multisampling is disabled. Changed to "Alpha Clip".'),g.game_settings.alpha_blend="CLIP"));"use_tangent_shading"in g||(g.use_tangent_shading=!1,b("material",g,"use_tangent_shading"));"b4w_node_mat_type"in g&&f("material",g,"b4w_node_mat_type");"b4w_skydome"in g&&f("material",g,"b4w_skydome");"b4w_procedural_skydome"in g&&f("material",g,"b4w_procedural_skydome");"b4w_lens_flares"in
g||(g.b4w_lens_flares=!1,b("material",g,"b4w_lens_flares"));"LENS_FLARES"===g.name&&(g.b4w_lens_flares||r.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),g.b4w_lens_flares=!0);g.b4w_water&&("b4w_water_shore_smoothing"in g||(g.b4w_water_shore_smoothing=!1,b("material",g,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in g||(g.b4w_water_dynamic=!1,b("material",g,"b4w_water_dynamic")),"b4w_waves_height"in g||(g.b4w_waves_height=1,b("material",
g,"b4w_waves_height")),"b4w_waves_length"in g||(g.b4w_waves_length=1,b("material",g,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in g||(g.b4w_water_dst_noise_scale0=.05,b("material",g,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in g||(g.b4w_water_dst_noise_scale1=.03,b("material",g,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in g||(g.b4w_water_dst_noise_freq0=1.3,b("material",g,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in g||(g.b4w_water_dst_noise_freq1=
1,b("material",g,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in g||(g.b4w_water_dir_min_shore_fac=.4,b("material",g,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in g||(g.b4w_water_dir_freq=.5,b("material",g,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in g||(g.b4w_water_dir_noise_scale=.05,b("material",g,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in g||(g.b4w_water_dir_noise_freq=.07,b("material",g,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in
g||(g.b4w_water_dir_min_noise_fac=.5,b("material",g,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in g||(g.b4w_water_dst_min_fac=.2,b("material",g,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in g||(g.b4w_water_waves_hor_fac=5,b("material",g,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in g||(g.b4w_water_absorb_factor=6,b("material",g,"b4w_water_absorb_factor")),"b4w_water_fog_color"in g||(g.b4w_water_fog_color=[.5,.7,.7],b("material",g,"b4w_water_fog_color")),"b4w_foam_factor"in
g||(g.b4w_foam_factor=5,b("material",g,"b4w_foam_factor")),"b4w_generated_mesh"in g||(g.b4w_generated_mesh=!1,b("material",g,"b4w_generated_mesh")),"b4w_water_num_cascads"in g||(g.b4w_water_num_cascads=5,b("material",g,"b4w_water_num_cascads")),"b4w_water_subdivs"in g||(g.b4w_water_subdivs=64,b("material",g,"b4w_water_subdivs")),"b4w_water_detailed_dist"in g||(g.b4w_water_detailed_dist=1E3,b("material",g,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in g||(g.b4w_water_enable_caust=!1,b("material",
g,"b4w_water_enable_caust")),"b4w_water_caust_scale"in g||(g.b4w_water_caust_scale=.25,b("material",g,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in g||(g.b4w_water_caust_brightness=.5,b("material",g,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in g||(g.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in g||(g.b4w_dynamic_grass_color="");"diffuse_intensity"in g||(g.diffuse_intensity=1,b("material",g,"diffuse_intensity"));"b4w_use_ghost"in g||(g.b4w_use_ghost=!1);"b4w_collision_margin"in
g||(g.b4w_collision_margin=.04,b("material",g,"b4w_collision_margin"));"b4w_collision_group"in g||(g.b4w_collision_group=128,b("material",g,"b4w_collision_group"));"b4w_collision_mask"in g||(g.b4w_collision_mask=127,b("material",g,"b4w_collision_mask"));"b4w_do_not_render"in g||(g.b4w_do_not_render=!1,b("material",g,"b4w_do_not_render"));"HALO"!=g.type||"b4w_halo_sky_stars"in g||(g.b4w_halo_sky_stars=!1,b("material",g,"b4w_halo_sky_stars"));"HALO"!=g.type||"b4w_halo_stars_blend_height"in g||(g.b4w_halo_stars_blend_height=
10,b("material",g,"b4w_halo_stars_blend_height"));"HALO"!=g.type||"b4w_halo_stars_min_height"in g||(g.b4w_halo_stars_min_height=0,b("material",g,"b4w_halo_stars_min_height"));"specular_shader"in g||(g.specular_shader="COOKTORR",b("material",g,"specular_shader"));"diffuse_shader"in g||(g.diffuse_shader="LAMBERT",b("material",g,"diffuse_shader"));"roughness"in g||(g.roughness=.5,b("material",g,"roughness"));"diffuse_fresnel"in g||(g.diffuse_fresnel=.1,b("material",g,"diffuse_fresnel"));"diffuse_fresnel_factor"in
g||(g.diffuse_fresnel_factor=.5,b("material",g,"diffuse_fresnel_factor"));"specular_slope"in g||(g.specular_slope=.2,b("material",g,"specular_slope"));"specular_toon_size"in g||(g.specular_toon_size=.5,b("material",g,"specular_toon_size"));"specular_toon_smooth"in g||(g.specular_toon_smooth=.1,b("material",g,"specular_toon_smooth"));"specular_alpha"in g||(g.specular_alpha=1,b("material",g,"specular_alpha"));"b4w_wettable"in g||(g.b4w_wettable=!1,b("material",g,"b4w_wettable"));"b4w_refractive"in g||
(g.b4w_refractive=!1,b("material",g,"b4w_refractive"));"b4w_refr_bump"in g||(g.b4w_refr_bump=0,b("material",g,"b4w_refr_bump"));"b4w_shallow_water_col"in g||(g.b4w_shallow_water_col=[0,.8,.3],b("material",g,"b4w_shallow_water_col"));"b4w_shore_water_col"in g||(g.b4w_shore_water_col=[0,.9,.2],b("material",g,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in g||(g.b4w_shallow_water_col_fac=1,b("material",g,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in g||(g.b4w_shore_water_col_fac=.5,
b("material",g,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in g||(g.b4w_water_sss_strength=5.9,b("material",g,"b4w_water_sss_strength"));"b4w_water_sss_width"in g||(g.b4w_water_sss_width=.45,b("material",g,"b4w_water_sss_width"));"b4w_render_above_all"in g||(g.b4w_render_above_all=!1,b("material",g,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in g||(g.b4w_water_norm_uv_velocity=.05,b("material",g,"b4w_water_norm_uv_velocity"));"specular_ior"in g||(g.specular_ior=1,b("material",g,"specular_ior"));
"darkness"in g||(g.darkness=0,b("material",g,"darkness"));"diffuse_toon_size"in g||(g.diffuse_toon_size=0,b("material",g,"diffuse_toon_size"));"diffuse_toon_smooth"in g||(g.diffuse_toon_smooth=0,b("material",g,"diffuse_toon_smooth"));"pass_index"in g||(g.pass_index=0,b("material",g,"pass_index"));h=g.texture_slots;for(n=0;n<h.length;n++)m=h[n],"blend_type"in m||(m.blend_type="MIX",b("texture_slot",m,"blend_type"));if(g.node_tree){h=g.node_tree.nodes;for(n=0;n<h.length;n++)e(h[n]);g.node_tree.animation_data&&
c(g.node_tree.animation_data)}}m=a.node_groups;for(l=0;l<m.length;l++)for(h=m[l].node_tree.nodes,n=0;n<h.length;n++)e(h[n]);h=a.objects;for(l=0;l<h.length;l++){m=h[l];switch(m.type){case "MESH":"b4w_dynamic_geometry"in m||(m.b4w_dynamic_geometry=!1);"b4w_reflexible"in m||(m.b4w_reflexible=!1);"b4w_reflexible_only"in m||(m.b4w_reflexible_only=!1);"b4w_reflective"in m||(m.b4w_reflective=!1);"b4w_reflection_type"in m||(m.b4w_reflection_type="PLANE",b("object",m,"b4w_reflection_type"));"b4w_wind_bending"in
m||(m.b4w_wind_bending=!1,b("object",m,"b4w_wind_bending"));"b4w_wind_bending_angle"in m||(m.b4w_wind_bending_angle=10,m.b4w_wind_bending_freq=.25,b("object",m,"wind bending params"));"b4w_detail_bending_amp"in m||(m.b4w_detail_bending_amp=.1,m.b4w_branch_bending_amp=.3,b("object",m,"detail bending params"));"b4w_detail_bending_freq"in m||(m.b4w_detail_bending_freq=1,b("object",m,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in m||(m.b4w_main_bend_stiffness_col="",b("object",m,"b4w_main_bend_stiffness_col"));
"b4w_detail_bend_colors"in m||(m.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",m,"b4w_detail_bend_colors"));"b4w_caustics"in m||(m.b4w_caustics=!1);"vertex_groups"in m&&m.vertex_groups.length&&m.data&&0==m.data.vertex_groups.length&&(m.data.vertex_groups=m.vertex_groups,delete m.vertex_groups,b("object",m,"vertex_groups"));"b4w_vertex_anim"in m&&m.b4w_vertex_anim.length&&m.data&&0==m.data.b4w_vertex_anim.length&&(m.data.b4w_vertex_anim=m.b4w_vertex_anim,
delete m.b4w_vertex_anim,b("object",m,"b4w_vertex_anim"));"b4w_do_not_render"in m||(m.b4w_do_not_render=!1);"b4w_hidden_on_load"in m||(m.b4w_hidden_on_load=!1);"b4w_hide_chldr_on_load"in m||(m.b4w_hide_chldr_on_load=!1);"use_ghost"in m.game||(m.game.use_ghost=!1);"use_sleep"in m.game||(m.game.use_sleep=!1);"velocity_min"in m.game||(m.game.velocity_min=0);"velocity_max"in m.game||(m.game.velocity_max=0);"collision_group"in m.game||(m.game.collision_group=1);"collision_mask"in m.game||(m.game.collision_mask=
255);n=m;d=n.game;g=d.collision_bounds_type;d.use_collision_bounds&&"BOX"!=g&&"CYLINDER"!=g&&"CONE"!=g&&"SPHERE"!=g&&"CAPSULE"!=g&&"EMPTY"!=g&&(r.error("Wrong collision bounds type "+g+". Disable physics for object "+n.name),n.b4w_collision=!1,n.b4w_floating=!1,n.b4w_vehicle=!1,n.b4w_character=!1);"b4w_vehicle_settings"in m?m.b4w_vehicle_settings&&("steering_ratio"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.steering_ratio=10),"steering_max"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.steering_max=
1),"inverse_control"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.inverse_control=!1),"force_max"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.force_max=1500),"brake_max"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.brake_max=100),"speed_ratio"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.delta_tach_angle=
4.43),"suspension_compression"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in
m.b4w_vehicle_settings||(m.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.floating_factor=3),"floating_factor"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in m.b4w_vehicle_settings||(m.b4w_vehicle_settings.water_rot_damp=.9)):(m.b4w_vehicle_settings=null,b("object",m,"b4w_vehicle_settings"));"b4w_floating_settings"in
m?m.b4w_floating_settings&&("floating_factor"in m.b4w_floating_settings||(m.b4w_floating_settings.floating_factor=3),"water_lin_damp"in m.b4w_floating_settings||(m.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in m.b4w_floating_settings||(m.b4w_floating_settings.water_rot_damp=.8)):(m.b4w_floating_settings=null,b("object",m,"b4w_floating_settings"));"b4w_character_settings"in m?m.b4w_character_settings&&("walk_speed"in m.b4w_character_settings||(m.b4w_character_settings.walk_speed=4),"run_speed"in
m.b4w_character_settings||(m.b4w_character_settings.run_speed=8),"step_height"in m.b4w_character_settings||(m.b4w_character_settings.step_height=.25),"jump_strength"in m.b4w_character_settings||(m.b4w_character_settings.jump_strength=5),"waterline"in m.b4w_character_settings||(m.b4w_character_settings.waterline=0)):(m.b4w_character_settings=null,b("object",m,"b4w_character_settings"));"b4w_selectable"in m||(m.b4w_selectable=!1,b("object",m,"b4w_selectable"));"b4w_outlining"in m||(m.b4w_outlining=
!1,b("object",m,"b4w_outlining"));"b4w_outline_on_select"in m||(m.b4w_outline_on_select=!1,b("object",m,"b4w_outline_on_select"));"b4w_billboard"in m||(m.b4w_billboard=!1,b("object",m,"b4w_billboard"));"b4w_billboard_geometry"in m||(m.b4w_billboard_geometry="SPHERICAL",b("object",m,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in m||(m.b4w_pres_glob_orientation=!1,b("object",m,"b4w_pres_glob_orientation"));"b4w_outline_settings"in m||("b4w_glow_settings"in m?m.b4w_outline_settings=m.b4w_glow_settings:
(m.b4w_outline_settings={},m.b4w_outline_settings.outline_duration=1,m.b4w_outline_settings.outline_period=1,m.b4w_outline_settings.outline_relapses=0),b("object",m,"b4w_outline_settings"));"lod_levels"in m||(m.lod_levels=[],b("object",m,"lod_levels"));"b4w_animation_mixing"in m||(m.b4w_animation_mixing=!1,b("object",m,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in m||(m.b4w_anchor=null,b("object",m,"b4w_anchor")),!m.b4w_anchor||"max_width"in m.b4w_anchor||(m.b4w_anchor.max_width=250)}"collision_margin"in
m.game||(m.game.collision_margin=.04,b("object",m,"collision_margin"));"b4w_anim_behavior"in m||(m.b4w_anim_behavior=m.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",m,"b4w_anim_behavior"));if(!("rotation_quaternion"in m)){n=[0,0,0,1];E.euler_to_quat(m.rotation_euler,n);var d=n,g=n[0],p=n[1],v=n[2];d[0]=n[3];d[1]=g;d[2]=p;d[3]=v;m.rotation_quaternion=n;b("object",m,"rotation_quaternion")}"webgl_do_not_batch"in m&&(m.b4w_do_not_batch=m.webgl_do_not_batch)&&f("object",m,"webgl_do_not_batch");
"b4w_shadow_cast_only"in m||(m.b4w_shadow_cast_only=!1,b("object",m,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in m||(m.b4w_correct_bounding_offset="AUTO",b("object",m,"b4w_correct_bounding_offset"));d=m.particle_systems;for(n=0;n<d.length;n++)g=d[n],p=g.settings,"use_rotation_dupli"in p||(p.use_rotation_dupli=!1,b("particle_settings",p,"use_rotation_dupli")),"use_whole_group"in p||(p.use_whole_group=!1,b("particle_settings",p,"use_whole_group")),g.transforms||(g.transforms=new Float32Array,
b("particle_system",g,"transforms")),"b4w_billboard_align"in p||(p.b4w_billboard_align="VIEW",b("particle_settings",p,"b4w_billboard_align")),"b4w_dynamic_grass"in p||(p.b4w_dynamic_grass=!1,b("object",p,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in p||(p.b4w_dynamic_grass_scale_threshold=.01,b("object",p,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in p||(p.b4w_initial_rand_rotation=!1,b("particle_settings",p,"b4w_initial_rand_rotation")),"b4w_rotation_type"in p||
(p.b4w_rotation_type="Z",b("particle_settings",p,"b4w_rotation_type")),"b4w_rand_rotation_strength"in p||(p.b4w_rand_rotation_strength=1,b("particle_settings",p,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in p||(p.b4w_hair_billboard=!1,b("particle_settings",p,"b4w_hair_billboard")),"b4w_hair_billboard_type"in p||(p.b4w_hair_billboard_type="BASIC",b("particle_settings",p,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in p||(p.b4w_hair_billboard_jitter_amp=0,b("particle_settings",
p,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in p||(p.b4w_hair_billboard_jitter_freq=0,b("particle_settings",p,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in p||(p.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",p,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in p||(p.b4w_wind_bend_inheritance="PARENT",b("particle_settings",p,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in p||(p.b4w_shadow_inheritance="PARENT",b("particle_settings",
p,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in p||(p.b4w_reflection_inheritance="PARENT",b("particle_settings",p,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in p||(p.b4w_vcol_from_name="",b("particle_settings",p,"b4w_vcol_from_name")),"b4w_vcol_to_name"in p||(p.b4w_vcol_to_name="",b("particle_settings",p,"b4w_vcol_to_name")),"b4w_coordinate_system"in p||(p.b4w_coordinate_system="LOCAL",b("particle_settings",p,"b4w_coordinate_system")),"b4w_allow_nla"in p||(p.b4w_allow_nla=!0,b("particle_settings",
p,"b4w_allow_nla")),"b4w_enable_soft_particles"in p||(p.b4w_enable_soft_particles=!1,b("particle_settings",p,"b4w_enable_soft_particles")),"b4w_particles_softness"in p||(p.b4w_particles_softness=1,b("particle_settings",p,"b4w_particles_softness")),"billboard_tilt"in p||(p.billboard_tilt=0,b("particle_settings",p,"billboard_tilt")),"billboard_tilt_random"in p||(p.billboard_tilt_random=0,b("particle_settings",p,"billboard_tilt_random")),"use_rotations"in p||(p.use_rotations=!1,b("particle_settings",
p,"use_rotations"));"constraints"in m||(m.constraints=[],b("object",m,"constraints"));d=m.constraints;for(n=0;n<d.length;n++)g=d[n],"influence"in g||(g.influence=1),"axes"in g||(g.axes=[1,1,1]);d=m.modifiers;for(n=0;n<d.length;n++){a:{g=d[n];switch(g.type){case "ARRAY":if(!("fit_type"in g)){r.error("WARNING Incomplete modifier "+String(g.type)+' for "'+m.name+'", reexport "'+a.b4w_filepath_blend+'" scene');g=!1;break a}}g=!0}g||(d.splice(n,1),n--)}"animation_data"in m||(m.animation_data={action:null,
nla_tracks:[]},b("object",m,"animation_data"));m.animation_data&&("action"in m.animation_data||(m.animation_data.action=null,k("no action in animation data "+m.name)),"nla_tracks"in m.animation_data||(m.animation_data.nla_tracks=[],k("no NLA in animation data "+m.name)),c(m.animation_data));"b4w_collision_id"in m||(m.b4w_collision_id="",b("object",m,"b4w_collision_id"));"b4w_viewport_alignment"in m||(m.b4w_viewport_alignment=null,b("object",m,"b4w_viewport_alignment"));"pinverse_tsr"in m||(m.pinverse_tsr=
null,b("object",m,"pinverse_tsr"));"b4w_cluster_data"in m||(m.b4w_cluster_data={cluster_id:-1,cluster_center:null},b("object",m,"b4w_cluster_data"));"pass_index"in m||(m.pass_index=0,b("object",m,"pass_index"));"b4w_custom_prop"in m||(b("object",m,"b4w_custom_prop"),m.b4w_custom_prop=null);(0>m.scale[0]||0>m.scale[1]||0>m.scale[2])&&k('negative scale for object "'+m.name+'", can lead to some errors');n=m.scale;0==n[0]&&0==n[1]&&0==n[2]?n=!0:(d=Math.abs((n[1]-n[2])/n[1]),n=.005>Math.abs((n[0]-n[1])/
n[0])&&.005>d);n||k("non-uniform scale for object "+m.name)}for(var q in D)l=D[q],n=q.match(/.*?(?=>>|$)/i)[0],r.warn('Property "'+String(n)+'" is '+l.MH+' for "'+l.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.uN=function(a,b){"num_channels"in a||(a.num_channels=1,k('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.GM=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var e=b[c].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=
!1}if(!b)return null;b=q(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var f=a[c];switch(f.type){case "ARRAY":for(var e=b,k=f,m=0,v=0,w=0,y=new Float32Array(16),f=[],D=1;D<k.count;D++){k.use_constant_offset&&(m+=k.constant_offset_displace[0],v+=k.constant_offset_displace[1],w+=k.constant_offset_displace[2]);if(k.use_relative_offset)var B=e.b4w_boundings.bb,m=m+(B.max_x-B.min_x)*k.relative_offset_displace[0],v=v+(B.max_y-B.min_y)*k.relative_offset_displace[1],w=w+(B.max_z-B.min_z)*
k.relative_offset_displace[2];E.rV(m,v,w,y);for(var G=B=q(e),t=y,I=l.fromMat4(t,F),I=p.fromMat3(I,N),ea=0;ea<G.submeshes.length;ea++){var qa=G.submeshes[ea];E.Wo(qa.position,t,qa.position,0);M.WA(qa.tbn,I,qa.tbn)}f.push(B)}for(D=0;D<f.length;D++)for(k=e,m=f[D],v=0;v<k.submeshes.length;v++)if(w=k.submeshes[v],y=m.submeshes[v],B=w.base_length,G=w.indices.length,B)for(var Z in w)switch(Z){case "base_length":w[Z]+=y[Z];break;case "boundings":break;case "indices":w[Z]=E.wV(w[Z],y[Z]);for(t=G;t<w[Z].length;t++)w[Z][t]+=
B;break;case "position":w[Z]=h(w[Z],y[Z],w[Z].length/B/3);break;case "tbn":w[Z]=h(w[Z],y[Z],w[Z].length/B/4);break;case "shade_tangs":w[Z]=h(w[Z],y[Z],w[Z].length/B/3);break;case "group":w[Z]=h(w[Z],y[Z],w[Z].length/B);break;case "texcoord":w[Z]=h(w[Z],y[Z],w.uv_layers.length);break;case "color":w[Z]=h(w[Z],y[Z],w.vertex_colors.length);break;case "uv_layers":case "vertex_colors":break;default:r.warn('array_mesh_join(): unknown submesh property "'+Z+'"'),w[Z]=E.qF(w[Z],y[Z])}break;case "CURVE":for(e=
b,D=g.EO(f.object),k=new Float32Array(16),v=D.Pk?4:3,m=new Float32Array(v),v=new Float32Array(v),w=new Float32Array(3),y=new Float32Array(4),B=new Float32Array(4),G=new Float32Array(3),t=new Float32Array(3),I=new Float32Array(3),ea=0;ea<e.submeshes.length;ea++){var aa=e.submeshes[ea],qa=aa.position,aa=aa.tbn,X;a:{X=f.deform_axis;switch(X){case "POS_X":case "NEG_X":X=0;break a;case "POS_Y":case "NEG_Y":X=1;break a;case "POS_Z":case "NEG_Z":X=2;break a;default:E.I("Wrong deform axis value "+X)}X=void 0}G[0]=
0;G[1]=0;G[2]=0;G[X]=1;for(var fa=g.dV(D),Ca=0;Ca<qa.length/3;Ca++){I[0]=qa[3*Ca];I[1]=qa[3*Ca+1];I[2]=qa[3*Ca+2];var ca=I[X],Y=g.cV(D,ca);g.eV(D,Y,m);w[0]=m[0];w[1]=m[1];w[2]=m[2];g.bV(D,Y,v);t[0]=v[0];t[1]=0;t[2]=v[2];z.normalize(t,t);p.rotationTo(G,t,y);0>ca?(m[0]=t[0],m[1]=t[1],m[2]=t[2],z.scale(m,ca,m),z.add(w,m,w)):ca>fa&&(m[0]=t[0],m[1]=t[1],m[2]=t[2],z.scale(m,ca-fa,m),z.add(w,m,w));d.fromRotationTranslation(y,w,k);D.Pk&&(p.setAxisAngle(G,m[3],B),z.transformQuat(I,B,I));I[X]=0;z.transformMat4(I,
k,I);qa[3*Ca]=I[0];qa[3*Ca+1]=I[1];qa[3*Ca+2]=I[2];ca=M.wm(aa,Ca,n);M.WA(ca,y,ca);M.Pi(aa,ca,Ca)}}}u.xT(b)}return b};a.LM=function(a,b){function c(b,c){for(var d in b){var g=b[d],e=g[0];if(1<g.length)for(var f=1;f<g.length;f++)e+="*"+g[f];for(f=0;f<a.length;f++)if(g=a[f],g.name==e)for(var h in c)g[h]=c[h]}}for(var d=b.b4w_logic_nodes,g=0;g<d.length;g++)for(var e=d[g],h=0;h<e.length;h++){var f=e[h],l={register1:"variable1",register2:"variable2",registerd:"variabled"},n;for(n in l)n in f&&(f[l[n]]=
f[n]);for(var p in f.variables)"boolean"!=typeof f.variables[p][0]&&(f.variables[p]=[!1,f.variables[p]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(f.type)&&("variable1"in f&&(f.variables.v1=[!1,f.variable1]),"variable2"in f&&(f.variables.v2=[!1,f.variable2]),"variabled"in f&&(f.variables.vd=[!1,f.variabled]));switch(f.type){case "SELECT":for(var r=0;r<a.length;r++)l=a[r],l.name==f.object&&(l.b4w_selectable=!0);f.bools||(f.bools={});f.bools.not_wait||(f.bools.not_wait=!1);k('Logic nodes type "SELECT" is deprecated');
break;case "SWITCH_SELECT":c(f.objects_paths,{b4w_selectable:!0});if(f.links instanceof Array){k('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var l={},v=0;for(r in f.objects_paths)l[r]=f.links[v],v++;f.links=l}break;case "SELECT_PLAY":k('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');f.mute=!0;break;case "SELECT_PLAY_ANIM":k('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');
break;case "SHOW":f.bools||(f.bools={}),void 0===f.bools.ch&&(f.bools.ch=!1);case "HIDE":c(f.objects_paths,{b4w_do_not_batch:!0});break;case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(f.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(f.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(f.objects_paths,{b4w_do_not_batch:!0});switch(f.common_usage_names.space_type){case "WORLD":f.common_usage_names.space_type=B.$K;break;case "PARENT":f.common_usage_names.space_type=
B.ZK;break;case "LOCAL":f.common_usage_names.space_type=B.YK}break;case "OUTLINE":c(f.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":f.condition&&(f.common_usage_names.condition=f.condition);if("cnd"in f.floats)f.common_usage_names.condition=f.floats.cnd;else switch(f.common_usage_names.condition){case "GEQUAL":f.common_usage_names.condition=B.$C;break;case "LEQUAL":f.common_usage_names.condition=B.bD;break;case "GREATER":f.common_usage_names.condition=B.aD;break;case "LESS":f.common_usage_names.condition=
B.cD;break;case "NOTEQUAL":f.common_usage_names.condition=B.dD;break;case "EQUAL":f.common_usage_names.condition=B.ZC}void 0!=f.number1&&(f.input1=f.number1);void 0!=f.number2&&(f.input2=f.number2);f.bools||(f.bools={});void 0===f.bools.str&&(f.bools.str=!1,f.floats.inp1=f.input1,f.floats.inp2=f.input2);break;case "SEND_REQ":f.bools||(f.bools={});f.strings||(f.strings={});void 0===f.bools.ct&&(f.bools.ct=!1);void 0!=f.url&&(f.bools.url=!1,f.strings.url=f.url);break;case "MATH":void 0!=f.number1&&
(f.input1=f.number1);void 0!=f.number2&&(f.input2=f.number2);void 0!=f.input1&&(f.floats.inp1=f.input1);void 0!=f.input2&&(f.floats.inp2=f.input2);switch(f.operation){case "DIV":f.operation=B.FK;break;case "SUB":f.operation=B.OK;break;case "MUL":f.operation=B.KK;break;case "ADD":f.operation=B.AK;break;case "RAND":f.operation=B.LK;break;case "SIN":f.operation=B.NK;break;case "COS":f.operation=B.EK;break;case "TAN":f.operation=B.PK;break;case "ARCSIN":f.operation=B.CK;break;case "ARCCOS":f.operation=
B.BK;break;case "ARCTAN":f.operation=B.DK;break;case "LOG":f.operation=B.GK;break;case "MIN":f.operation=B.IK;break;case "MAX":f.operation=B.HK;break;case "ROUND":f.operation=B.MK;break;case "MOD":f.operation=B.JK;break;case "ABS":f.operation=B.zK}break;case "REGSTORE":f.floats||(f.floats={});f.strings||(f.strings={});void 0!=f.number1&&(f.input1=f.number1);if(void 0!=f.input1)switch(typeof f.input1){case "number":f.floats.inp1=f.input1;f.common_usage_names.variable_type="NUMBER";break;default:f.strings.inp1=
f.input1,f.common_usage_names.variable_type="STRING"}switch(f.common_usage_names.variable_type){case "NUMBER":f.common_usage_names.variable_type=B.aL;break;case "STRING":f.common_usage_names.variable_type=B.bL}break;case "PAGEPARAM":f.bools||(f.bools={});void 0===f.bools.hsh&&(f.bools.hsh=!1);f.floats||(f.floats={});void 0===f.floats.ptp&&(f.floats.ptp=0);break;case "PLAY_ANIM":c(f.objects_paths,{b4w_do_not_batch:!0});f.bools||(f.bools={});void 0===f.bools.env&&(f.bools.env=!1);(l=f.common_usage_names.param_anim_behavior)||
(l="FINISH_STOP");f.common_usage_names.param_anim_behavior=w.Ny(l);break;case "STOP_ANIM":f.bools||(f.bools={});void 0===f.bools.env&&(f.bools.env=!1);break;case "STRING":switch(f.common_usage_names.string_operation){case "JOIN":f.common_usage_names.string_operation=B.VK;break;case "FIND":f.common_usage_names.string_operation=B.UK;break;case "REPLACE":f.common_usage_names.string_operation=B.WK;break;case "SPLIT":f.common_usage_names.string_operation=B.XK;break;case "COMPARE":f.common_usage_names.string_operation=
B.TK}if("cnd"in f.floats)f.common_usage_names.condition=f.floats.cnd;else switch(f.common_usage_names.condition){case "GEQUAL":f.common_usage_names.condition=B.$C;break;case "LEQUAL":f.common_usage_names.condition=B.bD;break;case "GREATER":f.common_usage_names.condition=B.aD;break;case "LESS":f.common_usage_names.condition=B.cD;break;case "NOTEQUAL":f.common_usage_names.condition=B.dD;break;case "EQUAL":f.common_usage_names.condition=B.ZC}break;case "REDIRECT":void 0!=f.url&&(f.bools.url=!1,f.strings.url=
f.url);break;case "SET_CAMERA_MOVE_STYLE":switch(f.common_usage_names.camera_move_style){case "STATIC":f.common_usage_names.camera_move_style=B.vK;break;case "TARGET":f.common_usage_names.camera_move_style=B.wK;break;case "EYE":f.common_usage_names.camera_move_style=B.tK;break;case "HOVER":f.common_usage_names.camera_move_style=B.uK}break;case "ENTRYPOINT":f.bools||(f.bools={});void 0===f.bools.js&&(f.bools.js=!1);f.bools.js&&(f.mute=!0);break;case "JS_CALLBACK":for(n in f=f.common_usage_names.js_cb_params,
f)switch(f[n]){case "OBJECT":f[n]=B.xK;break;case "VARIABLE":f[n]=B.yK}}}}};b4w.module.__scenegraph=function(a,t){function e(a,b){var c=[];A.mh(a,function(b,d,g){-1<c.indexOf(g)?A.JT(a,b,d,g,B(g)):c.push(g)});A.ba(a,function(a,d){for(var g=0;g<d.$a.length;g++){var e=d.$a[g];b||d.type!=m.$d&&d.type!=m.ud&&d.type!=m.Dg||(e.Xd=!0);-1<c.indexOf(e)?d.$a[g]=B(e):c.push(e)}})}function c(a,c){A.ba(a,function(b,d){d.type==m.JC&&A.hk(a,b,function(a,b){if(b.type==m.bi)for(var c=0;c<b.$a.length;c++){var d=b.$a[c];d.ja=H.R;d.ma=H.R}});c||A.hk(a,b,function(a,b,c){"DEPTH"==c.from&&(c.Xd=
!0)})});A.ba(a,function(c){var d={};b(a,c,d);for(var g in d){c=d[g];for(var e=c[0],f=0;f<c.length;f++)if(c[f].ja==H.R){e=c[f];break}for(var h=c[0],f=0;f<c.length;f++)if(c[f].ma==H.R){h=c[f];break}for(var m=c[0],f=0;f<c.length;f++)if(!c[f].Xd){m=c[f];break}for(f=0;f<c.length;f++)c[f].ja=e.ja,c[f].ma=h.ma,c[f].Xd=m.Xd}})}function b(a,c,d){A.hk(a,c,function(c,g,e){e.active&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),b(a,c,d))});A.xl(a,c,function(a,b,c){c.active&&
(d[c.from]=d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=A.Ya(a,c);if(c.type==m.bi)for(var g=0;g<c.$a.length;g++){var e=c.$a[g];d[e.from].push(e)}}function f(a){var b=[m.bi,m.Dy,m.ht,m.$d,m.ud,m.Wp];V.Hb||b.push(m.MC);var c=A.kC(a),d=[];A.ba(c,function(a,g){for(var e=0;e<g.$a.length;e++){var f=g.$a[e];-1<b.indexOf(g.type)&&(f.zl=!0);var m=y(d,f,k(f));f.Ua=m;g.lh[e]=m}for(e=0;e<g.lh.length;e++)m=g.lh[e],u(d,m);A.xl(c,a,function(e,f,m){if(!m.Ua){if(-1<b.indexOf(g.type))m.zl=!0;else if((e=
q(c,a,m.from))&&m.active&&!m.Ua){h(d,e);m.Ua=e;return}e=y(d,m,k(m));m.Ua=e}});A.hk(c,a,function(a,b,c){u(d,c.Ua)});A.xl(c,a,function(a,b,c){c.Ua&&"NONE"==c.to&&u(d,c.Ua)})})}function k(a){var b=a.to,c=a.active,d=a.Ua;a.to="";a.active=!1;a.Ua=null;var g=U.fE(a);a.to=b;a.active=c;a.Ua=d;return g}function q(a,b,c){var d=null;A.hk(a,b,function(a,b,g){if(g.active&&g.from==g.to&&g.from==c&&g.Ua)return d=g.Ua,!0});A.xl(a,b,function(a,b,g){if(g.active&&g.from==c&&g.Ua)return d=g.Ua,!0});return d}function h(a,
b){for(var c=0;c<a.length;c++){var d=a[c];d.hC===b&&d.es++}}function u(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.hC===b&&d.es&&d.es--}}function y(a,b,c){if(b.Wm)return h(a,b.Wm.Ua),b.Wm.Ua;if(b.zl)return g(b);for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.es){d=f;break}}if(d&&!V.oF)return d.es++,d.hC;b=g(b);a.push({id:c,es:1,hC:b});return b}function g(a){var b=a.Xj*a.size,c=a.Yj*a.size,d=a.Xx,g=a.nh;switch(a.from){case "COLOR":return a.Xd?(d=H.Bk(a.Ii?H.mt:H.lt,d,g),H.resize(d,
b,c)):(d=H.Bk(H.rh,d,g),H.resize(d,b,c),H.KB(d,a.ja,a.ma)),d;case "DEPTH":return a.Xd?(d=H.Bk(a.Ii?H.kt:H.jt,d,g),H.resize(d,b,c)):(d=H.Bk(H.Kl,d,g),H.resize(d,b,c),H.KB(d,a.ja,a.ma)),d;case "CUBEMAP":return d=H.jO(b,g);case "SCREEN":case "NONE":return null;default:U.I("Wrong slink param: "+a.from)}}function d(a,b){var c=!1;A.mh(a,function(d,g,e){if(e&&(d=A.Ya(a,d),g=A.Ya(a,g),b(e,!1,d,g)))return c=!0});c||A.ba(a,function(a,c){for(var d=0;d<c.$a.length;d++)if(b(c.$a[d],!0,c,null))return!0})}function r(a){A.ba(a,
function(b,c){if(c.type!=m.$i){var d=c.F;A.xl(a,b,function(a,b,c){c.Ua&&c.active&&c.Ua&&(I.Ww(d,c.from,c.Ua),c.from==c.to&&b.F&&I.Ww(b.F,c.from,c.Ua))});for(var g=0;g<c.$a.length;g++){var e=c.$a[g];e.active&&e.from==e.to&&I.Ww(d,e.from,c.lh[g])}!d.hc&&!d.vf||d.Ve||(d.Ve=C.FT(d.hc,d.vf))}});A.ba(a,function(b,c){if(c.type==m.ft||c.type==m.uy){var d=v(a,c);c.F.hr=d[0].F.Ve}})}function p(a){var b=null,c=0;A.ba(a,function(a,d){if(d.type==O.zs){if(c==O.nV)return b=d,!0;c++}});return b}function M(a,b){var c=
A.Oj(a,b),d=m.Fc("NONE"),g=A.X(a,d),e=A.pr(a)[0];A.mh(a,function(b,c){c==e&&A.yT(a,b,e,b,g)});var f=E(b,a);A.mh(a,function(g,e,h){if(g==c){if(f){g=m.iu();A.X(a,g);e=l("COLOR","RESOLVE",1,1,1,!0,!0);e.Ii=!0;e.Xd=!0;var k=l("DEPTH","RESOLVE",1,1,1,!0,!0);k.Ii=!0;k.Xd=!0;A.H(a,b,g,e);A.H(a,b,g,k);b=g}A.H(a,b,d,l(O.QU,"u_color",h.size,h.Xj,h.Yj,h.kn,h.wt));return!0}});A.Ec(a,g,e,l("SCREEN","NONE",.5,.5,.5,!0,!0))}function E(a,b){var c=!1,d=A.Oj(b,a);A.rg(b,d)&&(c=A.Ug(b,d,0),d=A.Mc(b,d,c,0),"COLOR"==
d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=A.Ya(b,c),c=E(d,b)):c="RESOLVE"==d.to);return c}function z(a,b,c,d){for(var g=c.ha,e=b.yv,f=b.Qh.Mi,h=b.Qh.Fw,k=A.sl(a,A.aR(a,d),A.nk),n=[],p=[],r=[],k=A.clone(k,function(b){var d;if(-1<na.indexOf(b.type))p.push(b),d=b;else{d=m.UN(b);if(d.type==m.$d)for(var l=0;l<f.length;l++)if(f[l][0]==b){f[l]=[b,d];d.F.wc=b.F.wc;c.ha.push(d.F);break}if(b.type==m.Vf)for(l=0;l<f.length;l++){if(h[l][0]==b){h[l]=[b,d];d.F=f[l][1].F;break}}else-1<g.indexOf(b.F)&&
(e?(I.cw(b.F,I.hf),I.cw(d.F,I.Oe),d.qm=!0):(I.cw(b.F,I.Cc),I.cw(d.F,I.Jc)),g.push(d.F));var k=A.Oj(a,b);A.hk(a,k,function(a,b,c){-1<na.indexOf(b.type)&&n.push([b,d,c])});if(b.type!==m.bi)for(l=0;l<b.$a.length;l++)d.$a[l].Wm=b.$a[l];b=!0;for(l=0;l<A.zi(a,k);l++){var v=A.jg(a,k,l),v=A.Ya(a,v);-1==na.indexOf(v.type)&&(b=!1)}b&&r.push(d)}return d},function(a){var b=B(a,!0);b.Wm=a;return b}),v=0;v<p.length;v++)A.Hf(k,A.Oj(k,p[v]));A.iz(k);b=m.cP(e);v=A.X(a,b);if(V.Dv)var q=m.Fc("NONE"),u=l("COLOR","u_color",
1,1,1,!0,!0);else q=m.uz(),u=l("COLOR","COPY",1,1,1,!0,!0);u.ja=H.R;u.ma=H.R;A.X(a,q);A.H(a,d,q,u);var w=l("COLOR","u_sampler_left",1,1,1,!0,!0);w.zl=!0;w.ja=H.R;w.ma=H.R;A.H(a,q,b,w);if(!d.Wb){if(V.Dv)var w=m.Fc("NONE"),z=l("COLOR","u_color",1,1,1,!0,!0);else w=m.uz(),z=l("COLOR","COPY",1,1,1,!0,!0);A.X(k,w);z.Wm=u;var x=A.pr(k)[0],x=A.Ya(k,x);A.H(k,x,w,z)}w=l("COLOR","u_sampler_right",1,1,1,!0,!0);d.Wb&&(w.Wm=u);w.ja=H.R;w.ma=H.R;A.FD(k,a,[A.pr(k)[0],v,w]);for(v=0;v<n.length;v++)A.H(a,n[v][0],n[v][1],
n[v][2]);d=l("SCREEN","NONE",0,0,0,!1,!1);for(v=0;v<r.length;v++)A.H(a,q,r[v],d);A.mh(a,function(b,c,d){A.Ya(a,b).type===m.bi&&(d.Wm=null)});return b}function l(a,b,c,d,g,e,f){return{from:a,to:b,size:c,Xj:d,Yj:g,kn:e,wt:f,active:!0,Ua:null,Ii:!1,Xd:!1,ja:H.Xf,ma:H.Xf,zl:!1,Xx:!1,nh:!1}}function B(a,b){var c=l(a.from,a.to,a.size,a.Xj,a.Yj,a.kn,a.wt);c.active=a.active;!b&&a.Ua&&U.I("Failed to clone slink with attached texture");c.Ua=a.Ua;c.Ii=a.Ii;c.Xd=a.Xd;c.ja=a.ja;c.ma=a.ma;c.zl=a.zl;c.Xx=a.Xx;c.nh=
a.nh;return c}function w(a,b,c){if(b.type==c)return!0;b=D(a,b);for(var d=0;d<b.length;d++)if(w(a,b[d],c))return!0;return!1}function G(a,b,c){if(b.type==c)return!0;b=v(a,b);for(var d=0;d<b.length;d++)if(G(a,b[d],c))return!0;return!1}function v(a,b){var c=A.Oj(a,b);c==A.Cy&&U.I("Subscene not in graph");for(var d=[],g=A.zi(a,c),e=0;e<g;e++){var f=A.jg(a,c,e);f!=c&&d.push(A.Ya(a,f))}return d}function D(a,b){var c=A.Oj(a,b);c==A.Cy&&U.I("Subscene not in graph");for(var d=[],g=A.rg(a,c),e=0;e<g;e++){var f=
A.Ug(a,c,e);f!=c&&d.push(A.Ya(a,f))}return d}function F(a){var b=[],c=[];d(a,function(a){a.Ua&&-1==b.indexOf(a.Ua)&&(b.push(a.Ua),c.push(a.Ua,b.length-1))});return c}function n(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.kn){var d=a.Xj,g=a.Yj;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(g)!=g&&(g=g.toFixed(2));c=c+((1==d?"":d)+"Sx"+((1==g?"":g)+"S"))+(a.wt?" FACT":" VIEW")}else d=a.Xj,g=a.Yj,c+=a.size*d+"x"+a.size*g;if("SCREEN"!=a.from){c+=" ";if(a.Xd)c+="RR";else{var d=
a.ja,g=a.ma,e="";d==H.R?e+="L":d==H.Xf&&(e+="N");g==H.R?e+="L":g==H.Xf&&(e+="N");c+=e}for(d=0;d<b.length;d+=2)b[d]==a.Ua&&(c+=" "+b[d+1])}return c+")\\n"}var N=t("__batch"),I=t("__camera"),x=t("__config"),J=t("__debug"),A=t("__graph"),C=t("__renderer"),R=t("__shaders"),m=t("__subscene"),H=t("__textures"),U=t("__util"),O=x.im,V=x.K,ia=x.ap,na=[m.Zi,m.wd,m.ud,m.gf];a.GN=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;
default:return!0}};a.Px=d;a.yO=function(a,b,d,g){function h(c){var d=I.Kc(Ha,!0);b.ha.push(d);d=m.gm(c,d,!1,t,G,la,ka,ma,a.tl);A.X(k,d);c==m.Dg?(A.H(k,n[0],d,l("COLOR","COLOR",1,1,1,!0,!0)),d.$a.push(l("DEPTH","DEPTH",1,1,1,!0,!0))):(c=Ta&&n[0].type==m.ft?gb:n[0],A.H(k,gb,d,ja),A.H(k,c,d,Wa));Ea&&(A.H(k,Ea,d,qa),A.H(k,Ea,d,Ma));for(c=0;c<u.length;c++)A.H(k,u[c],d,w[c]);wc&&A.H(k,wc,d,cc);if(x.length){var g=x.length;for(c=0;c<g;c++)A.H(k,x[c],d,F[c])}if(C.length)for(c=0;c<C.length;c++)A.H(k,C[c],d,
y[c]);ec&&A.H(k,ec,d,Qc);return d}var k=A.create(),n=[],q=[],u=[],w=[],x=[],F=[],C=[],y=[],E=[],G=a.XR,t=a.sd,N=a.shore_smoothing,pa=a.SU,ga=a.ssao,va=a.god_rays,R=a.Qh,K=a.TG,T=a.$M,na=a.motion_blur,ea=a.compositing,da=a.antialiasing,ka=a.Il,la=a.VJ,ma=a.Zc,ha=a.FS,La=a.tN,L=a.kR,Xa=a.WS,Ba=a.dof,Q=a.qP,Da=a.refractions,ta=!!g.length,Ta=1<V.Zb,Wa=l("COLOR","COLOR",1,1,1,!0,!0),ja=l("DEPTH","DEPTH",1,1,1,!0,!0);if(Ta){var Aa=B(ja);Wa.Ii=!0;Wa.Xd=!0;ja.Ii=!0;ja.Xd=!0}var Ha=b.ha[0];if(a.Lc){var Ea=
m.RO();A.X(k,Ea);var Na=ia.qr;Ea.F.width=Na;Ea.F.height=Na;var qa=l("DEPTH","u_grass_map_depth",Na,1,1,!1,!1);V.Hb||(qa.ja=H.R,qa.ma=H.R);var Ma=l("COLOR","u_grass_map_color",Na,1,1,!1,!1);Ma.ja=H.R;Ma.ma=H.R}else Ma=qa=Ea=null;if(ma){I.xC(Ha,ma);for(var Ia=0;Ia<ma.Hh.length;Ia++)for(var ua=ma.csm_num,Fa=0;Fa<ua;Fa++){var ra=m.YO(Fa,Ia,ma,G);A.X(k,ra);u.push(ra);var Na=ma.csm_resolution,S=ra.F;b.uI.push(S);S.width=Na;S.height=Na;ra.yb=!0;var Ya=0<Ia?Ia:Fa;if(V.ks){w.push(l("COLOR","u_shadow_map"+
Ya,Na,1,1,!1,!1));var ab=l("DEPTH","DEPTH",Na,1,1,!1,!1);ab.Xd=!0;ra.$a.push(ab)}else{var Ga=l("DEPTH","u_shadow_map"+Ya,Na,1,1,!1,!1);V.Hq&&(Ga.ja=H.R,Ga.ma=H.R,Ga.Xx=!0);w.push(Ga);(J.AN()||V.vI)&&ra.$a.push(l("COLOR","COLOR",Na,1,1,!1,!1))}Ea&&(A.H(k,Ea,ra,qa),A.H(k,Ea,ra,Ma))}}if(R&&R.iH&&!ta)for(Fa=0;Fa<R.iH;Fa++){S=I.fd(I.Pc);S.width=a.si;S.height=a.si;I.dI(S,Math.PI/2,.1,100);I.set_projection(S,!1);var Ra=m.gm(m.ud,S,!1,t,G,la,ka,null,a.tl);Ra.sj=U.pQ();for(Ia=0;6>Ia;Ia++)Ra.hm.push(I.nO());
A.X(k,Ra);var Ob=l("CUBEMAP","u_cube_reflection",a.si,1,1,!1,!1);Ob.ja=H.R;Ob.ma=H.R;y.push(Ob);if(!R.jA){var Ib=l("CUBEMAP","u_cube_reflection",a.si,1,1,!1);Ib.nh=!0;Ib.ja=H.Zp;Ib.ma=H.R;E.push(Ib)}Ea&&(A.H(k,Ea,Ra,qa),A.H(k,Ea,Ra,Ma));if(R.XF){var Ua=m.gm(m.gf,S,!1,t,G,la,ka,null,a.tl);Ua.sj=Ra.sj;Ua.hm=Ra.hm;A.X(k,Ua);var Ka=l("DEPTH","DEPTH",a.si,1,1,!1,!1),zb=l("COLOR","COLOR",a.si,1,1,!1,!1);A.H(k,Ra,Ua,Ka);A.H(k,Ra,Ua,zb);C.push(Ua);R.xz.push(Ua);Ea&&(A.H(k,Ea,Ua,qa),A.H(k,Ea,Ua,Ma))}else{var hb=
l("DEPTH","DEPTH",a.si,1,1,!1,!1);Ra.$a.push(hb);C.push(Ra)}R.rj.push(Ra)}if(R&&0<R.HH.length&&!ta)for(Ia=0;Ia<R.HH.length;Ia++)S=I.Kc(Ha,!0),S.wc=new Float32Array(4),b.ha.push(S),Ra=m.gm(m.$d,S,!1,t,G,la,ka,null,a.tl),A.X(k,Ra),Ob=l("COLOR","u_plane_reflection",1,a.Ph,a.Ph,!0,!0),Ob.ja=H.R,Ob.ma=H.R,F.push(Ob),Ea&&(A.H(k,Ea,Ra,qa),A.H(k,Ea,Ra,Ma)),R.XF?(Ua=m.gm(m.Vf,S,!1,t,G,la,ka,null,a.tl),A.X(k,Ua),Ka=l("DEPTH","DEPTH",1,a.Ph,a.Ph,!0,!0),zb=l("COLOR","COLOR",1,a.Ph,a.Ph,!0,!0),zb.ja=H.Xf,zb.ma=
H.Xf,A.H(k,Ra,Ua,Ka),A.H(k,Ra,Ua,zb),R.Fw.push([Ua]),x.push(Ua),Ea&&(A.H(k,Ea,Ua,qa),A.H(k,Ea,Ua,Ma))):(hb=l("DEPTH","DEPTH",1,a.Ph,a.Ph,!0,!0),Ra.$a.push(hb),x.push(Ra)),R.Mi.push([Ra]);if(ma){var sb=I.Kc(Ha,!0);b.ha.push(sb);var vb=m.ZO(sb,G);A.X(k,vb);vb.self_shadow_normal_offset=ma.self_shadow_normal_offset;for(Fa=0;Fa<u.length;Fa++)ra=u[Fa],A.H(k,ra,vb,w[Fa]);if(ga){var fc=l("COLOR","u_color",1,1,1,!0,!0),Db=l("DEPTH","u_depth",1,1,1,!0,!0),Rc=I.Kc(Ha,!0);b.ha.push(Rc);var nb=a.gV,Va=m.aP(Rc,
la,nb);A.X(k,Va);var Pb=l("COLOR","u_ssao_mask",1,1,1,!0,!0);A.H(k,vb,Va,fc);A.H(k,vb,Va,Db);var Za=I.Kc(Ha,!0);b.ha.push(Za);var Eb=m.bP(Za,nb);A.X(k,Eb);var $c=l("COLOR","u_shadow_mask",1,1,1,!0,!0);A.H(k,Va,Eb,Pb);A.H(k,vb,Eb,Db)}Ta?Ga=l("DEPTH","DEPTH",1,1,1,!0,!0):V.ks?(Ga=l("DEPTH","DEPTH",1,1,1,!0,!0),Ga.Xd=!0):Ga=ja;vb.$a.push(Ga);Ea&&(A.H(k,Ea,vb,qa),A.H(k,Ea,vb,Ma))}else vb=null;var gb=m.gm(m.Nb,Ha,!0,t,G,la,ka,null,a.tl);A.X(k,gb);if(Ta){var Ab=m.iu();A.X(k,Ab);q.push(Ab);var ob=l("COLOR",
"RESOLVE",1,1,1,!0,!0);ob.Ii=!0;ob.Xd=!0;var Jb=l("DEPTH","RESOLVE",1,1,1,!0,!0);Jb.Ii=!0;Jb.Xd=!0;A.H(k,gb,Ab,ob);A.H(k,gb,Ab,Jb)}else q.push(gb);vb&&(Pb?A.H(k,Eb,gb,$c):ma?A.H(k,vb,gb,l("COLOR","u_shadow_mask",1,1,1,!0,!0)):U.I("Internal error"));Ea&&(A.H(k,Ea,gb,qa),A.H(k,Ea,gb,Ma));if(x.length)for(var Bb=x.length,Ia=0;Ia<Bb;Ia++)A.H(k,x[Ia],gb,F[Ia]);if(C.length)for(Ia=0;Ia<C.length;Ia++)A.H(k,C[Ia],gb,y[Ia]);n=q;q=[];if(!ta&&a.VN){var Qb=O.enabled&&(O.zs===m.Ne||O.zs===m.oh),S=I.Kc(Ha,!0);Qb||
(S.width=S.height=1);b.ha.push(S);var Mb=m.QE(S,!1,G);A.X(k,Mb);if(a.ai){S=I.Kc(Ha,!0);Qb||(S.width=S.height=1);b.ha.push(S);var Gb=m.QE(S,!0,G);A.X(k,Gb);A.H(k,Mb,Gb,l("COLOR","COLOR",1,1,1,Qb,!0));A.H(k,Mb,Gb,l("DEPTH","DEPTH",1,1,1,Qb,!0))}}else Mb=null;if(!K.refractions&&!Da||ta)ec=null;else{if(Ta)ec=Ab;else{if(V.Dv)var ec=m.Fc("NONE"),Sc=l("COLOR","u_color",1,1,1,!0,!0);else ec=m.uz(),Sc=l("COLOR","COPY",1,1,1,!0,!0);A.X(k,ec);A.H(k,n[0],ec,Sc)}var Qc=l("COLOR","u_refractmap",1,1,1,!0,!0)}if(Q&&
(Da||N||pa)){var Hc=I.Kc(Ha,!0);b.ha.push(Hc);var wc=m.OO(Hc);A.X(k,wc);A.H(k,Ta?Ab:gb,wc,l("DEPTH","u_depth",1,1,1,!0,!0));var cc=l("COLOR","u_scene_depth",1,1,1,!0,!0);cc.ja=H.Xf;cc.ma=H.Xf}else wc=null;if(a.kv){var Bc=h(m.bd);q.push(Bc);n=q;q=[]}if(a.glow_materials){var Ad=I.Kc(Ha,!0);b.ha.push(Ad);var kb=m.gm(m.Zd,Ad,!1,t,G,la,ka);A.X(k,kb);wc&&A.H(k,wc,kb,cc);ec&&A.H(k,ec,kb,Qc);Ea&&(A.H(k,Ea,kb,qa),A.H(k,Ea,kb,Ma));if(x.length)for(Bb=x.length,Ia=0;Ia<Bb;Ia++)A.H(k,x[Ia],kb,F[Ia]);if(C.length)for(Ia=
0;Ia<C.length;Ia++)A.H(k,C[Ia],kb,y[Ia]);a.kv&&A.H(k,kb,Bc,l("SCREEN","NONE",0,0,0,!1,!1));A.H(k,Ta?Ab:gb,kb,Ta?Aa:ja);var ib=m.Fc("X_GLOW_BLUR");ib.zb="GLOW_MASK_SMALL";ib.Ie=a.xi.small_glow_mask_width;var Cb=l("COLOR","u_color",1,1,1,!0,!0);Cb.ja=H.R;Cb.ma=H.R;A.X(k,ib);A.H(k,kb,ib,Cb);var fb=m.Fc("Y_GLOW_BLUR");fb.zb="GLOW_MASK_SMALL";fb.Ie=a.xi.small_glow_mask_width;var gc=l("COLOR","u_color",1,.5,.5,!0,!0);gc.ja=H.R;gc.ma=H.R;A.X(k,fb);A.H(k,ib,fb,gc);var lb=m.Fc("X_GLOW_BLUR");lb.zb="GLOW_MASK_LARGE";
lb.Ie=a.xi.large_glow_mask_width;var Ic=l("COLOR","u_color",1,.5,.5,!0,!0);Ic.ja=H.R;Ic.ma=H.R;A.X(k,lb);A.H(k,fb,lb,Ic);var Tc=m.Fc("Y_GLOW_BLUR");Tc.zb="GLOW_MASK_LARGE";Tc.Ie=a.xi.large_glow_mask_width;var Jc=l("COLOR","u_color",1,.25,.25,!0,!0);Jc.ja=H.R;Jc.ma=H.R;A.X(k,Tc);A.H(k,lb,Tc,Jc);var ad=I.Kc(Ha,!0);b.ha.push(ad);var lc=m.PO(ad,a);A.X(k,lc);var bd=l("COLOR","u_src_color",1,1,1,!0,!0);bd.ja=H.R;bd.ma=H.R;if(a.kv)if(Ta){var Uc=m.iu();A.X(k,Uc);A.H(k,Bc,Uc,ob);A.H(k,Bc,Uc,Jb);A.H(k,Uc,lc,
bd)}else A.H(k,Bc,lc,bd);else A.H(k,Ta?Ab:gb,lc,bd);var mc=l("COLOR","u_glow_mask_small",1,.5,.5,!0,!0);mc.ja=H.R;mc.ma=H.R;A.H(k,fb,lc,mc);var cd=l("COLOR","u_glow_mask_large",1,.25,.25,!0,!0);cd.ja=H.R;cd.ma=H.R;A.H(k,Tc,lc,cd);n=[lc];q=[]}a.kv||(Bc=h(m.bd),q.push(Bc),n=q,q=[]);if(V.debug_view){S=I.Kc(Ha,!0);b.ha.push(S);var tb=m.NO(S);q.push(tb);A.X(k,tb);A.H(k,n[0],tb,Wa);A.H(k,n[0],tb,ja);Ea&&(A.H(k,Ea,tb,qa),A.H(k,Ea,tb,Ma));J.jU(tb);n=q;q=[]}if(Ta){var rc=m.iu();A.X(k,rc);q.push(rc);A.H(k,
n[0],rc,ob);A.H(k,n[0],rc,Jb);n=q;q=[]}var Vc=n.slice(0);if(!ta&&a.lM){S=I.Kc(Ha,!0);b.ha.push(S);var sc=m.JO(S);A.X(k,sc);A.H(k,n[0],sc,Ta?Aa:ja)}if(va&&Q&&!ta){var Fb=L.Vk,Rb=L.intensity,mb=L.ql,Sa=n[0],Xb=t?!0:!1,dd=l("DEPTH","u_input",1,1,1,!0,!0),Wc=l("COLOR","u_input",1,.25,.25,!0,!0);Wc.ja=H.R;Wc.ma=H.R;var ic=Fb/mb,Kc=I.Kc(Ha,!0);b.ha.push(Kc);var Sb=m.vz(Kc,Xb,Fb,!0,ic,G,mb);A.X(k,Sb);A.H(k,Sa,Sb,dd);var ic=Fb/mb*.5,Lc=I.Kc(Ha,!0);b.ha.push(Lc);var nc=m.vz(Lc,Xb,Fb,!1,ic,G,mb);A.X(k,nc);
A.H(k,Sb,nc,Wc);var ic=Fb/mb*.25,Mc=I.Kc(Ha,!0);b.ha.push(Mc);var Tb=m.vz(Mc,Xb,Fb,!1,ic,G,mb);A.X(k,Tb);A.H(k,nc,Tb,Wc);var Hb=m.QO(Rb,G);q.push(Hb);A.X(k,Hb);var pb=l("COLOR","u_main",1,1,1,!0,!0);pb.ja=H.R;pb.ma=H.R;A.H(k,Sa,Hb,pb);var oc=l("COLOR","u_god_rays",1,1,1,!0,!0);oc.ja=H.R;oc.ma=H.R;A.H(k,Tb,Hb,oc);n=q;q=[]}if(T&&!ta){var Sa=n[0],jb=m.SO();A.X(k,jb);pb=l("COLOR","u_input",1,1,1,!0,!0);pb.ja=H.R;pb.ma=H.R;A.H(k,Sa,jb,pb);var Xc=T.key,ed=T.edge_lum,Nc=I.Kc(Ha,!0);b.ha.push(Nc);var wb=
m.TO(Xc,ed,G,Nc);A.X(k,wb);var xb=l("COLOR","u_luminance",1,.25,.25,!0,!0);xb.ja=H.R;xb.ma=H.R;if(T.adaptive){var Ub=m.KO();A.X(k,Ub);Ub.F.width=1;Ub.F.height=1;var Yb=l("COLOR","u_input",1,.25,.25,!0,!0);Yb.nh=!0;Yb.ja=H.Zp;Yb.ma=H.R;if(V.Hb)xb.nh=!0,xb.ja=H.Zp,A.H(k,jb,Ub,Yb);else{var Kb=m.AO(),jc=l("COLOR","u_color",1,.25,.25,!0,!0);A.X(k,Kb);A.H(k,jb,Kb,jc);A.H(k,Kb,Ub,Yb)}A.H(k,Ub,wb,l("COLOR","u_average_lum",1,1,1,!1,!1));wb.Ol=!0}else wb.Ol=!1,wb.average_luminance=T.average_luminance;A.H(k,
Sa,wb,l("COLOR","u_main",1,1,1,!0,!0));A.H(k,jb,wb,xb);for(var Lb=wb,ub=1,Pa=[],Fa=0;5>Fa;Fa++)ib=m.Fc("X_BLOOM_BLUR"),ib.Ie=a.xi.small_glow_mask_width,Cb=l("COLOR","u_color",1,ub,ub,!0,!0),Cb.ja=H.R,Cb.ma=H.R,A.X(k,ib),A.H(k,Lb,ib,Cb),ub/=2,fb=m.Fc("Y_BLOOM_BLUR"),fb.Ie=a.xi.small_glow_mask_width,gc=l("COLOR","u_color",1,ub,ub,!0,!0),gc.ja=H.R,gc.ma=H.R,A.X(k,fb),A.H(k,ib,fb,gc),Lb=fb,fb.Kn=ub,ib.Kn=ub,Pa.push(fb,ub);var Zb=m.LO(T.blur);A.X(k,Zb);for(Fa=0;Fa<Pa.length;Fa+=2){var fb=Pa[Fa],Nb=Pa[Fa+
1],mc=l("COLOR","u_bloom_level_"+(Fa/2).toString(),1,Nb,Nb,!0,!0);mc.ja=H.R;mc.ma=H.R;A.H(k,fb,Zb,mc)}A.H(k,Sa,Zb,l("COLOR","u_main",1,1,1,!0,!0));q.push(Zb);n=q;q=[]}if(Ba&&Q&&!ta){var Sa=n[0],bb=I.Kc(Ha,!0);b.ha.push(bb);if(d.dof_bokeh){var $a=l("COLOR","u_color",1,1,1,!0,!0);$a.ja=H.R;$a.ma=H.R;var $b=l("DEPTH","u_depth",1,1,1,!0,!0),kc=l("COLOR","u_color",1,.5,.5,!0,!0);kc.ja=H.Xf;kc.ma=H.Xf;var Cc=l("COLOR","u_color",1,.5,.5,!0,!0);Cc.ja=H.Xf;Cc.ma=H.Xf;var Yc=l("COLOR","u_blurred1",1,.5,.5,
!0,!0);Yc.ja=H.R;Yc.ma=H.R;var xc=l("COLOR","u_blurred2",1,.5,.5,!0,!0);xc.ja=H.R;xc.ma=H.R;var tc=Vc[0];if(d.Jd){var qb=I.Kc(Ha,!0);b.ha.push(qb);var yc=m.sz(qb,"COC_FOREGROUND");qb.dof_distance=d.dof_distance;qb.dof_object=d.dof_object;qb.dof_front_start=d.dof_front_start;qb.dof_front_end=d.dof_front_end;qb.dof_rear_start=d.dof_rear_start;qb.dof_rear_end=d.dof_rear_end;qb.dof_power=d.dof_power;qb.dof_bokeh=d.dof_bokeh;qb.dof_bokeh_intensity=d.dof_bokeh_intensity;qb.Jd=d.Jd;qb.dof_on=!0;A.X(k,yc);
A.H(k,Sa,yc,$a);A.H(k,tc,yc,$b);var fd=m.Fc("X_ALPHA_BLUR");A.X(k,fd);A.H(k,yc,fd,kc);var Zc=m.Fc("Y_ALPHA_BLUR");A.X(k,Zc);A.H(k,fd,Zc,Cc);var cb=I.Kc(Ha,!0),Vb=m.sz(cb,"COC_COMBINE");b.ha.push(cb);cb.dof_distance=d.dof_distance;cb.dof_object=d.dof_object;cb.dof_front_start=d.dof_front_start;cb.dof_front_end=d.dof_front_end;cb.dof_rear_start=d.dof_rear_start;cb.dof_rear_end=d.dof_rear_end;cb.dof_power=d.dof_power;cb.dof_bokeh=d.dof_bokeh;cb.dof_bokeh_intensity=d.dof_bokeh_intensity;cb.Jd=d.Jd;cb.dof_on=
!0;A.X(k,Vb);A.H(k,Sa,Vb,$a);A.H(k,tc,Vb,$b);A.H(k,Zc,Vb,l("COLOR","u_coc_fg",1,.5,.5,!0,!0))}else cb=I.Kc(Ha,!0),b.ha.push(cb),Vb=m.sz(cb,"COC_ALL"),cb.dof_distance=d.dof_distance,cb.dof_object=d.dof_object,cb.dof_front_start=d.dof_front_start,cb.dof_front_end=d.dof_front_end,cb.dof_rear_start=d.dof_rear_start,cb.dof_rear_end=d.dof_rear_end,cb.dof_power=d.dof_power,cb.dof_bokeh=d.dof_bokeh,cb.dof_bokeh_intensity=d.dof_bokeh_intensity,cb.Jd=d.Jd,cb.dof_on=!0,A.X(k,Vb),A.H(k,Sa,Vb,$a),A.H(k,tc,Vb,
$b);var ac=m.Fc("X_DOF_BLUR");ac.F.dof_bokeh_intensity=d.dof_bokeh_intensity;A.X(k,ac);A.H(k,Vb,ac,kc);var bc=m.Fc("Y_DOF_BLUR");bc.F.dof_bokeh_intensity=d.dof_bokeh_intensity;A.X(k,bc);A.H(k,ac,bc,Cc);var Dc=m.Fc("Y_DOF_BLUR");Dc.F.dof_bokeh_intensity=d.dof_bokeh_intensity;A.X(k,Dc);A.H(k,ac,Dc,Cc);var Wb=m.RE(bb);bb.dof_distance=d.dof_distance;bb.dof_object=d.dof_object;bb.dof_front_start=d.dof_front_start;bb.dof_front_end=d.dof_front_end;bb.dof_rear_start=d.dof_rear_start;bb.dof_rear_end=d.dof_rear_end;
bb.dof_power=d.dof_power;bb.dof_bokeh=d.dof_bokeh;bb.dof_bokeh_intensity=d.dof_bokeh_intensity;bb.Jd=d.Jd;bb.dof_on=!0;q.push(Wb);A.X(k,Wb);A.H(k,Sa,Wb,l("COLOR","u_sharp",1,1,1,!0,!0));A.H(k,bc,Wb,Yc);A.H(k,Dc,Wb,xc)}else{var nd=l("COLOR","u_color",1,1,1,!0,!0);nd.ja=H.R;nd.ma=H.R;var db=l("COLOR","u_color",1,1,1,!0,!0);db.ja=H.R;db.ma=H.R;ac=m.Fc("X_BLUR");A.X(k,ac);A.H(k,Sa,ac,nd);var eb=m.Fc("Y_BLUR");A.X(k,eb);A.H(k,ac,eb,db);var Bd=Vc[0],Wb=m.RE(bb);bb.dof_distance=d.dof_distance;bb.dof_object=
d.dof_object;bb.dof_front_start=d.dof_front_start;bb.dof_front_end=d.dof_front_end;bb.dof_rear_start=d.dof_rear_start;bb.dof_rear_end=d.dof_rear_end;bb.dof_power=d.dof_power;bb.dof_bokeh=d.dof_bokeh;bb.dof_bokeh_intensity=d.dof_bokeh_intensity;bb.Jd=d.Jd;bb.dof_on=!0;q.push(Wb);A.X(k,Wb);A.H(k,Sa,Wb,l("COLOR","u_sharp",1,1,1,!0,!0));A.H(k,eb,Wb,l("COLOR","u_blurred",1,1,1,!0,!0));A.H(k,Bd,Wb,l("DEPTH","u_depth",1,1,1,!0,!0))}n=q;q=[]}if(a.ai){var Oc=h(m.Dg);q.push(Oc);n=q;q=[]}if(na&&!ta){var uc=
n[0],td=m.UO(ha.mb_decay_threshold,ha.mb_factor);q.push(td);A.X(k,td);A.H(k,uc,td,l("COLOR","u_mb_tex_curr",1,1,1,!0,!0));td.$a.push(l("COLOR","u_mb_tex_accum",1,1,1,!0,!0));n=q;q=[]}if(!ta&&a.outline){var Sa=n[0],Qd=I.Kc(Ha,!0);b.ha.push(Qd);var Cd=m.WO(Qd,G);A.X(k,Cd);var gd=m.Fc("X_EXTEND"),Dd=l("COLOR","u_color",1,1,1,!0,!0),ud=l("COLOR","u_outline_mask",1,1,1,!0,!0);ud.ja=H.R;ud.ma=H.R;gd.Fm=!0;A.X(k,gd);A.H(k,Cd,gd,Dd);var Ed=l("COLOR","u_color",1,.5,.5,!0,!0);Ed.ja=H.R;Ed.ma=H.R;var zc=m.Fc("Y_EXTEND");
zc.Fm=!0;A.X(k,zc);A.H(k,gd,zc,Ed);ac=m.Fc("X_BLUR");ac.Fm=!0;A.X(k,ac);A.H(k,zc,ac,Ed);var hd=l("COLOR","u_color",1,.25,.25,!0,!0);hd.ja=H.R;hd.ma=H.R;var hc=l("COLOR","u_outline_mask_blurred",1,.25,.25,!0,!0);hc.ja=H.R;hc.ma=H.R;eb=m.Fc("Y_BLUR");eb.Fm=!0;A.X(k,eb);A.H(k,ac,eb,hd);var Ec=m.VO(Xa);A.X(k,Ec);var Id=l("COLOR","u_outline_src",1,1,1,!0,!0);Id.ja=H.R;Id.ma=H.R;A.H(k,Sa,Ec,Id);A.H(k,Cd,Ec,ud);A.H(k,eb,Ec,hc);q.push(Ec);n=q;q=[]}e(k,Q);if((a.anaglyph_use||a.yv)&&!ta){var Jd=z(k,a,b,n[0]);
q.push(Jd);n=q;q=[]}if(ea&&!ta){var Sa=n[0],Ac=m.MO(La.brightness,La.contrast,La.exposure,La.saturation),od=l("COLOR","u_color",1,1,1,!0,!0);od.ja=H.R;od.ma=H.R;!a.anaglyph_use&&!a.yv||ta||(od.zl=!0);A.X(k,Ac);A.H(k,Sa,Ac,od);q.push(Ac);n=q;q=[]}if(!n[0].Wb||n[0].type==m.bi||n[0].type==m.ft){var vd=m.Fc("NONE");A.X(k,vd);var id=l("COLOR","u_color",1,1,1,!0,!0);id.ja=H.R;id.ma=H.R;A.H(k,n[0],vd,id);q.push(vd);n=q;q=[]}if(da){Sa=n[0];if(V.smaa){var jd=l("COLOR","u_color",1,1,1,!0,!1);jd.ja=H.R;jd.ma=
H.R;var pd=m.wz(m.gt,a);A.X(k,pd);A.H(k,Sa,pd,jd);var kd=m.wz(m.Yp,a);A.X(k,kd);A.H(k,pd,kd,jd);var wd=l("COLOR","u_search_tex",1,1,1,!1,!1),xd=l("COLOR","u_area_tex",1,1,1,!1,!1);wd.ja=H.R;wd.ma=H.R;xd.ja=H.R;xd.ma=H.R;kd.$a.push(wd);kd.$a.push(xd);var qd=m.wz(m.ht,a);A.X(k,qd);A.H(k,Sa,qd,jd);var Kd=l("COLOR","u_blend",1,1,1,!0,!1);Kd.ja=H.R;Kd.ma=H.R;A.H(k,kd,qd,Kd);q.push(qd)}else{var pc=m.IO(a);A.X(k,pc);var rd=l("COLOR","u_color",1,1,1,!0,!1);rd.ja=H.R;rd.ma=H.R;!a.anaglyph_use&&!a.yv||ta||
(rd.zl=!0);A.H(k,Sa,pc,rd);q.push(pc)}n=q;q=[]}q.push(n[0]);Mb&&(Gb?q.push(Gb):q.push(Mb));sc&&q.push(sc);Na=1;if(a.jx.KH){var Ld=a.jx,vc=a.Il,yb=vc.cn,Na=yb?yb.WI:Na,Md=m.$O(vc,G,Ld,Na);A.X(k,Md);q.push(Md)}var Fc=m.SE();A.X(k,Fc);for(Fa=0;Fa<q.length;Fa++){var qc=q[Fa];switch(qc.type){case m.Ne:case m.oh:A.H(k,qc,Fc,l("COLOR","NONE",1,1,1,Qb,!1));A.H(k,qc,Fc,l("DEPTH","NONE",1,1,1,Qb,!1));break;case m.qe:A.H(k,qc,Fc,l("CUBEMAP","u_sky",Na,1,1,!1));for(Ia=0;Ia<E.length;Ia++)A.H(k,qc,gb,E[Ia]),Bc&&
A.H(k,qc,Bc,E[Ia]),kb&&A.H(k,qc,kb,E[Ia]),Oc&&A.H(k,qc,Oc,E[Ia]);break;case m.zn:A.H(k,qc,Fc,l("COLOR","NONE",1,1,1,!0,!1));break;default:if(ta){var Nd=g[0],ld=l("COLOR","OFFSCREEN",1,1,1,!0,!0);ld.Ua=Nd;A.H(k,q[Fa],Fc,ld);for(Ia=1;Ia<g.length;Ia++){var sd=g[Ia],md=m.Fc("NONE");A.X(k,md);A.H(k,q[Fa],md,l("COLOR","SCALE",1,1,1,!0,!0));var Od=sd.Zj/Nd.Zj,ld=l("COLOR","OFFSCREEN",1,Od,Od,!0,!0);ld.Ua=sd;A.H(k,md,Fc,ld)}}else A.H(k,q[Fa],Fc,l("SCREEN","NONE",1,1,1,!0,!1))}}Ab&&!D(k,Ab).length&&(A.Hf(k,
A.Oj(k,Ab)),A.iz(k));e(k,Q);c(k,Q);if(O.enabled){var Fd=p(k);Fd&&M(k,Fd)}f(k);r(k);ma&&A.ba(k,function(a,b){if(b.type==m.Wf||b.type==m.bd||b.type==m.Dg){for(var c=0,d=v(k,b),g=0,e=0;e<d.length;e++){var f=d[e];f.type==m.wd&&(g++,b.Qj=b.Qj||[],b.Qj[0<f.vg?f.vg:c]=f.F.wb,c++)}b.Hp&&b.Gp||(V.$v?b.Ts=new Float32Array(9*g):(b.Hp=new Float32Array(4*g),b.Gp=new Float32Array(4*g)))}});if(!R.jA)for(Fa=0;Fa<y.length;Fa++)y[Fa].active=!1;return k};a.LS=function(a,b,c){var d=[];A.ba(a,function(b,c){if(-1==na.indexOf(c.type)&&
c.$a.length&&w(a,c,m.Eg))for(var g=0;g<c.$a.length;g++){var e=c.$a[g];-1==d.indexOf(e)&&d.push(e)}});A.mh(a,function(b,c,g){b=A.Ya(a,b);c=A.Ya(a,c);-1==na.indexOf(b.type)&&w(a,c,m.Eg)&&-1==d.indexOf(g)&&d.push(g)});for(var g=0;g<d.length;g++)d[g].Xj*=b,d[g].Yj*=c};a.Sd=function(a,b,c){var d=a.Ie;a.Bs[0]=b*a.Fb[0]*d;a.Bs[1]=c*a.Fb[1]*d};a.od=function(a,b){a.Ie=b};a.xO=function(){var a=A.create(),b=m.XO(),c=I.fd(I.Bc);c.width=512;c.height=512;b.F=c;A.X(a,b);b.$a.push(l("COLOR","u_color",512,1,1,!1,
!1));c=m.SE();A.X(a,c);A.H(a,b,c,l("COLOR","NONE",512,1,1,!1,!1));f(a);r(a);return a};a.WP=function(a){var b=null;A.ba(a,function(a,c){return c.F&&null===c.F.Ve?(b=c,!0):!1});return b};a.Tc=function(a,b,c){a=v(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.dv=function(a,b,c){a=v(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.PY=w;a.RY=G;a.XQ=v;a.cR=D;a.jc=function(a,b){var c=null;A.ba(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.lP=
function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=F(a);A.ba(a,function(a,d){var g=b+="    ",e=m.Cx(d);if(d.F){for(var e=e+"\\n",f=0;f<c.length;f+=2){var h=d.F.hc;c[f]==h&&(e=H.yo(h)?e+("CR"+c[f+1]+" "):e+("C"+c[f+1]+" "))}for(f=0;f<c.length;f+=2)h=d.F.vf,c[f]==h&&(e=H.yo(h)?e+("DR"+c[f+1]):e+("D"+c[f+1]))}d.$a.length&&(e+="\\n-----\\n");for(f=0;f<d.$a.length;f++)e+=n(d.$a[f],c);
b=g+(String(a)+' [label="'+e+'" color="black" style="'+((d.type==m.$i?"dotted":d.enqueue?"solid":"dashed")+",bold")+'"];\n')});A.mh(a,function(a,d,g){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+n(g,c)+'" style="'+(g.active?"solid":"dotted")+'"];\n'});return b+="}"};a.zO=function(a){a=A.qV(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b};a.dm=function(a,b,c){var d=A.Oj(a,b);A.hk(a,d,function(a,b,d){if(d.active){switch(d.from){case "COLOR":case "CUBEMAP":var g=b.F.hc;
break;case "DEPTH":g=b.F.vf;break;case "SCREEN":g=null;break;case m.ud:return;default:U.I("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;default:g||U.I("Connection of SCREEN is forbidden"),g.ef&&U.I("Batch texture can't use renderbuffer"),R.rE(c.pb,d.to)&&N.rk(c,g,d.to)}}});for(a=0;a<b.$a.length;a++){var d=b.$a[a],g=b.lh[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;
default:g.ef&&U.I("Batch texture can't use renderbuffer"),R.rE(c.pb,d.to)&&N.rk(c,g,d.to)}}}};b4w.module.__subscene=function(a,t){function e(a,b){a.Po=b;a.Gr=new Float32Array(3*b);a.Km=new Float32Array(4*b);a.Jm=new Float32Array(4*b)}function c(a){a={type:a,zb:"",qm:!1,rb:!1,Aw:!1,iq:!1,Jo:!1,Un:0,uf:0,Dk:[],debug_view_mode:0,debug_colors_seed:0,pu:1,Wq:!1,time:0,F:null,sj:null,hm:[],Xa:[],$a:[],lh:[],Zh:new Float32Array(3),jd:new Float32Array(3),Kd:new Float32Array(4),zf:new Float32Array(4),tf:new Float32Array(16),hp:0,gg:0,Po:0,Gr:null,Km:null,Jm:null,HG:null,Ld:new Float32Array(3),Yd:new Float32Array(3),
ip:new Float32Array(4),Ex:new Float32Array(3),Dx:new Float32Array([0,0,1]),Fx:new Float32Array(4),gp:new Float32Array(3),ix:"",Mt:0,Um:0,Xq:0,Fm:!1,Mh:new Float32Array(3),Qf:!1,vq:0,Yh:new Float32Array(4),Wi:0,cg:!1,mj:0,Qt:new Float32Array(2),lj:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,pl:new Float32Array(3),
mp:!1,jp:!1,kp:0,op:0,np:0,lp:0,fn:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Vk:0,Xo:0,ql:0,Pq:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Hp:null,Gp:null,Ts:null,Qj:null,Wb:!1,Vu:"",Mn:0,Jn:0,Ln:0,Ol:!0,average_luminance:0,qq:0,dr:0,mb_decay_threshold:0,mb_factor:0,iw:0,Zr:"",Xt:"",zA:new Float32Array(2),Qv:0,It:2,Kn:.5,small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Bs:new Float32Array(2),
Fb:new Float32Array(2),uj:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,vg:0,Mr:!0,hx:!1,px:!1,lx:!1,mx:!1,ox:!1,nx:!1,gx:"",mn:!1,nn:!1,on:!1,dc:!0,enqueue:!0,yb:!0,Bb:!0,Id:!0,Ka:!0,Ie:1};a.Fb[0]=1;a.Fb[1]=1;a.uj[2]=.5;a.uj[3]=.5;a.fn=8;return a}function b(a,b){return a==b?0:a>b?1:-1}function f(a,c){return b(a.kf,c.kf)||b(a.Ej,c.Ej)||b(a.md,c.md)||b(a.pb.ZF,c.pb.ZF)||b(a.pb.PB,c.pb.PB)}var k=t("__camera"),q=t("__config"),h=t("__util"),u=t("__boundings"),
y=q.Yc;a.Nb=0;a.bd=1;a.Dg=2;a.$d=3;a.ud=4;a.Vf=5;a.gf=6;a.Zd=7;a.wd=8;a.Wf=9;a.Zi=10;a.bc=11;a.Up=13;a.ft=14;a.Ne=15;a.oh=16;a.ph=17;a.zn=18;a.OC=19;a.it=20;a.Fy=21;a.JC=22;a.Yp=23;a.gt=24;a.Dy=25;a.ht=26;a.ty=27;a.bi=28;a.sy=29;a.Tp=30;a.qh=31;a.Cn=32;a.Bn=33;a.bt=34;a.qe=35;a.uy=36;a.Eg=37;a.LUMINANCE=38;a.MC=39;a.dt=40;a.Pp=41;a.aM=42;a.$i=43;a.Wp=44;a.jD=45;a.YO=function(a,b,f,h){var d=c(8);d.Pq=a;d.self_shadow_polygon_offset=f.self_shadow_polygon_offset;d.vg=b;switch(f.Hh[b]){case "SPOT":case "POINT":d.F=
k.fd(k.Pc);k.dI(d.F,f.EI[b],f.Cq[b],f.Bq[b]);break;default:d.F=k.fd(k.aj)}e(d,h);return d};a.UN=function(a){var b=c(a.type);b.zb=a.zb;b.qm=a.qm;b.dc=a.dc;b.enqueue=a.enqueue;b.yb=a.yb;b.Bb=a.Bb;b.Id=a.Id;b.rb=a.rb;b.Aw=a.Aw;b.iq=a.iq;b.Jo=a.Jo;b.Ka=a.Ka;b.Un=0;b.uf=0;b.Dk=[];b.debug_view_mode=a.debug_view_mode;b.debug_colors_seed=a.debug_colors_seed;b.pu=a.pu;b.Wq=a.Wq;b.time=a.time;b.F=k.Kc(a.F,!0);b.sj=h.V(a.sj);b.hm=h.V(a.hm);b.Xa=h.V(a.Xa);b.$a=h.V(a.$a);b.lh=h.V(a.lh);b.Zh.set(a.Zh);b.jd.set(a.jd);
b.Kd.set(a.Kd);b.zf.set(a.zf);b.tf.set(a.tf);b.hp=a.hp;b.gg=a.gg;b.Po=a.Po;b.Gr=h.V(a.Gr);b.Km=h.V(a.Km);b.Jm=h.V(a.Jm);b.HG=h.V(a.HG);b.Ld.set(a.Ld);b.Yd.set(a.Yd);b.ip.set(a.ip);b.Ex.set(a.Ex);b.Dx.set(a.Dx);b.Fx.set(a.Fx);b.gp.set(a.gp);b.ix=a.ix;b.Mt=a.Mt;b.Um=a.Um;b.Xq=a.Xq;b.Fm=a.Fm;b.Mh.set(a.Mh);b.Qf=a.Qf;b.vq=a.vq;b.Yh.set(a.Yh);b.Wi=a.Wi;b.cg=a.cg;b.mj=a.mj;b.Qt.set(a.Qt);b.lj=a.lj;b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.mie_brightness=
a.mie_brightness;b.rayleigh_brightness=a.rayleigh_brightness;b.spot_brightness=a.spot_brightness;b.mie_strength=a.mie_strength;b.rayleigh_strength=a.rayleigh_strength;b.scatter_strength=a.scatter_strength;b.mie_collection_power=a.mie_collection_power;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_distribution=a.mie_distribution;b.pl.set(a.pl);b.mp=a.mp;b.jp=a.jp;b.kp=a.kp;b.op=a.op;b.np=a.np;b.lp=a.lp;b.fn=a.fn;b.ssao_only=a.ssao_only;b.ssao_white=a.ssao_white;b.brightness=a.brightness;
b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;b.god_rays_intensity=a.god_rays_intensity;b.Vk=a.Vk;b.Xo=a.Xo;b.ql=a.ql;b.Pq=a.Pq;b.self_shadow_polygon_offset=a.self_shadow_polygon_offset;b.self_shadow_normal_offset=a.self_shadow_normal_offset;b.Hp=h.V(a.Hp);b.Gp=h.V(a.Gp);b.Ts=h.V(a.Ts);b.Qj=h.V(a.Qj);b.Wb=a.Wb;b.Vu=a.Vu;b.Mn=a.Mn;b.Jn=a.Jn;b.Ln=a.Ln;b.Ol=a.Ol;b.average_luminance=a.average_luminance;b.qq=a.qq;b.dr=a.dr;b.mb_decay_threshold=a.mb_decay_threshold;b.mb_factor=a.mb_factor;
b.iw=a.iw;b.Zr=a.Zr;b.Xt=a.Xt;b.zA.set(a.zA);b.Qv=a.Qv;b.It=a.It;b.Kn=a.Kn;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.Ie=a.Ie;b.Bs.set(a.Bs);b.Fb.set(a.Fb);b.uj.set(a.uj);b.chromatic_aberration_coefs.set(a.chromatic_aberration_coefs);b.enable_hmd_stereo=a.enable_hmd_stereo;b.vg=a.vg;b.Mr=a.Mr;b.hx=a.hx;b.px=a.px;b.lx=a.lx;b.mx=a.mx;b.ox=a.ox;b.nx=a.nx;
b.gx=a.gx;b.mn=a.mn;b.nn=a.nn;b.on=a.on;return b};a.RO=function(){var a=c(10);a.F=k.fd(k.sh);return a};a.Fc=function(a){var b=c(11);b.yb=!1;b.Bb=!1;b.Id=!1;b.Wb=!0;b.F=k.fd(k.Bc);b.Zr=a;switch(a){case "NONE":b.Fb[0]=1;b.Fb[1]=1;break;case "GRAYSCALE":b.Fb[0]=1;b.Fb[1]=1;break;case "X_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLUR":b.Fb[0]=0;b.Fb[1]=1;break;case "X_GLOW_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_GLOW_BLUR":b.Fb[0]=0;b.Fb[1]=1;break;case "X_BLOOM_BLUR":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_BLOOM_BLUR":b.Fb[0]=
0;b.Fb[1]=1;break;case "X_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "Y_DOF_BLUR":b.Fb[0]=1;b.Fb[1]=1;break;case "X_ALPHA_BLUR":b.Fb[0]=1;b.Fb[1]=0;b.Ie=3;break;case "Y_ALPHA_BLUR":b.Fb[0]=0;b.Fb[1]=1;b.Ie=3;break;case "X_EXTEND":b.Fb[0]=1;b.Fb[1]=0;break;case "Y_EXTEND":b.Fb[0]=0;b.Fb[1]=1;break;default:h.I("Wrong postprocessing effect: "+a)}return b};a.PO=function(a,b){var d=c(13);d.yb=!1;d.Bb=!1;d.Id=!1;d.small_glow_mask_coeff=b.xi.small_glow_mask_coeff;d.large_glow_mask_coeff=b.xi.large_glow_mask_coeff;
d.small_glow_mask_width=b.xi.small_glow_mask_width;d.large_glow_mask_width=b.xi.large_glow_mask_width;d.F=a;d.Wb=!0;return d};a.gm=function(a,b,f,k,q,u,z,l,y){var d=c(a);0==a?(d.yb=!0,d.Bb=f,d.rb=!1):1==a?(d.yb=!1,d.Bb=!1,d.rb=!0):2==a?(d.yb=!1,d.Bb=!0,d.rb=!0):3==a||4==a?(d.yb=!0,d.Bb=!0,d.rb=!1):5==a||6==a?(d.yb=!1,d.Bb=!1,d.rb=!0):7==a?(d.yb=!0,d.Bb=!1,d.rb=!0):h.I("wrong main subscene type");d.rb&&l&&(d.self_shadow_normal_offset=l.self_shadow_normal_offset);d.F=b;if(a=z.cn)d.ip.set([a.WD,a.dG,
a.XJ,a.WJ]),d.gp.set(a.color),d.hp=a.Ga;d.Ld.set(z.Ld);d.Yd.set(z.Yd);d.gg=z.gg;d.Kd=u.Kd;d.zf=u.zf;k&&(k.Kd&&d.Yh.set(k.Kd),d.Wi=k.Wi,k.cg&&y&&(d.cg=!0,d.mj=k.rN,d.lj=k.qN,d.Qt.set(k.sN)));e(d,q);return d};a.iu=function(){var a=c(14);a.Wb=!0;a.F=k.fd(k.Bc);return a};a.QE=function(a,b,f){var d=c(15);b&&(d.type=16,d.yb=!1,d.Bb=!0);d.enqueue=!1;d.F=a;e(d,f);return d};a.NO=function(a){var b=c(17);b.dc=!1;b.yb=!1;b.Bb=!1;b.F=a;return b};a.JO=function(a){var b=c(18);b.yb=!0;b.Bb=!1;b.F=a;return b};a.ZO=
function(a,b){var d=c(9);d.F=a;e(d,b);return d};a.OO=function(a){var b=c(19);b.yb=!1;b.Bb=!1;b.F=a;b.Wb=!0;return b};a.aP=function(a,b,e){var d=c(20);d.yb=!1;d.Bb=!1;d.Id=!1;d.F=a;d.Kd=b.Kd;d.Yh.set(b.Kd);d.op=e.radius_increase;d.mp=e.tR;d.np=e.influence;d.lp=e.dist_factor;d.fn=e.YT;d.Wb=!0;return d};a.bP=function(a,b){var d=c(21);d.yb=!1;d.Bb=!1;d.Id=!1;d.F=a;d.jp=b.aN;d.kp=b.blur_discard_value;d.Wb=!0;return d};a.IO=function(a){var b=c(22);b.yb=!1;b.Bb=!1;b.Id=!1;b.Ie=1/a.Yo;b.Vu=a.wD;b.F=k.fd(k.Bc);
b.Wb=!0;return b};a.wz=function(a,b){var d=c(a);d.yb=23==a||24==a?!0:!1;d.Bb=!1;d.Id=!1;d.Ie=1/b.Yo;d.F=k.fd(k.Bc);23==a&&(d.SR=new Float32Array(4));d.Wb=!0;return d};a.MO=function(a,b,e,f){var d=c(27);d.yb=!1;d.Bb=!1;d.Id=!1;d.F=k.fd(k.Bc);d.brightness=a;d.contrast=b;d.exposure=e;d.saturation=f;d.Wb=!0;return d};a.UO=function(a,b){var d=c(28);d.yb=!1;d.Bb=!1;d.Id=!1;d.F=k.fd(k.Bc);d.iq=!0;d.mb_decay_threshold=a;d.mb_factor=b;d.Wb=!0;return d};a.sz=function(a,b){var d=c(29);d.yb=!1;d.Bb=!1;d.Id=!1;
d.F=a;d.Ie=d.F.dof_power;d.Xt=b;d.Wb=!0;return d};a.RE=function(a){var b=c(30);b.yb=!1;b.Bb=!1;b.Id=!1;b.F=a;b.Ie=b.F.dof_power;b.Wb=!0;return b};a.WO=function(a,b){var d=c(31);d.Id=!1;d.F=a;e(d,b);return d};a.VO=function(a){var b=c(32);y.outlining_overview_mode?b.Mh.set(y.Mh):b.Mh.set(a.Mh);b.Um=a.Um;b.dr=5;b.qq=3;b.Id=!1;b.F=k.fd(k.Bc);b.Wb=!0;return b};a.vz=function(a,b,f,h,k,q,u){var d=c(33);d.yb=!1;d.Bb=!1;d.Id=!1;d.Ld=new Float32Array([1,1,1]);d.Yd=new Float32Array([1,1,1]);d.gg=1;d.Aw=h;d.Qf=
b;d.Xo=k;d.Vk=f;d.ql=u;d.F=a;e(d,q);return d};a.QO=function(a,b){var d=c(34);d.yb=!1;d.Bb=!1;d.Id=!1;d.F=k.fd(k.Bc);d.god_rays_intensity=a;e(d,b);d.Wb=!0;return d};a.$O=function(a,b,f,p){var d=c(35);d.enqueue=!1;d.yb=!1;d.Bb=!1;d.Id=!1;var g=k.fd(k.Bc);g.width=p;g.height=p;d.F=g;d.sj=h.lQ();e(d,b);d.Ld=new Float32Array([1,1,1]);d.Yd=new Float32Array([1,1,1]);d.gg=1;d.pl.set(f.pl);d.procedural_skydome=f.procedural_skydome;d.use_as_environment_lighting=f.use_as_environment_lighting;d.rayleigh_brightness=
f.rayleigh_brightness;d.mie_brightness=f.mie_brightness;d.spot_brightness=f.spot_brightness;d.scatter_strength=f.scatter_strength;d.rayleigh_strength=f.rayleigh_strength;d.mie_strength=f.mie_strength;d.rayleigh_collection_power=f.rayleigh_collection_power;d.mie_collection_power=f.mie_collection_power;d.mie_distribution=f.mie_distribution;if(a){d.Ld.set(a.Ld);d.Yd.set(a.Yd);d.gg=a.gg;if(b=a.cn)d.ip.set([b.WD,b.dG,b.XJ,b.WJ]),d.gp.set(b.color),d.hp=b.Ga,d.hx=b.invert,d.px=b.BJ,d.lx=b.wJ,d.mx=b.xJ,d.ox=
b.zJ,d.nx=b.yJ,d.gx=b.XD;d.mn=a.mn;d.nn=a.nn;d.on=a.on;d.ix=a.ie}return d};a.uz=function(){var a=c(36);a.yb=!1;a.Bb=!1;a.F=k.fd(k.Bc);a.Wb=!0;return a};a.cP=function(a){var b=c(37);b.yb=!1;b.Bb=!1;b.zb=a?"HMD":"ANAGLYPH";b.F=k.fd(k.Bc);b.Wb=!0;return b};a.SO=function(){var a=c(38);a.yb=!1;a.Bb=!1;a.F=k.fd(k.Bc);a.Wb=!0;return a};a.KO=function(){var a=c(39);a.yb=!1;a.Bb=!1;a.F=k.fd(k.Bc);a.Wb=!0;return a};a.AO=function(){var a=c(45);a.yb=!1;a.Bb=!1;a.F=k.fd(k.Bc);a.Wb=!0;return a};a.TO=function(a,
b,f,h){var d=c(40);d.yb=!1;d.Bb=!1;d.Mn=a;d.Ln=b;d.F=h;e(d,f);d.Wb=!0;return d};a.LO=function(a){var b=c(41);b.yb=!1;b.Bb=!1;b.F=k.fd(k.Bc);b.Jn=a;b.It=5;b.Wb=!0;return b};a.hY=function(a){var b=c(42);b.yb=!1;b.Bb=!1;b.F=a;b.Wb=!0;return b};a.SE=function(){var a=c(43);a.enqueue=!1;return a};a.XO=function(){var a=c(44);a.Wb=!0;return a};a.Cx=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";
case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.Zr.replace(/_/g," ")+")";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";
case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";
case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";case 45:return"RESIZE";default:return"UNKNOWN"}};a.Rc=function(a,b){for(var c=b.ya,d=c.pb,e=c.kf,g=0;g<a.Xa.length;g++){var f=a.Xa[g].Ia,h=f.indexOf(b);if(-1!=h&&(f.splice(h,1),!f.length)){a.Xa.splice(g,1);break}}g=a.rb?c.md:0;a:{f=a.Xa;for(h=0;h<f.length;h++){var k=f[h];if(k.pb==d&&k.kf==e&&k.md==g&&k.Ej==c.Ej){f=k;break a}}f=null}f?f.Ia.push(b):(a.Xa.push({pb:d,Ia:[b],kf:e,md:g,Ej:c.Ej,dc:!0}),a.Mr=!0)};
a.Ai=function(a,b,c){b={dc:!0,Gz:[!0,!0,!0,!0,!0,!0],qg:b,ya:a,IC:c||null,Bv:null};a.ff&&a.la.fe&&(c=a.la.fe,b.Bv={GS:new Float32Array(c.length),HS:new Float32Array(c.length),uP:new Float32Array(c.length/3),YJ:new Float32Array(3),UM:u.lN(a.sb.Pe)});return b};a.UU=function(a){a.Xa.sort(f);a.Mr=!1}};b4w.module.__texcomp=function(a,t){function e(a,b,c,e){var d=new Int32Array(c,0,31),g,p,l,q,r,G;if(542327876!=d[0])return k.error("Invalid magic number in DDS header"),0;if(!d[20]&4)return k.error("Unsupported format, must contain a FourCC code"),0;g=d[21];switch(g){case h:p=8;l=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case u:p=16;l=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case y:p=16;l=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return k.error("Unsupported FourCC code:",f(g)),null}G=
1;d[2]&131072&&!1!==e&&(G=Math.max(1,d[7]));q=d[4];r=d[3];d=d[1]+4;if(b)for(g=0;g<G;++g)e=Math.max(4,q)/4*Math.max(4,r)/4*p,b=new Uint8Array(c,d,e),a.compressedTexImage2D(a.TEXTURE_2D,g,l,q,r,0,b),d+=e,q=Math.max(.5*q,1),r=Math.max(.5*r,1);else if(g==h){c=b=new Uint16Array(c);p=d/2;l=q;d=new Uint16Array(4);b=new Uint16Array(l*r);for(var v,D,F,n,t,I,x=l/4,J=r/4,A=0;A<J;A++)for(var C=0;C<x;C++)g=p+4*(A*x+C),d[0]=c[g],d[1]=c[g+1],v=d[0]&31,D=d[0]&2016,F=d[0]&63488,n=d[1]&31,t=d[1]&2016,I=d[1]&63488,
d[2]=5*v+3*n>>3|5*D+3*t>>3&2016|5*F+3*I>>3&63488,d[3]=5*n+3*v>>3|5*t+3*D>>3&2016|5*I+3*F>>3&63488,v=c[g+2],D=4*A*l+4*C,b[D]=d[v&3],b[D+1]=d[v>>2&3],b[D+2]=d[v>>4&3],b[D+3]=d[v>>6&3],D+=l,b[D]=d[v>>8&3],b[D+1]=d[v>>10&3],b[D+2]=d[v>>12&3],b[D+3]=d[v>>14],v=c[g+3],D+=l,b[D]=d[v&3],b[D+1]=d[v>>2&3],b[D+2]=d[v>>4&3],b[D+3]=d[v>>6&3],D+=l,b[D]=d[v>>8&3],b[D+1]=d[v>>10&3],b[D+2]=d[v>>12&3],b[D+3]=d[v>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,q,r,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,b);e&&a.generateMipmap(a.TEXTURE_2D)}else return k.error("No manual decoder for",
f(g),"and no native support"),0;return G}function c(a,b,c,f,h){var d=new XMLHttpRequest;d.open("GET",c,!0);d.responseType="arraybuffer";d.onload=function(){if(200==d.status){a.bindTexture(a.TEXTURE_2D,f);var c=e(a,b,d.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}h&&h(f)};d.send(null)}function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}
function f(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var k=t("__print"),q=t("__util"),h=b("DXT1"),u=b("DXT3"),y=b("DXT5");a.jW=e;a.kW=function(a,b,c){var d=new Uint32Array(c,0,13);if(55727696==d[0]){var e=d[7],f=d[6],g=d[11],h=52+d[12];switch(d[2]){case 0:var k=2,r=1;break;case 1:k=2;r=3;break;case 2:k=4;r=0;break;case 3:k=4;r=2;break;default:q.I("Unsupported PVR V3 format.")}}else if(559044176==d[11]){e=d[2];f=d[1];g=d[3];h=d[0];g++;var u=d[4]&255,d=0<d[10];25==u?(k=4,r=d?
2:0):24==u?(k=2,r=d?3:1):q.I("Unsupported PVR V2 format.")}else q.I("Unsupported PVR version.");u=2==k?8:4;d=4;switch(r){case 0:var v=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:v=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:v=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:v=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=u*d*k/8;for(k=0;k<g;k++){var r=Math.max(e>>k,1),y=Math.max(f>>k,1),F=r/u,n=y/d;2>F&&(F=2);2>n&&(n=2);F=F*n*b;n=new Uint8Array(c,h,F);a.compressedTexImage2D(a.TEXTURE_2D,k,v,r,y,0,n);
h+=F}};a.VF=function(a,b){switch(b){case "dds":var c=new Int32Array(a,0,31);return{width:c[4],height:c[3]};case "pvr":c=new Uint32Array(a,0,13);if(55727696==c[0])var d=c[7],c=c[6];else d=c[2],c=c[1];return{width:d,height:c}}};a.EQ=function(a,b){var c=1;if("dds"==b){var d=new Int32Array(a,0,31),e=d[21];switch(e){case h:c=6;break;case u:case y:c=4;break;default:k.error("Unsupported FourCC code:",f(e))}}else if("pvr"==b)if(d=new Uint32Array(a,0,13),55727696==d[0])switch(d[2]){case 0:c=12;break;case 1:c=
16;break;case 2:c=6;break;case 3:c=8}else e=d[4]&255,d=0<d[10],25==e?c=d?8:6:24==e&&(c=d?16:12);return c};a.lZ=function(a,b,e,f){var d=a.createTexture();c(a,b,e,d,f);return d}};b4w.module.__textures=function(a,t){function e(){pa||(pa=K.createFramebuffer());return pa}function c(){sa||(sa=K.createTexture());return sa}function b(){return{type:0,source:"",us:"",width:0,height:0,Jq:1,anisotropic_filtering:0,Zj:1024,Fk:!1,Lg:null,ub:0,Gb:null,ef:null,Ci:!1,Xs:-1,eb:null,dy:"",Wk:0,Bh:0,za:0,ec:0,Hk:0,bh:!1,Th:1,nh:!1,$G:0,Gd:null,ns:0,ms:0,Wj:-1,ps:!1,ml:-1,Vs:!1,zC:!1,ik:!1,Cl:!1,repeat:!0,Mk:"",uo:"",ym:"",oA:"",nA:"",Lk:""}}function f(a,b,c){a.ym=b.uuid;a.uo=b.filepath;a.oA=
b.source;a.nA=b.name;a.Mk=X.Ji(c+b.filepath);a.Lk=b.Fg;-1==ga.ka.indexOf(a)&&(ga.ka.push(a),ga.Do.push(!1))}function k(a,b,c){var d=-1<b.indexOf(".pvr");a.Lk=-1<b.indexOf(".dds")?"dds":d?"pvr":"";a.uo=b;a.Mk=c;a.ym=X.Xu();ga.ka.push(a);ga.Do.push(!0)}function q(c,d,e){var f=b();f.type=c;f.source="NONE";f.nh=e;if(c==a.lt||c==a.jt||c==a.mt||c==a.kt)f.ef=K.createRenderbuffer();else{var g=K.TEXTURE_2D,h=K.createTexture();K.bindTexture(g,h);K.texParameteri(g,K.TEXTURE_MAG_FILTER,K.LINEAR);e?K.texParameteri(g,
K.TEXTURE_MIN_FILTER,Oa[ya.dk]):K.texParameteri(g,K.TEXTURE_MIN_FILTER,K.LINEAR);K.texParameteri(g,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE);K.texParameteri(g,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE);e=l(f);var m=B(f),k=G(f);K.texImage2D(g,0,m,1,1,0,e,k,c==a.Kl?null:new Uint8Array([204,204,204,255]));ya.Hq&&d&&K.texParameterf(g,K.TEXTURE_COMPARE_MODE,K.COMPARE_REF_TO_TEXTURE);K.bindTexture(g,null);f.ub=g;f.Gb=h}return f}function h(a){var b=a.ub;K.bindTexture(b,a.Gb);var c=l(a),d=B(a),e=G(a),f=a.Lg.canvas;K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,
!0);K.texImage2D(b,0,d,c,e,f);K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!1);a.Fk&&K.generateMipmap(b);K.bindTexture(b,null);a.width=f.width;a.height=f.height}function u(a){var b=a.ub;K.bindTexture(b,a.Gb);K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!0);4!=a.eb.length?a.bh?d(a,a.eb,a.width*a.Th,a.height*a.Th,!1):K.texImage2D(b,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,a.eb):K.texImage2D(b,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,a.eb);K.bindTexture(b,null)}function y(a){var b=a.ub;K.bindTexture(b,a.Gb);K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,
!0);a.bh?d(a,a.Gd[a.Wj],a.width*a.Th,a.height*a.Th,!1):K.texImage2D(b,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,a.Gd[a.Wj]);K.bindTexture(b,null)}function g(){W||(W=document.createElement("canvas"));return W}function d(a,b,d,f,g){g||(p(K.TEXTURE_2D),K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,b));K.bindTexture(K.TEXTURE_2D,null);b=e();g=c();fa.yP(a,d,f,b,g)}function r(a,b,c){for(var d=0;6>d;d++){var e=Qa[d],f=wa[d],h=g();h.width=c;h.height=c;var m=h.getContext("2d");m.translate(c/2,c/2);"TEXTURE_CUBE_MAP_POSITIVE_X"==
e?(m.rotate(Math.PI/2),m.scale(1,-1)):"TEXTURE_CUBE_MAP_NEGATIVE_X"==e?(m.rotate(Math.PI/2),m.scale(-1,1)):"TEXTURE_CUBE_MAP_POSITIVE_Y"==e||"TEXTURE_CUBE_MAP_POSITIVE_Z"==e?m.scale(1,-1):"TEXTURE_CUBE_MAP_NEGATIVE_Y"!=e&&"TEXTURE_CUBE_MAP_NEGATIVE_Z"!=e||m.scale(-1,1);m.drawImage(a,f[0]*b,f[1]*b,b,b,-c/2,-c/2,c,c);ya.XE?K.texImage2D(K[e],0,K.RGBA,c,c,0,K.RGBA,K.UNSIGNED_BYTE,new Uint8Array(m.getImageData(0,0,c,c).data.buffer)):K.texImage2D(K[e],0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,h)}}function p(a){K.bindTexture(a,
null);var b=c();K.bindTexture(a,b);K.texParameteri(a,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE);K.texParameteri(a,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE);K.texParameteri(a,K.TEXTURE_MAG_FILTER,K.LINEAR);K.texParameteri(a,K.TEXTURE_MIN_FILTER,K.LINEAR)}function M(a,b,f){var h=a.source,m=a.Gb,l=a.ub,k=a.Lk,n=a.uo,v;K.bindTexture(l,m);a.repeat?(K.texParameteri(l,K.TEXTURE_WRAP_S,K.REPEAT),K.texParameteri(l,K.TEXTURE_WRAP_T,K.REPEAT)):(K.texParameteri(l,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(l,K.TEXTURE_WRAP_T,
K.CLAMP_TO_EDGE));a.Ci||"NODE_TEX"==h?K.texParameteri(l,K.TEXTURE_MIN_FILTER,K.LINEAR):K.texParameteri(l,K.TEXTURE_MIN_FILTER,Oa[ya.dk]);a.anisotropic_filtering&&K.texParameterf(l,qa.Tz().TEXTURE_MAX_ANISOTROPY_EXT,a.anisotropic_filtering);4==b.length&&(v=!0,b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]]));if("IMAGE"==h)if(v)K.texImage2D(l,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(k){v=ja.VF(b,k);f=X.Aq(v.width)||X.Aq(v.height);if(v.width>ba.Yb||v.height>ba.Yb){Z.error('Image "'+
n+'" has unsupported size: '+v.width+"x"+v.height+". Max available: "+ba.Yb+"x"+ba.Yb+".");return}h=v.width;v=v.height;if(f||"pvr"==k)a.bh=!0,p(l),h=z(h*a.Th),v=z(v*a.Th);"dds"==k?ja.jW(K,qa.PF(),b,!0):"pvr"==k&&ja.kW(K,qa.OF(),b);a.bh&&(d(a,null,h,v,!0),K.bindTexture(l,m),K.generateMipmap(l));a.width=h;a.height=v;a.Jq=ja.EQ(b,k)}else{K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!0);a.Ci?ya.os?(h=b[0].width,v=b[0].height):(h=b.videoWidth,v=b.videoHeight):(h=b.width,v=b.height);a.width=h;a.height=v;if(h>ba.Yb||
v>ba.Yb)Z.warn('Image "'+n+'" has unsupported size: '+h+"x"+v+". Max available: "+ba.Yb+"x"+ba.Yb+". Reduced image size will be used."),a.Th=Math.min(ba.Yb/h,ba.Yb/v),a.bh=!0;a.Ci&&(f in xa||(xa[f]={}),xa[f][a.dy]=a,ya.os?(a.Gd=b,a.ns=b.length,a.Bh=a.ms*a.Wk/b.length,b=b[0]):(a.eb=b,a.eb.loop=a.ik,a.Bh=b.duration?a.Wk/b.duration:aa.Dd(),oa.eF||(b.playbackRate=aa.Dd()/a.Bh,oa.vE&&2<b.playbackRate&&(b.playbackRate=2)),E(a)));h=z(a.width*a.Th);v=z(a.height*a.Th);a.bh||ya.NH?(n=g(),k=n.getContext("2d"),
n.width=h,n.height=v,k.drawImage(b,0,0,a.width,a.height,0,0,h,v),ya.XE?K.texImage2D(l,0,K.RGBA,h,v,0,K.RGBA,K.UNSIGNED_BYTE,new Uint8Array(k.getImageData(0,0,h,v).data.buffer)):K.texImage2D(l,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,n)):ya.Hb||!X.Aq(a.width)&&!X.Aq(a.height)?K.texImage2D(l,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,b):(d(a,b,h,v,!1),a.bh=!0);a.width=h;a.height=v;a.Ci||(K.bindTexture(l,m),K.generateMipmap(l))}else if("ENVIRONMENT_MAP"==h)if(v){for(m=0;6>m;m++)K.texImage2D(K["TEXTURE_CUBE_MAP_"+Qa[m]],
0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){Z.error('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}m=b.width/3;m>ba.og?(Z.warn('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*ba.og+"x"+2*ba.og+". Reduced image size will be used."),n=z(ba.og/m*m),a.bh=!0):(n=z(m),!ya.Hb&&
(3*n>ba.Yb||2*n>ba.Yb)&&(a.bh=!0));if(a.bh||ya.hs)r(b,m,n);else{k=b;h=n;p(K.TEXTURE_2D);K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,k);K.bindTexture(K.TEXTURE_2D,null);for(k=0;6>k;k++)K.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+k,0,K.RGBA,h,h,0,K.RGBA,K.UNSIGNED_BYTE,null);K.bindTexture(a.ub,null);k=e();K.bindFramebuffer(K.FRAMEBUFFER,k);v=c();for(k=0;6>k;k++)fa.xP(a,K[Qa[k]],h,m,v,k);K.bindFramebuffer(K.FRAMEBUFFER,null);K.bindTexture(a.ub,a.Gb);K.texParameteri(a.ub,K.TEXTURE_MIN_FILTER,
Oa[ya.dk]);K.texParameteri(a.ub,K.TEXTURE_MAG_FILTER,K.LINEAR)}ea.CN()&&(Z.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),r(b,m,na.eD));a.width=3*n;a.height=2*n;K.generateMipmap(l)}else"NODE_TEX"==h&&(K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!1),K.texImage2D(l,0,K.RGBA,b.width,b.height,0,K.RGBA,K.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);K.bindTexture(l,null)}function E(a){a.eb.oncanplay=function(){N(a)&&u(a)}}function z(a){return X.Aq(a)?X.clamp(Math.pow(2,
(a|0).toString(2).length),2,ba.Yb):a}function l(b){var c;switch(b.type){case a.rh:c=K.RGBA;break;case a.nt:c=K.RGB;break;case a.$p:c=K.RGBA;break;case a.aq:c=K.RGB;break;case a.Kl:c=K.DEPTH_COMPONENT;break;default:X.I("Wrong texture type")}return c}function B(b){var c;switch(b.type){case a.rh:c=ya.Hb?K.RGBA8:K.RGBA;break;case a.nt:c=ya.Hb?K.RGB8:K.RGB;break;case a.$p:c=ya.Hb?K.RGBA8:K.RGBA;break;case a.aq:c=ya.Hb?K.RGB8:K.RGB;break;case a.Kl:c=ya.Hb?w(ba.Xn):K.DEPTH_COMPONENT;break;default:X.I("Wrong texture type")}return c}
function w(a){switch(a){case 16:a=K.DEPTH_COMPONENT16;break;case 24:a=K.DEPTH_COMPONENT24;break;case 32:a=K.DEPTH_COMPONENT32F;break;default:a=K.DEPTH_COMPONENT24}return a}function G(b){var c;switch(b.type){case a.rh:c=K.UNSIGNED_BYTE;break;case a.nt:c=K.UNSIGNED_BYTE;break;case a.$p:c=K.FLOAT;break;case a.aq:c=K.FLOAT;break;case a.Kl:c=K.UNSIGNED_INT;break;default:X.I("Wrong texture type")}return c}function v(a){a.eb?a.eb.play():a.Gd&&(a.ps=!0);a.Vs=!1}function D(a){a.eb?a.eb.pause():a.Gd&&(a.ps=
!1);a.Vs=!0}function F(a){a.eb?a.eb.currentTime=a.ec/a.Bh:a.Gd&&(a.Wj=I(a,a.ec),y(a))}function n(a){return a.eb?!a.eb.paused:a.Gd?a.ps:!1}function N(a){return a.eb||a.Gd?a.eb?2<=a.eb.readyState:!0:0}function I(a,b){return Math.round(b*a.ns/a.Wk)}function x(a,b){if(ca.is_dynamic(a))return A(a,b);for(var c=a.Jr,d=0;d<c.length;d++){var e=A(c[d],b);if(e)return e}return null}function J(a,b,c){if(ca.is_dynamic(a))C(a,b,c);else{a=a.Jr;for(var d=0;d<a.length;d++)C(a[d],b,c)}}function A(a,b){var c=a.O;if(c.length)for(var c=
c[0].Y,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type||"SKY"==e.type)for(var f=0;f<e.ka.length;f++)if(e.pf[f]==b)return e.ka[f]}return null}function C(a,b,c){a=a.O;if(a.length){a=a[0].Y;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.ka.length;f++)if(e.pf[f]==b){var g=e.ka[f];e.ka[f]=c;O(g)}}}}function R(a,b){var c=a.O;if(c.length)for(var c=c[0].Y,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.ka.length;f++){var g=e.ka[f],h=e.pf[f];-1==b.indexOf(h)&&"NODE_TEX"!=
g.source&&b.push(h)}}}function m(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),g=H(d,f,!0),h=U(d,f,!0);if(g&&h)if("CONSTANT"==a)c.push.apply(c,g.color);else{var m=c,l=g,k=h;l==k?m.push.apply(m,l.color):(m.push(Y.Uv(k.color[0],k.position,l.color[0],l.position,f)),m.push(Y.Uv(k.color[1],k.position,l.color[1],l.position,f)),m.push(Y.Uv(k.color[2],k.position,l.color[2],l.position,f)),m.push(Y.Uv(k.color[3],k.position,l.color[3],l.position,f)))}h&&!g&&c.push.apply(c,h.color);
g&&!h&&c.push.apply(c,g.color)}}function H(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function U(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function O(a){var b;if(!(b=ya.enable_texture_cache))a:{b=Ca.get_all_objects("ALL",Ca.DATA_ID_ALL);for(var c=0;c<b.length;c++){var d=b[c];if(V(d,a)){b=!0;break a}for(var d=
d.Jr,e=0;e<d.length;e++)if(V(d[e],a)){b=!0;break a}}b=!1}b||(a.Gb&&K.deleteTexture(a.Gb),a=ga.ka.indexOf(a),-1!=a&&(ga.ka.splice(a,1),ga.Do.splice(a,1)))}function V(a,b){for(var c=0;c<a.O.length;c++)for(var d=a.O[c].Y,e=0;e<d.length;e++)for(var f=d[e].ka,g=0;g<f.length;g++)if(f[g]==b)return!0}function ia(a,b){for(var c=0;c<ga.ka.length;c++){var d=ga.ka[c];if(d.Mk==a&&d.type==b.type&&d.source==b.source&&d.repeat==b.repeat&&d.anisotropic_filtering==b.anisotropic_filtering&&d.Cl==b.Cl)return d}return null}
var na=t("__compat"),T=t("__config"),ja=t("__texcomp"),ea=t("__debug"),qa=t("__extensions"),Z=t("__print"),aa=t("__time"),X=t("__util"),fa=t("__renderer"),Ca=t("__objects"),ca=t("__obj_util"),Y=t("__curve"),za=t("__vec3"),P=t("__scenes"),ya=T.K,ba=T.xh,oa=T.ea,W=null,sa=null,pa=null;a.Xf=0;a.R=0;a.$L=0;a.YL=0;a.ZL=0;a.Zp=0;a.rh=10;a.nt=20;a.$p=30;a.aq=40;a.Kl=50;a.lt=60;a.jt=70;a.mt=80;a.kt=90;a.NC=128;a.ZJ=128;a.iD=128;var ga={ka:[],Do:[]},va={},xa={},K=null,Oa,Qa="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
wa=[[2,0],[0,0],[2,1],[1,0],[1,1],[0,1]];a.ug=function(b){Oa=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Xf=b.NEAREST;a.R=b.LINEAR;a.$L=b.NEAREST_MIPMAP_NEAREST;a.YL=b.LINEAR_MIPMAP_NEAREST;a.ZL=b.NEAREST_MIPMAP_LINEAR;a.Zp=b.LINEAR_MIPMAP_LINEAR;K=b};a.CY=function(a,b){return b in va&&a in va[b]?va[b][a].Lg:null};a.WZ=function(a,b){return b in va&&a in va[b]?(h(va[b][a]),!0):!1};a.DD=f;a.Bk=q;a.jO=function(c,d){var e=K.createTexture(),f=K.TEXTURE_CUBE_MAP;
K.bindTexture(f,e);K.texParameteri(f,K.TEXTURE_MAG_FILTER,K.LINEAR);d?K.texParameteri(f,K.TEXTURE_MIN_FILTER,Oa[ya.dk]):K.texParameteri(f,K.TEXTURE_MIN_FILTER,K.LINEAR);K.texParameteri(f,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE);K.texParameteri(f,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE);for(var g=0;6>g;g++)K.texImage2D(K[Qa[g]],0,K.RGBA,c,c,0,K.RGBA,K.UNSIGNED_BYTE,null);K.bindTexture(f,null);f=b();f.type=a.rh;f.source="NONE";f.width=3*c;f.height=2*c;f.Jq=1;f.nh=d;f.Gb=e;f.ub=K.TEXTURE_CUBE_MAP;return f};a.YH=function(a,
b){var c=a.ub;K.bindTexture(c,a.Gb);for(var d=0;6>d;d++)K.texImage2D(K[Qa[d]],0,K.RGBA,b,b,0,K.RGBA,K.UNSIGNED_BYTE,null);K.bindTexture(c,null);a.width=3*b;a.height=2*b};a.KB=function(a,b,c){var d=a.ub;K.bindTexture(d,a.Gb);b&&K.texParameteri(d,K.TEXTURE_MIN_FILTER,b);c&&K.texParameteri(d,K.TEXTURE_MAG_FILTER,c);K.bindTexture(d,null)};a.resize=function(b,c,d){c=Math.max(c,1);d=Math.max(d,1);if(b.width!=c||b.height!=d){switch(b.type){case a.lt:K.bindRenderbuffer(K.RENDERBUFFER,b.ef);K.renderbufferStorage(K.RENDERBUFFER,
K.RGB565,c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);break;case a.jt:K.bindRenderbuffer(K.RENDERBUFFER,b.ef);K.renderbufferStorage(K.RENDERBUFFER,w(ba.Xn),c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);break;case a.mt:K.bindRenderbuffer(K.RENDERBUFFER,b.ef);K.renderbufferStorageMultisample(K.RENDERBUFFER,ya.Zb,K.RGBA8,c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);break;case a.kt:K.bindRenderbuffer(K.RENDERBUFFER,b.ef);K.renderbufferStorageMultisample(K.RENDERBUFFER,ya.Zb,w(ba.Xn),c,d);K.bindRenderbuffer(K.RENDERBUFFER,
null);break;default:var e=b.ub;K.bindTexture(e,b.Gb);var f=l(b),g=B(b),h=G(b);b.nh&&(ya.Hb||(d=Math.max(c,d),c=z(d),d=z(d)),b.$G=Math.round(Math.log(Math.max(c,d))/Math.log(2)+.5));K.texImage2D(e,0,g,c,d,0,f,h,null);K.bindTexture(e,null)}c>ba.Yb||d>ba.Yb?X.I('Slink texture "'+b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+ba.Yb+"x"+ba.Yb+"."):(b.width=c,b.height=d)}};a.dP=function(c,d,e,g,m){var l=c.type;if("BLEND"==l)return null;var k=c.image,n=b();n.type=a.rh;n.width=1;n.height=1;
if(ya.Oy){var p=c.b4w_anisotropic_filtering;"DEFAULT"===p&&(p=d);"OFF"!==p&&ya.anisotropic_filtering&&(n.anisotropic_filtering=parseFloat(p.split("x")[0]))}if("REPEAT"!=c.extension||c.b4w_shore_dist_map)n.repeat=!1;if(k){"IMAGE"==l&&"MOVIE"==k.source&&(n.Ci=!0,n.dy=c.name,n.za=c.frame_start,n.ec=c.frame_offset,n.Hk=c.frame_duration,n.zC=c.use_auto_refresh,n.ik=c.use_cyclic,n.Wk=c.movie_length,n.Cl=c.b4w_nla_video,0!=n.ec&&Z.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));
n.source=l;d=X.Ji(m+k.filepath);if(d=ia(d,n))return d;f(n,k,m)}d=new Uint8Array([204,204,204,255]);switch(l){case "IMAGE":m=K.createTexture();k=K.TEXTURE_2D;K.bindTexture(k,m);K.texImage2D(k,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,d);break;case "NONE":if("NONE"==c.b4w_source_type)return null;m=K.createTexture();k=K.TEXTURE_2D;n.source=c.b4w_source_type;if("SCENE"==n.source){if(!c.b4w_source_id)return null;g=X.keysearch("name",c.b4w_source_id,e);if(!g)return null;n.us=c.b4w_source_id;n.Zj=c.b4w_source_size;
g.Gg=g.Gg||[];g.Gg.push(n);K.bindTexture(k,m);K.texImage2D(k,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,d)}else"CANVAS"==n.source&&(e=c.b4w_source_id,d=c.b4w_source_size,n.us=e,n.Fk=c.b4w_enable_canvas_mipmapping,c=document.createElement("canvas"),c.width=d,c.height=d,n.Lg=c.getContext("2d"),g in va||(va[g]={}),va[g][e]=n,K.bindTexture(k,m));break;case "ENVIRONMENT_MAP":m=K.createTexture();k=K.TEXTURE_CUBE_MAP;K.bindTexture(k,m);c="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");
for(g=0;6>g;g++)K.texImage2D(K["TEXTURE_CUBE_MAP_"+c[g]],0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,d);break;default:return Z.error('texture "'+c.name+'" has unsupported type "'+l+'"'),null}n.Gb=m;n.ub=k;"NONE"==l?(n.Fk?K.texParameteri(k,K.TEXTURE_MIN_FILTER,Oa[ya.dk]):K.texParameteri(k,K.TEXTURE_MIN_FILTER,K.LINEAR),n.anisotropic_filtering&&K.texParameterf(k,qa.Tz().TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropic_filtering),"CANVAS"==n.source&&h(n)):(K.generateMipmap(k),K.bindTexture(k,null));return n};a.iW=
h;a.rJ=u;a.qJ=y;a.Ls=M;a.bz=z;a.Ao=function(a){return a&&(a.Gb||a.ef)?!0:!1};a.yo=function(a){return a&&a.ef?!0:!1};a.eZ=function(b){return b.type==a.$p||b.type==a.aq?!0:!1};a.gR=function(b){var c=0;switch(b.type){case a.rh:case a.nt:c=4;break;case a.$p:case a.aq:c=16;break;case a.Kl:c=3;break;case a.lt:case a.jt:c=2;break;case a.mt:c=4*ya.Zb;break;case a.kt:c=3*ya.Zb}return c};a.cleanup=function(){if(!ya.os)for(var a in xa)for(var b in xa[a])xa[a][b].eb.pause(),xa[a][b].eb.src="",xa[a][b].eb.load();
ga.ka.length=0;ga.Do.length=0;va={};xa={}};a.pause=function(){for(var a in xa)for(var b in xa[a]){var c=xa[a][b];n(c)&&D(c)}};a.reset=function(){for(var a in xa)for(var b in xa[a])F(xa[a][b])};a.play=function(a){for(var b in xa)for(var c in xa[b]){var d=xa[b][c];a&&!d.Vs||v(d)}};a.dA=function(a,b){return b in xa&&a in xa[b]?xa[b][a]:null};a.DC=function(a){return a.Cl};a.play_video=v;a.pause_video=D;a.reset_video=F;a.nU=function(a,b){if(void 0 in xa&&a in xa[void 0]){var c=xa[void 0][a];c.eb?c.eb.currentTime=
b/c.Bh:c.Gd&&(c.Wj=b,y(c))}};a.OJ=n;a.PJ=N;a.LJ=function(a){return a.eb||a.Gd?a.eb?Math.round(a.eb.currentTime*a.Bh):a.Wj:0};a.NJ=function(a){return a.eb||a.Gd?a.eb?a.ec:I(a,a.ec):0};a.wW=function(a){if(!a.eb&&!a.Gd)return 0;var b=Math.min(a.Hk,a.Wk-a.ec);return a.eb?a.ec+b:I(a,a.ec+b)};a.Vw=function(a,b){return Math.round(b*a.ms*(aa.Dd()/a.Bh))};a.MJ=function(a){return Math.min(a.Hk,a.Wk-a.ec)};a.vW=I;a.CQ=function(a,b){var c=x(a,b);return c&&"CANVAS"==c.source?c.Lg:null};a.iv=x;a.FU=J;a.get_texture_names=
function(a){var b=[];if(ca.is_dynamic(a))R(a,b);else{a=a.Jr;for(var c=0;c<a.length;c++)R(a[c],b)}return b};a.OU=function(a){for(var c={},d=0;d<a.length;d++){for(var e=a[d].ka,f=a[d].Lf,g=[],m=[],l=0;l<e.length;l++){var k=e[l],n=f[l];if("CANVAS"==k.source)if(n in c)k=c[n];else{var p=e[l],k=b();k.source="CANVAS";k.width=p.width;k.height=p.height;k.Fk=p.Fk;k.type=p.type;p=document.createElement("canvas");p.width=k.width;p.height=k.height;k.Lg=p.getContext("2d");k.ub=K.TEXTURE_2D;k.Gb=K.createTexture();
K.bindTexture(K.TEXTURE_2D,k.Gb);k.Fk?K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,Oa[ya.dk]):K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR);K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR);K.bindTexture(K.TEXTURE_2D,null);p=k;p.Lg.drawImage(e[l].Lg.canvas,0,0);h(p);c[n]=k}g.push(k);m.push(n)}a[d].ka=g}};a.MP=function(a,b){for(var c=[],d=0;d<a.length;d++)m(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return X.clamp(255*a,0,255)}))};a.jN=m;a.QP=
function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var g=a[f].data.value,h=[],m=g.curve_mapping.curves_data,k=g.curve_mapping.curve_extend,l=g.curve_mapping.curves_handle_types,g=0;g<m.length;g++){for(var n=k[g],p=m[g],v=[],q=l[g],r=0;r<p.length;r++)v.push([new Float32Array(3),new Float32Array(p[r].concat(0)),new Float32Array(3)]);Y.dz(v[0],null,v[1],q[0],q[0]);for(r=1;r<v.length-1;r++)Y.dz(v[r],v[r-1],v[r+1],q[r],q[r]);Y.dz(v[v.length-1],v[v.length-2],
null,q[v.length-1],q[v.length-1]);if(2<v.length){if("AUTO"==q[0]){za.subtract(v[0][2],v[0][1],c);r=za.length(c);za.copy(v[1][0],d);d[0]<v[0][1][0]&&(d[0]=v[0][1][0]);za.subtract(d,v[0][1],d);var u=za.length(d);1E-8<u&&(za.scale(d,r/u,d),za.add(v[0][1],d,v[0][2]),za.subtract(v[0][1],d,v[0][0]))}p=v.length-1;"AUTO"==q[0]&&(za.subtract(v[p][0],v[p][1],c),r=za.length(c),za.copy(v[p-1][2],d),d[0]>v[p][1][0]&&(d[0]=v[p][1][0]),za.subtract(d,v[p][1],d),u=za.length(d),1E-8<u&&(za.scale(d,r/u,d),za.add(v[p][1],
d,v[p][0]),za.subtract(v[p][1],d,v[p][2])))}for(p=0;p<v.length-1;p++)Y.$N(v[p][1],v[p][2],v[p+1][0],v[p+1][1]);p=[];3>=m.length?(r=Math.round(-b/2),q=Math.round(b/2)):(r=0,q=b);for(;r<q;r++){var u=r/(q-1),x=H(v,u,!1),w=U(v,u,!1);x&&w?p.push(Y.SD(u,x[1],x[2],w[0],w[1],.001)):w&&!x?"EXTRAPOLATED"==n?(u=w[1][0]==w[2][0]?w[1][1]:Y.IG(u,w[1],w[2]),p.push(u)):p.push(w[1][1]):x&&!w&&("EXTRAPOLATED"==n?(u=x[0][0]==x[1][0]?x[1][1]:Y.IG(u,x[0],x[1]),p.push(u)):p.push(x[1][1]))}h.push(p)}e.push(h)}c=[];for(r=
0;r<e.length;r++)for(h=e[r],g=0;g<h[0].length;g++)3>=h.length?(d=X.clamp(127.5*(h[0][g]+1),0,255),f=X.clamp(127.5*(h[1][g]+1),0,255),m=X.clamp(127.5*(h[2][g]+1),0,255),p=255):(d=X.clamp(255*h[0][g],0,255),f=X.clamp(255*h[1][g],0,255),m=X.clamp(255*h[2][g],0,255),p=X.clamp(255*h[3][g],0,255)),c.push(d,f,m,p);return new Uint8Array(c)};a.NE=function(b,c){var d=q(a.rh,!1);d.source="NODE_TEX";d.repeat=!1;M(d,{width:c,height:b.length/(4*c),data:b});return d};a.change_image=function(a,c,d,e,f){var g=X.Ji(f);
if("WORLD"!=a.type){var h=ia(g,c);if(!h){h=b();h.type=c.type;h.anisotropic_filtering=c.anisotropic_filtering;h.source=c.source;h.us=c.us;h.width=c.width;h.height=c.height;h.Jq=c.Jq;h.Zj=c.Zj;h.Fk=c.Fk;h.Lg=c.Lg;h.ub=c.ub;h.Gb=c.Gb;h.ef=c.ef;h.Ci=c.Ci;h.Xs=c.Xs;h.eb=c.eb;h.dy=c.dy;h.Wk=c.Wk;h.Bh=c.Bh;h.za=c.za;h.ec=c.ec;h.Hk=c.Hk;h.bh=c.bh;h.Th=c.Th;h.Gd=c.Gd;h.ns=c.ns;h.ms=c.ms;h.Wj=c.Wj;h.ps=c.ps;h.ml=c.ml;h.Vs=c.Vs;h.zC=c.zC;h.ik=c.ik;h.Cl=c.Cl;h.repeat=c.repeat;h.uo=c.uo;h.Mk=c.Mk;h.ym=c.ym;h.oA=
c.oA;h.nA=c.nA;h.Lk=c.Lk;var m=h;K.bindTexture(c.ub,c.Gb);var l=K.getTexParameter(c.ub,K.TEXTURE_MAG_FILTER),n=K.getTexParameter(c.ub,K.TEXTURE_MIN_FILTER),p=K.getTexParameter(c.ub,K.TEXTURE_WRAP_S);c=K.getTexParameter(c.ub,K.TEXTURE_WRAP_T);m.Gb=K.createTexture();K.bindTexture(m.ub,m.Gb);K.texParameteri(m.ub,K.TEXTURE_MAG_FILTER,l);K.texParameteri(m.ub,K.TEXTURE_MIN_FILTER,n);K.texParameteri(m.ub,K.TEXTURE_WRAP_S,p);K.texParameteri(m.ub,K.TEXTURE_WRAP_T,c);K.bindTexture(m.ub,null);k(h,f,g);M(h,e,
0)}J(a,d,h)}else h=c,k(h,f,g),M(h,e,0),P.LV(a,h),P.Tx(a)};a.zE=O;a.ye=function(a){return a.texture.J};a.OT=function(){K=null};a.LF=function(){return ga.ka};a.BQ=function(a){a=ga.ka.indexOf(a);return-1==a?!1:ga.Do[a]};a.fU=function(a){a=ga.ka.indexOf(a);-1!=a&&(ga.Do[a]=!0)}};b4w.module.__assets=function(a,t){function e(){return M.oG()?t(M.Ze.Ot).data:null}function c(){var a={rt:null,gM:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.rt=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=e();b&&a.rt in b&&(a.status=200,b[a.rt]&&(a.response=a.gM(b[a.rt])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=D.DS)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.AT_JSON_ZIP:case a.AT_ARRAYBUFFER:case a.AT_ARRAYBUFFER_ZIP:f(e,"arraybuffer");break;case a.AT_JSON:f(e,"json");break;case a.AT_TEXT:f(e,"text");break;case a.AT_AUDIOBUFFER:k(e);
break;case a.AT_IMAGE_ELEMENT:q(e);break;case a.AT_AUDIO_ELEMENT:h(e);break;case a.AT_VIDEO_ELEMENT:u(e);break;case a.AT_SEQ_VIDEO_ELEMENT:y(e);break;default:w.I("Wrong asset type: "+e.type)}}}function f(b,d){var f=b.url.split("?v=")[0];if(f in I)"json"==d?b.Vb(w.V(I[f]),b.id,b.type,b.url,b.param):b.Vb(I[f],b.id,b.type,b.url,b.param);else{var g=e(),h=g&&b.url in g?new c:new XMLHttpRequest,g=null;if("GET"==b.request_method)h.open("GET",b.url,!0);else if("POST"==b.request_method)switch(h.open("POST",
b.url,!0),b.type){case a.AT_TEXT:g="text/plain";break;case a.AT_JSON:g="application/json"}if(b.overwrite_header)for(var k in b.overwrite_header)"Content-Type"==k?g=b.overwrite_header[k]:h.setRequestHeader(k,b.overwrite_header[k]);g&&h.setRequestHeader("Content-Type",g);"text"==d?(h.overrideMimeType("text/plain"),h.responseType="text"):"json"==d?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=d;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||
0==h.status){var c=h.response;if(!c||"arraybuffer"==d&&0==c.byteLength)l.error("empty responce when trying to get "+b.url),b.Vb(null,b.id,b.type,b.url,b.param);else{switch(b.type){case a.AT_JSON_ZIP:try{c=z.vo(c,{to:"string"})}catch(ia){l.error(ia+" (parsing gzipped file "+b.url+")");b.Vb(null,b.id,b.type,b.url,b.param);return}case a.AT_JSON:try{c=JSON.parse(c,b.TR)}catch(ia){l.error(ia+" (parsing JSON "+b.url+")");b.Vb(null,b.id,b.type,b.url,b.param);return}break;case a.AT_ARRAYBUFFER_ZIP:try{c=
z.vo(c).buffer}catch(ia){l.error(ia+" (parsing gzipped file "+b.url+")");b.Vb(null,b.id,b.type,b.url,b.param);return}}b.ze&&(I[f]=b.type==a.AT_JSON||b.type==a.AT_JSON_ZIP?w.V(c):c);b.Vb(c,b.id,b.type,b.url,b.param)}}else l.error(h.status+" when trying to get "+b.url),b.Vb(null,b.id,b.type,b.url,b.param);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.BH(a.loaded/a.total)},!1);h.send(b.post_data)}}function k(a){var b=a.url.split("?v=")[0];if(b in A)a.Vb(A[b],a.id,a.type,
a.url,a.param),a.state=30;else{"GET"!=a.request_method&&w.I("Unsupported request type for audio buffer");var d=(b=e())&&a.url in b?new c:new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?B.oP(b,function(b){a.Vb(b,a.id,a.type,a.url,a.param);a.state=30;a.ze&&(A[a.url.split("?v=")[0]]=b)},function(){l.error("failed to decode "+a.url);a.Vb(null,a.id,a.type,a.url,a.param);
a.state=30}):(l.error("empty responce when trying to get "+a.url),a.Vb(null,a.id,a.type,a.url,a.param),a.state=30)}else l.error(d.status+" when trying to get "+a.url),a.Vb(null,a.id,a.type,a.url,a.param),a.state=30};d.send()}}function q(a){var b=a.url.split("?v=")[0];if(b in x)a.Vb(x[b],a.id,a.type,a.url,a.param),a.state=30;else{"GET"!=a.request_method&&w.I("Unsupported request type for image element");var c=document.createElement("img");v.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=
a.state&&(a.Vb(c,a.id,a.type,a.url,a.param),a.state=30,a.ze&&(x[a.url.split("?v=")[0]]=c))};c.addEventListener("error",function(){40!=a.state&&(l.error("could not load image: "+a.url),a.Vb(null,a.id,a.type,a.url,a.param),a.state=30)},!1);if((b=e())&&a.url in b)if(b[a.url]){var f=d(a.url);c.src="data:"+f+";base64,"+b[a.url]}else E.is_ie11()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function h(a){var b=
a.url.split("?v=")[0];if(b in J)a.Vb(J[b],a.id,a.type,a.url,a.param),a.state=30;else{"GET"!=a.request_method&&w.I("Unsupported request type for audio element");var c=document.createElement("audio");v.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.Vb(c,a.id,a.type,a.url,a.param),a.state=30,a.ze&&(J[a.url.split("?v=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(l.error("could not load sound: "+a.url),a.Vb(null,a.id,a.type,a.url,
a.param),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(l.error("could not load sound: "+a.url),a.Vb(null,a.id,a.type,a.url,a.param),a.state=30)},!1);if((b=e())&&a.url in b)if(b[a.url]){var d=r(a.url);c.src="data:"+d+";base64,"+b[a.url];40!=a.state&&(a.Vb(c,a.id,a.type,a.url,a.param),a.state=30)}else E.is_ie11()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,v.is_mobile_device&&c.load();
v.QA&&(c.autoplay=!0,c.pause());setTimeout(function(){c.hM=1},5E3)}}function u(a){function b(){40!=a.state&&(l.error("could not load video: "+a.url,a.param),a.Vb(null,a.id,a.type,a.url),a.state=30)}var c=a.url.split("?v=")[0];if(c in x)a.Vb(x[c],a.id,a.type,a.url,a.param),a.state=30;else{"GET"!=a.request_method&&w.I("Unsupported request type for video element");var d=document.createElement("video");d.muted=!0;v.allow_cors&&(d.crossOrigin="Anonymous");d.addEventListener("loadeddata",function(){d.removeEventListener("error",
b,!1);40!=a.state&&(a.Vb(d,a.id,a.type,a.url,a.param),a.state=30,a.ze&&(x[a.url.split("?v=")[0]]=d))},!1);d.addEventListener("error",b,!1);if((c=e())&&a.url in c)if(c[a.url]){var f=p(a.url);d.src="data:"+f+";base64,"+c[a.url];40!=a.state&&d.addEventListener("loadeddata",function(){a.Vb(d,a.id,a.type,a.url,a.param);a.state=30},!1)}else E.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),d.dispatchEvent(c);else d.src=a.url,v.is_mobile_device&&
d.load();if(v.QA||v.kG)d.autoplay=!0,d.pause();setTimeout(function(){d.hM=1},1E4)}}function y(a){function b(b){a.Vb(b,a.id,a.type,a.url,a.param);a.state=30;a.ze&&(x[a.url.split("?v=")[0]]=b)}var d=a.url.split("?v=")[0];if(d in x)a.Vb(x[d],a.id,a.type,a.url,a.param),a.state=30;else{"GET"!=a.request_method&&w.I("Unsupported request type for seq video element");var f=(d=e())&&a.url in d?new c:new XMLHttpRequest;f.open("GET",a.url,!0);f.responseType="arraybuffer";f.onreadystatechange=function(){if(40!=
a.state&&4==f.readyState)if(200==f.status||0==f.status){var c=f.response;c?g(c,b):(l.error("empty responce when trying to get "+a.url),a.Vb(null,a.id,a.type,a.url,a.param),a.state=30)}else l.error(f.status+" when trying to get "+a.url),a.Vb(null,a.id,a.type,a.url,a.param),a.state=30};f.addEventListener("progress",function(b){b.lengthComputable&&a.BH(b.loaded/b.total)},!1);f.send()}}function g(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],YD:[],Bh:c[4]},g=20,h=0;h<e;h++){var k=
c[g/4],l=new Blob([d.subarray(g+4,g+4+k)],{type:"image/jpg"}),n=document.createElement("img");n.src=window.URL.createObjectURL(l);f.images.push(n);f.YD.push(l);g+=k+8-k%4}n.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.YD;b(f)}}function d(a){var b="image";switch(w.Yz(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function r(a){var b="audio";switch(w.Yz(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";
break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function p(a){var b="video";switch(w.Yz(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var M=t("__config"),E=t("__compat"),z=t("__pako_inflate"),l=t("__print"),B=t("__sfx"),w=t("__util"),G=t("__version"),v=M.K,D=M.ae;a.AT_ARRAYBUFFER=10;a.AT_ARRAYBUFFER_ZIP=20;a.AT_JSON=30;a.AT_JSON_ZIP=40;a.AT_TEXT=50;a.AT_AUDIOBUFFER=60;a.AT_IMAGE_ELEMENT=
70;a.AT_AUDIO_ELEMENT=80;a.AT_VIDEO_ELEMENT=90;a.AT_SEQ_VIDEO_ELEMENT=100;var F=[],n=0,N={},I={},x={},J={},A={};a.vx=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.KY=function(a){if(N[a])return N[a];var b=D.prevent_caching?a+"?v="+G.get_build_version():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200!=c.status&&c.status)w.I("Error XHR: "+c.status+", GET "+a);else{b=c.responseText;if(b.length)return N[a]=
b;w.I("Error XHR: responce is empty, GET "+a)}};a.cleanup=function(){for(var a=0;a<F.length;a++)F[a].state=40;F=[];n=0;N={}};a.enqueue=function(a,c,d,f,g){for(var h=0;h<a.length;h++){var k=a[h],k={id:k.id,type:k.type,url:k.url,ze:k.ze,request_method:k.request_method?k.request_method:"GET",overwrite_header:k.overwrite_header?k.overwrite_header:null,post_data:k.post_data?k.post_data:null,param:k.param?k.param:null,state:10,Vb:c||function(){},rH:d||function(){},BH:f||function(){},TR:g||null,sH:n};if(D.prevent_caching){var l=
e();l&&k.url in l||(k.url+="?v="+G.get_build_version())}F.push(k)}b(F);n++};a.update=function(){b(F);for(var a=F,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.sH===a[c].sH?30!==f.state&&(d=!1):(d&&(a[e-1].rH(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(f=a[e],a.splice(c),f.rH())}};a.DN=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.NN=function(){I={};x={};J={};A={}}};b4w.module.__loader=function(a,t){function e(b,d,e,f){var g=B,h=M.create(),k;for(k in d){var l=c(d[k]);if(f&&l.Tb||!b&&l.mc)l.rs=!0;M.X(h,l)}for(k in d)for(l=d[k],l.name=k,b=0;b<l.inputs.length;b++)M.H(h,d[l.inputs[b]],l,null);d=c({name:"out",Lb:a.aK,cc:function(a,b,c,d,e){b.Kb&&(g.YB=!0);p(b)||(b.status=2);b.LG(b.id,!0);e(b,c);E.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},$b:5});if(e)e=M.pr(h);else{k=M.clone(h);do{e=M.pr(k);l=[];for(b=0;b<e.length;b++){f=e[b];var v=M.Ya(k,f);v.Sb&&
l.push(f)}for(b=0;b<l.length;b++)M.Hf(k,l[b]);l.length&&M.iz(k)}while(l.length)}M.X(h,d);for(b=0;b<e.length;b++)f=e[b],v=M.Ya(h,f),d.inputs.push(v.name),M.H(h,v,d,null);return h}function c(a){a.Sb=a.Sb||!1;a.Lb||0===a.Lb||(a.Lb=a.re);a.inputs=a.inputs||[];a.Dm=a.Dm||!1;a.rs=a.rs||!1;a.$b=a.$b||0;a.Tb=a.Tb||!1;a.mc=a.mc||!1;a.status=0;a.mZ=0;a.KG=0;a.yq=a.yq||null;return a}function b(a,b,c){b.EE(c,b);b.status=3;a.Jy--;l.debug_loading&&E.log("%cTHREAD "+b.id+": 100% LOADING END "+Math.round(performance.now()-
b.Cs)+"ms","color: #f0f;");b.WB=null;b.EE=null;l.debug_loading||(b.jh=null);b.bk=null}function f(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];M.Ya(a.jh,f).Dm&&(M.xl(a.jh,f,function(d){var e=!0;M.hk(a.jh,d,function(a,b){if(!b.Dm)return e=!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function k(a){function b(b,c){var d=M.Ya(a.jh,b),e=M.Ya(a.jh,c),f=e.Lb-d.Lb;f||(f=d.Sb-e.Sb);return f}var c=[],d=a.bk,e=!1;do{var g=f(a,
d);c.push.apply(c,d);0<g.length&&(e=!0);d=g}while(0<g.length);e&&c.sort(b);a.bk=c;return a.bk.length}function q(a,b,c){if(b.rs)return b.Dm=!0,l.debug_loading&&E.log("%cTHREAD "+a.id+": SKIP STAGE "+b.name,"color: #f0f;"),u(a,b),!1;if(l.debug_loading&&0==b.status){var d=h(a);E.log("%cTHREAD "+a.id+": "+d+"% "+("LOADING START "+b.name)+" "+Math.round(performance.now()-a.Cs)+"ms ","color: #f0f;")}if(!b.cc&&!b.vk&&!b.xq)return u(a,b),!1;if(0==b.status&&(b.status++,b.cc))return b.cc(c,a,b,b.yq,u,y),!0;
if(1==b.status){if(b.vk)return b.vk(c,a,b,b.yq,u,y),!0;b.status++}return 2==b.status&&(b.status++,b.xq)?(b.xq(c,a,b,b.yq,u,y),!0):!1}function h(a){if(0==a.wx)return 100;var b=0;M.ba(a.jh,function(c,d){a.do_not_load_resources&&d.Tb||(b+=d.KG*d.$b)});return z.trunc(100*b/a.wx)}function u(a,b){b.Dm=!0;b.status=3;g(a,b,1);if(l.debug_loading){var c=h(a);E.log("%cTHREAD "+a.id+": "+c+"% "+("LOADING END "+b.name)+" "+Math.round(performance.now()-a.Cs)+"ms ","color: #f0f;")}}function y(a,b,c){1>c?g(a,b,c):
b.status++}function g(a,b,c){var d=B;if(b.cc||b.vk||b.xq)if(b.KG=c,b=h(a),a.WE!=b||1==c)a.WB(b,performance.now()-a.Cs,a.id),a.WE=b,d.FA=!0}function d(a,b){var c=null;M.ba(a.jh,function(a,d){if(d.name==b)return c=d,1});return c}function r(){return 0==B.Jy}function p(a){return a&&(3==a.status||4==a.status)}var M=t("__graph"),E=t("__print"),z=t("__util"),l=t("__config").K;a.re=0;a.Cg=1;a.aK=2;var B=null;a.Zz=function(){return B};a.PE=function(){var a={Mf:[],Az:0,Jy:0,YB:!1,FA:!1};return B=a};a.TE=function(a,
b,c,d,f,g,h,k,l){var n=B,p=n.Mf.length,v={id:p,Kb:0==p,status:0,wi:b,VD:"",LG:c||function(){},JG:k||!1,a_:g,Cs:0,WE:0,wx:0,AB:!1,WB:d||function(){},EE:f||function(){},jh:null,bk:null,lA:!1,iA:!1,pA:!1,lg:l};a=e(v.Kb,a,g,h);v.jh=a;b=[];c=M.eR(a);for(d=0;d<c.length;d++)b.push(c[d]);v.bk=b;M.ba(a,function(a,b){!(b.cc||b.vk||b.xq)||v.do_not_load_resources&&b.Tb||(v.wx+=b.$b)});n.Mf.push(v);n.Jy++;return v.id};a.cW=function(c){var d=B;if(d&&!r())if(d.FA)d.FA=!1;else{var e=performance.now();do{var f=d.Mf[d.Az],
g=c[f.id];if(!p(f))if(0==f.status&&(f.status=1,f.Cs=performance.now(),f.WB(0,0,f.id),l.debug_loading&&E.log("%cTHREAD "+f.id+": 0% LOADING START 0ms","color: #f0f;")),k(f)){var h=f,u=h.bk.length;do{var z=M.Ya(h.jh,h.bk[0]),x=q(h,z,g);z.Lb==a.Cg&&(h.AB=!0);z=h.bk.shift();h.bk.push(z);u--}while(!x&&0!=u)}else b(d,f,g);d.YB&&(d.Az=(d.Az+1)%d.Mf.length);if(f.AB){f.AB=!1;break}}while(16>performance.now()-e)}};a.xD=function(a){var c=B;b(c,a,null);a.status=4;a.Kb&&(c.YB=!0);a.LG(a.id,!1)};a.OZ=y;a.fx=function(a,
b){var c=d(a,b);null!==c&&(c.rs=!0)};a.Dm=r;a.pV=p;a.is_primary_loaded=function(a){var b=B;if(!b)return!1;a|=0;return b.Mf[a]&&(3==b.Mf[a].status||2==b.Mf[a].status)};a.lR=function(b){if(l.debug_loading){var c=B;return c&&c.Mf[b]&&c.Mf[b].jh?M.ZE(c.Mf[b].jh,function(b,c){if(c.rs)return"SKIPPED\n("+c.name+")";var d=c.name+"\n",e=[];e.push(c.Lb==a.Cg?"ASYNC":"SYNC");c.Sb&&e.push("BKG");c.Tb&&e.push("RES");return d+e.join(" | ")},null):null}E.error("Debug mode isn't enabled. Can not retrieve the graph.")};
a.cleanup=function(){B=null}};b4w.module.__logic_nodes=function(a,t){function e(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.Uw;f++)if(v.get_sensor_value(a,b,f))for(var g=0;g<c.Tw.length;g++)if(c.Tw[g]==f){e.Rm==c.XI?(z.is_play(e.Ba)&&(c.state=-1),d.zg.kg||(c.state=1,c.ss=c.Wv[g])):(c.state=1,c.ss=c.Wv[g]);return}c.state=0}}}function c(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.Uw;f++)if(v.get_sensor_value(a,b,f)&&f==c.XH){if(z.is_play(e.Ba)&&e.Rm==c.XI)c.state=-1;
else if(!d.zg.kg||c.P.no_wait)c.state=1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Na:a.slot_idx_order,ss:a.slot_idx_jump,za:a.frame_range[0],gb:a.frame_range[1],cQ:a.frame_range_mask?a.frame_range_mask[0]:!0,bQ:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,Uw:-1,XH:-1,$S:a.param_name,US:a.operation,mute:a.mute,Yq:a.object,obj:null,rc:null,Ac:null,hb:{},Ig:a.anim_name,Dc:p.SLOT_ALL,bT:a.parse_json_vars,aT:a.parse_json_paths,Gc:a.objects_paths,hH:a.nodes_paths,
sa:a.floats,P:a.bools,U:a.variables,ck:a.strings,GA:a.materials_names,sI:a.shader_nd_type,Sc:a.common_usage_names,GP:a.encode_json_vars,FP:a.encode_json_paths,XI:b,AH:ja[a.type]?ja[a.type]:h,Jw:!1,Mx:0,Tw:null,mS:a.links,Wv:[]}}function f(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function k(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function q(a,b,c){switch(b.state){case 2:c.qa=a.Na}}function h(a,b,c){switch(b.state){case 1:B.error("Unknown node type: "+a.type);break;case 2:c.qa=a.Na}}function u(a){return l.uc(l.Ic,
a.Yq||[],0)}function y(a,c){var d=a.b4w_logic_nodes,e=c.Ce;c.state=1;for(var f=0;f<d.length;f++){var g={Z:[],zg:{jb:a,qa:0,kg:!1,jC:f,G:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(g);for(var h=e[e.length-1],k=d[f],l=0;l<k.length;l++){var m=b(k[l],h);h.Z.push(m)}for(k=0;k<h.Z.length;k++)m=h.Z[k],m.mute||m.AH(m,c,g.zg,0,0)}var d=a.timeline_markers,n;for(n in d)c.ts.push(d[n]);c.ts.sort(function(a,b){return a-b});c.state=2;ea.push(c)}function g(a,b){switch(b){case 0:return Number(a)?Number(a):
0;case 1:return String(a);default:return null}}function d(a){switch(typeof a){case "string":return g(a,1);case "number":return g(a,0);default:return g(a,1)}}function r(a){Z[a]||(Z[a]=0);var b=a+"_"+Z[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Z[a]++;return b}var p=t("__animation"),M=t("__assets"),E=t("__camera"),z=t("__nla"),l=t("__objects"),B=t("__print"),w=t("__scenes"),G=t("__config"),v=t("__controls"),D=t("__batch"),F=t("__geometry"),n=t("__mat3"),N=t("__mat4"),I=t("__physics"),x=t("__quat"),
J=t("__sfx"),A=t("__time"),C=t("__transform"),R=t("__tsr"),m=t("__util"),H=t("__vec3"),U=new Float32Array(4),O=new Float32Array(3),V=new Float32Array(3),ia=new Float32Array(2),na=new Float32Array(9),T=new Float32Array(16);a.aL=0;a.bL=1;a.FK=0;a.OK=1;a.KK=2;a.AK=3;a.LK=4;a.NK=5;a.EK=6;a.PK=7;a.CK=8;a.BK=9;a.DK=10;a.GK=11;a.IK=12;a.HK=13;a.MK=14;a.JK=15;a.zK=16;a.VK=0;a.UK=1;a.WK=2;a.XK=3;a.TK=4;a.$C=0;a.bD=1;a.aD=2;a.cD=3;a.dD=4;a.ZC=5;a.$K=0;a.ZK=1;a.YK=2;a.vK=0;a.wK=1;a.tK=2;a.uK=3;a.xK=0;a.yK=1;
var ja={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.qa=a.Na}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=u(a);a.obj||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:a.P.ch?w.zq(a.obj,!0):w.$l(a.obj,!0),c.qa=a.Na}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=u(a);a.obj||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:a.P.ch?w.zq(a.obj,!1):w.$l(a.obj,!1),c.qa=a.Na}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=
a.U.vd;b=b.G;var e=c.G,f;a:{f=a.$S;var h=a.sa.ptp,l=a.P.hsh,m=G.get("url_params");if(m&&f in m)f=Number(m[f]);else{if(l=l?location.hash:location.search)for(l=l.slice(1).split("&"),m=0;m<l.length;m++){var n=l[m].split("=");if(1<n.length&&n[0]==f){f=g(n[1],h);break a}}f=0}}k(d,b,e,f);c.qa=a.Na}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.Ce[c.jC];var d=l.get_selectable_objects();a.Tw=[];a.Wv=[];for(var f in a.Gc){var g=l.uc(l.Ic,a.Gc[f],0),h=d.indexOf(g);if(-1==h){B.error("logic script error: non-selectable object:",
a.Gc[f][a.Gc[f].length-1]);break a}a.Tw.push(h);a.Wv.push(a.mS[f])}a.state=-1;a.Uw=d.length;f=[];for(h=0;h<d.length;h++)f.push(v.create_selection_sensor(d[h],!1));d=e();v.create_sensor_manifold(g,"LOGIC_NODES_SWITCH_SELECT_"+r(a.label),v.CT_SHOT,f,v.default_OR_logic_fun,d,[a,b,c])}break;case 2:if(-1==a.state){b=b.Ce[c.jC].Z;for(g=0;g<b.length;g++)d=b[g],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.qa=a.state?a.ss:a.Na,a.state=-1}},SELECT:function(a,b,d){switch(b.state){case 1:d=
b.Ce[d.jC];var e=u(a),f=l.get_selectable_objects(),g=f.indexOf(e);if(-1==g)B.error("logic script error: non-selectable object:",a.Yq[a.Yq.length-1]);else{a.state=-1;a.Uw=f.length;a.XH=g;for(var g=[],h=0;h<f.length;h++)g.push(v.create_selection_sensor(f[h],!1));f=c();v.create_sensor_manifold(e,"LOGIC_NODES_SELECT_"+r(a.label),v.CT_SHOT,g,v.default_OR_logic_fun,f,[a,b,d])}break;case 2:0==a.state||1==a.state?(d.qa=a.state?a.ss:a.Na,a.state=-1):a.P.not_wait&&(d.qa=a.Na)}},PLAY:function(a,b,c,d){switch(b.state){case 1:z.$B();
a.state=-1;a.P.not_wait||(a.P.not_wait=!1);break;case 2:switch(a.state){case -1:if(z.is_play(b.Ba))if(b.yz==b.Rm&&c.kg)break;else{var e=b.Rm;if(e){e.zg.qa=e.Z[e.zg.qa].Na;e.Z[e.zg.qa].state=-1;for(var e=b.Rm.Z,f=0;f<e.length;f++){var g=e[f];"PLAY"==g.type&&(g.state=-1)}}}c.kg=!a.P.not_wait;b.Rm=b.yz;a.state=0;a.cQ&&(z.zU(a.za),z.jI(d));if(a.bQ)z.LB(a.gb);else{d=z.get_frame(d);var e=-1,h;for(h in b.ts)if(d<b.ts[h]){e=h;break}0<=e?z.LB(b.ts[e]):z.LB(z.get_frame_end())}z.xH(null);a.P.not_wait&&(c.qa=
a.Na,a.state=-1,c.kg=!1);break;case 0:z.is_play()||(c.qa=a.Na,a.state=-1,c.kg=!1);break;case 1:c.qa=a.Na;a.state=-1;b.Rm=null;c.kg=!1;break;default:m.I("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.P.url?g(f(a.U.url,b.G,c.G),1):a.ck.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.U.v1[1]?a.sa.inp1:g(f(a.U.v1,b.G,c.G),0),e=-1==a.U.v2[1]?a.sa.inp2:g(f(a.U.v2,b.G,c.G),0),h=0;switch(a.US){case 3:h=d+e;break;case 2:h=
d*e;break;case 1:h=d-e;break;case 0:0==e&&m.I("Division by zero in Logic script");h=d/e;break;case 4:h=Math.random()*(e-d)+d;break;case 5:h=Math.sin(d);break;case 6:h=Math.cos(d);break;case 7:h=Math.tan(d);break;case 8:h=Math.asin(d);break;case 9:h=Math.acos(d);break;case 10:h=Math.atan(d);break;case 11:h=Math.log(d);break;case 12:h=Math.min(d,e);break;case 13:h=Math.max(d,e);break;case 14:h=Math.round(d);break;case 15:h=d%e;break;case 16:h=Math.abs(d)}k(a.U.vd,b.G,c.G,h);c.qa=a.Na}},CONDJUMP:function(a,
b,c){switch(b.state){case 2:var d=a.P.str?1:0,e=a.P.str?a.ck:a.sa,h=-1==a.U.v1[1]?e.inp1:g(f(a.U.v1,b.G,c.G),d);b=-1==a.U.v2[1]?e.inp2:g(f(a.U.v2,b.G,c.G),d);d=!1;switch(a.Sc.condition){case 5:h==b&&(d=!0);break;case 4:h!=b&&(d=!0);break;case 3:h<b&&(d=!0);break;case 2:h>b&&(d=!0);break;case 1:h<=b&&(d=!0);break;case 0:h>=b&&(d=!0)}c.qa=d?a.ss:a.Na}},REGSTORE:function(a,b,c){switch(b.state){case 2:k([a.P.gl||a.U.vd[0],a.U.vd[1]],b.G,c.G,(1==a.Sc.variable_type?a.ck:a.sa).inp1),c.qa=a.Na}},PLAY_ANIM:function(a,
b,c){switch(b.state){case 1:a.obj=a.P.env?l.get_world_by_name(a.Yq[0],0):u(a);a.obj||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:switch(0!=a.state||p.is_play(a.obj,a.Dc)||(a.state=1),a.state){case -1:for(var d in b.Ce){var e=b.Ce[d].zg.qa;-1!=e&&(e=b.Ce[d].Z[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}b=a.Sc.param_anim_behavior;if(""==a.Ig)p.apply_def(a.obj),p.set_behavior(a.obj,b,p.SLOT_ALL);else{a:{d=a.obj;for(var e=a.Ig,f=-1,
g=0;8>g;g++){var h=d.na[g];if(h&&h.gj&&p.MI(h.gj)==p.MI(e))if(-1!=f)f=g;else{d=-1;break a}}d=f}-1==d?(a.Dc=p.RU(a.obj,a.Ig),p.apply(a.obj,null,a.Ig,a.Dc)):a.Dc=d;p.set_behavior(a.obj,b,a.Dc)}a.P.not_wait||(c.kg=!0);p.play(a.obj,null,a.Dc);a.state=0;a.P.not_wait&&(c.qa=a.Na,a.state=-1);break;case 0:break;case 1:a.P.not_wait||(c.kg=!1);c.qa=a.Na;a.state=-1;break;default:m.I("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:q,SEND_REQ:function(a,b,c){function d(a,d,e,f,g){a=JSON.stringify(a);k(g[0].U.dst,
b.G,c.G,a);g[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.P.url?g(f(a.U.url,b.G,c.G),1):a.ck.url,h={};a.P.ct&&(h["Content-Type"]=a.ck.ct);"GET"==a.Sc.request_type?M.enqueue([{id:e,type:M.AT_JSON,url:e,overwrite_header:h,param:[a,c.G]}],d,null,null,null):"POST"==a.Sc.request_type&&M.enqueue([{id:e,type:M.AT_JSON,url:e,overwrite_header:h,request_method:"POST",post_data:g(f(a.U.dst1,b.G,c.G),1),param:[a,c.G]}],d,null,null,null);break;case 1:a.state=-1,c.qa=a.Na}}},INHERIT_MAT:function(a,
b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.hb["id"+b]=l.uc(l.Ic,a.Gc["id"+b],0),a.hb["id"+b]||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:l.inherit_material(a.hb.id0,a.GA.id0,a.hb.id1,a.GA.id1),c.qa=a.Na}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.Gc.id0&&(a.hb.id0=l.uc(l.Ic,a.Gc.id0,0),a.Gc.id0||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0),a.hH.id0.unshift(a.GA.id0));break;case 2:var d=a.hb.id0,e=a.hH.id0,
h=e[0],k=D.ab(d,h,"MAIN");c.qa=a.Na;if(null===k)B.error('Material "'+h+'" was not found in the object "'+d.name+'".');else{if("ShaderNodeRGB"==a.sI){var m=l.nr(k.Ef,e,1);l.set_nodemat_rgb(d,h,m,a.P.id0?g(f(a.U.id0,b.G,c.G),0):a.sa.id0,a.P.id1?g(f(a.U.id1,b.G,c.G),0):a.sa.id1,a.P.id2?g(f(a.U.id2,b.G,c.G),0):a.sa.id2)}"ShaderNodeValue"==a.sI&&(m=l.or(k.Ff,e,1),l.set_nodemat_value(d,h,m,a.P.id0?g(f(a.U.id0,b.G,c.G),0):a.sa.id0))}}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=
0,a.Mx=0,c.kg=!0):0==a.state&&(a.Mx+=e,(a.P.dl?g(f(a.U.dl,b.G,c.G),0):a.sa.dl)<a.Mx&&(a.state=-1,c.qa=a.Na,c.kg=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.hb.id0=l.uc(l.Ic,a.Gc.id0,0);b||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c=a.Sc.sk;F.check_shape_keys(b)?F.kA(b,c)||(B.error("Wrong key name:",c),a.mute=!0):(B.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:F.Py(a.hb.id0,a.Sc.sk,a.P.skv?g(f(a.U.skv,b.G,c.G),0):a.sa.skv),
c.qa=a.Na}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.hb.id0=l.uc(l.Ic,a.Gc.id0,0);d||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);d&&d.v&&d.v.Yc||(B.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:d=a.hb.id0;switch(a.Sc.outline_operation){case "PLAY":b=d.v.Ki;l.apply_outline_anim(d,b.al,b.bl,b.cl);break;case "STOP":l.clear_outline_anim(d);break;case "INTENSITY":d.v.Nh=a.P["in"]?g(f(a.U["in"],b.G,c.G),0):a.sa["in"]}c.qa=
a.Na}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,d){switch(E.get_move_style(a)){case E.MS_TARGET_CONTROLS:E.MB(a,b,c);break;case E.MS_EYE_CONTROLS:case E.MS_STATIC:C.set_tsr(a,d);break;case E.MS_HOVER_CONTROLS:H.sub(c,b,O),H.normalize(O,O),E.hI(a,c),V[0]=O[0],V[1]=0,V[2]=O[2],b=H.dot(V,O),c=Math.acos(b/(H.length(V)*H.length(O))),b=O[2]?Math.atan(O[0]/O[2]):0<O[0]?0:Math.PI,0<O[2]&&0<O[0]?ia[1]=-(Math.PI+ia[1]):0<O[2]&&0>O[0]?ia[1]=-(Math.PI+ia[1]):0>O[2]&&0>O[0]?(ia[0]+=Math.PI,b=-(Math.PI-b)):
0>O[2]&&0<O[0]&&(ia[0]+=Math.PI,b-=Math.PI),E.CU(a,b+Math.PI,-c)}C.T(a);I.sync_transform(a)}function e(a,b,c,d){N.lookAt(b,c,m.AXIS_Z,T);N.invert(T,T);n.fromMat4(T,na);x.fromMat3(na,U);x.normalize(U,U);a=R.get_scale(a.v.C);R.set_sep(b,a,U,d)}switch(b.state){case 1:var h=null,h=a.hb.ca=l.uc(l.Ic,a.Gc.id0,0);h||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.hb.tr=l.uc(l.Ic,a.Gc.id1,0);a.hb.tr||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.hb.ta=
l.uc(l.Ic,a.Gc.id2,0);a.hb.ta||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.Ac={aJ:new Float32Array(3),$I:new Float32Array(3),tA:new Float32Array(3),gC:new Float32Array(3),VI:new Float32Array(3),sA:new Float32Array(3),yl:new Float32Array(8),Ti:new Float32Array(8),vr:new Float32Array(8)};break;case 2:var k=a.hb.ca,h=R.get_trans_view(a.hb.tr.v.C),p=R.get_trans_view(a.hb.ta.v.C);switch(a.state){case -1:b=a.P.dur?g(f(a.U.dur,b.G,c.G),0):a.sa.dur;if(0==b){e(k,
h,p,a.Ac.Ti);d(k,h,p,a.Ac.Ti);c.qa=a.Na;break}c=R.get_trans_view(k.v.C);H.copy(c,a.Ac.aJ);var v=E.get_move_style(k);v==E.MS_HOVER_CONTROLS?H.copy(k.v.vc,a.Ac.gC):v==E.MS_STATIC||v==E.MS_EYE_CONTROLS?(R.copy(k.v.C,a.Ac.yl),e(k,h,p,a.Ac.Ti)):H.copy(k.v.pivot,a.Ac.gC);H.copy(h,a.Ac.$I);H.copy(p,a.Ac.VI);a.state=0;var q=A.animate(0,1,1E3*b,function(b){w.La()&&(v==E.MS_STATIC||v==E.MS_EYE_CONTROLS?R.interpolate(a.Ac.yl,a.Ac.Ti,m.smooth_step(b),a.Ac.vr):(a.Ac.sA=H.lerp(a.Ac.gC,a.Ac.VI,m.smooth_step(b),
a.Ac.sA),a.Ac.tA=H.lerp(a.Ac.aJ,a.Ac.$I,m.smooth_step(b),a.Ac.tA)),d(k,a.Ac.tA,a.Ac.sA,a.Ac.vr),1==b&&(a.state=1))});break;case 1:A.clear_animation(q),a.state=-1,c.qa=a.Na}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d;d=a.hb.ca=l.uc(l.Ic,a.Gc.id0,0);d||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);b=d.v;a.jE={Ri:b.Ri,use_panning:b.use_panning,Ib:b.Ib,Pa:b.Pa,Cb:b.Cb,Vc:b.Vc,Wc:b.Wc,Fd:b.Fd,Og:b.Og};break;case 2:d=a.hb.ca;var e=d.v,h=a.jE;E.Ys(d);
switch(a.Sc.camera_move_style){case 0:e.nb=E.MS_STATIC;break;case 2:e.nb=E.MS_EYE_CONTROLS;var k=R.get_trans_view(e.C);E.oI(d,k,null,h.Ib,h.Pa);break;case 3:e.nb=E.MS_HOVER_CONTROLS;var k=R.get_trans_view(e.C),n=O;a.P.pvo?(n=l.uc(l.Ic,a.Gc.id1,0),n=R.get_trans_view(n.v.C)):(n[0]=a.P.pvx?g(f(a.U.pvx,b.G,c.G),0):a.sa.pvx,n[1]=a.P.pvy?g(f(a.U.pvy,b.G,c.G),0):a.sa.pvy,n[2]=a.P.pvz?g(f(a.U.pvz,b.G,c.G),0):a.sa.pvz);E.pI(d,k,n,h.Cb,h.Pa,h.Vc,h.Wc,h.Og);break;case 1:e.nb=E.MS_TARGET_CONTROLS,k=R.get_trans_view(e.C),
n=O,a.P.pvo?(n=l.uc(l.Ic,a.Gc.id1,0),n=R.get_trans_view(n.v.C)):(n[0]=a.P.pvx?g(f(a.U.pvx,b.G,c.G),0):a.sa.pvx,n[1]=a.P.pvy?g(f(a.U.pvy,b.G,c.G),0):a.sa.pvy,n[2]=a.P.pvz?g(f(a.U.pvz,b.G,c.G),0):a.sa.pvz),E.qI(d,k,n,h.Ib,h.Pa,h.Cb,h.Fd,h.use_panning)}V[0]=a.P.vtr?g(f(a.U.vtr,b.G,c.G),0):a.sa.vtr;V[1]=a.P.vro?g(f(a.U.vro,b.G,c.G),0):a.sa.vro;V[2]=a.P.vzo?g(f(a.U.vzo,b.G,c.G),0):a.sa.vzo;V[0]=m.clamp(V[0],0,Infinity);V[1]=m.clamp(V[1],0,Infinity);V[2]=m.clamp(V[2],0,.99);e.Jp=V[0];e.Ip=V[1];e.Kp=V[2];
C.T(d);I.sync_transform(d);E.wo(d);c.qa=a.Na}},SET_CAMERA_LIMITS:function(a,b,c){switch(b.state){case 1:var d;d=a.hb.ca=l.uc(l.Ic,a.Gc.id0,0);d||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c=d.v;a.jE={Ri:c.Ri,use_panning:c.use_panning,Ib:c.Ib,Pa:c.Pa,Cb:c.Cb,Vc:c.Vc,Wc:c.Wc,Fd:c.Fd,Og:c.Og};break;case 2:d=a.hb.ca;switch(d.v.nb){case E.MS_TARGET_CONTROLS:if(a.P.dsl){var e=a.P.dslmin?g(f(a.U.dslmin,b.G,c.G),0):a.sa.dslmin,h=a.P.dslmax?g(f(a.U.dslmax,b.G,c.G),0):a.sa.dslmax,
k={};k.min=Math.max(e,0);k.max=Math.max(h,0);E.ZH(d,k)}a.P.vrl&&(e=a.P.vrldown?g(f(a.U.vrldown,b.G,c.G),0):a.sa.vrldown,h=a.P.vrlup?g(f(a.U.vrlup,b.G,c.G),0):a.sa.vrlup,k={},k.down=e,k.up=h,k.camera_space="CAMERA"==a.Sc.cam_lim_vert_rot_space_type,E.Yw(d,k));a.P.hrl&&(e=a.P.hrlleft?g(f(a.U.hrlleft,b.G,c.G),0):a.sa.hrlleft,h=a.P.hrlright?g(f(a.U.hrlright,b.G,c.G),0):a.sa.hrlright,k={},k.left=e,k.right=h,k.camera_space="CAMERA"==a.Sc.cam_lim_hor_rot_space_type,E.Xw(d,k));a.P.pvl&&(e=a.P.pvlmin?g(f(a.U.pvlmin,
b.G,c.G),0):a.sa.pvlmin,b=a.P.pvlmax?g(f(a.U.pvlmax,b.G,c.G),0):a.sa.pvlmax,k={},k.min_z=e,k.max_z=b,E.kI(d,k));break;case E.MS_HOVER_CONTROLS:a.P.htl&&(e=a.P.htlmin?g(f(a.U.htlmin,b.G,c.G),0):a.sa.htlmin,h=a.P.htlmax?g(f(a.U.htlmax,b.G,c.G),0):a.sa.htlmax,k={},k.min=e,k.max=h,E.gI(d,k));a.P.vtl&&(e=a.P.vtlmin?g(f(a.U.vtlmin,b.G,c.G),0):a.sa.vtlmin,h=a.P.vtlmax?g(f(a.U.vtlmax,b.G,c.G),0):a.sa.vtlmax,k={},k.min=e,k.max=h,E.mI(d,k));a.P.vrl&&(e=a.P.vrldown?g(f(a.U.vrldown,b.G,c.G),0):a.sa.vrldown,h=
a.P.vrlup?g(f(a.U.vrlup,b.G,c.G),0):a.sa.vrlup,k={},k.down=e,k.up=h,k.camera_space="CAMERA"==a.Sc.cam_lim_vert_rot_space_type,E.hover_set_vertical_limits(d,k));a.P.dsl&&(e=a.P.dslmin?g(f(a.U.dslmin,b.G,c.G),0):a.sa.dslmin,h=a.P.dslmax?g(f(a.U.dslmax,b.G,c.G),0):a.sa.dslmax,k={},k.min=Math.max(e,0),k.max=Math.max(h,0),E.hover_set_distance_limits(d,k));break;case E.MS_EYE_CONTROLS:a.P.vrl&&(e=a.P.vrldown?g(f(a.U.vrldown,b.G,c.G),0):a.sa.vrldown,h=a.P.vrlup?g(f(a.U.vrlup,b.G,c.G),0):a.sa.vrlup,k={},
k.down=e,k.up=h,k.camera_space="CAMERA"==a.Sc.cam_lim_vert_rot_space_type,E.Yw(d,k)),a.P.hrl&&(e=a.P.hrlleft?g(f(a.U.hrlleft,b.G,c.G),0):a.sa.hrlleft,h=a.P.hrlright?g(f(a.U.hrlright,b.G,c.G),0):a.sa.hrlright,k={},k.left=e,k.right=h,k.camera_space="CAMERA"==a.Sc.cam_lim_hor_rot_space_type,E.Xw(d,k))}C.T(d);I.sync_transform(d);c.qa=a.Na}},MOVE_TO:function(a,b,c){function d(a,b){C.set_tsr(a,b);C.T(a);I.sync_transform(a)}switch(b.state){case 1:a.hb.ob=l.uc(l.Ic,a.Gc.id0,0);a.hb.ob||(B.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0);a.hb.de=l.uc(l.Ic,a.Gc.id1,0);a.hb.de||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.rc={dF:new Float32Array(8),Dz:new Float32Array(8),jG:new Float32Array(8)};break;case 2:var e=a.hb.ob;R.copy(a.hb.ob.v.C,a.rc.dF);R.copy(a.hb.de.v.C,a.rc.Dz);switch(a.state){case -1:b=a.P.dur?g(f(a.U.dur,b.G,c.G),0):a.sa.dur;if(0==b){d(e,a.rc.Dz);c.qa=a.Na;break}a.state=0;var h=A.animate(0,1,1E3*b,function(b){w.La()&&(a.rc.bZ=R.interpolate(a.rc.dF,a.rc.Dz,
m.smooth_step(b),a.rc.jG),d(e,a.rc.jG),1==b&&(a.state=1))});break;case 1:A.clear_animation(h),a.state=-1,c.qa=a.Na}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?C.set_tsr(a,b):C.set_tsr_rel(a,b);C.T(a);I.sync_transform(a)}switch(b.state){case 1:a.hb.ob=l.uc(l.Ic,a.Gc.id0,0);a.hb.ob||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.rc={qx:0,yl:new Float32Array(8),Ti:new Float32Array(8),vr:new Float32Array(8)};break;case 2:var e=a.hb.ob;switch(a.state){case -1:V[0]=
a.P.trx?g(f(a.U.trx,b.G,c.G),0):a.sa.trx;V[1]=a.P["try"]?g(f(a.U["try"],b.G,c.G),0):a.sa["try"];V[2]=a.P.trz?g(f(a.U.trz,b.G,c.G),0):a.sa.trz;O[0]=a.P.rox?g(f(a.U.rox,b.G,c.G),0)*Math.PI/180:a.sa.rox;O[1]=a.P.roy?g(f(a.U.roy,b.G,c.G),0)*Math.PI/180:a.sa.roy;O[2]=a.P.roz?g(f(a.U.roz,b.G,c.G),0)*Math.PI/180:a.sa.roz;var h=a.P.sc?f(a.U.sc,b.G,c.G):a.sa.sc;m.euler_to_quat(O,U);R.set_sep(V,h,U,a.rc.Ti);a.rc.qx=a.Sc.space_type;switch(a.rc.qx){case 0:C.get_tsr(e,a.rc.yl);break;case 1:C.get_tsr_rel(e,a.rc.yl);
break;case 2:C.get_tsr_rel(e,a.rc.yl),R.multiply(a.rc.yl,a.rc.Ti,a.rc.Ti)}b=a.P.dur?g(f(a.U.dur,b.G,c.G),0):a.sa.dur;if(0==b){d(e,a.rc.Ti,a.rc.qx);c.qa=a.Na;break}a.state=0;h=A.animate(0,1,1E3*b,function(b){w.La()&&(R.interpolate(a.rc.yl,a.rc.Ti,m.smooth_step(b),a.rc.vr),d(e,a.rc.vr,a.rc.qx),1==b&&(a.state=1))});break;case 1:A.clear_animation(h),a.state=-1,c.qa=a.Na}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=l.uc(l.Ic,a.Gc.id0,0);a.obj||(B.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0);void 0==a.P.not_wait&&(a.P.not_wait=!0);break;case 2:switch(J.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.Ce){var e=b.Ce[d].zg.qa;-1!=e&&(e=b.Ce[d].Z[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}a.P.not_wait||(c.kg=!0);J.play_def(a.obj);a.state=0;break;case 0:a.P.not_wait&&(c.qa=a.Na,a.state=-1);break;case 1:a.P.not_wait||(c.kg=!1);c.qa=a.Na;a.state=-1;break;default:m.I("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,
b,c){switch(b.state){case 1:a.obj=l.uc(l.Ic,a.Gc.id0,0);a.obj||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:J.stop(a.obj),c.qa=a.Na}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.P.env?l.get_world_by_name(a.Yq[0],0):u(a);a.obj||(B.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:p.stop(a.obj,p.SLOT_ALL),a.P.rst&&p.set_first_frame(a.obj,p.SLOT_ALL),c.qa=a.Na}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.P.rst&&
z.jI(d),z.$B(),c.qa=a.Na}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.U)d[a.U[e][1]]=f(a.U[e],b.G,c.G);B.log(a.Sc.msg,JSON.stringify(d));c.qa=a.Na}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.P.id0?g(f(a.U.id0,b.G,c.G),1):a.ck.id0,e=a.P.id1?g(f(a.U.id1,b.G,c.G),1):a.ck.id1,h=0;switch(a.Sc.string_operation){case 0:h=d+e;break;case 1:h=d.indexOf(e);break;case 2:h=d.replace(e,a.P.id2?g(f(a.U.id2,b.G,c.G),1):a.ck.id2);break;case 3:var l=a.U,h=d.substring(0,d.indexOf(e));
k(l.dst1,b.G,c.G,d.substring(d.indexOf(e)+1,d.length));""==f(l.dst,b.G,c.G)&&(h=f(l.dst1,b.G,c.G),k(l.dst1,b.G,c.G,""));break;case 4:switch(a.Sc.condition){case 5:h=d==e?1:0;break;case 4:h=d!=e?1:0;break;case 3:h=d<e?1:0;break;case 2:h=d>e?1:0;break;case 1:h=d<=e?1:0;break;case 0:h=d>=e?1:0}}k(a.U.dst,b.G,c.G,h);c.qa=a.Na}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=a.P.nla?g(z.get_frame(d),0):g(A.get_frame(d),0),k(a.U.vd,b.G,c.G,d),c.qa=a.Na}},JSON:function(a,b,c){function e(a,b,c,e){for(var f=
0;f<b.length;f++){for(var g=b[f].split("."),h=a,k=c[f],l=0;l<g.length&&(h=h[g[l]],void 0!==h&&null!==h);l++);h=d(h);e[k]=h}}function h(a,b,c,e){e||(e={});for(var f=0;f<b.length;f++){var g=b[f].split("."),h=e,k=c[f];if(k in a){for(var l=0;l<g.length-1;l++)void 0===h[g[l]]&&(h[g[l]]=isNaN(g[l+1])?{}:[]),h=h[g[l]];h[g[g.length-1]]=d(a[k])}}}switch(b.state){case 2:switch(a.Sc.json_operation){case "PARSE":try{var l=JSON.parse(g(f(a.U.jsn,b.G,c.G),1));e(l,a.aT,a.bT,c.G)}catch(za){B.error("logic script error: non valid JSON string")}break;
case "ENCODE":l={},h(c.G,a.FP,a.GP,l),l=g(JSON.stringify(l),1),k(a.U.jsn,b.G,c.G,l)}c.qa=a.Na}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var e=a.P.cb?g(f(a.U.cb,b.G,c.G),1):a.ck.cb,h=[],m=0,n="id"+m,p=a.Sc.js_cb_params;n in p;)n=0==p[n]?l.uc(l.Ic,a.Gc[n],0):f(a.U[n],b.G,c.G),h.push(n),m++,n="id"+m;p=[];m=0;for(n="out"+m;n in a.U;)n=f(a.U[n],b.G,c.G),p.push(n),m++,n="out"+m;m=1;if(e in qa){if(m=!qa[e](h,p))for(e=0;e<p.length;e++)n="out"+e,n in a.U&&k(a.U[n],b.G,c.G,d(p[e]))}else B.error("logic script error: no custom callback with id "+
e);m&&(c.qa=a.Na)}},EMPTY:q,DATE_TIME:function(a,b,c){switch(b.state){case 2:var d=new Date,e,f,g,h,l;"L"==a.Sc.time_type?(e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=d.getHours(),l=d.getMinutes(),d=d.getSeconds()):(e=d.getUTCFullYear(),f=d.getUTCMonth(),g=d.getUTCDate(),h=d.getUTCHours(),l=d.getUTCMinutes(),d=d.getUTCSeconds());a.P.y&&k(a.U.y,b.G,c.G,e);a.P.M&&k(a.U.M,b.G,c.G,f);a.P.d&&k(a.U.d,b.G,c.G,g);a.P.h&&k(a.U.h,b.G,c.G,h);a.P.m&&k(a.U.m,b.G,c.G,l);a.P.s&&k(a.U.s,b.G,c.G,d);c.qa=a.Na}},
ELAPSED:function(a,b,c,d,e){switch(b.state){case 2:k(a.U.s,b.G,c.G,e),c.qa=a.Na}}},ea=[],qa={},Z={};a.CR=function(a,b){var c={ce:b,VH:a.name,state:0,Rm:null,jb:a,yz:null,Ce:[],ts:[],G:{}};a.GX=c;y(a,c)};a.update=function(a,b){var c=z.fR();if(!(0>=c))for(var d=0;d<ea.length;d++)for(var e=d,f=a,g=b,h=c,k=ea[e],l=0;l<ea[e].Ce.length;l++){k.yz=ea[e].Ce[l];var m=ea[e].Ce[l],n=k,p=f,v=g,q=h,r=m.Z;if(r.length){for(var u=0;u<r.length;u++)r[u].Jw=!1;for(u=0;u<r.length;u++){if(0<=m.zg.qa)var x=r[m.zg.qa];else break;
if(x.Jw)break;if(x.mute)if("ENTRYPOINT"==x.type)break;else m.zg.qa=x.Na,x.Jw=!0;else x.AH(x,n,m.zg,p,v,q),x.Jw=!0}}}};a.sM=function(a,b){qa[a]=b};a.AT=function(a){delete qa[a]};a.UT=function(a,b){for(var c=0;c<ea.length;c++)if(ea[c].VH==a){for(var c=ea[c],d=0;d<c.Ce.length;d++){var e=c.Ce[d].Z[0];if(e.name==b){e.P.js&&(e.mute=!1);c.Ce[d].zg.qa=0;break}}break}};a.cleanup=function(){ea.length=0;qa={};Z={}}};b4w.module.__main=function(a,t){function e(a,b,d){var e=c.get_canvas();if(e.toBlob)e.toBlob(a,b,d);else{d=atob(e.toDataURL(b,d).split(",")[1]);for(var e=new Uint8Array(d.length),f=0;f<d.length;f++)e[f]=d.charCodeAt(f);a(new Blob([e],{type:b||"image/png"}))}}var c=t("__container"),b=null,f="image/png",k=1,q="",h=!1,u=!1;a.canvas_data_url=function(a,c,d,e){h=u="undefined"===typeof e?e:!0;b=a;f=c||f;k=d||k};a.frame=function(){var a=b;a&&(h&&URL.revokeObjectURL(q),e(function(b){q=URL.createObjectURL(b);
a(q)},f,k),b=null,f="image/png",k=1)}};b4w.module.__math=function(a,t){function e(a,b){for(var c=a[1],d=1,e=2;e<a.length;e++)4!=e&&8!=e&&Math.abs(a[e])>Math.abs(c)&&(c=a[e],d=e);for(var f=Math.floor(d/3),d=d%3,c=.5*Math.atan(2*c/(a[3*f+f]-a[3*d+d])),e=0;e<b.length;e++)b[e]=e&&4!=e&&8!=e?0:1;b[d+3*f]=-Math.sin(c);b[f+3*d]=Math.sin(c);b[f+3*f]=Math.cos(c);b[d+3*d]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var c=a.content[b];0<b;){var d=(b+1>>1)-1,e=a.content[d];if(a.an(c)<a.an(e))a.content[d]=
c,a.content[b]=e,b=d;else break}}function f(a,b){for(var c=a.content.length,d=a.content[b],e=a.an(d);;){var f=b+1<<1,g=f-1,h=null;if(g<c){var k=a.an(a.content[g]);k<e&&(h=g)}f<c&&a.an(a.content[f])<(null===h?e:k)&&(h=f);if(null!==h)a.content[b]=a.content[h],a.content[h]=d,b=h;else break}}function k(a,b,c,d){return c-q(d-a,0,c,d)+b}function q(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*
a+.984375)+b}var h=t("__mat3"),u=t("__vec3"),y=new Float32Array(3),g=new Float32Array(9),d=new Float32Array(9),r=new Float32Array(9),p=new Float32Array(9);a.get_pline_directional_vec=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};a.get_pline_initial_point=function(a,b){b=b||new Float32Array(3);return u.copy(a,b)};a.set_pline_initial_point=function(a,b){u.copy(b,a)};a.set_pline_directional_vec=function(a,b){u.normalize(b,y);a[3]=y[0];a[4]=y[1];a[5]=y[2]};a.calc_pline_point=
function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b;return c};a.nN=function(a,b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return u.scale(b,3/a.length,b)};a.kN=function(a,b,c){for(var d=0;d<c.length;d++)c[d]=0;for(d=0;d<a.length;d+=3){var e=a[d]-b[0],f=a[d+1]-b[1],g=a[d+2]-b[2];c[0]+=e*e;c[1]+=e*f;c[2]+=e*g;c[4]+=f*f;c[5]+=f*g;c[8]+=g*g}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(d=0;d<c.length;d++)c[d]*=3/a.length;return c};
a.UP=function(a,b){var f=h.copy(a,g);if(5E-4>c(f))return h.identity(b);var k=e(f,d),q=h.transpose(k,r);h.multiply(f,q,p);h.multiply(k,p,f);for(var u=h.copy(k,b),y=1;5E-4<=c(f)&&100>y;)k=e(f,d),q=h.transpose(k,r),h.multiply(f,q,p),h.multiply(k,p,f),h.multiply(k,u,u),y++;return u};a.point_plane_dist=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]};a.WM=function(a){return{content:[],an:a}};a.UD=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.XM=function(a){var b=a.content[0],c=a.content.pop();
0<a.content.length&&(a.content[0]=c,f(a,0));return b};a.SX=function(a,c){var d=a.content.indexOf(c),e=a.content.pop();d!==a.content.length-1&&(a.content[d]=e,a.an(e)<a.an(c)?b(d):f(d))};a.YM=function(a,c){b(a,a.content.indexOf(c))};a.linear_tween=function(a,b,c,d){return c*a/d+b};a.ease_in_quad=function(a,b,c,d){return c*(a/=d)*a+b};a.ease_out_quad=function(a,b,c,d){return-c*(a/=d)*(a-2)+b};a.ease_in_out_quad=function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b};a.ease_in_cubic=function(a,
b,c,d){return c*(a/=d)*a*a+b};a.ease_out_cubic=function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b};a.ease_in_out_cubic=function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b};a.ease_in_quart=function(a,b,c,d){return c*(a/=d)*a*a*a+b};a.ease_out_quart=function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b};a.ease_in_out_quart=function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b};a.ease_in_quint=function(a,b,c,d){return c*(a/=d)*a*a*a*a+b};a.ease_out_quint=function(a,b,c,d){return c*
((a=a/d-1)*a*a*a*a+1)+b};a.ease_in_out_quint=function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b};a.ease_in_sine=function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b};a.ease_out_sine=function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b};a.ease_in_out_sine=function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b};a.ease_in_expo=function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b};a.ease_out_expo=function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b};a.ease_in_out_expo=
function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b};a.ease_in_circ=function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b};a.ease_out_circ=function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b};a.ease_in_out_circ=function(a,b,c,d){return 1>(a/=d/2)?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b};a.ease_in_elastic=function(a,b,c,d){var e=0,f=c;if(0==a)return b;if(1==(a/=d))return b+c;e||(e=.3*d);f<Math.abs(c)?(f=c,c=e/4):c=e/(2*
Math.PI)*Math.asin(c/f);return-(f*Math.pow(2,10*--a)*Math.sin(2*(a*d-c)*Math.PI/e))+b};a.ease_out_elastic=function(a,b,c,d){var e,f=0,g=c;if(0==a)return b;if(1==(a/=d))return b+c;f||(f=.3*d);g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g);return g*Math.pow(2,-10*a)*Math.sin(2*(a*d-e)*Math.PI/f)+c+b};a.ease_in_out_elastic=function(a,b,c,d){var e,f=0,g=c;if(0==a)return b;if(2==(a/=d/2))return b+c;f||(f=.3*d*1.5);g<Math.abs(c)?(g=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/g);return 1>a?-.5*g*Math.pow(2,
10*--a)*Math.sin(2*(a*d-e)*Math.PI/f)+b:g*Math.pow(2,-10*--a)*Math.sin(2*(a*d-e)*Math.PI/f)*.5+c+b};a.ease_in_back=function(a,b,c,d,e){void 0==e&&(e=1.70158);return c*(a/=d)*a*((e+1)*a-e)+b};a.ease_out_back=function(a,b,c,d,e){void 0==e&&(e=1.70158);return c*((a=a/d-1)*a*((e+1)*a+e)+1)+b};a.ease_in_out_back=function(a,b,c,d,e){void 0==e&&(e=1.70158);return 1>(a/=d/2)?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b};a.ease_in_bounce=k;a.ease_out_bounce=q;a.ease_in_out_bounce=
function(a,b,c,d){return a<d/2?.5*k(2*a,0,c,d)+b:.5*q(2*a-d,0,c,d)+.5*c+b}};b4w.module.__navmesh=function(a,t){function e(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.Fl,f=c.Fl,g=[],h=0;h<e.length;h++)0<=b(f,e[h])&&g.push(e[h]);if(2>g.length)return[];0<=b(g,e[0])&&0<=b(g,e[e.length-1])&&d(e);0<=b(g,f[0])&&0<=b(g,f[f.length-1])&&d(f);g=[];for(h=0;h<e.length;h++)0<=b(f,e[h])&&g.push(e[h]);return g}function c(a){function b(a){for(var c=a.dh,d=0;d<c.length;d++){var e=c[d];void 0==e.island&&(e.island=a.island,b(e))}}a=a.lT;for(var c=[],d=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=d++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[e])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function f(a){function b(a,b){for(var c=0;c<a.length;c++)if(b===a[c])return c}for(var d={},f=a.Mp,g=0;g<f.length;g++)f[g][0]=parseFloat(f[g][0].toFixed(2)),f[g][1]=parseFloat(f[g][1].toFixed(2)),f[g][2]=parseFloat(f[g][2].toFixed(2));d.Mp=a.Mp;a=c(a);d.xA=[];for(g=0;g<a.length;g++){for(var f=
[],h=a[g],k=0;k<h.length;k++){for(var m=[],l=h[k],n=0;n<l.dh.length;n++)m.push(b(h,l.dh[n]));for(var p=[],n=0;n<l.dh.length;n++)p.push(e(l,l.dh[n]));l.ed[0]=parseFloat(l.ed[0].toFixed(2));l.ed[1]=parseFloat(l.ed[1].toFixed(2));l.ed[2]=parseFloat(l.ed[2].toFixed(2));f.push({id:b(h,l),dh:m,Fl:l.Fl,ed:l.ed,Xc:l.Xc,mT:p,Oz:0,ir:0,Rb:0,aO:1,EC:!1,closed:!1,parent:null})}d.xA.push(f)}return d}function k(a,b,c,d,e){function f(a,b){B.subtract(a,b,G);return B.dot(G,G)}function g(a,b){for(var c=[],d=0;d<b.dh.length;d++)c.push(a[b.dh[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.Oz=0;c.ir=0;c.Rb=0;c.aO=1;c.EC=!1;c.closed=!1;c.parent=null}})(a);var h=E.WM(function(a){return a.Oz});for(E.UD(h,b);0<h.content.length;){var k=E.XM(h);if(k===c){a=k;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}k.closed=!0;for(var m=g(a,k),l=0,n=m.length;l<n;l++){var p=m[l];if(!p.closed){var v=k.ir+B.dist(p.ed,k.ed),q=p.EC;if(!q||v<p.ir)p.EC=!0,p.parent=k,p.Rb=p.Rb||f(p.ed,e)+f(p.ed,d),p.ir=v,p.Oz=p.ir+p.Rb,q?E.YM(h,
p):E.UD(h,p)}}}return[]}function q(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function h(a,b,c,d){b=B.subtract(b,a,G);a=B.subtract(c,a,v);a=B.cross(b,a,G);return l.sign(B.dot(d,a))}function u(a,b){B.subtract(a,b,G);return 1E-5>B.dot(G,G)}function y(a,b,c){var d=B.subtract(b.right,b.left,G),e=c.Xc,f=b.Xc;c=Math.acos(B.dot(e,f));e=l.sign(B.dot(d,B.cross(e,f,v)));c*=-e;e=z.identity(x);z.translate(e,b.left,e);z.rotate(e,c,d,e);z.translate(e,B.scale(b.left,-1,v),e);z.multiply(a,e,a)}function g(a,b,c,
d,e,f,g,h,k){for(var m=z.identity(N),l=e;l<c;l++)if(a[l].rG&&(l>e||!l)){var p,v=b,r=d;p=a[l].left;var u=a[l].right,x=f,A=m,t=B.create(),J=B.transformMat4(p,A,D);J[3]=1;A=B.transformMat4(u,A,G);A=B.subtract(A,J,F);v=B.subtract(r,v,G);x=B.cross(x,v,n);.01>Math.abs(B.dot(x,A))?r=.5:(B.normalize(x,x),x[3]=-B.dot(x,r),r=-w.dot(x,J)/w.dot(x,A));u=B.subtract(u,p,G);p=B.scaleAndAdd(p,u,r,t);q(g,p);h&&q(k,a[l].Xc);l&&y(m,a[l],a[l-1])}}function d(a,b){function c(b,c){F=x=r=c;l=k=f=b;B.copy(b,n);B.copy(b,p);
B.copy(a[r].Xc,v)}var d=[],e=[],f,k,l,n,p,v,r=0,x=0,F=0;f=a[0].right;k=a[0].left;l=a[0].right;n=B.copy(k,J);p=B.copy(l,A);v=B.copy(a[0].Xc,m);q(d,f);b&&q(e,a[0].Xc);for(var w=z.identity(I),D=1;D<a.length;D++){var t=a[D].left,E=a[D].right,G=B.transformMat4(t,w,C),H=B.transformMat4(E,w,R);a[D].rG&&y(w,a[D],a[D-1]);if(0>=h(f,p,H,v)){var N=u(f,l);if(N||0<h(f,n,H,v))l=E,B.copy(H,p),F=D;else{(t=u(n,f))||g(a,n,x,f,r,v,d,b,e);w=z.identity(w);c(k,x);D=r;t||(q(d,f),b&&q(e,a[D].Xc));continue}}0<=h(f,n,G,v)&&
((N=u(f,k))||0>h(f,p,G,v)?(k=t,B.copy(G,n),x=D):((t=u(p,f))||g(a,p,F,f,r,v,d,b,e),w=z.identity(w),c(l,F),D=r,t||(q(d,f),b&&q(e,a[D].Xc))))}w=a.length-1;D=a[w].left;(t=u(f,D))||g(a,n,w,f,r,v,d,b,e);t&&r||q(d,D);return b?(q(e,a[w].Xc),{positions:new Float32Array(d),normals:new Float32Array(e)}):{positions:new Float32Array(d),normals:null}}function r(a,b,c,d,e){for(var f=null,g=Number.MAX_VALUE,h=0;h<a.length;h++){var k=a[h],m=e(c,k.ed,k.Fl,b,g);m<g&&(f=k,g=m)}return 0<d&&g>d?null:f}function p(a,b,c,
d,e){a.push({left:b,right:c,rG:d,Xc:e})}var M=t("__geometry"),E=t("__math"),z=t("__mat4"),l=t("__util"),B=t("__vec3"),w=t("__vec4"),G=B.create(),v=B.create(),D=w.create(),F=w.create(),n=w.create(),N=z.create(),I=z.create(),x=z.create(),J=B.create(),A=B.create(),C=B.create(),R=B.create(),m=B.create();a.OS=function(a){var b=M.bA(a.gc,M.Dn),c=a.fe;a=[];for(var d=0;d<c.length;d+=3)a.push({xa:new Uint32Array([c[d],c[d+1],c[d+2]]),ed:new Float32Array(3),Xc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var e=new Float32Array(3);e[0]=b[d];e[1]=b[d+1];e[2]=b[d+2];c.push(e)}for(b=0;b<a.length;b++)d=a[b],B.add(c[d.xa[0]],c[d.xa[1]],G),B.add(G,c[d.xa[2]],G),B.scale(G,1/3,d.ed);for(b=0;b<a.length;b++){var d=a[b],e=B.subtract(c[d.xa[1]],c[d.xa[0]],G),g=B.subtract(c[d.xa[2]],c[d.xa[0]],v),e=B.cross(e,g,G);B.normalize(e,e);B.copy(e,d.Xc)}for(var h={},b=[],d=[],k,m,l=Math.pow(10,4),e=0,g=c.length;e<g;e++)k=c[e],m=Math.round(k[0]*l)+"_"+Math.round(k[1]*l)+"_"+Math.round(k[2]*l),void 0===h[m]?(h[m]=e,b.push(k),
d[e]=b.length-1):d[e]=d[h[m]];h=[];e=0;for(g=a.length;e<g;e++)for(k=a[e],k.xa[0]=d[k.xa[0]],k.xa[1]=d[k.xa[1]],k.xa[2]=d[k.xa[2]],k=[k.xa[0],k.xa[1],k.xa[2]],m=0;3>m;m++)if(k[m]==k[(m+1)%3]){h.push(e);break}for(e=h.length-1;0<=e;e--)a.splice(h[e],1);for(e=c.length=0;e<b.length;e++)c.push(b[e]);d=[];for(b=e=0;b<a.length;b++)g=a[b],d.push({id:e++,Fl:g.xa,ed:g.ed,Xc:g.Xc,dh:[]});a={lT:d,Mp:c};c={};for(b=0;b<d.length;b++)for(e=0;3>e;e++)g=d[b].Fl[e],h=d[b].Fl[(e+1)%3],g=g>h?h+"-"+g:g+"-"+h,g in c||(c[g]=
[]),c[g].push(d[b]);d=Object.keys(c);b=0;for(h=d.length;b<h;b++)for(g=d[b],e=0;e<c[g].length;e++)for(k=e+1;k<c[g].length;k++)c[g][e].dh.push(c[g][k]),c[g][k].dh.push(c[g][e]);return f(a)};a.navmesh_get_island=function(a,b,c){for(var d=null,e=Number.MAX_VALUE,f=a.xA,g=0;g<f.length;g++)for(var h=0;h<f[g].length;h++){var k=f[g][h];B.subtract(k.ed,b,G);k=c(b,k.ed,k.Fl,a.Mp,e);k<e&&(d=g,e=k)}return d};a.RR=function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(c[b[e]]);b=!1;c=-1;for(var e=d.length,f=e-
1;++c<e;f=c)(d[c][1]<=a[1]&&a[1]<d[f][1]||d[f][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[f][0]-d[c][0])*(a[1]-d[c][1])/(d[f][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.navmesh_find_path=function(a,b,c,e){var f;f=a.xA[e.island];var g=a.Mp,h=r(f,g,b,e.allowed_distance,e.distance_to_closest);f=h?(g=r(f,g,c,e.allowed_distance,e.distance_to_farthest))?k(f,h,g,b,c):null:null;if(f&&f.length)if(e.do_not_pull_string)if(c=f,e.return_normals){b=new Float32Array(3*c.length);for(f=0;f<c.length;f++)b.set(c[f].ed,3*f);
c={positions:b,normals:null}}else{b=new Float32Array(3*c.length);a=new Float32Array(3*c.length);for(f=0;f<c.length;f++)b.set(c[f].ed,3*f),a.set(c[f].Xc,3*f);c={positions:b,normals:a}}else{a=a.Mp;e=e.return_normals;h=[];p(h,b,b,!1,f[0]&&f[0].Xc||l.AXIS_Z);for(b=0;b<f.length;b++){var m=f[b];if(g=f[b+1]){var n=.999>Math.abs(B.dot(m.Xc,g.Xc));a:{for(var v=0;v<m.dh.length;v++)if(m.dh[v]===g.id){m=m.mT[v];break a}m=void 0}p(h,a[m[0]],a[m[1]],n,g.Xc)}}p(h,c,c,!1,h[h.length-1].Xc);c=d(h,e)}else c=null;return c}};b4w.module.__nla=function(a,t){function e(a,b){for(var c=d.vQ(),e=[],f=0,g=0;g<a.length;g++){var h=a[g];""!=h.cq?h=w.keysearch("uuid",h.cq,c):(h=h.Ig,h=w.keysearch("name",h,c)||w.keysearch("name",h+"_B4W_BAKED",c));if(h){var h=h.fcurves,k=[],l;for(l in h)k.push(l);e.push(k)}}for(g=0;g<e.length;g++){c=!1;for(l=0;l<g;l++)if(w.JM(e[g],e[l])){a[g].Dc=a[l].Dc;c=!0;break}c||(a[g].Dc=b+f++)}return f}function c(){return{type:"CLIP",za:0,gb:0,Uj:!1,paused:!1,Ig:"",cq:"",Dc:0,Io:null,qk:0,Ml:0,lF:0,kF:0,AJ:!1,
scale:1,repeat:1,zD:0}}function b(a,c,d){if(a.animation_data){var e=a.animation_data.nla_tracks;if(e)for(var f=0;f<e.length;f++)e[f].Io=d,c.push(e[f])}a=a.nodes;for(f=0;f<a.length;f++)if(e=a[f],e.node_group){var g=e.node_group.node_tree;if(g){var h=d.slice();h.push(e.name);b(g,c,h)}}}function f(a,b){var c=Math.round(a)-b.za;b.ik&&(c%=b.Hk,0>c&&(c+=b.Hk));return b.ec+c}function k(a,b){var c=(b-v)*B.Dd()+a.ec;c>a.za?(c-=a.za,a.cyclic&&(c%=a.gb-a.za+1),c+=a.za):c=a.za;return c}function q(a,b){a=w.clamp(a,
b.za,b.gb);var c=a==b.gb?b.zD:b.qk+(a-b.za)/b.scale%(b.Ml-b.qk);b.AJ&&(c=b.Ml-c+b.qk);return c}function h(a,b){for(var d=[],e=0;e<a.length;e++){var f=a[e],g=f.strips;if(g)for(var h=0;h<g.length;h++){var k=g[h],l=c();l.type=k.type;l.za=k.frame_start;l.gb=k.frame_end;l.Dc=b;l.qk=k.action_frame_start;l.Ml=k.action_frame_end;l.AJ=k.use_reverse;l.scale=k.scale;l.repeat=k.repeat;k.action&&(l.Ig=k.action.name,l.cq=k.action.uuid,l.Io=f.Io);d.push(l)}}return d}function u(a){return("SPEAKER"==a.type||"LAMP"==
a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function y(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.Md;if(c=c.Bg&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}function g(a,b){var c=E.get_active();if(c.Ba){var d=k(c.Ba,b);c.Ba.ec-=d-a;c.Ba.jo=!0}}var d=t("__animation"),r=t("__objects"),p=t("__obj_util"),
M=t("__print"),E=t("__scenes"),z=t("__sfx"),l=t("__textures"),B=t("__time"),w=t("__util"),G=[],v=-1;a.Ap=function(a,d){for(var f,g=null,k=d.O.length-1;0<=k&&(f=d.O[k],!f.jb.b4w_use_nla||(g=f,!f.jb.vD));k--);if(f=g){f.mH=!0;g=0;if((k=a.animation_data)&&k.nla_tracks.length){var l=k.nla_tracks;if(p.is_armature(d)||p.is_camera(d)||p.is_mesh(d)||p.is_empty(d)||p.is_line(d)||p.is_lamp(d)||p.is_speaker(d)||p.is_world(d))l=h(l,g),l.length&&(d.Df=d.Df.concat(l),g++)}u(a)&&(l=a.data.animation_data.nla_tracks,
l=h(l,g),l.length&&(d.Df=d.Df.concat(l),g++));if(p.is_mesh(d))for(var v=d.kc,k=0;k<v.length;k++){var q=v[k];q.Bg&&q.Md&&(l=[],b(q.Md,l,[q.name]),l=h(l,g),l.length&&(g+=e(l,g),d.Df=d.Df.concat(l)))}if(p.is_world(d))a.use_nodes&&a.node_tree&&(l=[],b(a.node_tree,l,[a.name]),l=h(l,g),l.length&&(e(l,g),d.Df=d.Df.concat(l)));else{for(k=0;k<a.particle_systems.length;k++)l=a.particle_systems[k],v=l.settings,"EMITTER"==v.type&&v.b4w_allow_nla&&(v=c(),v.type="CLIP",v.za=f.jb.frame_start,v.gb=f.jb.frame_end+
1,v.Ig=l.name,v.Dc=g,v.qk=v.za,v.Ml=v.gb,d.Df.push(v),g++);f=g+1;for(k=0;k<d.ad.length;k++)l=d.ad[k],l.kM&&(g=f,v=c(),v.type="CLIP",v.za=l.za,v.gb=l.gb,v.Ig=l.name,v.Dc=g,v.qk=v.za,v.Ml=v.gb,d.Df.push(v))}}};a.bW=function(a,b,d){a.Ba||(a.Ba={za:a.frame_start,gb:a.frame_end,ec:0,Dr:-1,as:a.frame_end,bs:a.frame_start,rn:null,cyclic:b,hb:[],ka:[],VH:a.name,Tk:!1,jo:!1,BB:!0},G.push(a.Ba));b=a.Ba;for(var e=r.QF(a,"ALL",d),f=0;f<e.length;f++){var g=e[f];if(g.Df.length){b.hb[d]||(b.hb[d]=[]);for(var h=
0;h<g.O.length;h++){var k=g.O[h];k.jb==a&&k.mH&&b.hb[d].push(g)}for(var h=g.Df,k=b,l=g.name,n=0;n<h.length;n++){var m=h[n];k.za>m.gb||k.gb<m.za?(M.warn("NLA: Strip is out of scene range: "+(l+" ["+m.za+":"+m.gb+"]")),h.splice(n,1),n--):m.Ig||"CLIP"!=m.type||(M.warn('NLA: no action in strip for object "'+l+'".'),h.splice(n,1),n--)}g=g.Df;h=b;for(k=0;k<g.length;k++){for(var l=g[k],n=h.za,m=h.gb+1,p=0;p<g.length;p++){var v=g[p];l.Dc==v.Dc&&(v.gb<=l.za&&(n=l.za),v.za>=l.gb&&(m=Math.min(m,v.za)))}l.lF=
n;l.kF=m;l.zD=l.repeat%1?l.qk+l.repeat%1*(l.Ml-l.qk):l.Ml}}}a=a.J.Np;for(f=0;f<a.length;f++)e=a[f].J,e.Cl&&(e.eb||e.Gd)&&e.Xs==d&&(g=c(),g.type="VIDEO",e.ik?(g.za=0,g.gb=b.gb):(g.za=w.clamp(e.za,0,b.gb),g.gb=w.clamp(e.za+e.Hk,0,b.gb)),g.Ig=a[f].name,b.ka.push(e))};a.start=function(){v=0};a.fR=function(){return v};a.HY=function(a){return a.Ba?a.Ba.ec:null};a.CZ=function(a,b){return a.Ba?(a.Ba.ec=b,!0):!1};a.update=function(a,b){if(!(0>v)){0==v&&(v=a);for(var c=0;c<G.length;c++){var e=G[c];e.Tk&&(e.ec-=
B.Dd()*b);var h=k(e,a);if((!e.Tk||e.jo)&&h>=e.as)if(e.cyclic){var h=e,p=a;h.rn&&h.rn();g(h.bs,p);h.BB=!0;h=k(h,p)}else{var p=e,r=h;p.Tk=!0;p.ec-=r-p.as;p.rn&&p.rn()}if(!e.Tk||e.jo){for(var p=e,r=h,u=0;u<p.hb.length;u++){var F=p.hb[u];if(F)for(var y=0;y<F.length;y++){for(var m=F[y],t=m.Df,D=0;D<t.length;D++){var E=t[D];"SOUND"==E.type&&r<p.Dr-1E-6&&(E.Uj=!1)}for(D=0;D<t.length;D++)switch(E=t[D],E.type){case "CLIP":if(E.lF<=r&&r<E.kF&&!E.Uj){var u=m,M=E,ia=M.Io;""!=M.cq?d.EM(u,ia,M.cq,M.Dc):d.apply(u,
ia,M.Ig,M.Dc);d.set_behavior(u,d.AB_FINISH_STOP,M.Dc);ia=q(M.za,M);d.set_frame(u,ia,M.Dc);for(u=0;u<t.length;u++)t[u]!=E&&t[u].Dc==E.Dc&&(t[u].Uj=!1);E.Uj=!0}E.Uj&&(M=m,ia=q(r,E),1E-6<Math.abs(ia-d.Vz(M,E.Dc))&&d.set_frame(M,ia,E.Dc));break;case "SOUND":if((r<p.Dr-1E-6||p.Dr<E.za)&&E.za<=r&&r<E.gb&&!E.Uj){var M=m,na=E,ia=(na.za-r)/B.Dd(),na=(na.gb-na.za)/B.Dd();z.play(M,ia,na);E.Uj=!0}p.Dr<E.gb&&E.gb<=r&&E.Uj&&(E.Uj=!1)}}}p=a;r=e;F=h;for(y=0;y<r.ka.length;y++)if(m=r.ka[y],m.eb||m.Gd){t=l.LJ(m);D=
m;E=w.clamp(f(F,D),D.ec,D.ec+l.MJ(D)-1);D.Gd&&(E=l.vW(D,E),E==D.ns&&E--);D=E;E=l.NJ(m);M=u=!1;if(r.jo||r.BB)M=!0;r.Tk||(ia=f(F,m),ia=m.ec<=ia&&ia<=m.ec+l.MJ(m),na=l.OJ(m),m.ik&&D==E&&(M=!0),na||t==D||(M=!0),ia&&!na?l.play_video(m):ia&&na?u=!0:!ia&&na&&(m.eb&&t<D?u=!0:l.pause_video(m)));M?(l.nU(m,D),m.Gd&&(m.ml=l.Vw(m,p))):u&&l.PJ(m)&&(m.eb?l.rJ(m):(t=l.Vw(m,p),t!=m.ml&&(m.Wj=D,l.qJ(m)),m.ml=t))}e.Dr=h}e.jo=!1;e.BB=!1}}};a.cleanup=function(a){if(0==a)G.length=0,v=-1;else for(var b=0;b<G.length;b++)G[b].hb[a]=
null};a.$D=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||u(a)||y(a)?!0:!1};a.set_frame=g;a.get_frame=function(a){var b=E.get_active();return b.Ba?k(b.Ba,a):-1};a.$B=function(){var a=E.get_active();if(a.Ba){a.Ba.Tk=!0;for(var a=a.Ba.ka,b=0;b<a.length;b++)l.pause_video(a[b])}};a.xH=function(a){var b=E.get_active();b.Ba&&(b.Ba.Tk=!1,a?b.Ba.rn=a:b.Ba.rn=null)};a.get_frame_start=function(){var a=E.get_active();return a.Ba?a.Ba.za:-1};a.get_frame_end=function(){var a=E.get_active();
return a.Ba?a.Ba.gb:-1};a.is_play=function(){var a=E.get_active();return a.Ba?!a.Ba.Tk:!1};a.check_nla=function(){var a=E.get_active();return a.Ba?a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=E.get_active();return a.Ba?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=E.get_active();if(c.Ba)c.Ba.bs=a,c.Ba.as=b;else return!1};a.LB=function(a){var b=E.get_active();b.Ba&&(b.Ba.as=a)};a.zU=function(a){var b=E.get_active();b.Ba&&(b.Ba.bs=a)};a.reset_range=function(){var a=E.get_active();
if(a.Ba)a=a.Ba,a.bs=a.za,a.as=a.gb;else return!1};a.set_cyclic=function(a){var b=E.get_active();if(b.Ba)b.Ba.cyclic=a;else return!1};a.clear_callback=function(){var a=E.get_active();a.Ba&&(a.Ba.rn=null)};a.jI=function(a){var b=E.get_active().Ba;b&&(b.ec=-(a-v)*B.Dd()+b.bs,b.jo=!0)};a.get_frame_end=function(){var a=E.get_active().Ba;return a?a.gb:null}};b4w.module.__camera=function(a,t){function e(a,b,c,d,e){Qa.set_translation(a,b);c&&G(a,b,c);N(a,d);I(a,e)}function c(a,b,c,d,e,f,g,h){var k=a.v;Qa.set_translation(a,b);k.pivot.set(c);G(a,b,c);N(a,d);I(a,e);C(a,f);R(a,g);k.use_panning=h}function b(a,b,c,d,e,f,g,h){var k=a.v;Qa.set_translation(a,b);k.vc.set(c);G(a,b,c);A(a,d);x(a,e);m(a,f);H(a,g);k.Og=h}function f(a,b,c){var d=a.v,e=wa.get_trans_view(d.C),f=wa.get_quat_view(d.C),d=Ha;d.set(da.AXIS_Z);d[3]=0;a=p(a,Ba)[1];f=da.quat_to_dir(f,da.AXIS_MZ,
ta);pa.set_pline_initial_point(Ia,e);pa.set_pline_directional_vec(Ia,f);if(!da.line_plane_intersect(d,-b,Ia,c)||Math.abs(a)<ha)va.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=e[0],c[1]=e[1],c[2]=0;return c}function k(b){for(var c=b.v,d=0;d<b.O.length;d++){var e=b.O[d].ha[0];if(e.type==a.se)switch(c.nb){case a.MS_TARGET_CONTROLS:var f=wa.get_trans_view(c.C);c.Nk=ka.dist(f,c.pivot);c.Ok=e.tc;break;
case a.MS_HOVER_CONTROLS:f=wa.get_trans_view(c.C),c.Nk=ka.dist(f,c.vc),c.Ok=e.tc}}}function q(a){a={type:a,name:"",yI:1,width:0,height:0,Ve:null,hr:null,hc:null,vf:null,qb:0,tc:0,eo:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,kd:la.create(),C:new Float32Array(9),Ub:new Float32Array(16),fy:new Float32Array(16),wb:new Float32Array(16),rd:new Float32Array(16),ey:new Float32Array(16),qB:new Float32Array(16),hh:new Float32Array(16),direction:new Float32Array(3),Pf:wa.fm(),gy:wa.fm(),ds:wa.fm(),
Ow:wa.fm(),qs:wa.fm(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,Jd:!1,dof_on:!1,Xv:new Float32Array(3),Eh:u(),rl:0,Kf:0,wc:null,ri:null,Qq:null,ju:new Float32Array(4),Uo:new Float32Array(4)};a.kd[0]=a.kd[2]=0;a.kd[1]=a.kd[3]=0;return a}function h(a,b){var c=q(a.type);c.name=a.name;c.yI=a.yI;c.width=a.width;c.height=a.height;b||(c.Ve=a.Ve,c.hr=a.hr,c.hc=a.hc,c.vf=a.vf);c.qb=a.qb;c.eo=a.eo;c.tc=a.tc;
c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;la.copy(a.kd,c.kd);wa.copy(a.C,c.C);sa.copy(a.Ub,c.Ub);sa.copy(a.wb,c.wb);sa.copy(a.rd,c.rd);sa.copy(a.ey,c.ey);sa.copy(a.qB,c.qB);sa.copy(a.hh,c.hh);wa.copy(a.Pf,c.Pf);wa.copy(a.gy,c.gy);wa.copy(a.ds,c.ds);wa.copy(a.Ow,c.Ow);wa.copy(a.qs,c.qs);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=
a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.dof_bokeh=a.dof_bokeh;c.Jd=a.Jd;c.dof_on=a.dof_on;ka.copy(a.Xv,c.Xv);y(a.Eh,c.Eh);c.rl=a.rl;c.Kf=a.Kf;a.wc&&(c.wc=la.clone(a.wc));if(a.ri){var d=a.ri.length;c.ri=Array(d);for(var e=0;e<d;e++)c.ri[e]=ka.clone(a.ri[e]);c.Qq=new Float32Array(a.Qq)}la.copy(a.ju,c.ju);la.copy(a.Uo,c.Uo);return c}function u(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,
0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function y(a,b){la.copy(a.left,b.left);la.copy(a.right,b.right);la.copy(a.top,b.top);la.copy(a.bottom,b.bottom);la.copy(a.near,b.near);la.copy(a.far,b.far)}function g(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:da.I("Unknown move style")}}function d(b){var c=q(b);if(b==a.Bc)return c;switch(b){case a.Pc:z(c,
ma,.1,1E3);break;case a.se:z(c,2.5,.1,1E3);break;case a.jf:break;case a.sh:break;case a.aj:break;case a.Cc:case a.Jc:case a.hf:case a.Oe:da.I("Stereo camera may only be created from perspective one");break;default:da.I("Unknown camera type")}return c}function r(b,c,d){b.type!=a.Cc&&b.type!=a.Jc&&b.type!=a.hf&&b.type!=a.Oe&&da.I("set_stereo_params(): wrong camera type");if(b.type==a.Cc||b.type==a.Jc)b.rl=c;b.Kf=d;X(b,!1);if(K.La()&&(c=K.get_active(),b=c.J.Zc))for(c=ga.Da(K.Jk(c),c).ha,d=0;d<c.length;d++)Y(c[d],
b)}function p(a,b){var c=wa.get_quat_view(a.v.C);return M(c,b)}function M(a,b){var c=da.quat_to_dir(a,da.AXIS_Z,ta),d=da.quat_to_dir(a,da.AXIS_MY,Ta),e=-Math.asin(c[2]/ka.length(c)),c=Math.abs(e)>Math.PI/4?ka.scale(d,-da.sign(e),Wa):ka.scale(c,-da.sign(d[2]),Wa),f=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(e=da.sign(e)*Math.PI-e);d=f;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function E(a){switch(a.eo){case "AUTO":return 1<a.qb?ya(a)?a.tc/a.qb:2*Math.atan(Math.tan(a.tc/2)/a.qb):
a.tc;case "HORIZONTAL":return ya(a)?a.tc/a.qb:2*Math.atan(Math.tan(a.tc/2)/a.qb);case "VERTICAL":return a.tc}}function z(b,c,d,e){switch(b.type){case a.Pc:case a.Cc:case a.Jc:b.tc=c;b.qb=1;break;case a.se:b.tc=c;b.qb=1;break;case a.hf:case a.Oe:break;default:da.I("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function l(b,c){var d=wa.Qb(c.v.C,ta),e=wa.tb(c.v.C,rb),f=sa.fromRotationTranslation(e,d,Na);sa.invert(f,b.Ub);if(K.La())var f=K.get_active(),g=K.Pb(f,Oa.Eg);if(b.type==
a.Cc||g&&g.enable_hmd_stereo&&b.type==a.hf)b.Ub[12]+=b.Kf/2;else if(b.type==a.Jc||g&&g.enable_hmd_stereo&&b.type==a.Oe)b.Ub[12]-=b.Kf/2;if(b.wc){wa.from_mat4(b.Ub,b.ds);wa.invert(b.ds,b.Ow);var f=b.wc[0],g=b.wc[1],h=b.wc[2],k=b.wc[3],l=b.fy;l[0]=1-2*f*f;l[1]=-2*f*g;l[2]=-2*f*h;l[3]=0;l[4]=-2*f*g;l[5]=1-2*g*g;l[6]=-2*g*h;l[7]=0;l[8]=-2*f*h;l[9]=-2*g*h;l[10]=1-2*h*h;l[11]=0;l[12]=-2*f*k;l[13]=-2*g*k;l[14]=-2*h*k;l[15]=1;sa.multiply(b.Ub,b.fy,b.Ub);X(b,!0);f=Ha;g=Na;sa.invert(b.Ub,g);sa.transpose(g,
g);la.transformMat4(b.wc,g,f);g=Ea;g[0]=(da.sign(f[0])+b.wb[8])/b.wb[0];g[1]=(da.sign(f[1])+b.wb[9])/b.wb[5];g[2]=-1;g[3]=(1+b.wb[10])/b.wb[14];la.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.wb[2]=f[0];b.wb[6]=f[1];b.wb[10]=f[2]+1;b.wb[14]=f[3];ka.transformMat4(d,b.fy,d)}wa.from_mat4(b.Ub,b.Pf);wa.invert(b.Pf,b.gy);Ca(b);fa(b);wa.set_sep(d,1,e,b.C)}function B(b,c,d,e){sa.lookAt(c,d,e,b.Ub);d=K.get_active();d=K.Pb(d,Oa.Eg);if(b.type==a.Cc||d&&d.enable_hmd_stereo&&b.type==a.hf)b.Ub[12]+=
b.Kf/2;else if(b.type==a.Jc||d&&d.enable_hmd_stereo&&b.type==a.Oe)b.Ub[12]-=b.Kf/2;wa.from_mat4(b.Ub,b.Pf);Ca(b);fa(b);wa.set_trans(c,b.C)}function w(a,b,c){c=ka.subtract(c,b,ta);ka.length(c)&&(ka.normalize(c,c),c=da.RH(da.AXIS_MZ,c,rb),Qa.set_rotation(a,c));Qa.set_translation(a,b)}function G(a,b,c){var d=a.v,e=n(a);w(a,b,c);e?(b=ka.copy(d.oe,ta),ka.negate(b,b),D(a,b,!0)):D(a,d.oe,!0)}function v(a,b){for(var c=a.v,d=b.ha,e=wa.tb(c.C,rb),e=da.quat_to_dir(e,da.AXIS_MZ,ta),f=wa.Qb(c.C,Ta),g=b.uI,h=0;h<
g.length;h++){var k=g[h];ka.copy(e,k.direction);wa.Qb(c.C,k.Xv)}for(h=0;h<d.length;h++)k=d[h],l(k,a),ka.copy(e,k.direction),da.nm(k.rd,k.Eh),k.dof_object&&k.dof_on&&(c=Qa.get_translation(k.dof_object,Wa),c=ka.dist(f,c),k.dof_distance=c)}function D(b,c,d){var e=b.v,f=wa.get_quat_view(e.C),g=da.quat_to_dir(f,da.AXIS_Z,ta);ka.normalize(g,g);if(.999999<Math.abs(ka.dot(c,g)))g=xa.identity(rb);else{var h=ka.cross(c,g,Ta);ka.normalize(h,h);e.nb==a.MS_TARGET_CONTROLS?e.Ri&&ka.negate(h,h):(e=da.quat_to_dir(f,
da.AXIS_MY,Wa),0<ka.dot(e,c)&&ka.negate(h,h));e=da.quat_to_dir(f,da.AXIS_X,Wa);ka.normalize(e,e);var k=da.clamp(ka.dot(e,h),-1,1),g=-.999999>=k?xa.setAxisAngle(g,Math.acos(k),rb):xa.rotationTo(e,h,rb);xa.normalize(g,g)}xa.multiply(g,f,f);d&&(d=da.quat_to_dir(f,da.AXIS_Y,ta),0>ka.dot(c,d)&&xa.rotateZ(f,Math.PI,f));F(b)}function F(b){var c=b.v;c.nb==a.MS_TARGET_CONTROLS&&(c.Ri=n(b))}function n(a){a=wa.get_quat_view(a.v.C);return 0>da.quat_to_dir(a,da.AXIS_Y,ta)[2]}function N(b,c){var d=b.v;if(c){d.Ib=
d.Ib||{};d.Ib.left=c.left;d.Ib.right=c.right;d.Ib.Co=c.left;d.Ib.$o=c.right;d.Ib.camera_space=!!c.camera_space;var e=b.v;!(d=e.Ib)||e.nb!=a.MS_EYE_CONTROLS&&e.nb!=a.MS_TARGET_CONTROLS||(e=p(b,Ba),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.Co-=e[0],d.$o-=e[0]),d.left=da.angle_wrap_0_2pi(d.left),d.right=da.angle_wrap_0_2pi(d.right),d.Co=da.angle_wrap_0_2pi(d.Co),d.$o=da.angle_wrap_0_2pi(d.$o))}else d.Ib=null}function I(a,b){var c=a.v;b?(c.Pa=c.Pa||{},c.Pa.down=b.down,c.Pa.up=b.up,c.Pa.$n=b.down,
c.Pa.zp=b.up,c.Pa.camera_space=!!b.camera_space,J(a)):c.Pa=null}function x(a,b){var c=a.v;if(!b){var d=p(a,Ba);b={down:d[1],up:d[1]}}c.Pa=c.Pa||{};c.Pa.down=b.down;c.Pa.up=b.up;J(a);c.Cb&&c.Pa&&aa(a)}function J(b){var c=b.v,d=c.Pa;if(d)switch(c.nb){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=p(b,Ba);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.zp-=b[1],d.$n-=b[1]);d.up=da.angle_wrap_periodic(d.up,-Math.PI,Math.PI);d.down=da.angle_wrap_periodic(d.down,-Math.PI,Math.PI);d.zp=da.angle_wrap_periodic(d.zp,
-Math.PI,Math.PI);d.$n=da.angle_wrap_periodic(d.$n,-Math.PI,Math.PI);break;case a.MS_HOVER_CONTROLS:d.up=da.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=da.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=da.clamp(d.up,-Math.PI/2,0),d.down=da.clamp(d.down,-Math.PI/2,0)}}function A(a,b){var c=a.v;if(!b){var d=Qa.Nr(a,c.vc);b={min:d,max:d}}c.Cb=c.Cb||{};c.Cb.min=b.min;c.Cb.max=b.max;c.Cb&&c.Pa&&aa(a)}function C(a,b){var c=a.v;b?(c.Cb=c.Cb||{},c.Cb.min=b.min,c.Cb.max=b.max):c.Cb=null}function R(a,
b){var c=a.v;b?(c.Fd=c.Fd||{},c.Fd.min_z=b.min_z,c.Fd.max_z=b.max_z):c.Fd=null}function m(a,b){var c=a.v;b?(c.Vc=c.Vc||{},c.Vc.min=b.min,c.Vc.max=b.max):c.Vc=null}function H(a,b){var c=a.v;b?(c.Wc=c.Wc||{},c.Wc.min=b.min,c.Wc.max=b.max):c.Wc=null}function U(b){var c=b.v;if(ga.is_camera(b))for(var d=b.O,e=0;e<d.length;e++){var f=d[e].ha;if(f[0].type===a.se){switch(c.nb){case a.MS_TARGET_CONTROLS:var g=wa.get_trans_view(c.C),g=ka.dist(g,c.pivot),g=g/c.Nk*c.Ok;break;case a.MS_HOVER_CONTROLS:g=wa.get_trans_view(c.C);
g=ka.distance(g,c.vc);g=g/c.Nk*c.Ok;break;default:g=f[0].tc}for(var h=0;h<f.length;h++){var k=f[h];k.tc=g;X(k,!1)}v(b,d[e])}}}function O(b){var c=b.v,d=c.nb;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.Ib){var e=c.Ib.left,f=c.Ib.right,g=p(b,Ba);(g=d==a.MS_TARGET_CONTROLS?da.Zl(g[0],e,f):da.Zl(g[0],f,e))&&(d==a.MS_TARGET_CONTROLS?ia(b,g,0):T(b,g,0))}c.Pa&&(e=c.Pa.down,f=c.Pa.up,g=p(b,Ba),(g=d==a.MS_TARGET_CONTROLS?da.Zl(g[1],f,e):da.Zl(g[1],e,f))&&(d==a.MS_TARGET_CONTROLS?ia(b,0,g):T(b,
0,g)));if(d===a.MS_TARGET_CONTROLS&&c.Cb){var g=b.v,e=wa.get_trans_view(g.C),f=ka.subtract(e,g.pivot,ta),h=ka.length(f);h>g.Cb.max?(ka.scale(f,g.Cb.max/h,f),ka.add(g.pivot,f,e)):h<g.Cb.min&&(h=wa.get_quat_view(g.C),h=da.quat_to_dir(h,da.AXIS_MZ,Ta),ka.scale(h,100*g.Cb.min,h),ka.add(f,h,f),ka.scale(f,-g.Cb.min/ka.length(f),f),ka.add(g.pivot,f,e))}}d===a.MS_TARGET_CONTROLS&&c.Fd&&(c=b.v,g=c.pivot[2],e=da.clamp(c.pivot[2],c.Fd.min_z,c.Fd.max_z),e!=g&&(g=ka.set(0,0,e-g,ta),ka.add(c.pivot,g,c.pivot),c=
wa.get_trans_view(c.C),ka.add(c,g,c)));d===a.MS_HOVER_CONTROLS&&(d=b.v,d.Vc&&(g=da.clamp(d.vc[0],d.Vc.min,d.Vc.max)-d.vc[0],d.vc[0]+=g,c=wa.get_trans_view(d.C),c[0]+=g),d.Wc&&(g=da.clamp(d.vc[1],d.Wc.min,d.Wc.max)-d.vc[1],d.vc[1]+=g,c=wa.get_trans_view(d.C),c[1]+=g),d=b.v,c=p(b,Ba)[1],(d=da.Zl(c,d.Pa.up,d.Pa.down))&&ea(b,0,d))}function V(a,b,c,d){a=p(a,Da);d[0]=b-a[0];d[1]=c-a[1];return d}function ia(a,b,c){var d=a.v;Z(a,a.v.pivot,b,c);a=p(a,Q);a=da.angle_wrap_periodic(a[1],-Math.PI,Math.PI);d.Ri=
Math.abs(a)>Math.PI/2}function na(a,b,c){b=V(a,b,c,Q);ia(a,b[0],b[1])}function T(a,b,c){var d=a.v;if(b||c)a=xa.identity(rb),b&&(b=xa.setAxisAngle(d.oe,b,Aa),xa.multiply(a,b,a)),b=wa.get_quat_view(d.C),c&&(d=da.quat_to_dir(b,da.AXIS_X,ta),c=xa.setAxisAngle(d,c,Aa),xa.normalize(c,c),xa.multiply(a,c,a)),xa.multiply(a,b,b),xa.normalize(b,b)}function ja(a,b,c){var d=wa.tb(a.v.C,rb),d=M(d,Ba);T(a,b-d[0],c-d[1])}function ea(a,b,c){var d=a.v;d.Og||(b=0);Z(a,d.vc,b,c);c&&aa(a)}function qa(a,b,c){b=V(a,b,c,
Q);ea(a,b[0],b[1])}function Z(a,b,c,d){var e=a.v;if(c||d){a=xa.identity(rb);c&&(c=xa.setAxisAngle(da.AXIS_Z,c,Aa),xa.multiply(a,c,a));c=wa.get_quat_view(e.C);if(d){var f=da.quat_to_dir(c,da.AXIS_X,ta);d=xa.setAxisAngle(f,d,Aa);xa.normalize(d,d);xa.multiply(a,d,a)}d=wa.get_trans_view(e.C);da.ST(d,b,a,d);xa.multiply(a,c,c);xa.normalize(c,c)}}function aa(a){var b=a.v,c=p(a,Ba)[1],d=a.v;a=d.Pa;d=d.Cb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=wa.get_trans_view(b.C);
d=wa.get_quat_view(b.C);d=da.quat_to_dir(d,da.AXIS_MZ,ta);ka.normalize(d,d);ka.scale(d,c,d);ka.subtract(b.vc,d,a)}function X(b,c){switch(b.type){case a.Pc:case a.jf:sa.perspective(E(b),b.qb,b.near,b.far,b.wb);break;case a.se:case a.sh:var d=E(b),e=d*b.qb;sa.ortho(-e,e,-d,d,b.near,b.far,b.wb);break;case a.aj:sa.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.wb);break;case a.Cc:case a.Jc:var e=Math.tan(E(b)/2),d=b.near*e,f=b.qb*b.rl*e;b.type==a.Cc?(e=f-b.Kf/2,f+=b.Kf/2):(e=f+b.Kf/2,f-=b.Kf/2);e=
-(b.near/b.rl*e);f*=b.near/b.rl;sa.frustum(e,f,-d,d,b.near,b.far,b.wb);b.left=e;b.right=f;break;case a.hf:case a.Oe:K.La()&&(d=K.get_active(),(d=K.Pb(d,Oa.Eg))&&d.enable_hmd_stereo?(d=Math.tan(b.kd[1]),e=Math.tan(b.kd[2]),f=Math.tan(b.kd[3]),b.top=b.near*Math.tan(b.kd[0]),b.right=b.near*d,b.bottom=-b.near*e,b.left=-b.near*f,sa.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.wb)):(b.top=b.near*Math.tan(E(b)/2),b.bottom=-b.top,b.right=b.top*b.qb,b.left=-b.right,sa.perspective(E(b),b.qb,b.near,
b.far,b.wb)));break;case a.Bc:return;default:da.I("Wrong camera type: "+b.type)}c||(Ca(b),fa(b))}function fa(a){sa.copy(a.Ub,a.hh);a.hh[12]=0;a.hh[13]=0;a.hh[14]=0;a.hh[15]=1;sa.multiply(a.wb,a.hh,a.hh);sa.invert(a.hh,a.hh)}function Ca(a){sa.copy(a.Ub,a.rd);sa.multiply(a.wb,a.rd,a.rd);sa.invert(a.rd,a.ey)}function ca(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var g,h,k,l,m,n,p,Q;switch(b.type){case a.Bc:da.I("Extraction from NONE camera is not possible");break;case a.Pc:case a.jf:g=
c*Math.tan(E(b)/2);l=-g;h=g*b.qb;k=-h;m=d/c*g;Q=-m;n=m*b.qb;p=-n;break;case a.se:case a.sh:l=E(b);k=l*b.qb;g=m=l;h=n=k;l=Q=-l;k=p=-k;break;case a.aj:g=m=b.top;h=n=b.right;l=Q=b.bottom;k=p=b.left;break;case a.Cc:case a.Jc:m=c/b.near;g=c*Math.tan(E(b)/2);l=-g;h=b.right*m;k=b.left*m;p=d/c;m=g*p;Q=-m;n=h*p;p*=k;break;case a.hf:case a.Oe:m=c/b.near;g=b.top*m;l=b.bottom*m;h=b.right*m;k=b.left*m;p=d/c;m=g*p;Q=l*p;n=h*p;p*=k;break;default:da.I("Wrong camera type: "+b.type)}e[0]=k;e[1]=l;e[2]=-c;e[3]=h;e[4]=
l;e[5]=-c;e[6]=h;e[7]=g;e[8]=-c;e[9]=k;e[10]=g;e[11]=-c;e[12]=p;e[13]=Q;e[14]=-d;e[15]=p;e[16]=m;e[17]=-d;e[18]=n;e[19]=m;e[20]=-d;e[21]=n;e[22]=Q;e[23]=-d;f&&(c=Na,sa.invert(b.Ub,c),da.Wo(e,c,e,0));return e}function Y(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.ri){var d=b.csm_num;a.ri=Array(d);for(var e=0;e<d;e++)a.ri[e]=new Float32Array(3);a.Qq=new Float32Array(d)}for(d=0;d<c;d++){var e=d?za(b,a,d-1):a.near,f=za(b,a,d),e=ca(a,e,f,Ja),e=oa.SQ(e);a.ri[d].set(e.S);a.Qq[d]=e.ib;a.ju[d]=ka.length(e.S);
a.Uo[d]=P(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.Uo[0]=b.first_cascade_blur_radius}function za(a,b,c){var d=a.csm_num,e=da.clamp(a.csm_first_cascade_border,b.near,b.far);a=da.clamp(a.csm_last_cascade_border,b.near,b.far);return da.clamp(P(e,a,d,c),b.near,b.far)}function P(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function ya(b){switch(b.type){case a.se:case a.sh:case a.aj:return!0;default:return!1}}function ba(a,
b){b||(b=new Float32Array(3));var c=wa.get_trans_view(a.v.C);ka.copy(c,b);return b}var oa=t("__boundings"),W=t("__container"),sa=t("__mat4"),pa=t("__math"),ga=t("__obj_util"),va=t("__print"),xa=t("__quat"),K=t("__scenes"),Oa=t("__subscene"),Qa=t("__transform"),wa=t("__tsr"),da=t("__util"),ka=t("__vec3"),la=t("__vec4");a.Bc=10;a.Pc=20;a.se=30;a.jf=40;a.sh=50;a.aj=60;a.Cc=70;a.Jc=80;a.hf=90;a.Oe=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var ma=da.deg_to_rad(40),
ha=da.deg_to_rad(.5),La=new Float32Array([1,1,1,1]),L=new Float32Array([-1,-1,1,1]),Xa=new Float32Array([0,0,-1,1]),Ba=new Float32Array(2),Q=new Float32Array(2),Da=new Float32Array(2),ta=new Float32Array(3),Ta=new Float32Array(3),Wa=new Float32Array(3),rb=new Float32Array(4),Aa=new Float32Array(4),Ha=new Float32Array(4),Ea=new Float32Array(4),Na=new Float32Array(16),Ja=new Float32Array(24),Ma=u(),Ia=new Float32Array(6);a.pN=function(l,m){var n=m.v,p=l.data;switch(p.type){case "PERSP":var Q=d(a.Pc);
Q.eo=p.sensor_fit;z(Q,p.angle,p.clip_start,p.clip_end);break;case "ORTHO":Q=d(a.se),Q.eo=p.sensor_fit,z(Q,p.ortho_scale/2,p.clip_start,p.clip_end)}Q.name=m.name;var v=m.O;v[0].ha.push(Q);for(var r=1;r<v.length;r++){var q=h(Q,!1);v[r].ha.push(q)}n.nb=g(p.b4w_move_style);n.dof_distance=p.dof_distance;Q=p.dof_object;n.dof_object=Q?Q.Fa:null;n.dof_front_start=p.b4w_dof_front_start;n.dof_front_end=p.b4w_dof_front_end;n.dof_rear_start=p.b4w_dof_rear_start;n.dof_rear_end=p.b4w_dof_rear_end;n.dof_power=p.b4w_dof_power;
n.dof_bokeh=p.b4w_dof_bokeh;n.dof_bokeh_intensity=p.b4w_dof_bokeh_intensity;n.Jd=p.b4w_dof_foreground_blur;n.Jp=p.b4w_trans_velocity;n.Ip=p.b4w_rot_velocity;n.Kp=p.b4w_zoom_velocity;Q=m.v.nb;v=l.data;r=null;Q!=a.MS_TARGET_CONTROLS&&Q!=a.MS_EYE_CONTROLS||!v.b4w_use_horizontal_clamping||(r={left:v.b4w_rotation_left_limit,right:v.b4w_rotation_right_limit,camera_space:"LOCAL"==v.b4w_horizontal_clamping_type},Q==a.MS_EYE_CONTROLS&&(r.left*=-1,r.right*=-1));Q=r;v=m.v.nb;r=l.data;q=null;v!=a.MS_TARGET_CONTROLS&&
v!=a.MS_EYE_CONTROLS||!r.b4w_use_vertical_clamping?v==a.MS_HOVER_CONTROLS&&r.b4w_use_zooming&&(r.b4w_hover_angle_min<=r.b4w_hover_angle_max?(q={down:r.b4w_hover_angle_min,up:r.b4w_hover_angle_max},q.down*=-1,q.up*=-1):va.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(q={down:r.b4w_rotation_down_limit,up:r.b4w_rotation_up_limit,camera_space:"LOCAL"==r.b4w_vertical_clamping_type},v==a.MS_TARGET_CONTROLS&&(q.down*=-1,q.up*=-1));var v=q,r=m.v.nb,q=l.data,u=null;r==a.MS_TARGET_CONTROLS&&
q.b4w_use_target_distance_limits&&q.b4w_distance_min<=q.b4w_distance_max?u={min:q.b4w_distance_min,max:q.b4w_distance_max}:r===a.MS_HOVER_CONTROLS&&q.b4w_use_zooming&&(q.b4w_distance_min<=q.b4w_distance_max?u={min:q.b4w_distance_min,max:q.b4w_distance_max}:va.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));r=u;q=l.data;u=null;m.v.nb==a.MS_HOVER_CONTROLS&&q.b4w_use_horizontal_clamping&&q.b4w_horizontal_translation_min<=q.b4w_horizontal_translation_max&&(u={min:q.b4w_horizontal_translation_min,
max:q.b4w_horizontal_translation_max});var q=u,u=l.data,x=null;m.v.nb==a.MS_HOVER_CONTROLS&&u.b4w_use_vertical_clamping&&u.b4w_vertical_translation_min<=u.b4w_vertical_translation_max&&(x={min:u.b4w_vertical_translation_min,max:u.b4w_vertical_translation_max});var u=x,x=l.data,L=null;m.v.nb==a.MS_TARGET_CONTROLS&&x.b4w_use_pivot_limits&&(L={min_z:x.b4w_pivot_z_min,max_z:x.b4w_pivot_z_max});x=L;switch(n.nb){case a.MS_EYE_CONTROLS:n=wa.get_trans_view(m.v.C);e(m,n,null,Q,v);break;case a.MS_TARGET_CONTROLS:n=
wa.get_trans_view(m.v.C);c(m,n,p.b4w_target,Q,v,r,x,p.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:n=wa.get_trans_view(m.v.C),Q=f(m,l.data.b4w_hover_zero_level,Ta),b(m,n,Q,r,v,q,u,p.b4w_enable_hover_hor_rotation)}O(m);k(m)};a.oI=e;a.qI=c;a.pI=b;a.wo=k;a.Kc=h;a.nO=u;a.pZ=g;a.fd=d;a.UX=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return!!a.hc;case "DEPTH":return!!a.vf;case "SCREEN":return!a.hc&&!a.vf;default:da.I("Wrong attachment type: "+b)}};a.Ww=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.hc=
c;break;case "DEPTH":a.vf=c;break;case "SCREEN":a.hc=null;a.vf=null;break;default:da.I("Wrong attachment type: "+b)}};a.BY=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.hc;case "DEPTH":return a.vf;case "SCREEN":return null;default:da.I("Wrong attachment type: "+b)}};a.cw=function(b,c){(b.type!=a.Pc||c!=a.Cc&&c!=a.Jc&&c!=a.hf&&c!=a.Oe)&&da.I("make_stereo(): wrong camera type");b.type=c;r(b,6,.065)};a.DU=r;a.get_camera_angles=p;a.Uz=M;a.get_camera_angles_char=function(a,b){p(a,b);b[0]=
da.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.set_fov=function(b,c){switch(b.type){case a.Pc:case a.jf:case a.Cc:case a.Jc:b.tc=c}};a.get_fov=function(b){switch(b.type){case a.Pc:case a.jf:case a.Cc:case a.Jc:return b.tc;default:return 0}};a.hR=E;a.dI=z;a.eI=function(b,c,d,e,f){switch(b.type){case a.Pc:case a.Cc:case a.Jc:case a.se:b.tc=d;b.qb=1;break;case a.jf:case a.sh:b.tc=d;b.qb=c/d;break;case a.hf:case a.Oe:break;default:da.I("set_frustum2(): Unsupported camera type: "+b.type)}b.near=
e;b.far=f};a.pU=function(b,c,d,e,f,g,h){switch(b.type){case a.aj:b.left=c;b.right=d;b.bottom=e;b.top=f;b.near=g;b.far=h;break;default:da.I("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.v.nb};a.IU=l;a.IZ=B;a.NB=function(a,b,c){var d=ta;d[0]=0;d[1]=0;d[2]=-1;ka.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=Ta;e[0]=0;e[1]=1;e[2]=0;ka.transformQuat(e,c,e);B(a,b,d,e)};a.iI=w;a.vU=G;a.JV=v;a.IV=function(b){var c=b.v;O(b);U(b);switch(c.nb){case a.MS_TARGET_CONTROLS:var d=
wa.get_trans_view(c.C),e=wa.get_quat_view(c.C);da.Mw(d,e,c.pivot,da.AXIS_MZ);for(e=0;e<b.O.length;e++)for(var f=b.O[e].ha,g=0;g<f.length;g++){var h=f[g];h.type!=a.Cc&&h.type!=a.Jc||r(h,ka.dist(d,c.pivot),h.Kf)}D(b,c.oe);break;case a.MS_EYE_CONTROLS:b.qc||D(b,c.oe)}F(b)};a.correct_up=D;a.jJ=F;a.Xw=N;a.Yw=I;a.hover_set_vertical_limits=x;a.hover_set_distance_limits=A;a.ZH=C;a.kI=R;a.gI=m;a.mI=H;a.XV=U;a.zZ=ia;a.HZ=na;a.wZ=function(a,b,c){T(a,b,c)};a.FZ=function(a,b,c){ja(a,b,c)};a.yZ=T;a.GZ=ja;a.xZ=
ea;a.CU=qa;a.RT=function(b,c,d){var e=b.v.nb;e===a.MS_TARGET_CONTROLS?ia(b,c,d):e===a.MS_EYE_CONTROLS?T(b,c,d):e===a.MS_HOVER_CONTROLS?ea(b,c,d):e===a.MS_STATIC&&T(b,c,d)};a.BU=function(b,c,d){var e=b.v.nb;e===a.MS_TARGET_CONTROLS?na(b,c,d):e===a.MS_EYE_CONTROLS?ja(b,c,d):e===a.MS_HOVER_CONTROLS?qa(b,c,d):e===a.MS_STATIC&&ja(b,c,d)};a.fZ=function(b){switch(b.type){case a.Pc:case a.se:case a.Cc:case a.Jc:return!0;default:return!1}};a.wQ=function(b){switch(b.type){case a.Pc:case a.jf:case a.Cc:case a.Jc:var c;
a:{switch(b.eo){case "AUTO":c=1<b.qb?b.tc:ya(b)?b.tc*b.qb:2*Math.atan(Math.tan(b.tc/2)*b.qb);break a;case "HORIZONTAL":c=b.tc;break a;case "VERTICAL":c=ya(b)?b.tc*b.qb:2*Math.atan(Math.tan(b.tc/2)*b.qb);break a}c=void 0}return Math.min(E(b),c);default:return va.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.eU=function(b,c){switch(b.type){case a.jf:case a.sh:va.error("set_aspect(): Unsupported camera type: "+b.type);break;default:b.qb=c}};a.AY=function(a){return a.qb};a.set_projection=
X;a.gU=function(b,c,d,e,f){var g=1/Math.max(f,e);switch(b.type){case a.Bc:case a.Pc:case a.jf:f/=2;e/=2;d=-(d-f)/f*Math.tan(E(b)/2);c=(c-e)/e*Math.tan(E(b)/2)*b.qb;e=b.near*(d+g);f=b.near*(c+g);d=b.near*(d-g);c=b.near*(c-g);sa.frustum(c,f,d,e,b.near,b.far,b.wb);break;case a.se:case a.sh:d=-d/f;c/=e;e=E(b);f=e*b.qb;sa.ortho(-f+(c-g)*(f+f),-f+(c+g)*(f+f),e+(d-g)*(e+e),e+(d+g)*(e+e),b.near,b.far,b.wb);break;case a.aj:d=-d/f,c/=e,e=b.top+(d+g)*(b.top-b.bottom),f=b.left+(c+g)*(b.right-b.left),d=b.top+
(d-g)*(b.top-b.bottom),c=b.left+(c-g)*(b.right-b.left),sa.ortho(c,f,d,e,b.near,b.far,b.wb)}sa.copy(b.Ub,b.rd);sa.multiply(b.wb,b.rd,b.rd);da.nm(b.rd,b.Eh)};a.cz=fa;a.gE=Ca;a.NP=ca;a.KM=function(a){a=a.v;var b=oa.Re();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.ra=b;var c=oa.bE(1,da.f32([0,0,0]));a.pc=c;a.kq=oa.PD(1,b);a.mq=oa.RD(1,b);a.lq=oa.QD(1,b)};a.is_static_camera=function(b){return ga.is_camera(b)&&b.v&&b.v.nb==a.MS_STATIC};a.is_target_camera=function(b){return ga.is_camera(b)&&
b.v&&b.v.nb==a.MS_TARGET_CONTROLS};a.is_eye_camera=function(b){return ga.is_camera(b)&&b.v&&b.v.nb==a.MS_EYE_CONTROLS};a.is_hover_camera=function(b){return ga.is_camera(b)&&b.v&&b.v.nb==a.MS_HOVER_CONTROLS};a.is_ortho_camera=function(b){return ga.is_camera(b)&&b.v&&b.O[0].ha[0].type==a.se};a.xC=Y;a.hP=za;a.project_point=function(b,c,d){b=b.O[0].ha[0];switch(b.type){case a.Pc:case a.jf:case a.se:case a.sh:case a.Cc:case a.Jc:case a.hf:case a.Oe:case a.Bc:var e=Ha;e.set(c);e[3]=1;la.transformMat4(e,
b.rd,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;W.xW(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return va.error("Non-compatible camera"),d}};a.MQ=function(a){return a.O[0].ha[0]};a.Zu=function(b,c){switch(b.type){case a.Pc:case a.jf:case a.Cc:case a.Jc:var d=Math.tan(E(b)/2);switch(c){case "LEFT":return-d*b.qb;case "RIGHT":return d*b.qb;case "TOP":return d;case "BOTTOM":return-d}break;case a.se:case a.sh:switch(c){case "LEFT":return-E(b)*b.qb;
case "RIGHT":return E(b)*b.qb;case "TOP":return E(b);case "BOTTOM":return-E(b)}break;case a.aj:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.hf:case a.Oe:d=K.get_active();if((d=K.Pb(d,Oa.Eg))&&d.enable_hmd_stereo)switch(c){case "LEFT":return-Math.tan(Math.min(b.kd[1],b.kd[3]));case "RIGHT":return Math.tan(Math.min(b.kd[1],b.kd[3]));case "TOP":return Math.tan(Math.min(b.kd[0],b.kd[2]));case "BOTTOM":return-Math.tan(Math.min(b.kd[0],
b.kd[2]))}else switch(d=Math.tan(E(b)/2),c){case "LEFT":return-d*b.qb;case "RIGHT":return d*b.qb;case "TOP":return d;case "BOTTOM":return-d}break;default:da.I("Unknown camera type")}};a.QR=ya;a.MB=function(a,b,c){a=a.v;wa.set_trans(b,a.C);ka.copy(c,a.pivot)};a.hI=function(a,b){var c=a.v,d=ka.subtract(b,c.vc,ta),e=wa.get_trans_view(c.C),d=ka.add(d,e,d);Qa.set_translation(a,d);ka.copy(b,c.vc)};a.EU=function(a,b){var c=a.v,d=ka.subtract(b,c.pivot,ta),e=wa.get_trans_view(c.C),d=ka.add(d,e,d);Qa.set_translation(a,
d);ka.copy(b,c.pivot)};a.FY=ba;a.EZ=function(c,d){c.v.nb=d;c.v.Ib=null;c.v.Pa=null;c.v.Cb=null;c.v.Vc=null;c.v.Wc=null;k(c);switch(d){case a.MS_HOVER_CONTROLS:var e=wa.get_trans_view(c.v.C),g=f(c,0,Ta);b(c,e,g,null,null,null,null,c.v.Og);break;case a.MS_TARGET_CONTROLS:e=ba(c,ta),g=wa.get_quat_view(c.v.C),g=da.quat_to_dir(g,da.AXIS_MZ,Ta),g=ka.scaleAndAdd(e,g,10,g),ka.copy(g,c.v.pivot)}};a.Ys=function(a){a=a.v;a.nb=0;ka.set(0,0,0,a.pivot);ka.set(0,0,0,a.vc);a.Ri=!1;a.use_panning=!1;a.Ib=null;a.Pa=
null;a.Cb=null;a.Vc=null;a.Wc=null;a.Fd=null;a.Og=!0};a.set_eye_distance=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];70!=d.type&&80!=d.type&&90!=d.type&&100!=d.type||r(d,d.rl,b)}};a.set_hmd_fov=function(a,b,c){var d=K.get_active();a=ga.Da(a,d).ha;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&la.copy(b,e.kd),100==e.type&&la.copy(c,e.kd),e.wc||X(e,!1),Ca(e),fa(e)}};a.DZ=function(a,b,c){var d=K.get_active();a=ga.Da(a,d).ha;for(d=0;d<a.length;d++){var e=a[d];if(90==
e.type||100==e.type)90==e.type&&b&&sa.copy(b,e.wb),100==e.type&&c&&sa.copy(c,e.wb),Ca(e),fa(e)}};a.yU=function(b,c){for(var d=K.get_active(),d=ga.Da(b,d).ha,e,f,g,h,k,l,m,n,p=0;p<d.length;p++){var Q=d[p];if(Q.type==a.Bc&&Q.near||Q.type==a.Pc||Q.type==a.jf){e=Q.near;f=sa.invert(c,Na);h=la.transformMat4(La,f,Ha);g=h[0]*e;h=h[1]*e;l=la.transformMat4(L,f,Ha);k=l[0]*e;l=l[1]*e;f=la.transformMat4(Xa,f,Ha);f=-f[2]*f[3];m=sa.frustum(k,g,l,h,e,f,Na);da.nm(m,Ma);n=(g-k)/(h-l);break}}for(p=0;p<d.length;p++)if(Q=
d[p],Q.type==a.Bc||Q.type==a.Pc||Q.type==a.jf)Q.far=f,Q.near=e,Q.right=g,Q.top=h,Q.left=k,Q.bottom=l,Q.qb=n,Q.tc=Math.atan(h/e)-Math.atan(l/e),sa.copy(m,Q.wb),y(Ma,Q.Eh),Ca(Q),fa(Q)}};b4w.module.__lights=function(a,t){function e(a){f.scale(a.color,a.fg,a.Gq)}var c=t("__tsr"),b=t("__util"),f=t("__vec3"),k=new Float32Array(3);a.WR=function(a,h){var q=a.data,y=h.Db={name:"",type:q.type,zH:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Gq:new Float32Array(3),aF:0,BC:!1,en:0,xs:0,Cq:.1,Bq:30,CF:!1,dH:!1,iF:!1,ln:!0,pn:!0,fg:1,distance:25,pY:"INVERSE_SQUARE"};y.name=h.name;y.ln=q.use_diffuse;y.pn=q.use_specular;var g=c.get_quat_view(h.v.C),g=b.quat_to_dir(g,
b.AXIS_Z,k);f.normalize(g,g);y.direction.set(g);y.color[0]=q.color[0];y.color[1]=q.color[1];y.color[2]=q.color[2];y.fg=y.aF=q.energy;e(y);y.distance=q.distance;y.BC=q.use_sphere;y.Cq=q.clip_start;y.Bq=q.clip_end;if("POINT"===y.type||"SPOT"===y.type)y.distance=q.distance;"SPOT"===y.type?(y.xs=q.spot_blend,y.en=q.spot_size):"POINT"===y.type&&(y.en=Math.PI/2);y.CF=q.b4w_generate_shadows;y.iF=q.b4w_dynamic_intensity};a.set_light_color=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];e(a)};
a.tU=function(a,b){a.xs=b};a.sU=function(a,b){a.distance=b};a.uU=function(a,b){a.en=b};a.set_light_energy=function(a,b){a.fg=b;e(a)};a.OV=function(a){var e=a.Db;if(e){a=c.get_quat_view(a.v.C);b.quat_to_dir(a,b.AXIS_Z,e.direction);f.normalize(e.direction,e.direction);if("SUN"==e.type){a=Math.acos(f.dot(e.zH,b.Hy));var k=Math.acos(f.dot(e.direction,b.Hy));e.dH=Math.floor(a/.025)!=Math.floor(k/.025)?!0:!1}f.copy(e.direction,e.zH)}}};b4w.module.__scenes=function(a,t){function e(){Va||(Va=c(Za));return Va}function c(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.Gg||!c.Gg.length)return c}return null}function b(){Pb||Ga.I("No active scene available");return Pb}function f(a,b,c){if(!k(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>zb.Yb?(d.csm_resolution=zb.Yb,Ja.error("Shadow map texture has unsupported size. Changed to "+zb.Yb+".")):d.csm_resolution=c.csm_resolution;Ka.shadow_blur_samples=Ka.shadow_blur_samples?
Ka.shadow_blur_samples:c.blur_samples;d.TU=c.soft_shadows;a=Aa.hv(b,Ka.ssao&&a.b4w_enable_ssao);d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;c.b4w_enable_csm&&1<c.csm_num&&1<a.length&&Ja.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps.");d.Hh=[];d.EI=[];d.Cq=[];d.Bq=[];for(b=0;b<a.length;b++)d.Hh.push(a[b].Db.type),d.EI.push(a[b].Db.en),d.Cq.push(a[b].Db.Cq),
d.Bq.push(a[b].Db.Bq),"SPOT"!=d.Hh[b]&&"POINT"!=d.Hh[b]||!d.enable_csm||(Ja.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):
(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function k(a,b,c){if(0!=b.length&&Ka.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=Ka.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=
c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function q(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Db.type)return!0;return!1}function h(a){if(!Ka.shore_smoothing)return!1;a=ca(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.da.Di&&c.da.shore_smoothing)return!0}return!1}function u(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(Aa.oE(a[b].Fa,c[d].settings))return!0;return!1}function y(a){for(var b=ca(a),c=[],d=0;d<b.length;d++){var e=
b[d];if(e.da.Di){for(var f={},g=0;g<a.length;g++)for(var h=a[g],k=h.Fa.kc,l=0;l<k.length;l++)k[l]==e&&(f.Wi=h.location[2]);f.Kd=new Float32Array(4);f.Kd.set(e.da.pm);f.Kd[3]=e.da.Ru;e.da.is_dynamic?(f.Zq=!0,f.waves_height=e.da.waves_height,f.waves_length=e.da.waves_length,f.dst_noise_scale0=e.da.dst_noise_scale0,f.dst_noise_scale1=e.da.dst_noise_scale1,f.dst_noise_freq0=e.da.dst_noise_freq0,f.dst_noise_freq1=e.da.dst_noise_freq1,f.dir_min_shore_fac=e.da.dir_min_shore_fac,f.dir_freq=e.da.dir_freq,
f.dir_noise_scale=e.da.dir_noise_scale,f.dir_noise_freq=e.da.dir_noise_freq,f.dir_min_noise_fac=e.da.dir_min_noise_fac,f.dst_min_fac=e.da.dst_min_fac,f.waves_hor_fac=e.da.waves_hor_fac):(f.Zq=!1,f.waves_height=0,f.waves_length=0);f.cg=e.da.Eu;f.rN=e.da.mj;f.qN=e.da.lj;f.sN=new Float32Array([.3,.7]);f.nl=null;e=e.yg;for(g=0;g<e.length;g++)h=e[g].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(f.nl=h.image,f.SB=h.image.size[0],f.KA=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,f.cp=[(h[0]+
h[1])/2,(h[2]+h[3])/2],f.ep=[h[0]-h[1],h[2]-h[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.Zq)for(d=0;d<c.length;d++)c[d].Zq&&(f=c[d]);return f}return null}function g(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.refractions=!0);"BSDF_TRANSPARENT"==e.type&&(c.refractions=!0)}}}var c={refractions:!1};a=ca(a);for(var d=0;d<a.length;d++){var e=a[d];e.Gm&&(c.refractions=
!0);e.Md&&b(e.Md)}return c}function d(a,b,c){if(Ka.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;a=[];for(var d=0,e=!1,f=!1,g=0;g<b.length;g++){var h=b[g];h.v.Qd&&"CUBE"==h.v.Rh&&d++;if(h.fs.length){for(var k=null,l=0;l<a.length;l++)if(a[l]==h){k=l;break}null==k&&a.push(h)}}for(g=0;g<c.length;g++){b=c[g];b.b4w_reflexible&&(e=!0);a:if(b.b4w_reflexible){b=b.Fa.kc;for(h=0;h<b.length;h++)if(k=b[h].lb,"OPAQUE"!=k&&"CLIP"!=k&&"ALPHA_ANTIALIASING"!=k){b=!0;break a}b=!1}else b=
void 0;b&&(f=!0)}return{HH:a,iH:d,rj:[],xz:[],Mi:[],Fw:[],jA:e,XF:f}}function r(a,b){var c=a.b4w_sky_settings,d={};d.KH=c.render_sky||c.procedural_skydome;d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.pl=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=
c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.ke=c.reflexible;d.Rd=c.reflexible_only;!b&&c.procedural_skydome&&Ja.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function p(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.tR=a.hemisphere;b.aN=a.blur_depth;b.blur_discard_value=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.YT=a.samples;
return b}function M(a){if(!Ka.bloom||!a.b4w_enable_bloom)return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;b.adaptive=a.adaptive;b.average_luminance=a.average_luminance;return b}function E(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function z(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=
a.saturation;return b}function l(a){var b={};a=a.b4w_god_rays_settings;b.intensity=a.intensity;b.Vk=a.max_ray_length;b.ql=a.steps_per_pass;return b}function B(a){var b={};b.Mh=a.b4w_outline_color;b.Um=a.b4w_outline_factor;return b}function w(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function G(a,b){var c=a.light_settings,
d={};d.gg=c.environment_energy;d.Ps=c.use_environment_light;d.Iz=c.environment_color;d.Ld=a.horizon_color.slice(0);d.Yd=a.zenith_color.slice(0);d.nn=a.use_sky_paper;d.mn=a.use_sky_blend;d.on=a.use_sky_real;d.kx=null;d.cn=null;d.Gu=null;d.ie="";b.render_sky&&a.use_nodes&&a.node_tree&&(c=Ta.GE(a.node_tree,a.uuid,!1,a.name,"MAIN"),d.ie=c.id);c=!0;if(d.Ps&&"SKY_TEXTURE"==d.Iz&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&
!a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];break}e?d.Gu=e:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];e.texture.image&&(c=!0,d.kx=e,f=Math.min(zb.og,Ya.bz(e.texture.image.size[0]/3)),d.cn={WI:f,WD:e.blend_factor,dG:e.horizon_factor,XJ:e.zenith_up_factor,WJ:e.zenith_down_factor,color:e.color,Ga:e.default_value,invert:e.invert,BJ:e.use_rgb_to_intensity,XD:e.blend_type,wJ:e.use_map_blend,xJ:e.use_map_horizon,
zJ:e.use_map_zenith_up,yJ:e.use_map_zenith_down});break}d.Ps=d.Ps?c:!1;return d}function v(a){var b=a.fog_settings,c={};c.oW=b.use_fog;c.intensity=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.RP=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Kd=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.zf=new Float32Array([c.intensity,c.depth,c.start,c.height]);return c}function D(a,b){if(!Ka.Lc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;
case "ON":return!0}for(var c=!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],g=f.Fa.kc,h=0;h<g.length;h++)g[h].Si.zo&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function F(a,b){if(hb.outlining_overview_mode)return!0;if(Ka.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Fa.v.ll)return!0;return!1}else return!1}function n(a,
b){if(hb.outlining_overview_mode)return!0;if(Ka.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Fa.v.Yc)return!0;return!1}else return!1}function N(a,b){if(Ka.glow_materials)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].Fa.kc,e=0;e<d.length;e++)if(Ta.nE(d[e]))return!0;return!1}else return!1}function I(a,b){if(Ka.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;
case "ON":return!0;case "AUTO":return b.refractions}else return!1}function x(a){for(var b=0;b<a.length;b++)for(var c=a[b].Fa.kc,d=0;d<c.length;d++){var e=c[d];if(e.Tj&&"OPAQUE"!=e.lb&&"CLIP"!=e.lb&&"ALPHA_ANTIALIASING"!=e.lb)return!0}return!1}function J(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].Fa;if(d.anchor&&d.anchor.Yn)return!0}return!1}}function A(a,b){for(var c=ba(a,[S.Nb,S.bd,S.Zd]),d=0;d<c.length;d++)c[d].Mt=
b}function C(a,b,c,d,e,f){for(var g=b.v,h=Aa.Da(b,e),k=h.Y,l=0;l<k.length;l++){var n=k[l];if(!(n.Ge||n.Rd||"MAIN"!=n.type&&"NODES_GLOW"!=n.type&&"PARTICLES"!=n.type&&"LINE"!=n.type)&&("OPAQUE"==n.zb&&"OPAQUE"==d||"BLEND"==n.zb&&"BLEND"==d||"XRAY"==n.zb&&"XRAY"==d||"NODES_GLOW"==n.type&&"GLOW"==d)){if(!f&&(m(n,a,b,c,d,e),!la.Hc(n)))if("DEBUG"===Ib.type())la.xt(n,"error.glslv","error.glslf"),la.Hc(n);else continue;var p=S.Ai(n,g,h.bg[l]);S.Rc(a,p);ua.dm(c,a,n);U(n)}}}function R(a){a.Uk.Qs&&la.xb(a,
"USE_LOD_SMOOTHING",1)}function m(a,b,c,d,e,f){var g=c.v,h=f.J,k=Aa.Da(c,f),l="NO_SHADOWS";c=ba(f,[S.wd]);if(c.length&&a.Td){switch(e){case "OPAQUE":l="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":l="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":l="NO_SHADOWS";break;case "SHADOW":l="SHADOW_MASK_GENERATION";break;default:Ga.I("Wrong subscene type")}for(var m=0;m<c.length;m++)la.JD(a,f.J.Zc)}m="NO_SOFT_SHADOWS";if(h.Zc&&h.Zc.TU)switch(Ka.shadow_blur_samples){case "16x":m=
"POISSON_X_16";break;case "8x":m="POISSON_X_8";break;case "4x":m="POISSON_X_4"}c=a.Za;ra.pa(c,"SHADOW_USAGE",l);ra.pa(c,"POISSON_DISK_NUM",m);R(a);a.Lc&&(m=ua.jc(d,S.Zi))&&O(a,m,g);H(c,b.F);if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.vb){e=b.Po;ra.pa(c,"NUM_LIGHTS",e);ra.pa(c,"NUM_LFACTORS",e%2?Math.floor(e/2)+1:e/2);ra.pa(c,"REFLECTION_PASS","REFL_PASS_NONE");ra.pa(c,"SSAO_ONLY",0);if(e=h.sd)ra.pa(c,"WATER_EFFECTS",1),ra.pa(c,"WAVES_HEIGHT",ra.W(e.waves_height)),ra.pa(c,"WAVES_LENGTH",ra.W(e.waves_length)),
ra.pa(c,"WATER_LEVEL",ra.W(e.Wi));if(b.cg&&a.cg){ra.pa(c,"CAUSTICS",1);if(m=h.Zc){g=m.Hh;for(m=l=0;m<g.length;m++)"SUN"==g[m]&&(l=m);ra.pa(c,"SUN_NUM",l)}ra.pa(c,"CAUST_SCALE",ra.W(b.mj));ra.pa(c,"CAUST_SPEED",ra.W(b.Qt,2));ra.pa(c,"CAUST_BRIGHT",ra.W(b.lj))}m=k.rj;g=k.Mi;k=ua.jc(d,S.qe);if(-1!==a.Lf.indexOf("u_mirrormap"))ra.pa(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Qd&&m)b=m.F.hc,h.Qh.jA||(m.qm=!0,k&&(b=k.F.hc)),la.rk(a,b,"u_cube_reflection"),ra.pa(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Qd&&
g)for(m=0;m<g.length;m++)b=g[m].F.hc,la.rk(a,b,"u_plane_reflection"),ra.pa(c,"REFLECTION_TYPE","REFL_PLANE");else ra.pa(c,"REFLECTION_TYPE","REFL_NONE");k?a.zu?(b=k.F.hc,la.rk(a,b,"u_sky")):k.procedural_skydome&&(a.tf=k.tf,ra.pa(c,"PROCEDURAL_FOG",1)):ra.pa(c,"PROCEDURAL_FOG",0);b=h.Il;b.Ps&&(ra.pa(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.Iz?(b.Gu?(k=b.Gu.texture,b=Ya.ye(b.Gu),la.rk(a,b,"u_sky_texture",k.name)):k&&(b=k.F.hc,la.rk(a,b,"u_sky_texture")),ra.pa(c,"SKY_TEXTURE",1)):"SKY_COLOR"==b.Iz&&
ra.pa(c,"SKY_COLOR",1));b=h.VJ;b.oW&&(ra.pa(c,"USE_FOG",1),ra.pa(c,"FOG_TYPE",b.RP));a.Rj&&a.rb?(Ka.ru&&ra.pa(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.vb||"NODES_GLOW"==a.type?(ra.pa(c,"REFRACTIVE",1),h.refractions?ra.pa(c,"USE_REFRACTION",1):ra.pa(c,"USE_REFRACTION",0)):h.refractions?ra.pa(c,"REFRACTIVE",1):ra.pa(c,"REFRACTIVE",0),(h.TG.refractions||h.refractions)&&ra.pa(c,"HAS_REFRACT_TEXTURE",1)):(ra.pa(c,"REFRACTIVE",0),ra.pa(c,"USE_REFRACTION",0),ra.pa(c,"USE_REFRACTION_CORRECTION",
0));a.Qf&&(Ka.shore_smoothing&&a.wn&&ua.jc(d,S.OC)?ra.pa(c,"SHORE_SMOOTHING",1):ra.pa(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ra.pa(c,"DYNAMIC",1):ra.pa(c,"DYNAMIC",0));"PARTICLES"==a.type&&ra.pa(c,"COLOR_RAMP_LENGTH",a.Ha.$t);if(!a.Rg)for(a=a.ka,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(h=0;h<Za.length;h++)for(c=Za[h],k=Za[h].Gg,e=0;e<k.length;e++)k[e]==b&&Ba.H(Eb,c,f,null)}}function H(a,b){b.type==ha.se||b.type==ha.sh||b.type==ha.aj?ra.pa(a,"CAMERA_TYPE","CAM_TYPE_ORTHO"):
ra.pa(a,"CAMERA_TYPE","CAM_TYPE_PERSP")}function U(a){8<a.ka.length&&Ja.warn(a.type,"too many textures used - "+a.ka.length+' (max 8), materials "'+a.Xb.join(", ")+'"')}function O(a,b,c){a.jd=b.jd;var d=b.jd[0],e=b.jd[1],f=b.jd[2];c=c.ra;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.jd[2]=f;b=b.F;ha.eI(b,f/2,f/2,-e,-d);ha.set_projection(b,!1);d=a.Bj||0;d=0==d?c:Math.max(d,c);a.Bj=d}function V(a,b,c,d,e,f){for(var g=b.v,h=Aa.Da(b,e),k=h.Y,l=0;l<k.length;l++){var n=k[l];if(("MAIN"==
n.type||"PARTICLES"==n.type||"LINE"==n.type)&&"REFLECT"==n.zb&&n.rb==d){if(a.type==S.$d||a.type==S.Vf){var p;a:{var Q=e.J.Qh.Mi;for(p=0;p<Q.length;p++)for(var v=0;v<Q[p].length;v++)if(Q[p][v]==a)break a;Q=e.J.Qh.Fw;for(p=0;p<Q.length;p++)for(v=0;v<Q[p].length;v++)if(Q[p][v]==a)break a;p=null}if(p==g.Nd)continue}else if(p=ka(e,a),p==g.be)continue;if(!f&&(m(n,a,b,c,"REFLECT",e),p=n.Za,ra.pa(p,"WATER_EFFECTS",0),a.type==S.$d||a.type==S.Vf?ra.pa(p,"REFLECTION_PASS","REFL_PASS_PLANE"):ra.pa(p,"REFLECTION_PASS",
"REFL_PASS_CUBE"),ra.pa(p,"TEXTURE_NORM",0),!la.Hc(n)))if("DEBUG"===Ib.type())la.xt(n,"error.glslv","error.glslf"),la.Hc(n);else continue;p=S.Ai(n,g,h.bg[l]);S.Rc(a,p);ua.dm(c,a,n);U(n)}}}function ia(a){X(a);var b=oa(a,S.Nb),c=!0,d=a.J.Zc;Ba.ba(a.J.Aa,function(e,f){f.type===S.wd&&(T(f,a,b.F,d,c),c=!1)})}function na(a){Ba.ba(a.J.Aa,function(a,b){b.type===S.Cn&&(b.Xq=1)})}function T(a,b,c,d,e){if(0!=a.Xa.length){var f=a.F;ab.copy(c.C,f.C);ab.copy(c.Pf,f.qs);if("SUN"===d.Hh[a.vg]||"HEMI"===d.Hh[a.vg]){var g=
c.C,h=ec;ma.KW(h);for(var k=0;k<a.Xa.length;k++)for(var l=a.Xa[k].Ia,m=0;m<l.length;m++){var n=l[m].ya,p=l[m].qg;if(n.Lc){var Q=ab.tb(g,Jb),v=Ra.transformQuat(Ga.AXIS_MZ,Q,ob),Q=-v[0],v=v[1],r=ab.Qb(g,ob),Q=r[0]-n.Bj*(1+Q)/2,v=r[1]-n.Bj*(1-v)/2,p=ma.On(n.sb.Pe,p.C,Sc),p=p.max_z-p.min_z,r=Sc;r.min_x=Q;r.min_y=v;r.min_z=n.jd[0]-p;r.max_x=Q+n.Bj;r.max_y=v+n.Bj;r.max_z=n.jd[1]+p}else r=p.uh;k||m?ma.Iu(h,r):ma.ni(r,h)}g=ma.mF(h,Mb);Ga.Wo(g,f.Ub,g);if(d.enable_csm){b=Ra.copy(c.ri[a.Pq],Ab);d=ta.invert(c.Ub,
Qb);Ga.Wo(b,d,b);Ga.Wo(b,f.Ub,b);a=c.Qq[a.Pq];if(e)for(Qc=0,Hc=-Infinity,e=2;e<g.length;e+=3)Qc=Math.min(Qc,g[e]),Hc=Math.max(Hc,g[e]);e=ec;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=Hc;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=Qc}else{c=e=ec;d=Gb;d.set(g);g=$c/9;h=ta.identity(Qb);ta.rotate(h,g,Ga.AXIS_MZ,h);l=k=-1;for(m=0;10>m;m++){n=ma.Sy(d,0,d.length,Sc);p=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==k||.1<k-p)k=p,l=m,ma.ni(n,c);Ga.Wo(d,h,d)}c=l*g;0<c&&(d=ta.identity(Qb),ta.rotate(d,c,Ga.AXIS_MZ,d),ta.multiply(d,
f.Ub,f.Ub),ab.from_mat4(f.Ub,f.Pf));c=e.max_x-e.min_x;d=e.max_y-e.min_y;c&&d&&(g=Math.abs(c-d)/2,2<c/d?(e.max_y+=g,e.min_y-=g):2<d/c&&(e.max_x+=g,e.min_x-=g));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;ja(a,b.J.Aa)}ha.pU(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);ha.set_projection(f,!1);Ga.nm(f.rd,f.Eh)}else"SPOT"!==d.Hh[a.vg]&&"POINT"!==d.Hh[a.vg]||ha.set_projection(f,!1)}}function ja(a,b){for(var c=a.F,d=ua.cR(b,a),e=0;e<d.length;e++){var f=d[e];
if(f.type==S.Nb||f.type==S.Wf||f.type==S.bd||f.type==S.Dg)if(Ka.$v)f.Ts.set(c.Pf,9*a.vg);else{var g=ab.get_trans_view(c.Pf),h=ab.get_scale(c.Pf),k=ab.get_quat_view(c.Pf);Ob.set(g[0],g[1],g[2],h,Bb);f.Hp.set(Bb,4*a.vg);f.Gp.set(k,4*a.vg)}}}function ea(a,b,c,d,e){for(var f=b.v,g=Aa.Da(b,d),h=g.Y,k=0;k<h.length;k++){var l=h[k];if("COLOR_ID"==l.type&&(a.type==S.Ne&&"COLOR_ID"==l.zb||a.type==S.oh&&"COLOR_ID_XRAY"==l.zb)){if(!e&&(m(l,a,b,c,"COLOR_ID",d),la.xb(l,"USE_OUTLINE",0),!la.Hc(l)))continue;l=S.Ai(l,
f,g.bg[k]);S.Rc(a,l)}}}function qa(a,b){Z(a,b);for(var c=0;c<a.ue.length;c++)a.ue[c].parent==a&&qa(a.ue[c],b)}function Z(a,b){a.v.hide=b;if(Aa.is_lamp(a))for(var c=0;c<a.O.length;c++)for(var d=a.O[c],e=ba(d.jb,fc),f=0;f<e.length;f++){var g=e[f],h=a.v,k=a.Db,l=d.Hr,m=k.ln&&!h.hide?1:0;g.Km[4*l+3]=m;m=k.pn&&!h.hide?1:0;g.Jm[4*l+3]=m;g.Ka=!0}}function aa(a,b){for(var c=ba(b,fc),d=a.Db,e=a.v,f=Aa.Da(a,b),g=ab.get_trans_view(e.C),e=ab.get_quat_view(e.C),h=0;h<c.length;h++){var k=c[h],l=k,m=a.v,n=a.Db,
p=f.Hr,Q=ab.get_trans_view(a.v.C),v=n.Gq;l.Gr.set(n.direction,3*p);Bb[0]=Q[0];Bb[1]=Q[1];Bb[2]=Q[2];Bb[3]=n.ln&&!m.hide?1:0;l.Km.set(Bb,4*p);Bb[0]=v[0];Bb[1]=v[1];Bb[2]=v[2];Bb[3]=n.pn&&!m.hide?1:0;l.Jm.set(Bb,4*p);l.Ka=!0;switch(d.type){case "SUN":k.Fx.set(e);k.Ex=d.Gq;Ra.copy(d.direction,k.Dx);k.type==S.qe&&k.procedural_skydome&&(k.Jo=d.dH,Ca(b,k));break;case "HEMI":case "POINT":case "SPOT":break;default:Ja.error("Unknown light type: "+d.type+'".')}k=k.Xa;for(l=0;l<k.length;l++)for(m=k[l].Ia,n=
0;n<m.length;n++)p=m[n].ya,p.Im&&la.rU(p,a)}c=oa(b,S.Nb).F;f=f.QB;d=b.J.Zc;for(h=0;h<f.length;h++)k=f[h],ha.NB(k.F,g,e),T(k,b,c,d,!0),ja(k,b.J.Aa)}function X(a){var b=Wa.Ob(a,"LAMP",Wa.DATA_ID_ALL),b=Aa.hv(b,Ka.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.v,f=ab.Qb(e.C,Ab),e=ab.tb(e.C,Jb),g=0;g<d.O.length;g++){var h=d.O[g],k=h.QB;if(h.jb==a)for(h=0;h<k.length;h++)ha.NB(k[h].F,f,e)}}function fa(a){var b=oa(a,S.qe);b&&Ca(a,b)}function Ca(a,b){Ea.Gw(b);Ia.ao(b);
if(b.Jo)for(var c=ba(a,Db),d=0;d<c.length;d++)for(var e=c[d].Xa,f=0;f<e.length;f++)for(var g=e[f].Ia,h=0;h<g.length;h++){var k=g[h];k.dc&&(k=k.ya,la.vN(k)&&Ia.EV(k))}}function ca(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].Fa.kc,e=0;e<d.length;e++){var f=d[e];-1==b.indexOf(f)&&b.push(f)}return b}function Y(a,b,c,d){L.uG()&&(b*=window.devicePixelRatio,c*=window.devicePixelRatio);var f=e();f&&(f=f.J,b*=f.Yo,c*=f.Yo);b*=a.Xj;c*=a.Yj;d[0]=Math.floor(b);d[1]=Math.floor(c);return d}function za(a,
b,c){a=Y(a,b,c,gb);return a[0]>zb.Yb||a[1]>zb.Yb?(Ja.warn("Texture size exceeds platform limits, downscaling"),Math.min(zb.Yb/a[0],zb.Yb/a[0])):1}function P(a,b,c){for(var d=a.J,e=Aa.Da(a.bj,a).ha,f=0!=c?b/c:1,g=0;g<e.length;g++){var h=e[g];ha.eU(h,f);ha.set_projection(h,!1);d.Zc&&ha.xC(h,d.Zc)}if(d.Zc){d.pw=!0;d=ba(a,[S.Wf]);for(g=0;g<d.length;g++)d[g].Ka=!0;d=ba(a,[S.bd]);for(g=0;g<d.length;g++)d[g].Ka=!0}ya(a,b,c)}function ya(a,b,c){var d=a.J.Aa,e=Infinity;ua.Px(d,function(a){a.kn&&(e=Math.min(e,
za(a,b,c)))});ua.Px(d,function(f,g,h,k){if(f.kn){var l,m;k&&k.type==S.$i||h.Wb&&!f.wt?(l=b*f.Xj,m=c*f.Yj):(m=Y(f,b,c,gb),l=m[0]*e,m=m[1]*e);if(g)for(g=0;g<h.$a.length;g++)h.$a[g]==f&&Ya.resize(f.Ua,l,m);else switch(Ya.Ao(f.Ua)&&(Ya.resize(f.Ua,l,m),f.Ua.nh&&(k.Qv=f.Ua.$G)),f=h.F,f.width=l,f.height=m,h.type){case S.Tp:sa(a,{dof_power:h.F.dof_power});break;case S.Up:ga(a,{small_glow_mask_width:h.small_glow_mask_width,large_glow_mask_width:h.large_glow_mask_width});break;case S.Pp:pa(a,{blur:h.Jn});
break;case S.jD:f.width=f.hc.width;f.height=f.hc.height;break;case S.Cn:h=ua.Tc(d,h,S.bc);f=ua.Tc(d,h,S.bc);m=ua.Tc(d,f,S.bc);g=ua.Tc(d,m,S.bc);ua.Sd(h,1/l,1/l);ua.Sd(f,1/l,1/l);ua.Sd(m,1/l,1/l);ua.Sd(g,1/l,1/l);break;default:ua.Sd(h,1/l,1/m)}}})}function ba(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];a.J.Aa&&Ba.ba(a.J.Aa,function(a,b){b.type==e&&c.push(b)})}return c}function oa(a,b){return ua.jc(a.J.Aa,b)}function W(a){var b=e();b&&Ba.ba(b.J.Aa,function(b,c){var d=c.F;d&&d.type==ha.Oe&&(c.qm=
a)})}function sa(a,b){var c=ba(a,[S.Tp]);if(!c.length)return Ja.error("DOF is not enabled on the scene. Check camera settings"),0;for(var d=0;d<c.length;d++){var e=c[d],f=b,g=a,h=e.F.dof_bokeh,k=h?ba(g,[S.sy]):[],g=g.J.Aa;if("boolean"==typeof f.dof_on&&(e.F.dof_on=f.dof_on,h))for(var l=0;l<k.length;l++)k[l].F.dof_on=f.dof_on;if("number"==typeof f.dof_distance&&(e.F.dof_distance=f.dof_distance,h))for(l=0;l<k.length;l++)k[l].F.dof_distance=f.dof_distance;if("number"==typeof f.dof_front_start&&(e.F.dof_front_start=
f.dof_front_start,h))for(l=0;l<k.length;l++)k[l].F.dof_front_start=f.dof_front_start;if("number"==typeof f.dof_front_end&&(e.F.dof_front_end=f.dof_front_end,h))for(l=0;l<k.length;l++)k[l].F.dof_front_end=f.dof_front_end;if("number"==typeof f.dof_rear_start&&(e.F.dof_rear_start=f.dof_rear_start,h))for(l=0;l<k.length;l++)k[l].F.dof_rear_start=f.dof_rear_start;if("number"==typeof f.dof_rear_end&&(e.F.dof_rear_end=f.dof_rear_end,h))for(l=0;l<k.length;l++)k[l].F.dof_rear_end=f.dof_rear_end;"number"==typeof f.dof_bokeh_intensity&&
(e.F.dof_bokeh_intensity=f.dof_bokeh_intensity,h&&(k=ua.dv(g,e,S.bc),k[0].F.dof_bokeh_intensity=f.dof_bokeh_intensity,k[1].F.dof_bokeh_intensity=f.dof_bokeh_intensity,k[0]=ua.Tc(g,k[0],S.bc),k[0].F.dof_bokeh_intensity=f.dof_bokeh_intensity));if("number"==typeof f.dof_power)if(h){f=f.dof_power;e.F.dof_power=f;var f=f/2,h=e.F.width,l=e.F.height,m=[1/h,0],n=[1/h*.5,1/l*.866],p=[-1/h*.5,1/l*.866],k=ua.dv(g,e,S.bc);ua.od(k[0],f);ua.Sd(k[0],p[0],p[1]);ua.od(k[1],f);ua.Sd(k[1],n[0],n[1]);k[0]=ua.Tc(g,k[0],
S.bc);ua.od(k[0],f);ua.Sd(k[0],m[0],m[1]);e.F.Jd&&(k[0]=ua.Tc(g,k[0],S.sy),k[0]=ua.Tc(g,k[0],S.bc),ua.Sd(k[0],1/h,1/l),k[0]=ua.Tc(g,k[0],S.bc),ua.Sd(k[0],1/h,1/l))}else e.F.dof_power=f.dof_power,k=ua.Tc(g,e,S.bc),g=ua.Tc(g,k,S.bc),ua.od(k,e.F.dof_power),ua.Sd(k,1/e.F.width,1/e.F.height),ua.od(g,e.F.dof_power),ua.Sd(g,1/e.F.width,1/e.F.height)}}function pa(a,b){var c=ba(a,[S.dt]),d=ba(a,[S.Pp]);if(!c.length||!d.length)return Ja.error("Bloom is not enabled on the scene"),0;if("number"==typeof b.key)for(var e=
0;e<c.length;e++)c[e].Mn=b.key,c[e].Ka=!0;if("number"==typeof b.edge_lum)for(e=0;e<c.length;e++)c[e].Ln=b.edge_lum,c[e].Ka=!0;if("number"==typeof b.blur)for(e=0;e<d.length;e++){d[e].Jn=b.blur;for(var f=a.J.Aa,g=d[e].F.width/.5,h=d[e].F.height/.5,k=ua.dv(f,d[e],S.bc),l=0;l<k.length;++l){var m=k[l],n=ua.Tc(f,m,S.bc),p=g*m.Kn,Q=h*m.Kn;ua.od(m,b.blur);ua.Sd(m,1/p,1/Q);ua.od(n,b.blur);ua.Sd(n,1/p,1/Q)}}if("number"==typeof b.average_luminance)for(e=0;e<c.length;e++)c[e].Ol||(c[e].average_luminance=b.average_luminance,
c[e].Ka=!0)}function ga(a,b){var c=ba(a,[S.Up]);if(!c.length)return Ja.error("Glow is not enabled on the scene"),null;for(var d=0;d<c.length;d++){for(var e=c[d],f=b,g=a.J.Aa,h=ua.XQ(g,e),k=0;k<h.length;++k){var l=h[k];if(l.type==S.bc&&"GLOW_MASK_LARGE"==l.zb)var m=l;if(l.type==S.bc&&"GLOW_MASK_SMALL"==l.zb)var n=l}h=ua.Tc(g,m,S.bc);g=ua.Tc(g,n,S.bc);"number"==typeof f.small_glow_mask_coeff&&(e.small_glow_mask_coeff=f.small_glow_mask_coeff,e.Ka=!0);"number"==typeof f.large_glow_mask_coeff&&(e.large_glow_mask_coeff=
f.large_glow_mask_coeff,e.Ka=!0);"number"==typeof f.small_glow_mask_width&&(e.small_glow_mask_width=f.small_glow_mask_width,ua.od(n,f.small_glow_mask_width),ua.Sd(n,1/e.F.width,1/e.F.height),n.Ka=!0,ua.od(g,f.small_glow_mask_width),ua.Sd(g,1/e.F.width,1/e.F.height),g.Ka=!0);"number"==typeof f.large_glow_mask_width&&(e.large_glow_mask_width=f.large_glow_mask_width,ua.od(m,f.large_glow_mask_width),ua.Sd(m,1/e.F.width,1/e.F.height),m.Ka=!0,ua.od(h,f.large_glow_mask_width),ua.Sd(h,1/e.F.width,1/e.F.height),
h.Ka=!0)}}function va(a,b,c){var d=a.J,e=d.sd;if(!e.Zq)return e.Wi;var f=e.waves_height,g=e.waves_length,h=e.Wi,k=Ra.length(d.Zh)||1;a=oa(a,S.Nb).time;a*=k;k=gb;k[0]=20/g*(b-.25*a);k[1]=20/g*(c-.25*a);var l=Ga.kE(k);k[0]=17/g*(c+.1*a);k[1]=17/g*(b+.1*a);var k=l+Ga.kE(k)-1,m=e.dst_noise_scale0,l=e.dst_noise_scale1,n=e.dst_noise_freq0,p=e.dst_noise_freq1,Q=gb;Q[0]=m*(b+n*a);Q[1]=m*(c+n*a);m=Ga.UB(Q);Q[0]=l*(c-p*a);Q[1]=l*(b-p*a);l=f*m*Ga.UB(Q);e.nl?(p=(b-e.cp[0])/e.ep[0],Q=(e.cp[1]+c)/e.ep[1],p+=.5,
Q+=.5,1<p||0>p||1<Q||0>Q?b=l:(d=Ga.GF(d.RB,e.SB,p,Q),p=e.dir_noise_scale,Q=e.dir_noise_freq,m=Math.sqrt(d),n=Math.max(m,e.dst_min_fac),b=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(m/(g/e.KA/Math.PI)+e.dir_freq*a)*Math.max(Ga.UB([p/g*(b+Q*a),p/g*(c+Q*a)]),e.dir_min_noise_fac)*(1-n)+l*n,k*=d)):b=l;return h+(b+.05*k)}function xa(a,b){a.Fm&&a.type==S.bc&&b.dc!=a.dc&&(a.dc=b.dc);b.dc||a.type!=S.Cn||(a.Xq=0)}function K(a,b,c,d){var e=Ba.Ya(a,b);ha.Ww(e.F,c,d);e.iq=!0;Ba.xl(a,b,function(b,e,f){f.active&&
f.from==c&&ua.GN(f)&&Oa(a,b,f.to,d)});Ba.hk(a,b,function(b,e,f){f.active&&f.from==c&&f.from==f.to&&K(a,b,c,d)})}function Oa(a,b,c,d){a=Ba.Ya(a,b).Xa;for(b=0;b<a.length;b++)for(var e=a[b].Ia,f=0;f<e.length;f++)la.KT(e[f].ya,d,c)}function Qa(a){for(var b=ba(a,[S.Zi]),c=0;c<b.length;c++){var d=b[c],e=d.F,f=a.bj.v,g=ab.Qb(f.C,Ab),h=ob;h[0]=0;h[1]=0;h[2]=-d.jd[2]/2;d=ab.tb(f.C,Jb);Ra.transformQuat(h,d,h);h[0]+=g[0];h[1]+=g[1];h[2]=0;Ma.identity(d);ha.NB(e,h,d)}}function wa(a,b){Ba.ba(a,function(c,d){if(d.type==
S.bi){d.$a[0]&&d.lh[0]||Ga.I("Wrong MOTION_BLUR subscene");var e=d.$a[0],f=d.lh[0];d.lh[0]=d.F.hc;Ba.xl(a,c,function(b,c,d){d.active&&Oa(a,b,d.to,f)});K(a,c,e.from,f);Oa(a,c,e.to,d.lh[0]);d.iw=Math.exp(-b/d.mb_factor)}})}function da(a){return a.J.Zh}function ka(a,b){if(!a.J.Qh)return null;for(var c=a.J.Qh.rj,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.J.Qh.xz;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var la=t("__batch"),ma=t("__boundings"),ha=t("__camera"),La=t("__config"),L=t("__container"),
Xa=t("__debug"),Ba=t("__graph"),Q=t("__hud"),Da=t("__input"),ta=t("__mat4"),Ta=t("__nodemat"),Wa=t("__objects"),rb=t("__textures"),Aa=t("__obj_util"),Ha=t("__physics"),Ea=t("__prerender"),Na=t("__primitives"),Ja=t("__print"),Ma=t("__quat"),Ia=t("__renderer"),ua=t("__scenegraph"),Fa=t("__sfx"),ra=t("__shaders"),S=t("__subscene"),Ya=t("__textures"),ab=t("__tsr"),Ga=t("__util"),Ra=t("__vec3"),Ob=t("__vec4"),Ib=t("__version"),Ua=La.im,Ka=La.K,zb=La.xh,hb=La.Yc,sb=La.ap,vb=[S.Zi,S.wd,S.Nb,S.bd,S.Dg,S.Zd,
S.$d,S.ud,S.Vf,S.gf,S.Ne,S.oh,S.Wf,S.qh,S.ph];a.dX=vb;var fc=[S.Nb,S.bd,S.Dg,S.Zd,S.$d,S.ud,S.Bn,S.bt,S.qe,S.Vf,S.gf,S.dt,S.Wf,S.wd,S.Ne,S.oh,S.qh],Db=[S.Nb,S.it,S.bd,S.Dg,S.Zd,S.$d,S.ud,S.Vf,S.gf],Rc=[S.wd,S.Nb,S.bd,S.Dg,S.Zd,S.$d,S.ud,S.Vf,S.gf,S.Ne,S.oh,S.Wf,S.Bn,S.qh,S.ph],nb=[S.Nb,S.bd,S.Dg,S.Zd,S.$d,S.ud,S.Vf,S.gf],Va=null,Pb=null,Za=[],Eb=null,$c=Math.PI/2,gb=new Float32Array(2),Ab=new Float32Array(3),ob=new Float32Array(3),Jb=new Float32Array(4),Bb=new Float32Array(4),Qb=new Float32Array(16),
Mb=new Float32Array(24),Gb=new Float32Array(24),ec=ma.Re(),Sc=ma.Re(),Qc=0,Hc=-Infinity,wc=new Uint8Array(4);a.gY=function(){return{}};a.set_active=function(a){Pb=a;Fa.dU(a)};a.qT=function(a,b){var c=a.J,d=ua.zO(c.Aa);if(a==b){P(a,L.UF(),L.TF());for(var e=0;e<d.length;e++)a.J.Ym.push(d[e])}else for(e=a.Gg[0],P(a,e.Zj,e.Zj),e=0;e<d.length;e++)b.J.Ym.push(d[e]);d=ba(a,Rc);for(e=0;e<d.length;e++)d[e].Zh.set(c.Zh);for(e=0;e<c.Ym.length;e++)c.Ym[e].type==S.wd&&Ia.ao(c.Ym[e])};a.Fh=e;a.Mu=c;a.get_active=
b;a.La=function(){return Pb?!0:!1};a.Jk=function(a){return a.bj};a.lr=function(){return Za};a.gv=function(){if(1==Za.length)return Za;for(var a=0;a<Za.length;a++){var b=Za[a].J.Aa;Ba.ba(b,function(b,c){for(var d=c.Xa,e=0;e<d.length;e++)for(var f=d[e].Ia,g=0;g<f.length;g++){for(var h=f[g],k=h.ya.ka,l=h.ya.pf,m=null,n=0;n<k.length;n++)if("SCENE"==k[n].source&&k[n].us==Za[a].name&&c.type!=S.uy){Ja.error('Texture-scene loop detected. A scene is rendered to texture "'+l[n]+'" yet this texture belongs to the same scene.');
m=h.ya;break}if(m)for(k=m.ka,m.ka=[],m.Lf=[],la.DV(m,null),la.Hc(m),S.Rc(c,h),n=0;n<k.length;n++)rb.zE(k[n])}})}for(var c=[],a=0;a<Za.length;a++)if(b=Za[a],!b.Gg.length){b=Ba.Oj(Eb,b);Ba.HP(Eb,b);b=Ba.sl(Eb,b,Ba.nk);b=Ba.kC(b);Ba.ba(b,function(a,b){c.push(b)});break}return c};a.uM=function(a,b,c,e,k){a.Gg=a.Gg||[];a.Ba=null;var m=a.J,Q=Aa.Da(a.bj,a),A=a.bj.v;m.Np=[];var t=a.world;m.XR=c.length;m.tl=q(c);m.jx=r(t,m.tl);m.Il=G(t,m.jx);m.VJ=v(t);if(t=!a.Gg.length)a:{if("HMD"==Ka.stereo){if(Q.ha[0].type!=
ha.Pc){Ja.warn("Head-mounted display stereo is disabled for the non-perspective camera");Ka.stereo="NONE";t=!1;break a}if(!Da.can_use_device(Da.DEVICE_HMD)){Ja.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");Ka.stereo="NONE";t=!1;break a}}t="HMD"==Ka.stereo}m.yv=t;if(t=!a.Gg.length)Q.ha[0].type!=ha.Pc&&"ANAGLYPH"==Ka.stereo?(Ja.warn("Anaglyph stereo is disabled for the non-perspective camera"),Ka.stereo="NONE",t=!1):t="ANAGLYPH"==Ka.stereo;m.anaglyph_use=t;
m.lM=!m.anaglyph_use&&J(a,k);m.Qh=d(a,b,e);m.$M=M(a);m.FS=E(a);m.tN=z(a);m.kR=l(a);m.WS=B(a);m.xi=w(a);m.dof=Ka.dof&&(0<A.dof_distance||A.dof_object);m.motion_blur=Ka.motion_blur&&a.b4w_enable_motion_blur;m.compositing=Ka.compositing&&a.b4w_enable_color_correction;m.antialiasing=Ka.antialiasing&&1==Ka.Zb&&"NONE"!=a.b4w_antialiasing_quality;m.ssao=Ka.ssao&&a.b4w_enable_ssao;m.god_rays=Ka.god_rays&&a.b4w_enable_god_rays&&m.tl;m.qP=Ka.ru;m.kv=a.b4w_glow_settings.render_glow_over_blend;m.gV=p(a);k=g(e);
m.TG=k;m.refractions=I(a,k);m.Zc=f(a,c,e);m.sd=y(e);m.ai=x(e);m.SU=u(e);m.shore_smoothing=h(e);m.Lc=D(a,e);m.VN=F(a,e);m.outline=n(a,e);m.glow_materials=N(a,e);m.vS=a.b4w_lod_smooth_type;m.MG=a.b4w_lod_hyst_interval;switch(Ka.reflection_quality?Ka.reflection_quality:a.b4w_reflection_quality){case "LOW":m.si=sb.UE;m.Ph=sb.vH;break;case "MEDIUM":m.si=sb.jP;m.Ph=sb.kT;break;case "HIGH":m.si=sb.iP;m.Ph=sb.jT;break;default:m.si=sb.UE,m.Ph=sb.vH}L.uG()?(Ja.log("%cENABLE HIDPI MODE","color: #00a"),m.wD=
"AA_QUALITY_LOW",m.Yo=1,Ka.Zb=1):1<Ka.Zb?(Ja.log("%cENABLE MSAA RENDERING: "+Ka.Zb+"x","color: #00a"),m.Yo=1):(m.wD="AA_QUALITY_"+a.b4w_antialiasing_quality,m.Yo=Ka.quality===La.P_ULTRA?1.33:1);c=a.Gg.sort(function(a,b){return b.Zj-a.Zj});m.Aa=ua.yO(m,Q,A,c);m.Ym=[];m.pw=!1;m.XA=!1;m.YA=!1;m.Zh=new Float32Array(3);Za.push(a);Eb||(Eb=Ba.create());Ba.X(Eb,a);for(m=0;m<b.length;m++)Aa.IB(b[m],!0,a);a=L.get_container();L.resize(a.clientWidth,a.clientHeight,!0)};a.vM=function(a,b,c){for(var d=0;d<b.length;d++){var e=
b[d].J;e&&e.Ci&&(e.Xs=c,a.J.Np.push(b[d]))}};a.cv=function(a){return a.J.Aa};a.yF=function(a,b){Ba.ba(b,function(c,d){var e=null;switch(d.type){case S.bc:e=la.gu(d.Zr);break;case S.it:e=la.FO(d);break;case S.Fy:e=la.GO(d);break;case S.OC:e=la.lO();break;case S.Bn:e=la.pO(d.Aw,d.Qf,d.ql);break;case S.bt:e=la.qO();break;case S.bi:e=la.tO();break;case S.sy:e=la.gO(d.Xt);break;case S.Tp:var e=la.mO(d),f=d.F.dof_power;if(d.F.dof_bokeh){var f=f/2,g=ua.dv(b,d,S.bc);ua.od(g[0],f);ua.od(g[1],f);g[0]=ua.Tc(b,
g[0],S.bc);ua.od(g[0],f)}else{var g=ua.Tc(b,d,S.bc),h=ua.Tc(b,g,S.bc);ua.od(g,f);ua.od(h,f)}break;case S.Cn:var e=la.uO(),f=ua.Tc(b,d,S.bc),g=ua.Tc(b,f,S.bc),h=ua.Tc(b,g,S.bc),k=ua.Tc(b,h,S.bc);ua.od(g,d.qq);ua.od(f,d.qq);ua.od(k,d.dr*d.Um);ua.od(h,d.dr*d.Um);break;case S.Up:e=la.oO();break;case S.ty:e=la.hO();break;case S.JC:e=la.cO(d);break;case S.Dy:case S.gt:case S.Yp:case S.ht:e=la.DO(d.type);break;case S.Eg:e=la.HO(d.zb);break;case S.qe:e=la.iO(a,d);break;case S.LUMINANCE:e=la.rO();break;case S.MC:e=
la.dO();break;case S.dt:e=la.sO(d.Ol);break;case S.Pp:e=la.fO(d.It);break;case S.jD:e=la.gu("NONE");break;case S.aM:e=la.eP();break;case S.zn:e=la.bO();break;case S.Wp:e=la.wO()}e&&(f=S.Ai(e,Aa.Rn("NONE")),S.Rc(d,f),ua.dm(b,d,e),U(e))})};a.append_object=function(a,b,c,d){switch(b.type){case "MESH":case "LINE":case "WORLD":var e=a.J.Aa,f=b.v;!ua.jc(e,S.wd)&&f.Td&&(f.Td=!1);f=ba(a,vb);(c||d)&&Ha.append_object(b,a);for(d=0;d<f.length;d++){var g=f[d],h=b,k=e,l=a,n=c;switch(g.type){case S.Nb:C(g,h,k,"OPAQUE",
l,n);break;case S.bd:C(g,h,k,"BLEND",l,n);break;case S.Dg:C(g,h,k,"XRAY",l,n);break;case S.Zd:C(g,h,k,"GLOW",l,n);break;case S.$d:case S.ud:V(g,h,k,!1,l,n);break;case S.Vf:case S.gf:V(g,h,k,!0,l,n);break;case S.Wf:for(var p=Aa.Da(h,l),Q=p.Y,v=0;v<Q.length;v++){var r=Q[v];if("SHADOW"==r.type&&"RECEIVE"==r.zb&&r.Td){if(!n&&(m(r,g,h,k,"SHADOW",l),!la.Hc(r)))continue;var q=S.Ai(r,h.v,p.bg[v]);S.Rc(g,q);ua.dm(k,g,r);U(r)}}break;case S.wd:p=!1;Q=h.v;h=Aa.Da(h,l);v=h.Y;r=ua.jc(k,S.Zi);for(q=0;q<v.length;q++){var u=
v[q];if("SHADOW"==u.type&&"CAST"==u.zb){p=!0;if(!n){R(u);var x=g.Po;la.xb(u,"NUM_LIGHTS",x);la.xb(u,"NUM_LFACTORS",x%2?Math.floor(x/2)+1:x/2);H(u.Za,g.F);ra.pa(u.Za,"SHADOW_USAGE","SHADOW_CASTING");u.Lc&&r&&O(u,r,Q);la.xb(u,"SHADOW_TEX_RES",ra.W(l.J.Zc.csm_resolution));if(!la.Hc(u))continue}u.Lc&&(l.J.Zc.AP=!0);x=S.Ai(u,Q,h.bg[q]);S.Rc(g,x);ua.dm(k,g,u);U(u)}}p&&(h=l.J.Zc,n=ua.jc(k,S.Nb),T(g,l,n.F,h,!0));break;case S.Ne:ea(g,h,k,l,n);break;case S.oh:ea(g,h,k,l,n);break;case S.qh:p=h.v;Q=Aa.Da(h,l);
v=Q.Y;for(r=0;r<v.length;r++)if(q=v[r],"COLOR_ID"==q.type&&"OUTLINE"==q.zb){if(!n&&(m(q,g,h,k,"COLOR_ID",l),la.xb(q,"USE_OUTLINE",1),!la.Hc(q)))continue;q=S.Ai(q,p,Q.bg[r]);S.Rc(g,q)}break;case S.Zi:k=h.v;h=Aa.Da(h,l);l=h.Y;for(p=0;p<l.length;p++)if(Q=l[p],"GRASS_MAP"==Q.type){if(!n&&!la.Hc(Q))if("DEBUG"===Ib.type())la.xt(Q,"error.glslv","error.glslf"),la.Hc(Q);else continue;Q=S.Ai(Q,k,h.bg[p]);S.Rc(g,Q);Q=g.F;u=k.uh;v=g.jd[0];r=g.jd[1];q=g.jd[2];0==v&&0==r?(v=u.min_z,r=u.max_z):(v=Math.min(v,u.min_z),
r=Math.max(r,u.max_z));u=1E-4*(r-v);v-=u;r+=u;g.jd[0]=v;g.jd[1]=r;ha.eI(Q,q/2,q/2,-r,-v);ha.set_projection(Q,!1)}break;case S.ph:for(p=h.v,h=Aa.Da(h,l),l=h.Y,Q=0;Q<l.length;Q++)if(v=l[Q],"DEBUG_VIEW"==v.type){if(!n&&(v.Lc&&(r=ua.jc(k,S.Zi))&&O(v,r,p),!la.Hc(v)))if("DEBUG"===Ib.type())la.xt(v,"error.glslv","error.glslf"),la.Hc(v);else break;r=S.Ai(v,p,h.bg[Q]);S.Rc(g,r);ua.dm(k,g,v);U(v)}}}break;case "LAMP":aa(b,a)}c=Aa.Da(b,a);e=c.Y;for(f=0;f<e.length;f++)null==e[f].pb&&"PHYSICS"!=e[f].type&&(Aa.UH(c,
f),f--);Aa.IB(b,!0,a)};a.BR=function(a,b){if(a&&a.J&&a.J.Aa){var c=a.J.Aa,d=ua.jc(a.J.Aa,S.qe);if(d){var e=null;ua.Px(c,function(a,b,c,d){if("CUBEMAP"==a.from&&c.type==S.qe&&d.type==S.$i)return e=a.Ua,!0});if(e){var c=sb.ku,f=la.mr(b,a);if(f&&f.vb)f=Ta.$Q(Ta.fv(f.ie).Aa),-1!=f&&(c=rb.bz(f/2));else if(f=a.J.Il.cn)c=f.WI;c=Math.min(c,zb.og);d.F.width=c;d.F.height=c;Ya.YH(e,c);A(a,c)}}}};a.LV=function(a,b){for(var c=a.O,d=0;d<c.length;d++){var e=c[d].jb,f=e.J.Aa,g=ua.jc(e.J.Aa,S.qe);if(g){var h=null;
ua.Px(f,function(a,b,c,d){if("CUBEMAP"==a.from&&c.type==S.qe&&d.type==S.$i)return h=a.Ua,!0});h&&(f=rb.bz(b.height/2),f=Math.min(f,zb.og),g.F.width=f,g.F.height=f,Ya.YH(h,f),A(e,f))}}};a.JB=function(a){a.J.pw=!0};a.dW=function(a,b){Ba.ba(b,function(b,c){c.type===S.wd&&(ab.copy(a.C,c.F.C),ab.copy(a.Pf,c.F.qs))})};a.XZ=ja;a.GQ=function(a,b){for(var c=a.J.Zc,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=ha.hP(c,b,e);return d};a.zq=qa;a.$l=Z;a.is_hidden=function(a){return a.v.hide};a.JH=function(a,
b){for(var c=0;c<a.O.length;c++)for(var d=ba(a.O[c].jb,vb),e=0;e<d.length;e++)for(var f=d[e].Xa,g=0;g<f.length;g++)for(var h=f[g].Ia,k=h.length-1;0<=k;k--){var l=h[k];if(l.qg==a.v)if(l.ya){if("undefined"==typeof b||-1!=l.ya.Xb.indexOf(b)||0==l.ya.Xb.length)la.AE(l.ya),h.splice(k,1)}else h.splice(k,1)}};a.NV=function(a,b){for(var c=a.Db,d=Aa.Da(a,b).Hr,e=ba(b,fc),f=0;f<e.length;f++){var g=e[f];g.Jm.set(c.Gq,4*d);g.Ka=!0}};a.Ks=aa;a.Tx=function(a){a=a.O;for(var b=0;b<a.length;b++)fa(a[b].jb)};a.Ux=
fa;a.fW=Ca;a.cleanup=function(){for(var a=0;a<Za.length;a++){var b=Za[a];Ba.ba(b.J.Aa,function(a,b){if(b.type!=S.$i){var c=b.F;Ia.ET(c.Ve,c.hc,c.vf,c.width,c.height);for(var c=b.Xa,d=0;d<c.length;d++)for(var e=c[d].Ia,f=0;f<e.length;f++){var g=e[f].ya;g&&la.AE(g)}}});b.J.Aa=null;b.J.Ym=[]}Pb=Va=null;Za.length=0;Eb=null};a.QG=function(a,b,c){a=ha.NP(a,a.near,a.far,null,!0);var d=Na.nQ(a);a=Aa.Rn("DYNAMIC");a.uh=a.ra={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.te=a.pc=ma.VM();
var e=a.te.ib;a.tk=a.Ab=ma.Ty([e,0,0],[0,e,0],[0,0,e],a.te.S);c=la.CO(d,c);c.vj=!0;c=S.Ai(c,a);S.Rc(b,c)};a.JY=function(a){return[a.frame_start,a.frame_end]};a.nI=function(a,b,c){L.LU(a,b,c);Pb&&P(Pb,a,b)};a.xg=ba;a.Pb=oa;a.CT=function(){W(!1)};a.DT=function(){W(!0)};a.get_environment_colors=function(a){a=oa(a,S.Nb);var b=a.Ld,c=a.Yd,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.gg,d,e]};a.set_environment_colors=function(a,b,c,d){for(var e=ba(a,fc),f=0;f<e.length;f++){var g=
e[f];g.Ld.set(c);g.Yd.set(d);g.gg=b;g.Ka=!0}(b=ua.jc(a.J.Aa,S.qe))&&Ca(a,b)};a.get_sky_params=function(a){if((a=oa(a,S.qe))&&a.procedural_skydome){var b={};b.color=Array(3);Ra.copy(a.pl,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=
a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.PQ=function(a){return ba(a,Db)[0].zf[0]};a.NQ=function(a){return ba(a,Db)[0].zf[1]};a.QQ=function(a){return ba(a,Db)[0].zf[2]};a.OQ=function(a){return ba(a,Db)[0].zf[3]};a.bI=function(a,b){for(var c=ba(a,Db),d=0;d<c.length;d++){var e=c[d];e.zf[0]=b;e.Ka=!0}};a.$H=function(a,b){for(var c=ba(a,Db),d=0;d<c.length;d++){var e=
c[d];e.zf[1]=b;e.Ka=!0}};a.cI=function(a,b){for(var c=ba(a,Db),d=0;d<c.length;d++){var e=c[d];e.zf[2]=b;e.Ka=!0}};a.aI=function(a,b){for(var c=ba(a,Db),d=0;d<c.length;d++){var e=c[d];e.zf[3]=b;e.Ka=!0}};a.get_fog_color_density=function(a,b){var c=b||[],d=ba(a,Db)[0].Kd;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=ba(a,Db),d=0;d<c.length;d++){var e=c[d];e.Kd.set(b);e.Ka=!0}};a.get_ssao_params=function(a){var b=oa(a,S.it),c=oa(a,S.Fy);a=oa(a,S.Nb);
if(!b)return null;var d={};d.quality=b.fn;d.use_hemisphere=b.mp;d.use_blur_depth=c.jp;d.blur_discard_value=c.kp;d.radius_increase=b.op;d.influence=b.np;d.dist_factor=b.lp;d.ssao_only=a.ssao_only;d.ssao_white=b.ssao_white;return d};a.get_dof_params=function(a){a=oa(a,S.Tp);if(!a)return null;var b={};b.dof_on=a.F.dof_on;b.dof_distance=a.F.dof_distance;b.dof_front_start=a.F.dof_front_start;b.dof_front_end=a.F.dof_front_end;b.dof_rear_start=a.F.dof_rear_start;b.dof_rear_end=a.F.dof_rear_end;b.dof_power=
a.F.dof_power;b.dof_bokeh=a.F.dof_bokeh;b.dof_bokeh_intensity=a.F.dof_bokeh_intensity;b.dof_object=a.F.dof_object;return b};a.set_dof_params=sa;a.get_god_rays_params=function(a){var b=ba(a,[S.Bn]);a=oa(a,S.bt);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Vk;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=la.hd(b[0].Xa[0].Ia[0].ya,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=ba(a,[S.Bn]),d=ba(a,[S.bt]);if(!c.length||!d.length)return Ja.error("God Rays are not enabled on the scene"),
0;if("number"==typeof b.god_rays_intensity)for(var e=0;e<d.length;e++)d[e].god_rays_intensity=b.god_rays_intensity;if("number"==typeof b.god_rays_max_ray_length)for(var f=b.god_rays_max_ray_length,e=0;e<c.length;e++)c[e].Vk=f,c[e].Xo=f/c[e].ql/(e+1),c[e].Ka=!0;if("number"==typeof b.god_rays_steps)for(var g=ra.W(b.god_rays_steps,1),f=c[0].Vk,e=0;e<c.length;e++){c[e].ql=g;c[e].Xo=f/g/(e+1);c[e].Ka=!0;var h=c[e].Xa[0].Ia[0],k=h.ya;la.xb(k,"STEPS_PER_PASS",g);la.Hc(k);S.Rc(c[e],h)}for(e=0;e<d.length;e++)d.Ka=
!0};a.get_bloom_params=function(a){var b=oa(a,S.dt);a=oa(a,S.Pp);if(!b||!a)return null;var c={};c.key=b.Mn;c.edge_lum=b.Ln;c.blur=a.Jn;c.adaptive=b.Ol;c.average_luminance=b.average_luminance;return c};a.set_bloom_params=pa;a.get_glow_material_params=function(a){a=oa(a,S.Up);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};
a.set_glow_material_params=ga;a.get_wind_params=function(a){var b=da(a);a=Ra.length(b);if(0==a)return null;var b=Ga.rad_to_deg(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};a.ZT=function(a){a.J.XA=!0};a.get_water_surface_level=va;a.get_water_mat_params=function(a,b){var c=a.J.sd,d=oa(a,S.Nb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,b.water_fog_density=d.Yh[3],c=b.water_fog_color=[],c[0]=d.Yh[0],c[1]=d.Yh[1],c[2]=d.Yh[2])};a.set_water_params=function(a,
b){var c=a.J.sd;if(!c)return Ja.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&
(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Zq=b.water_dynamic);for(var d=ba(a,nb),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&
c.Kd&&(f.Yh[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Kd&&f.Yh.set(b.water_fog_color);f.Ka=!0}};a.get_shore_dist=function(a,b,c){var d=a.J.sd;if(!d.nl)return 100;var e=d.KA;a=d.Wi;var f=(b[0]-d.cp[0])/d.ep[0],g=(d.cp[1]+b[1])/d.ep[1],f=f+.5,g=g+.5;if(!(1<f||0>f||1<g||0>g))return d=e*Ga.GF(Pb.J.RB,d.SB,f,g),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,c){for(var d=b().bj.v,e=0;e<Za.length;e++){var f=Za[e],g=f.J.Aa,h=f.J;if(h.sd)var k=ab.get_trans_view(d.C),l=k[2]-va(f,
k[0],k[1]);for(k=0;k<h.Np.length;k++){var m=h.Np[k].J,n=m.eb,p=m.Gd;if(!(f.b4w_use_nla&&m.Cl||!n&&!p)&&Ya.OJ(m)){var v=Ya.LJ(m),r=Ya.NJ(m);n&&Ka.is_mobile_device&&(r-=5);var q=Ya.wW(m);v>=q&&m.ik||v<r?(Ya.reset_video(m),p&&(m.ml=Ya.Vw(m,a))):v>=q&&!m.ik?Ya.pause_video(m):Ya.PJ(m)&&(n?Ya.rJ(m):(n=Ya.Vw(m,a),n!=m.ml&&(Ya.qJ(m),m.Wj++),m.ml=n))}}Ba.ba(g,function(b,c){-1<Rc.indexOf(c.type)&&(c.time=a);h.sd&&(c.vq=l)})}for(e=0;e<Za.length;e++)if(f=Za[e],h=f.J,g=h.Aa,d=h.Ym,d.length)for(h.pw&&(ia(f),h.pw=
!1),h.XA&&(Qa(f),h.XA=!1),h.YA&&(na(f),h.YA=!1),h.motion_blur&&wa(g,c),f=ua.jc(g,S.qh),k=0;k<d.length;k++)g=d[k],Ea.Gw(g),f&&xa(g,f),Ia.ao(g);Ka.show_hud_debug_info&&Q.PU(Za,c)};a.MT=function(a){a.J.YA=!0};a.Sz=function(a){var b=[];Ba.ba(a.J.Aa,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=oa(Pb,S.bd),b=Pb;return a||b.J.sd?a.vq:null};a.pJ=function(a){Ba.ba(a.J.Aa,function(a,b){b.Ka=!0})};a.iU=function(a,c){a.debug_view_mode=c;a.dc=c!=Xa.DV_NONE;a.rb=c==Xa.DV_TRANSPARENT_WIREFRAME;
a.Ka=!0;for(var d=b(),e=0;e<nb.length;e++)for(var f=ba(d,[nb[e]]),g=0;g<f.length;g++)f[g].Wq=c==Xa.DV_RENDER_TIME};a.hU=function(a,b){a.debug_colors_seed=b;a.Ka=!0};a.AU=function(a,b){a.pu=b;a.Ka=!0};a.JU=function(a,b){for(var c=a.Xa,d=0;d<c.length;d++)for(var e=c[d].Ia,f=0;f<e.length;f++){var g=e[f].ya;Ra.copy(b,g.wireframe_edge_color);g.pb.Ko=!0}};a.lJ=function(a,b){var c=b.co,d=a.J.Zh;if(c&&"WIND"==c.type&&d){var e=ab.get_quat_view(b.v.C);Ra.transformQuat(Ga.AXIS_Z,e,d);Ra.normalize(d,d);Ra.scale(d,
c.KI,d);c=ba(a,Rc);for(e=0;e<c.length;e++)c[e].Zh.set(d);return!0}return!1};a.eT=function(a,b,c){var d=oa(a,S.Ne);if(d){var e=Ua.enabled&&(Ua.zs===S.Ne||Ua.zs===S.oh);if(e)var f=L.wq(b,c,gb,d.F);else{var g=L.get_canvas();ha.gU(d.F,b,c,g.clientWidth,g.clientHeight)}Ea.Gw(d);d.dc&&Ia.ao(d);(a=oa(a,S.oh))?(ta.copy(d.F.wb,a.F.wb),ta.copy(d.F.rd,a.F.rd),Ga.nm(a.F.rd,a.F.Eh),Ea.Gw(a),a.dc&&Ia.ao(a),b=a.F):b=d.F;if(d.dc||a&&a.dc)return e?(f[1]=b.height-f[1],Ia.Nw(b.Ve,f[0],f[1],1,1,wc)):Ia.Nw(a?a.F.Ve:d.F.Ve,
0,0,1,1,wc)}else Ja.error("Object Selection is not available on the scene");return null};a.set_outline_color=function(a){for(var c=b(),c=ba(c,[S.Cn]),d=0;d<c.length;d++){var e=c[d];e.Mh.set(a);e.Ka=!0}};a.OY=da;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.get_custom_prop=function(a){return a.b4w_custom_prop};a.kJ=function(a,b){var c=Ab;Ra.negate(b,c);for(var d=0;6>d;d++){var e=a.sj[d],f=a.hm[d],
g=a.F;ta.translate(Ga.gK[d],c,e);ta.multiply(g.wb,e,g.rd);Ga.nm(g.rd,f)}};a.mJ=function(a,b,c){Ga.sV(b,c,Ga.AXIS_Z,a.F.wc)};a.ID=function(a,b,c){var d=a.J.Qh;if(d&&b)for(var e=0;e<b.length;e++){var f=b[e],g=Aa.Da(f,a);if(-1!=f.v.Nd){var h=d.Mi,k=d.Fw,f=f.v.Nd;k.length&&f<k.length?g.Mi=k[f]:h.length&&f<h.length&&(g.Mi=h[f])}else-1!=f.v.be&&(h=d.rj,k=d.xz,f=f.v.be,k.length?g.rj=k[f]:h.length&&(g.rj=h[f]))}if(c)for(b=Aa.hv(c,Ka.ssao&&a.b4w_enable_ssao),c=a.J.Zc,e=0;e<b.length;e++)if(g=Aa.Da(b[e],a),
c)for(d=ba(a,[S.wd]),f=0;f<d.length;f++)e==d[f].vg&&g.QB.push(d[f])};a.marker_frame=function(a,b){return a.timeline_markers[b]};a.set_hmd_params=function(a){var c=b();if(c=oa(c,S.Eg))a.distortion_coefs&&(c.uj[0]=a.distortion_coefs[0],c.uj[1]=a.distortion_coefs[1],c.Ka=!0),a.chromatic_aberration_coefs&&(c.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]=
a.chromatic_aberration_coefs[3],c.Ka=!0),a.base_line_factor&&(c.uj[2]=a.base_line_factor,c.Ka=!0),a.inter_lens_factor&&(c.uj[3]=a.inter_lens_factor,c.Ka=!0),null!=a.enable_hmd_stereo&&(c.enable_hmd_stereo=a.enable_hmd_stereo,c.Ka=!0)};a.mw=function(b,c){for(var d=Za,e=0;e<d.length;e++)ua.LS(a.cv(d[e]),b,c)};a.yV=function(a){for(var b=Wa.Ob(a,"LAMP",Wa.DATA_ID_ALL),c=ba(a,vb),d=0;d<c.length;d++)for(var e=c[d],f=e.Xa,g=0;g<f.length;g++)for(var h=f[g].Ia,k=0;k<h.length;k++){var l=h[k],m=l.ya;"MAIN"==
m.type&&(la.CV(m,b,a),la.Hc(m),S.Rc(e,l))}};a.GH=function(a){for(var b=0;b<Za.length;b++)Ba.ba(Za[b].J.Aa,function(b,c){for(var d=c.Xa,e=0;e<d.length;e++)for(var f=d[e].Ia,g=0;g<f.length;g++){var h=f[g];h.ya==a&&S.Rc(c,h)}})}};b4w.module.__physics=function(a,t){function e(a,b){for(var c=a.ue,d=0;d<c.length;d++)c[d].nd.Ns&&b.push(c[d]),e(c[d],b)}function c(a,b,c){for(var d=a.zc.Ia,e=0;e<d.length;e++)for(var f=d[e].L,g=0;g<f.sf.length;g++){var h=f.sf[g];"ANY"!=h.Jb&&c!=h.Jb||w(h,a,b)}}function b(a,b,c){if(m.Ev(a))switch(b){case m.nK:var d=f(a);d.zc.UJ=!0;m.oa(a,m.DL,Date.now()-performance.now(),aa.max_fps,aa.az?X.sF:0);break;case m.oK:U.ld("URANIUM:",c.slice(1));break;case m.jK:U.error(c);break;case m.kK:R.fbmsg.apply(this,
c.slice(1));break;case m.WC:if(a=k(c.ga)){var e=a;a=c.trans;d=c.quat;b=c.Fi;var g=c.ci,h=e.L;h.lu=c.time;c=T.get_scale(e.v.C);T.set_sep(a,c,d,h.zz);ea.copy(b,h.Fi);ea.copy(g,h.ci)}break;case m.UC:(a=k(c.fz))&&T.set_sep(c.trans,1,c.quat,a.N.$r[c.rB]);break;case m.lK:if(d=k(c[1]))a=c[4],d=d.Qg.Jt[c[2]],na.set_translation(d,c[3]),na.set_rotation(d,a),na.T(d);break;case m.rK:if(a=k(c[1]))a.N.speed=c[2];break;case m.SC:d=f(a);q(d,c.Xl,c.Yl,c.result,null,null,0);break;case m.TC:d=f(a);q(d,c.Xl,c.Yl,c.result,
c.bm,c.coll_norm,c.coll_dist);break;case m.hK:if(a=k(c[1]))a=a.L,a.am&&a.am(c[2]);break;case m.Ay:case m.VC:d=f(a);if(a=d.zc.il[c.id])d=k(c.Nn),b==m.Ay?(b=a.callback,b(a.id,c.hit_fract,d,c.hit_time)):(b=c.hit_fract,g=c.hit_time,h=c.hit_pos,e=a.callback,h?e(a.id,b,d,g,h,c.hit_norm):e(a.id,b,d,g));break;case m.qK:D(c.id);break;case m.pK:a=ca.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+
" ms");break;case m.mK:Ca=c[1];break;case m.iK:a=ca.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:U.error("Wrong message: "+b)}}function f(a){for(var b=0;b<ca.length;b++)if(ca[b]==a)return Y[b]}function k(a){return za[a]||null}function q(a,b,c,d,e,f,g){a=a.zc.Ia;for(var l=0;l<a.length;l++)for(var m=a[l].L,n=0;n<m.sf.length;n++){for(var p=m.sf[n],v=p.el,r=!1,q=0;q<v.length;q++){var u=v[q];if(u[0]===b&&u[1]===c){p.Pr[q]=d;r=!0;break}}r&&(v=h(p),e&&p.Xy!=b&&(r=e,q=f,u=
g,r[0]+=q[0]*u,r[1]+=q[1]*u,r[2]+=q[2]*u,q[0]*=-1,q[1]*=-1,q[2]*=-1),p.callback(v,v?p.Xy==b?k(c):k(b):null,e,f,g))}}function h(a){a=a.Pr;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function u(){ba.body++;return ba.body}function y(a){var b=ya.indexOf(a);return-1==b?(ya.push(a),ya.length-1):b}function g(a,b){return{ga:a,type:b,$g:0,Hv:!1,ol:!0,Bf:!1,is_character:!1,LR:!1,au:null,Jb:"",Fq:0,cY:{},sf:[],am:null,lu:0,zz:new Float32Array([0,0,0,1,0,0,0,1]),Fi:new Float32Array(3),ci:new Float32Array(3),
Pt:new Float32Array(3),uq:new Float32Array(4),Kr:null}}function d(a,b){switch(a){case "BOX":var c=b.ra;break;case "CYLINDER":c=b.mq;break;case "CONE":c=b.lq;break;case "SPHERE":c=b.pc;break;case "CAPSULE":c=b.kq}return c}function r(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&
(b.max_z=a.max_z);"object"===typeof a.S&&(b.center=a.S);"number"===typeof a.ib&&(b.radius=a.ib);"number"===typeof a.height&&(b.height=a.height);return b}function p(a,b,c,d,e){var f=T.get_trans_view(a.v.C),g=T.invert(b.v.C,sa),h=new Float32Array(3);T.transform_vec3(f,g,h);switch(b.N.type){case 10:b=b.Nf;a=a.v.ra;m.oa(e,m.gL,c,h,b.oV,b.CB,(a.max_z-a.min_z)/2,d);break;case 20:m.oa(e,m.fL,c,h,a.Wy)}}function M(a){return a.L&&a.L.au}function E(a,b,c,d,e,f,g,h,k,l){var n;ba.qc++;n=ba.qc.toString(16);var p=
b.L.ga;m.oa(z(p),m.nL,n,a,h,p,c,d,e.L.ga,f,g,k,l);b.L.au=n}function z(a){for(var b=0;b<Y.length;b++)for(var c=Y[b].zc.Ia,d=0;d<c.length;d++)if(c[d].L.ga==a)return ca[b];return null}function l(a){var b=a.L;if(b=b?0===b.$g?!0:!0===b.Hv?!0:!1===b.ol?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=T.Qb(a.v.C,oa),c=T.tb(a.v.C,W),b=b[0]!=a.L.Pt[0]||b[1]!=a.L.Pt[1]||b[2]!=a.L.Pt[2]||c[0]!=a.L.uq[0]||c[1]!=a.L.uq[1]||c[2]!=a.L.uq[2]||c[3]!=a.L.uq[3];if(b){var b=a.L,d=a.v,c=m.NF(m.Vp);c.ga=b.ga;
var e=T.Qb(d.C,c.trans),d=T.tb(d.C,c.quat);ea.copy(e,b.Pt);O.copy(d,b.uq);"DYNAMIC"==b.type&&O.identity(c.quat);m.oa(z(b.ga),m.Vp)}a=a.ue;for(b=0;b<a.length;b++)l(a[b])}function B(a,b,c,d,e){e=e||new Float32Array(3);a=T.get_quat_view(a.v.C);e[0]=b;e[1]=c;e[2]=d;ea.transformQuat(e,a,e)}function w(a,b,c){var d=a.el,e=a.Pr,f=a.Xy,g=[],h=a.Jb;g||ja.I("At least one destination required");for(var k=0;k<b.zc.Ia.length;k++){var l=b.zc.Ia[k];if("ANY"==h||l.L.Jb==h&&"NAVMESH"!=l.L.type)l=l.L.ga,g&&-1==g.indexOf(l)&&
g.push(l)}for(b=0;b<g.length;b++)h=g[b],f<h&&!G(d,f,h)?(d.push([f,h]),e.push(!1)):f>h&&!G(d,h,f)&&(d.push([h,f]),e.push(!1));m.oa(c,m.eL,f);m.oa(c,m.mL,d,a.ji)}function G(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function v(a){a.L&&a.L.am&&(a=a.L,m.oa(z(a.ga),m.zL,a.ga),a.am=null)}function D(a){var b=n(a),c=F(a).zc;c.il[a]&&(delete c.il[a],c.vB.splice(c.vB.indexOf,1),m.oa(b,m.IL,a))}function F(a){for(var b=0;b<Y.length;b++){var c=Y[b];if(c.zc.il[a])return c}return null}
function n(a){for(var b=0;b<Y.length;b++)if(Y[b].zc.il[a])return ca[b];return null}function N(a,b,c){if(b.rp){a=a.L.ga;var d=b.bo*b.fr,e=b.sq*b.tq,f=-b.pp*b.qp*2*Math.PI/b.ys;b.wr&&(f*=-1);switch(b.type){case 10:m.oa(c,m.WL,a,d,e,f);break;case 20:m.oa(c,m.VL,a,d,e,f)}}}function I(a){return a.Bf&&"CHASSIS"==a.Nf.Gf}function x(a){return a.Bf&&"HULL"==a.Nf.Gf}function J(a){return"NAVMESH"==a.nd.Tr}function A(a){return a.Em&&"MAIN_BODY"==a.ho.Gf}var C=t("__config"),R=t("__debug"),m=t("__ipc"),H=t("__obj_util"),
U=t("__print"),O=t("__quat"),V=t("__scenes"),ia=t("__subscene"),na=t("__transform"),T=t("__tsr"),ja=t("__util"),ea=t("__vec3"),qa=t("__version"),Z=t("__navmesh"),aa=C.L,X=C.K,fa=C.ae,Ca=0,ca=[],Y=[],za={},P=[],ya=["ANY"],ba={body:0,qc:0,EH:0},oa=new Float32Array(3),W=new Float32Array(4),sa=T.create(),pa=T.create();a.ER=function(a){a.zc={UJ:!1,Ia:[],il:{},vB:[]};var c=aa.Ms;fa.prevent_caching&&(c+="?v="+qa.get_build_version());U.log("%cLOAD PHYSICS","color: #0a0",aa.qn?"Using Separate Worker Thread,":
"Using Same Thread,","Max FPS: "+aa.max_fps);U.log("%cPHYSICS PATH","color: #0a0",c);var d=m.fP(c,!aa.qn);m.OM(d,b);ca.push(d);Y.push(a);aa.ping&&setInterval(function(){m.oa(d,m.FL,performance.now())},1E3)};a.HN=function(a){return a.zc?a.zc.UJ:!0};a.cleanup=function(){for(var a=0;a<ca.length;a++)m.terminate(ca[a]);ca.length=0;Y.length=0;za={};P.length=0;ya=["ANY"];for(var b in ba)ba[b]=0};a.append_object=function(a,b){if(b.zc){var f;a:{for(var h=0;h<Y.length;h++)if(Y[h]==b){f=ca[h];break a}f=void 0}var k=
[];a.nd.Ns&&e(a,k);var l=b.zc.Ia;if(I(a)||x(a)||a.is_character||A(a)||a.Dp){var n=J(a),v;if(n){var q=u(),w=g(q,"NAVMESH"),F=H.Da(a,b).Y;w.Kr=null;for(var ha=0;ha<F.length;ha++){var z=F[ha];if("PHYSICS"==z.type){w.Kr=Z.OS(z.la);break}}v=w}else{var L=f,t=a.v,B=a.nd,Q=B.Tr,Da=u();if("CAMERA"==a.type)var G=B.AC?B.Yt:"BOX",D=d(G,t),C=.5,ga=0;else if("EMPTY"==a.type)G="EMPTY",D=null,ga=C=0;else{var G=B.AC?B.Yt:"BOX",D=d(G,t),V=T.get_scale(t.C);if(1!=V){var va=D;switch(G){case "BOX":va.min_x*=V;va.max_x*=
V;va.min_y*=V;va.max_y*=V;va.min_z*=V;va.max_z*=V;break;case "CYLINDER":case "CONE":case "CAPSULE":va.height*=V;va.ib*=V;break;case "SPHERE":va.ib*=V}}C=t.Sg;ga=t.Ng}var R=T.get_trans_view(t.C),ia=T.get_quat_view(t.C),ba=B.Ui,ya=B.CJ,na=B.$g,ua=B.HJ,Fa=B.GJ,ra=B.YE,S=B.PH,Ya=a.Jb,ab=y(Ya),Ga=B.li,Ra=B.ki,Ob=B.mi,Ib=t.pc.ib,Ua=r(D),Ka=a.bu,oa;var hb=G;if(k.length){var sb=[],ea={};ea.quat=new Float32Array([0,0,0,1]);ea.trans=new Float32Array(3);ea.worker_bounding=Ua;ea.bounding_type=hb;sb.push(ea);
var aa=T.invert(t.C,sa),X=W,qa=T.get_quat_view(t.C);O.invert(qa,X);for(var fa=0;fa<k.length;fa++){var Va={},Ca=k[fa],Za=Ca.nd.Yt,Eb=new Float32Array(4),$c=new Float32Array(3),gb=T.get_trans_view(Ca.v.C),Ab=T.get_quat_view(Ca.v.C);T.transform_vec3(gb,aa,$c);O.multiply(X,Ab,Eb);Va.trans=$c;Va.quat=Eb;Va.bounding_type=Za;Va.worker_bounding=r(d(Za,Ca.v));sb.push(Va)}oa=sb}else oa=[];m.oa(L,m.jL,Da,R,ia,Q,ba,ya,na,ua,Fa,ra,S,ab,Ga,Ra,Ob,G,Ua,Ib,C,ga,oa,Ka);za[Da]=a;P.push(a);var ob=g(Da,"BOUNDING");ob.type=
Q;ob.$g=na;ob.Hv=ba;ob.Jb=Ya;ob.Fq=ab;v=ob}var Jb=v;a.L=Jb;var Bb={ya:null,L:Jb};n||(l.push(Bb),c(b,f,Jb.Jb))}else for(var Qb=H.Da(a,b).Y,Mb=0;Mb<Qb.length;Mb++){var Gb=Qb[Mb],ec;if(ec="PHYSICS"==Gb.type){var Sc;a:{for(var Qc=b.zc.Ia,Hc=0;Hc<Qc.length;Hc++){var wc=Qc[Hc].ya;if(wc&&wc.id==Gb.id){Sc=!0;break a}}Sc=!1}ec=!Sc}if(ec)if(Gb.Vd.Va)if(Gb.Qf&&b.J.sd){var cc=Gb,Bc=b,Ad=f,kb=Bc.J.sd;m.oa(Ad,m.sL,kb.Wi);if(cc.FW){var ib={};ib.dst_noise_scale0=cc.dst_noise_scale0;ib.dst_noise_scale1=cc.dst_noise_scale1;
ib.dst_noise_freq0=cc.dst_noise_freq0;ib.dst_noise_freq1=cc.dst_noise_freq1;ib.dir_min_shore_fac=cc.dir_min_shore_fac;ib.dir_freq=cc.dir_freq;ib.dir_noise_scale=cc.dir_noise_scale;ib.dir_noise_freq=cc.dir_noise_freq;ib.dir_min_noise_fac=cc.dir_min_noise_fac;ib.dst_min_fac=cc.dst_min_fac;ib.waves_hor_fac=cc.waves_hor_fac;var Cb=kb.waves_height,fb=kb.waves_length;kb.nl?m.oa(Ad,m.fD,ib,kb.ep[0],kb.ep[1],kb.cp[0],kb.cp[1],kb.KA,Cb,fb,kb.SB,Bc.J.RB):m.oa(Ad,m.fD,ib,0,0,0,0,0,Cb,fb,0,null)}}else{var gc;
if(Gb.Ui){var lb=a,Ic=Gb,Tc=f,Jc=u(),ad=Ic.Vd,lc=ad.fa[0].a_position,bd=ad.xa||null,Uc=Ic.Jb,mc=y(Uc),cd=Ic.li,tb=Ic.ki,rc=Ic.mi,Vc=T.get_trans_view(lb.v.C);m.oa(Tc,m.pL,Jc,lc,bd,Vc,mc,cd,tb,rc);var sc=g(Jc,"STATIC_MESH");sc.Hv=!0;sc.Jb=Uc;sc.Fq=mc;gc=sc}else{var Fb=a,Rb=Gb,mb=f,Sa=u(),Xb=Rb.Vd,dd=Xb.fa[0].a_position,Wc=Xb.xa||null,ic=T.get_trans_view(Fb.v.C),Kc=Rb.Sg,Sb=Rb.Ng,Lc=Rb.Jb,nc=y(Lc);m.oa(mb,m.rL,Sa,dd,Wc,ic,Kc,Sb,nc,Rb.li,Rb.ki,Rb.mi);var Mc=g(Sa,"STATIC_MESH");Mc.Jb=Lc;Mc.Fq=nc;gc=Mc}Jb=
gc;a.L=Jb;Bb={ya:Gb,L:Jb};l.push(Bb);c(b,f,Jb.Jb)}else U.error("Object "+a.name+" has collision material with no assigned vertices")}if(I(a)||x(a)){var Tb=f,Hb=a.L.ga;I(a)?(a.N.type=10,m.oa(Tb,m.kL,Hb,a.N.cC,a.N.eC,a.N.dC,a.N.HC,a.N.LA)):x(a)&&(a.N.type=20,m.oa(Tb,m.iL,Hb,a.N.om,a.N.un,a.N.vn));if(a.N.Xm){var pb=a.N.Xm;switch(a.N.type){case 10:p(pb[0],a,Hb,!0,Tb);p(pb[1],a,Hb,!0,Tb);p(pb[2],a,Hb,!1,Tb);p(pb[3],a,Hb,!1,Tb);break;case 20:for(var oc=0;oc<pb.length;oc++)p(pb[oc],a,Hb,!1,Tb)}}N(a,a.N,
f)}else if(a.is_character){var jb=f,Xc=a.v,ed=a.L,Nc=Xc.ra.max_z-Xc.ra.min_z,wb=ed.ga,xb=a.lE,Ub=xb.DW,Yb=xb.WT,Kb=xb.hV,jc=xb.VR,Lb=xb.GW,ub=ja.sP(a);m.oa(jb,m.lL,wb,ub,Nc,Ub,Yb,Kb,jc,Lb);ed.is_character=!0}else if(A(a)){var Pa=f,Zb=a.L.ga;m.oa(Pa,m.oL,Zb,a.Qg.om,a.Qg.un,a.Qg.vn);if(a.Qg.Jt)for(var Nb=a.Qg.Jt,bb=0;bb<Nb.length;bb++){var $a=Nb[bb],$b=T.get_trans_view($a.v.C),kc=T.invert(a.v.C,sa),Cc=new Float32Array(3);T.transform_vec3($b,kc,Cc);m.oa(Pa,m.hL,Zb,Cc,$a.Wy)}a.L.LR=!0}for(Mb=0;Mb<P.length;Mb++){var Yc=
P[Mb];if(Yc.L){var xc=Yc;if(!M(xc))for(var tc=0;tc<xc.oB.length;tc++){var qb=xc.oB[tc],yc=qb.target,fd=qb.fT;if(yc.L){var Zc=new Float32Array([qb.gT,qb.hT,qb.iT]),cb=ja.euler_to_quat(new Float32Array([qb.Qa,qb.Ra,qb.Sa]),new Float32Array(4)),Vb=T.identity(sa),Vb=T.set_trans(Zc,Vb),Vb=T.set_quat(cb,Vb),ac=T.multiply(xc.v.C,Vb,sa),bc=T.invert(yc.v.C,pa),Dc=T.multiply(bc,ac,bc),Wb=T.get_trans_view(Dc),nd=T.get_quat_view(Dc),db=qb,eb={};eb.use_limit_x=db.pW;eb.use_limit_y=db.qW;eb.use_limit_z=db.rW;eb.use_angular_limit_x=
db.lW;eb.use_angular_limit_y=db.mW;eb.use_angular_limit_z=db.nW;eb.limit_max_x=db.gS;eb.limit_min_x=db.jS;eb.limit_max_y=db.hS;eb.limit_min_y=db.kS;eb.limit_max_z=db.iS;eb.limit_min_z=db.lS;eb.limit_angle_max_x=db.aS;eb.limit_angle_min_x=db.dS;eb.limit_angle_max_y=db.bS;eb.limit_angle_min_y=db.eS;eb.limit_angle_max_z=db.cS;eb.limit_angle_min_z=db.fS;E(fd,xc,Zc,cb,yc,Wb,nd,eb,null,null)}}}}}};a.VP=k;a.update=function(a,b){for(var c=0;c<ca.length;c++){var d=ca[c],e=a;d&&m.tG(d)&&m.oa(d,m.XL,e,b);for(var f=
0;f<P.length;f++){var g=P[f],h=g.L;if(h.ol&&h.lu){var k=m.tG(d)?e-h.lu:performance.now()/1E3-h.lu,k=Math.min(k,10/aa.max_fps),k=k-1/aa.max_fps;X.PS&&(k=0);var n=sa;T.HR(h.zz,k,h.Fi,h.ci,sa);na.set_tsr(g,n);na.T(g);l(g);if(g.N)for(var h=g,k=h.N.Xm,n=h.v.C,p=sa,v=0;v<k.length;v++){var r=k[v];T.multiply(n,h.N.$r[v],p);na.set_tsr(r,p);na.T(r)}g.N&&g.N.rp&&(p=g,k=p.N,h=k.rp)&&(v=p.N.HI,T.multiply(p.v.C,p.N.II,h.v.C),n=oa,T.transform_dir_vec3(v,p.v.C,n),p=W,O.setAxisAngle(n,-k.pp*k.qp*2*Math.PI,p),k=T.get_quat_view(h.v.C),
O.multiply(p,k,k),na.T(h));g.N&&g.N.VB&&(p=g,k=p.N,h=k.VB)&&(v=p.N.CI,T.multiply(p.v.C,p.N.DI,h.v.C),n=oa,T.transform_dir_vec3(v,p.v.C,n),p=W,v=Math.abs(k.speed)*k.ws,v>k.Eo&&(v=k.Eo),O.setAxisAngle(n,-v,p),k=T.get_quat_view(h.v.C),O.multiply(p,k,k),O.normalize(k,k),na.T(h));g.N&&g.N.fC&&(n=g,h=n.N,g=h.fC)&&(p=n.N.SI,T.multiply(n.v.C,n.N.TI,g.v.C),k=oa,T.transform_dir_vec3(p,n.v.C,k),n=W,O.setAxisAngle(k,-Math.abs(h.bo)*h.Tq,n),h=T.get_quat_view(g.v.C),O.multiply(n,h,h),O.normalize(h,h),na.T(g))}}m.nT(d);
d=Y[c];(e=d.J.sd)&&0<e.waves_height&&(d=V.Pb(d,ia.Nb),e=ea.length(d.Zh)||1,m.oa(ca[c],m.UL,d.time*e))}};a.uQ=function(){return Y[0]};a.pause=function(){for(var a=0;a<ca.length;a++)m.oa(ca[a],m.EL)};a.resume=function(){for(var a=0;a<ca.length;a++)m.oa(ca[a],m.JL)};a.enable_simulation=function(a){(a=a.L)||ja.I("No object physics");if(!a.ol){var b=a.ga,c=z(b);a.ol=!0;m.oa(c,m.CL,b)}};a.disable_simulation=function(a){(a=a.L)||ja.I("No object physics");if(a.ol){var b=a.ga,c=z(b);a.ol=!1;m.oa(c,m.BL,b)}};
a.Sw=function(a){return!!a.zc};a.va=function(a){return!!a.L};a.has_dynamic_physics=function(a){return(a=a.L)&&a.ol&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.$g&&0==a.Hv?!0:!1};a.has_simulated_physics=function(a){return(a=a.L)&&a.ol?!0:!1};a.set_gravity=function(a,b){var c=a.L.ga;m.oa(z(c),m.TL,c,b)};a.oR=M;a.apply_constraint=E;a.clear_constraint=function(a){a=a.L;m.oa(z(a.ga),m.HL,a.au);a.au=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,g){c=T.set_sep(c,1,d,sa);f=T.set_sep(f,1,g,pa);T.invert(c,
c);T.multiply(f,c,c);na.get_tsr(e,f);T.multiply(f,c,c);na.set_tsr(b,c);na.T(b);e=T.get_trans_view(b.v.C);f=T.get_quat_view(b.v.C);a.set_transform(b,e,f)};a.set_transform=function(a,b,c){var d=a.L,e=m.NF(m.Vp),f=T.Qb(a.v.C,e.trans);a=T.tb(a.v.C,e.quat);T.set_sep(f,1,a,d.zz);e.ga=d.ga;ea.copy(b,e.trans);O.copy(c,e.quat);m.oa(z(d.ga),m.Vp)};a.sync_transform=l;a.apply_velocity=function(a,b,c,d){var e=oa;B(a,b,c,d,e);a=a.L.ga;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),g=Math.abs(e[1]),
h=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=g?e[1]/g*Math.max(g,c):0;e[2]=h?e[2]/h*Math.max(h,d):0;m.oa(z(a),m.hD,a,e[0],e[1],e[2])};a.apply_velocity_world=function(a,b,c,d){a=a.L.ga;m.oa(z(a),m.hD,a,b,c,d)};a.apply_force=function(a,b,c,d,e){var f=oa;e?(f[0]=b,f[1]=c,f[2]=d):B(a,b,c,d,f);a=a.L.ga;m.oa(z(a),m.tL,a,f[0],f[1],f[2])};a.apply_torque=function(a,b,c,d){var e=oa;B(a,b,c,d,e);a=a.L.ga;m.oa(z(a),m.vL,a,e[0],e[1],e[2])};a.set_angular_velocity=function(a,b,c,d){a=a.L.ga;m.oa(z(a),m.KL,
a,b,c,d)};a.set_character_move_dir=function(a,b,c){a=a.L.ga;m.oa(z(a),m.NL,a,b,c)};a.set_character_move_type=function(a,b){var c=a.L.ga;m.oa(z(c),m.OL,c,b)};a.set_character_walk_velocity=function(a,b){var c=a.L.ga;m.oa(z(c),m.SL,c,b)};a.set_character_run_velocity=function(a,b){var c=a.L.ga;m.oa(z(c),m.QL,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.L.ga;m.oa(z(c),m.LL,c,b)};a.character_jump=function(a){a=a.L.ga;m.oa(z(a),m.xL,a)};a.character_rotation_inc=function(a,b,c){a=a.L.ga;m.oa(z(a),
m.yL,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.L.ga;m.oa(z(a),m.PL,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.L.ga;m.oa(z(c),m.ML,c,b)};a.set_character_rotation_v=function(a,b){var c=a.L.ga;m.oa(z(c),m.RL,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.L;if(!e.Kr){for(var g=e.ga,h=0;h<e.sf.length;h++)if(a=e.sf[h],a.Jb==b&&a.callback==c)return;a={Xy:g,ji:d||!1,Jb:b,callback:c,el:[],Pr:[]};e.sf.push(a);b=z(g);w(a,f(b),b)}};a.remove_collision_test=function(a,b,c){a=a.L;
for(var d=z(a.ga),e=f(d),g=0;g<a.sf.length;g++){var k=a.sf[g];if(k.Jb==b&&k.callback==c){if(h(k)){var l=ea.set(0,0,0,oa);k.callback(!1,null,l,l,0)}a.sf.splice(g,1);g--;for(var l=d,k=k.el,n=e.zc.Ia,p=0;p<n.length;p++)for(var v=n[p].L,r=0;r<v.sf.length;r++)for(var q=v.sf[r],u=0;u<q.el.length;u++)for(var x=q.el[u],w=0;w<k.length;w++){var Q=k[w];x[0]==Q[0]&&x[1]==Q[1]&&(k.splice(w,1),w--)}k.length&&m.oa(l,m.gD,k)}}};a.apply_collision_impulse_test=function(a,b){a.L&&a.L.am&&v(a);var c=a.L;m.oa(z(c.ga),
m.uL,c.ga);c.am=b};a.clear_collision_impulse_test=v;a.append_ray_test=function(a,b,c,d,e,g,h,k,l){var n;ba.EH++;n=ba.EH;a={id:n,ga:a?a.L.ga:0,from:new Float32Array(b),to:new Float32Array(c),Jb:d,Fq:y(d),MD:g,iN:h,ji:k,Av:l,callback:e};b=z(a.ga)||ca[0];c=f(b).zc;c.il[n]=a;c.vB.push(a);m.oa(b,m.qL,a.id,a.ga,a.from,a.to,a.Fq,a.MD,a.iN,a.ji,a.Av);return n};a.remove_ray_test=D;a.change_ray_test_from_to=function(a,b,c){var d=n(a),e=F(a).zc.il[a];e&&!e.MD&&(e.from.set(b),e.to.set(c),m.oa(d,m.wL,a,b,c))};
a.vG=function(a){return F(a).zc.il[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.N;c.bo=b;N(a,c,z(a.L.ga))};a.vehicle_steer=function(a,b){var c=a.N;c.pp=b;N(a,c,z(a.L.ga))};a.vehicle_brake=function(a,b){var c=a.N;c.sq=b;N(a,c,z(a.L.ga))};a.is_vehicle_chassis=I;a.is_vehicle_hull=x;a.hZ=J;a.KR=function(a){if(!a.Bf)return!1;a=a.Nf.Gf;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.JR=function(a){return a.Bf?"BOB"==a.Nf.Gf?!0:!1:!1};a.MR=
function(a){return a.Em?"BOB"==a.ho.Gf?!0:!1:!1};a.xG=function(a){return a.Bf&&"STEERING_WHEEL"==a.Nf.Gf?!0:!1};a.wG=function(a){return a.Bf&&"SPEEDOMETER"==a.Nf.Gf?!0:!1};a.yG=function(a){return a.Bf&&"TACHOMETER"==a.Nf.Gf?!0:!1};a.get_vehicle_speed=function(a){return a.N.speed};a.IW=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.YF=function(a){return a.L&&a.L.is_character};a.gZ=A;a.RQ=
function(){return Ca};a.nP=function(){for(var a=0;a<ca.length;a++)m.oa(ca[a],m.AL)};a.remove_object=function(a){var b=a.L.ga;if("BOUNDING"==a.L.type){var c=P.indexOf(a);-1==c&&U.error("Object "+a.name+" doesn't have bounding physics");delete za[b];P.splice(c,1)}for(var c=z(b),d=f(c),e=d.zc.Ia,g=[],k=0;k<e.length;k++)for(var l=e[k].L,n=0;n<l.sf.length;n++)for(var p=l.sf[n],r=0;r<p.el.length;r++){var q=p.el[r],u=p.Pr[r];if(q[0]==b||q[1]==b)p.el.splice(r,1),p.Pr.splice(r,1),r--,u&&!h(p)&&(u=ea.set(0,
0,0,oa),p.callback(!1,null,u,u,0)),g.push(q)}g.length&&m.oa(c,m.gD,g);a.L&&a.L.am&&v(a);a=d.zc.Ia;for(d=0;d<a.length;d++)a[d].L.ga==b&&(a.splice(d,1),d--);m.oa(c,m.GL,b)};a.qR=function(a){var b=a.nd;return a.Bf||a.Em||a.is_character||a.Dp&&!b.Ui&&0<b.$g&&("DYNAMIC"==b.Tr||"RIGID_BODY"==b.Tr)}};b4w.module.__data=function(a,t){function e(a,b){Ua[b.id]=null;Ka[b.id]=null}function c(a,b,c,d){a instanceof ArrayBuffer?(a=Oa.VF(a,d),d=a.width,a=a.height):(d=a.width,a=a.height);ta.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(zb)&&c&&ta.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){function g(a){f(b,c,a)}function h(d,f,l,m){if(d){ta.log("%cLOAD METADATA","color: #616",m);f=ra.JI(d.b4w_format_version);switch(ra.IJ(f,Ga.Nm)){case -1:f[0]<
Ga.Nm[0]?ra.I("JSON version is too old relative to B4W engine: "+ra.El(f)+", required: "+ra.El(Ga.Nm)+". Reexport scene with the latest B4W addon to fix it."):ta.warn("JSON version is a bit old relative to B4W engine: "+ra.El(f)+", required: "+ra.El(Ga.Nm)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>Ga.Nm[0]?ra.I("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):ta.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}Ga.EA=
f;for(var n in d)a[n]=d[n];b.Kb&&(hb=Aa.Mu(a.scenes));(d=a.binaries[0].binfile)?b.VD=d:(ka.fx(b,"load_binaries"),ka.fx(b,"prepare_bindata"));Ga.is_mobile_device||ka.fx(b,"mobile_media_start");Ga.antialiasing&&Ga.smaa||ka.fx(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)n=a.b4w_export_errors[d],(b.Kb&&"PRIMARY"==n.type||"ALL"==n.type)&&ta.KP(n.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=
0;d<a.b4w_export_warnings.length;d++)n=a.b4w_export_warnings[d],(b.Kb&&"PRIMARY"==n.type||"ALL"==n.type)&&ta.LP(n.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.lg&&B(a);e(b,c)}else l==pa.AT_JSON_ZIP?(ta.warn("Compressed file ",m,"not found or invalid. Trying to load non-compressed",k),pa.enqueue([{id:k,type:pa.AT_JSON,url:k,ze:b.lg}],h,null,g)):ka.xD(b)}var k=b.wi;k||ra.I("Nothing requested");if(Ga.assets_gzip_available){d=k+".gz";var l=pa.AT_JSON_ZIP}else d=
k,l=pa.AT_JSON;pa.enqueue([{id:d,type:l,url:d,ze:b.lg}],h,null,g)}function f(a,b,c,d,e,f){function g(a){f(b,c,a)}function h(d,f,l,m){d?(ta.log("%cLOAD BINARY","color: #616",m),a.bin_data=d,f=(new Uint32Array(d,4,1))[0],d=(new Uint32Array(d,8,1))[0],d=[f,d],f=ra.JI(a.b4w_format_version),d[0]!=f[0]&&ra.I("BIN version does not match to JSON version: "+ra.El(d)+", required: "+ra.El(Ga.Nm)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&ta.warn("BIN version does not match to JSON version: "+
+ra.El(d)+", required: "+ra.El(Ga.Nm)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):l==pa.AT_ARRAYBUFFER_ZIP?(ta.warn("Compressed file ",m,"not found or invalid. Trying to load non-compressed",k),pa.enqueue([{id:k,type:pa.AT_ARRAYBUFFER,url:k,ze:b.lg}],h,null,g)):ka.xD(b)}var k=ya(b.wi)+b.VD;k||ra.I("Binary data is missing");if(Ga.assets_gzip_available){d=k+".gz";var l=pa.AT_ARRAYBUFFER_ZIP}else d=k,l=pa.AT_ARRAYBUFFER;pa.enqueue([{id:d,type:l,url:d,ze:b.lg}],h,null,
g)}function k(a,b,c,d,e){Ea.qE()&&e(b,c)}function q(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],g=a.objects,k=a.meshes;a=a.actions;for(var l=ra.BN(),m=["indices"],n=["position","texcoord","texcoord2","shade_tangs"],p=["normal","tangent"],Q=["group"],v=["color"],r=0;r<k.length;r++)for(var q=k[r].submeshes,u=0;u<q.length;u++){for(var x in q[u]){var L=q[u][x][1];if(-1!=m.indexOf(x)){var w=q[u][x][0]*ra.RC+f["int"]+12,y=q[u],F=x,z=d;if(l)var ha=new Uint32Array(z,w,L);else for(var ha=new Uint32Array(L),
z=new DataView(z),Da=0;Da<L;Da++)ha[Da]=z.getUint32(w+Da*ra.RC,!0);y[F]=ha}else if(-1!=n.indexOf(x))w=q[u][x][0]*ra.Yi+f["float"]+12,q[u][x]=h(d,w,L,l);else if(-1!=p.indexOf(x)){w=q[u][x][0]*ra.Xp+f["short"]+12;y=q[u];F=x;z=d;ha=new Float32Array(L);z=new DataView(z);for(Da=0;Da<L;Da++)ha[Da]=z.getInt16(w+Da*ra.Xp,!0)/32767;y[F]=ha}else if(-1!=Q.indexOf(x)){w=q[u][x][0]*ra.Xp+f.ushort+12;y=q[u];F=x;z=d;ha=new Float32Array(L);z=new DataView(z);for(Da=0;Da<L;Da++)ha[Da]=z.getUint16(w+Da*ra.Xp,!0)/65535;
y[F]=ha}else if(-1!=v.indexOf(x)){w=q[u][x][0]*ra.ry+f.uchar+12;y=q[u];F=x;z=d;ha=new Float32Array(L);z=new DataView(z);for(Da=0;Da<L;Da++)ha[Da]=z.getUint8(w+Da*ra.ry)/255;y[F]=ha}}L=q[u];if(k[r].b4w_shape_keys.length)for(w=L.base_length,y=L.normal.length/w/3,L.tbn=Ja.tm(L.normal.subarray(0,3*w),L.tangent.subarray(0,4*w),Ja.create(L.normal.length/3)),F=1;F<y;F++)for(z=F*w,ha=0;ha<w;ha++){var A=L.normal.subarray(3*ha,3*(ha+1)),t=S.add(L.normal.subarray(3*(z+ha),3*(z+ha+1)),A,vb),Da=Ja.identity(Rc);
if(L.tangent.length){var La=L.tangent.subarray(4*ha,4*(ha+1)),B=Ya.add(L.tangent.subarray(4*(z+ha),4*(z+ha+1)),La,fc),A=Ja.tm(A,La),t=Ja.tm(t,B);Ja.MS(t,A,Da)}else t=Ta.rotationTo(A,t,Db),Ja.set_quat(Da,t,0);Ja.Pi(L.tbn,Da,z+ha)}else L.tbn=Ja.tm(L.normal,L.tangent);delete q[u].normal;delete q[u].tangent;"texcoord2"in q[u]&&(L=new Float32Array(q[u].texcoord.length+q[u].texcoord2.length),L.set(q[u].texcoord),L.set(q[u].texcoord2,q[u].texcoord.length),q[u].texcoord=L,delete q[u].texcoord2)}for(x=0;x<
g.length;x++)for(k=g[x].particle_systems,m=0;m<k.length;m++)n=k[m],n.transforms=h(d,n.transforms[0]*ra.Yi+f["float"]+12,n.transforms[1],l);for(g=0;g<a.length;g++){x=a[g];k=x.fcurves;m=x.frame_range;p=m[0];Q=m[1];v=sa.yQ(p,Q);m=null;0>v&&(v=0);var q=r=!1,E;for(E in k)r|=-1<E.indexOf("rotation_euler"),q|=-1<E.indexOf("rotation_quaternion");n=[];for(E in k)if(r&&q&&-1<E.indexOf("rotation_euler"))delete k[E];else{var u=k[E],G;for(G in u)L=u[G],w=h(d,f["float"]+L.bin_data_pos[0]*ra.Yi+12,L.bin_data_pos[1],
l),y=new Float32Array(v),m||(m=new Int8Array(v)),sa.HM(L,w,y,m,p,Q),L.Yf=y;-1<E.indexOf("rotation_euler")&&(sa.SP(k[E]),n.push(E))}for(p=0;p<n.length;p++)Q=n[p],v=Q.replace("euler","quaternion"),k[v]=k[Q],delete k[Q];x.dM=m}e(b,c)}function h(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*ra.Yi,!0)}return d}function u(a,b,c,e,f){var h=a.cameras,k=a.groups,l=a.materials,m=a.meshes,Q=a.node_groups,v=a.objects,r=a.particles,
q=a.scenes,u=a.speakers,x=a.lamps,L=a.textures,w=a.worlds;Q||(ta.warn('"node_groups" datablock undefined. reexport main scene.'),Q=a.node_groups=[]);for(var y="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),z={},ha=0;ha<y.length;ha++)for(var A=a[y[ha]],t=0;t<A.length;t++){var La=A[t];z[La.uuid]=La}for(var E=0;E<q.length;E++){for(var G=q[E],D=G.objects,J=0;J<D.length;J++)N(D,J,z);G.camera&&N(G,"camera",
z);G.world&&N(G,"world",z)}for(E=0;E<k.length;E++)for(var ma=k[E].objects,J=0;J<ma.length;J++)N(ma,J,z);for(E=0;E<v.length;E++){var C=v[E];C.dupli_group&&N(C,"dupli_group",z);C.parent&&N(C,"parent",z);C.dg_parent&&N(C,"dg_parent",z);var H=C.animation_data;H&&F(H,z);switch(C.type){case "MESH":C.data||ra.I("mesh not found for object "+C.name);N(C,"data",z);for(var I=!1,ua=C.modifiers,J=0;J<ua.length;J++){var V=ua[J];"ARMATURE"==V.type?(I&&ta.warn('Object "'+C.name+'" has more than one armature modifiers. Only the first one will be used.'),
I=!0,N(V,"object",z)):"CURVE"==V.type&&N(V,"object",z)}var Fa=C.particle_systems;if(Fa)for(J=0;J<Fa.length;J++)N(Fa[J],"settings",z);break;case "ARMATURE":N(C,"data",z);for(var pa=C.pose.bones,S=C.data.bones,J=0;J<pa.length;J++){var P=pa[J];P.bone=S[P.bone];var Xa=P.constraints;if(Xa)for(var Y=0;Y<Xa.length;Y++){var O=Xa[Y];O.target&&N(O,"target",z)}for(var ga=P.parent_recursive,Y=0;Y<ga.length;Y++)ga[Y]=pa[ga[Y]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":N(C,"data",z)}if(Xa=C.constraints)for(J=
0;J<Xa.length;J++)O=Xa[J],O.target&&N(O,"target",z);var R=C.lod_levels;if(R)for(J=0;J<R.length;J++){var K=R[J];K.object&&N(K,"object",z)}}for(E=0;E<m.length;E++)for(var T=m[E].materials,J=0;J<T.length;J++)N(T,J,z);for(E=0;E<l.length;E++){for(var va=l[E],za=va.texture_slots,J=0;J<za.length;J++)N(za[J],"texture",z);var U=va.node_tree;U&&n(U,z)}for(E=0;E<Q.length;E++)(U=Q[E].node_tree)&&n(U,z);for(E=0;E<L.length;E++){var ba=L[E],Ib=ba.type;"IMAGE"!=Ib&&"ENVIRONMENT_MAP"!=Ib||N(ba,"image",z)}for(E=0;E<
h.length;E++){var Ra=h[E];Ra.dof_object&&N(Ra,"dof_object",z)}for(E=0;E<u.length;E++){var Ta=u[E];Ta.sound&&N(Ta,"sound",z);(H=Ta.animation_data)&&F(H,z)}for(E=0;E<r.length;E++){for(var Ya=r[E],za=Ya.texture_slots,J=0;J<za.length;J++)N(za[J],"texture",z);Ya.dupli_group&&N(Ya,"dupli_group",z);Ya.dupli_object&&N(Ya,"dupli_object",z)}for(E=0;E<x.length;E++)(H=x[E].animation_data)&&F(H,z);for(E=0;E<w.length;E++){var Ua=w[E];if(za=Ua.texture_slots)for(J=0;J<za.length;J++)N(za[J],"texture",z);(H=Ua.animation_data)&&
F(H,z);(U=Ua.node_tree)&&n(U,z)}Wa.xN(a);B(a);for(var Ga=ya(b.wi),ca=a.textures,ab=b.Kb?a.scenes[0].b4w_anisotropic_filtering:hb.b4w_anisotropic_filtering,Jb=0;Jb<ca.length;Jb++){var W=ca[Jb];b.Kb||"SCENE"!=W.b4w_source_type||(W.b4w_source_id="");var rb=Ma.dP(W,ab,a.scenes,b.id,Ga);W.J=rb}for(var oa={},sb=a.objects,ea=0;ea<sb.length;ea++){var Na=sb[ea];if("MESH"===Na.type&&!Na.particle_systems.length)for(var Bb=Na.data,zb=Bb.name,aa=Bb.submeshes,Z=Bb.materials,xa=0;xa<aa.length;xa++)0!==aa[xa].base_length||
oa[zb]||(Z[xa]&&ta.warn('material "'+Z[xa].name+'" is not assigned to any face (object "'+Na.name+'").'),oa[zb]=!0)}var X=[];a.materials=[];for(var Ea=a.meshes,Mb=0;Mb<Ea.length;Mb++){var ja=Ea[Mb];if(0==ja.materials.length){var vb=la.kO();ja.materials.push(vb);-1==X.indexOf(vb.Nc)&&(X.push(vb.Nc),a.materials.push(vb))}else for(var Gb=0;Gb<ja.materials.length;Gb++){var qa=ja.materials[Gb],Qb=la.DR();la.SV(qa,Qb);ja.materials[Gb]=Qb;-1==X.indexOf(Qb.Nc)&&(X.push(Qb.Nc),a.materials.push(Qb))}}for(var da=
a.actions,Ja=b.id,fa=0;fa<da.length;fa++){var ka=da[fa];ka.eM=Ja;sa.nM(ka)}for(var wa={OG:[],Yv:[]},Oa=a.scenes,fc=0;fc<Oa.length;fc++)for(var Qa=Oa[fc],Ca=Oa[fc].objects,Va=0;Va<Ca.length;Va++)ia(Qa,Ca,Ca[Va],null,wa);for(fc=0;fc<wa.Yv.length;fc++)for(var Db=wa.Yv[fc],Va=0;Va<Db.tw.length;Va++){var Rc=Db.tw[Va],nb=Db.eH[Va],Pb=Db.HB[Va],Za=Db.dB[Va];Db.NG[Va].object=nb;for(var gb=0;gb<Za.length;gb++)ra.DM(Za[gb],nb);for(var Eb=Rc,ob=Pb,Ab=0;Ab<ob.length;Ab++){for(var zc=ob[Ab].objects,hd=0;hd<zc.length;hd++){var hc=
zc[hd].dupli_group;hc&&na(Eb,hc)}var Ec=zc.indexOf(Eb);-1<Ec&&zc.splice(Ec,1)}}!b.Kb&&1<a.scenes.length&&(a.scenes=[Aa.Mu(a.scenes)],ta.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var Id=b.Kb?hb:Aa.Mu(a.scenes);Ia.oU(hb.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(hb),1),a.scenes.unshift(hb));for(var Jd=0;Jd<a.scenes.length;Jd++){var Ac=a.scenes[Jd];Ac.J={};Ac.vD=Ac==Id;Ac.fM=b.Kb;var od;if(od=Ob.enabled){var vd;if(vd="OFF"!=Ac.b4w_enable_physics){var id;
if(!(id="AUTO"!=Ac.b4w_enable_physics))a:{for(var jd=d(Ac),pd=0;pd<jd.length;pd++){if(jd[pd].b4w_collision){id=!0;break a}var kd=jd[pd].data;if(kd.materials)for(var wd=0;wd<kd.materials.length;wd++)if(kd.materials[wd].nd.Bp){id=!0;break a}}id=!1}vd=id}od=vd}od&&(b.Kb||!Da.Sw(hb)&&Ac==Aa.Mu(a))&&Da.ER(Ac)}for(var xd=0;xd<a.scenes.length;xd++){var qd=a.scenes[xd];if(qd.b4w_use_logic_editor){var Kd=d(qd);Wa.LM(Kd,qd)}}for(var pc=0;pc<a.scenes.length;pc++){for(var rd=a.scenes[pc],Ld=d(rd),vc=0;vc<Ld.length;vc++){var yb=
Ld[vc];Ba.yN(yb,rd,a)&&(yb.Hd||(yb.Hd=[]),yb.Hd.push(b.Kb?rd:hb))}for(var Md=Ld,Fc=0;Fc<Md.length;Fc++){var qc=Md[Fc];if(qc.Hd&&"WORLD"!=qc.type)for(var Nd=qc.particle_systems,ld=0;ld<Nd.length;ld++){var sd=Nd[ld].settings;if("HAIR"==sd.type)if("OBJECT"==sd.render_type){var md=sd.dupli_object;md.Hd||(md.Hd=qc.Hd.slice())}else if("GROUP"==sd.render_type)for(var Od=sd.dupli_group,Fd=0;Fd<Od.objects.length;Fd++)md=Od.objects[Fd],md.Hd||(md.Hd=qc.Hd.slice())}}}for(var be=a.scenes,Td=[],dc=0;dc<be.length;dc++)p(be[dc].objects,
0,b.Kb,Td);Ka[b.id]=[];for(dc=0;dc<Td.length;dc++)for(var ce=Td[dc],yd=0;yd<ce.length;yd++)for(var de=ce[yd],Ud=0;Ud<de.length;Ud++)Ka[b.id].push(de[Ud]);for(var Vd=a.particles,dc=0;dc<Vd.length;dc++){var Gd=Vd[dc].dupli_object;Gd&&(Gd.uD=!0,Ka[b.id].push(Gd));var ee=Vd[dc].dupli_group;if(ee)for(var fe=ee.objects,yd=0;yd<fe.length;yd++)Gd=fe[yd],Gd.uD=!0,Ka[b.id].push(Gd)}for(var Wd=Ka[b.id],dc=Wd.length-1;0<=dc;dc--)Wd[dc].Hd||Wd.splice(dc,1);for(var Rd=Ka[b.id],pc=0;pc<Rd.length;pc++){yb=Rd[pc];
!b.Kb&&yb.parent&&-1<$c.indexOf(yb.parent.type)&&(yb.parent="");if("MESH"==yb.type){var Xd=Wa.GM(yb);Xd&&(a.meshes.push(Xd),yb.data=Xd)}yb.Gn=Ba.IF(yb,!1);yb.cj=Ba.aE(yb)}for(pc=0;pc<Rd.length;pc++){for(var yb=Rd[pc],Yd=yb.cj,vc=0;vc<yb.lod_levels.length;vc++){var Sd=yb.lod_levels[vc].object;Sd&&(Yd=Yd||Sd.cj)}if(Yd)for(yb.cj=!0,vc=0;vc<yb.lod_levels.length;vc++)if(Sd=yb.lod_levels[vc].object)Sd.cj=!0}for(var Pc=0;Pc<a.scenes.length;Pc++){var ge=a.scenes[Pc],Gc=ge.world;Gc.Hd||(Gc.Hd=[]);Gc.Hd.push(b.Kb?
ge:hb)}for(var Zd=[],Pc=0;Pc<a.worlds.length;Pc++)Gc=a.worlds[Pc],Gc.Hd?(Gc.Gn=Ba.IF(Gc,!0),Gc.cj=Ba.aE(Gc)):Zd.push(Gc);for(Pc=0;Pc<Zd.length;Pc++)Gc=Zd[Pc],a.worlds.splice(a.worlds.indexOf(Gc),1);for(var he=a.node_groups,ie=a.materials,zd=0;zd<he.length;zd++){var Hd=he[zd].node_tree;if(Hd){var Pd=[];g(Hd,Pd,!0);Hd.qt=Pd}}for(zd=0;zd<ie.length;zd++)if(Hd=ie[zd].Md)Pd=[],g(Hd,Pd,!1),Hd.qt=Pd;for(var $d=0;$d<a.scenes.length;$d++){var je=a.scenes[$d],ae=b.Kb?je:hb;M(b.id,ae,"SPEAKER").length&&!ae.Qc&&
Ha.PM(ae)}f(b,c)}function y(a,b,c,d,e){d=ya(b.wi);for(var f=[],g=[],h=0;h<a.speakers.length;h++){var k=a.speakers[h],l=k.sound.uuid;if(-1==g.indexOf(l)){g.push(l);switch(k.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var n=pa.AT_AUDIOBUFFER;break;case "BACKGROUND_MUSIC":n=pa.AT_AUDIO_ELEMENT}k=ra.Ji(d+k.sound.filepath);m(f,l,n,k,b.lg)}}f.length?pa.enqueue(f,function(){},function(){e(b,c)}):e(b,c)}function g(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],f=e.type;if("GROUP"==f&&
e.node_group){if(e=e.node_group.node_tree)if(c)g(e,b,!0);else for(e=e.qt,f=0;f<e.length;f++){var h=e[f];-1==b.indexOf(h)&&b.push(h)}}else-1!=Ab.indexOf(f)&&-1==b.indexOf(f)&&b.push(f)}}function d(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);r(a.objects,"ALL",b);return b}function r(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||c.push(e);(e=e.dupli_group)&&r(e.objects,b,c)}}function p(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],
h=oa(g);e[h]=e[h]||[];(c||-1==$c.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&p(g.objects,b+1,c,d)}}function M(a,b,c){var d=[];a=Ka[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var g=0;g<f.Hd.length;g++)b==f.Hd[g]&&d.push(f)}return d}function E(a,b,c,d,e){for(var f=Ka[b.id],g=0;g<f.length;g++){var h=Ba.OE(f[g]);h.v.ce=b.id}for(var k=a.worlds,g=0;g<k.length;g++)Ba.OE(k[g],!0);d=Ba.get_all_objects("ALL",b.id);for(g=0;g<f.length;g++){var l=f[g],h=l.Fa;
ha.Ap(l,h)}for(g=0;g<k.length;g++)h=k[g],ha.Ap(h,h.Fa);b.Kb&&z(a,b.id);for(g=0;g<f.length;g++)l=f[g],h=l.Fa,h.xr||(xa.pT(l,h),Ba.VV(l,h),ua.T(h)),"MESH"==h.type&&Ba.rQ(l,h);for(a=0;a<f.length;a++){var m=f[a],k=m.Fa,g=k.v;if(Q.is_mesh(k)||Q.is_empty(k)){var n=m.lod_levels.length;if(n){for(var k=[m],h=[0],p=Infinity,l=0;l<n;l++){var v=m.lod_levels[l].object,r=m.lod_levels[l].distance;if(!v){p=r;break}k.push(v);h.push(r)}h.push(p);for(l=0;l<k.length;l++)v=k[l],m=v.Fa.v,m.Dj=!0,"DYNAMIC"==g.type&&0<l&&
S.subtract(g.te.S,m.te.S,m.aw),m.ng=h[l],m.mg=h[l+1],n=h[l+1]-h[l],p=l==k.length-1?Infinity:h[l+2]-h[l+1],m.Ij=Math.min(l?h[l]-h[l-1]:0,n),m.Jj=Math.min(n,p)}}}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.yt)){var g=g.v,k=a.v.hi,h=[],q;for(q in k)l=k[q],h.push(4*l.Cz,4*l.gi);g.fw.push(h);g.fp.push(a.v)}f=q=-1;a=sa.MF();for(g=0;g<d.length;g++)k=d[g],h=k.v,Q.is_mesh(k)&&h.Sk&&(k=h.Ih,k>q&&(q=k),a>=k&&k>f&&(f=k));for(g=0;g<d.length;g++)k=d[g],h=k.v,Q.is_mesh(k)&&h.Sk&&(h.sm=!0,q<a?h.Ih=q:h.Ih<=
a?h.Ih=f:(ta.warn('too many bones for "'+k.name+'" / '+h.Ih+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),h.Ih=q,h.sm=!1),h.sm=h.sm&&!ab.tF);for(q=0;q<d.length;q++)if(f=d[q],f.Bf)if(a=f.Nf,"CHASSIS"==a.Gf){f.N={};f.N.fr=a.fr;f.N.tq=a.tq;f.N.cC=a.cC;f.N.eC=a.eC;f.N.dC=a.dC;f.N.HC=a.HC;f.N.CB=a.CB;f.N.LA=a.LA;f.N.bo=0;f.N.sq=1;f.N.pp=0;f.N.speed=0;f.N.Xm=[];f.N.$r=[];f.N.rp=null;k=(g=Q.get_dg_parent(f))?Q.Wz(g,d):d;for(g=0;g<k.length;g++)h=
k[g],h.Bf&&(l=h.Nf,Da.KR(h)&&a.name==l.name?(l=Da.IW(h.Nf.Gf),f.N.Xm[l]=h,f.N.$r[l]=new Float32Array(8)):Da.xG(h)&&a.name==l.name?(f.N.rp=h,f.N.qp=l.qp,f.N.ys=l.ys,f.N.wr=l.wr,l=Fa.invert(f.v.C,Fa.create()),h=Fa.multiply(l,h.v.C,l),f.N.II=h,l=new Float32Array([1,0,0]),Fa.transform_dir_vec3(l,h,l),f.N.HI=l):Da.wG(h)&&a.name==l.name?(f.N.VB=h,f.N.ws=l.ws,f.N.Eo=l.Eo,l=Fa.invert(f.v.C,Fa.create()),h=Fa.multiply(l,h.v.C,l),f.N.DI=h,l=new Float32Array([1,0,0]),Fa.transform_dir_vec3(l,h,l),f.N.CI=l):Da.yG(h)&&
a.name==l.name&&(f.N.fC=h,f.N.Tq=l.Tq,l=Fa.invert(f.v.C,Fa.create()),h=Fa.multiply(l,h.v.C,l),f.N.TI=h,l=new Float32Array([1,0,0]),Fa.transform_dir_vec3(l,h,l),f.N.SI=l));4!=f.N.Xm.length&&ra.I("Not enough wheels for chassis "+f.name)}else if("HULL"==a.Gf)for(f.N={},f.N.Xm=[],f.N.$r=[],f.N.fr=a.fr,f.N.tq=a.tq,f.N.om=a.om,f.N.un=a.un,f.N.vn=a.vn,f.N.bo=0,f.N.sq=1,f.N.pp=0,f.N.speed=0,f.N.rp=null,k=(g=Q.get_dg_parent(f))?Q.Wz(g,d):d,g=0;g<k.length;g++)h=k[g],h.Bf&&(l=h.Nf,Da.JR(h)&&a.name==l.name?(f.N.Xm.push(h),
f.N.$r.push(new Float32Array(8))):Da.xG(h)&&a.name==l.name?(f.N.rp=h,f.N.qp=l.qp,f.N.ys=l.ys,f.N.wr=l.wr,l=Fa.invert(f.v.C,Fa.create()),h=Fa.multiply(l,h.v.C,l),f.N.II=h,l=new Float32Array([1,0,0]),Fa.transform_dir_vec3(l,h,l),f.N.HI=l):Da.wG(h)&&a.name==l.name?(f.N.VB=h,f.N.ws=l.ws,f.N.Eo=l.Eo,l=Fa.invert(f.v.C,Fa.create()),h=Fa.multiply(l,h.v.C,l),f.N.DI=h,l=new Float32Array([1,0,0]),Fa.transform_dir_vec3(l,h,l),f.N.CI=l):Da.yG(h)&&a.name==l.name&&(f.N.fC=h,f.N.Tq=l.Tq,l=Fa.invert(f.v.C,Fa.create()),
h=Fa.multiply(l,h.v.C,l),f.N.TI=h,l=new Float32Array([1,0,0]),Fa.transform_dir_vec3(l,h,l),f.N.SI=l));for(q=0;q<d.length;q++)if(f=d[q],f.Em&&(a=f.ho,"MAIN_BODY"==a.Gf))for(f.Qg={},f.Qg.om=a.om,f.Qg.un=a.un,f.Qg.vn=a.vn,f.Qg.Jt=[],g=(g=Q.get_dg_parent(f))?Q.Wz(g,d):d,k=0;k<g.length;k++)h=g[k],h.Em&&(l=h.ho,Da.MR(h)&&a.name==l.name&&(f.Qg.Jt.push(h),h.Wy=h.ho.RI));e(b,c)}function z(a,b){for(var c=0;c<a.scenes.length;c++){for(var d=a.scenes[c],e=Ba.Ob(d,"LAMP",b),f=Array(e.length),g=0;g<e.length;g++)f[g]=
g;f.sort(function(a,b){var c=e[a].Db,d=e[b].Db;return d.ln&&d.pn&&(!c.ln||!c.pn)||!c.ln&&(d.ln||!c.pn&&d.pn)?1:0});for(g=0;g<f.length;g++)Q.Da(e[f[g]],d).Hr=g}}function l(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.bj=f.camera.Fa}for(d=0;d<a.scenes.length;d++){var f=b.Kb?a.scenes[d]:hb,g=b.Kb?Ba.Ob(f,"LAMP",b.id):Ba.Ob(f,"LAMP",0),h=Ba.Ob(f,"ALL",b.id),k=M(b.id,f,"MESH"),l=M(b.id,f,"EMPTY");b.Kb&&Aa.uM(f,h,g,k,l);for(var h=!1,m=0;m<l.length;m++)for(var n=l[m].Fa,p=n.O,v=0;v<p.length;v++){var q=
p[v].jb,r=Aa.lJ(q,n);f.name==q.name&&(h=h||r)}b.Kb&&f.J.sd&&!h&&ta.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');l=[];Aa.set_active(f);ga.BF(f,k,g,l);m=Ba.Ob(f,"LINE",b.id);ga.AF(f,m);n=Aa.cv(f);if(b.Kb){h=f.J.jx;m=f.world;if(h.KH||h.procedural_skydome)p=m.Fa,ga.yM(f,h,p),ga.fu(p,n,f);Aa.yF(f,n);(h=f.J.Il)&&(h.Ps||h.ie)&&ga.rM(f,m.Fa)}for(m=0;m<k.length;m++)ga.fu(k[m].Fa,n,f);for(m=0;m<l.length;m++)ga.fu(l[m],n,f),Ba.TS(l[m]);h=Ba.Ob(f,"ALL",b.id);Aa.ID(f,h,g);for(m=
0;m<h.length;m++)n=h[m],n.v.cf&&!n.nG&&Ba.update_boundings(n),Q.EN(n)&&(n.cH=!0),Ba.QV(n,f)}Aa.vM(hb,a.textures,b.id);b.Kb&&hb.J.Np.length&&(b.lA=!0);e(b,c)}function B(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c];d.Fg="FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==Ga.cm?"dds":""}if((Ra.Bz&&"dds"==Ga.cm||Ra.Kw&&"pvr"==Ga.cm)&&Ga.vJ)for(a=0;a<b.length;a++){for(var d=b[a],e=d.texture_slots,c=0;c<e.length;c++){var f=e[c],g=f.texture;if("IMAGE"==g.type||"ENVIRONMENT_MAP"==
g.type){var h=g.image;h&&!h.Fg&&(f=!g.b4w_disable_compression&&!f.use_map_normal&&"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&"MOVIE"!=h.source,w(h,f))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){e=d[c];f=!1;if("TEXTURE"==e.type){if((g=e.texture)&&(h=g.image)&&!h.Fg&&(f=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{f=e.outputs;for(e=0;e<f.length;e++)if(g=f[e],g.is_linked&&"Normal"==g.identifier){f=!0;break a}f=!1}f=!f}}else"TEX_IMAGE"==e.type?(h=
e.image)&&!h.Fg&&(f="MOVIE"!=h.source):"TEX_ENVIRONMENT"==e.type&&(f=!1);h&&!h.Fg&&w(h,f)}}}function w(a,b){-1<a.filepath.indexOf(".dds")?a.Fg="dds":b?(a.Fg=Ga.cm,a.filepath="dds"==Ga.cm?a.filepath+".dds":a.filepath+".pvr"):a.Fg=""}function G(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},k={},l={},m=0;m<d.length;m++){var n=d[m];g[n.uuid]=n;k[n.uuid]=n}for(m=0;m<f.length;m++)n=f[m],h[n.uuid]=n,l[n.uuid]=n;a=a.scenes;for(m=0;m<a.length;m++)v(a[m].objects,null,l,k,null);for(var p in k)p in g||
d.push(k[p]);for(p in l)p in h||f.push(l[p]);e(b,c)}function v(a,b,c,d,e){for(var f=[],g=0;g<a.length;g++){var h=a[g],k=c[h.uuid];if(h=k.proxy){b&&-1==f.indexOf(h.uuid)&&f.push(h.uuid);for(var l=c[h.uuid],m=l.constraints,h=0;h<m.length;h++){var n=ra.V(m[h]);n.name=n.name+"_CLONE";k.constraints.push(n)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(l.animation_data=ra.V(k.animation_data)),l.b4w_use_default_animation=k.b4w_use_default_animation,l.b4w_auto_skel_anim=k.b4w_auto_skel_anim,
l.b4w_anim_behavior=k.b4w_anim_behavior,l.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=0;g<f.length;g++)k=ra.WQ(a,f[g]),-1<k&&a.splice(k,1);f={};if(b)for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],m=ra.V(k),l="origin_name"in k?k.origin_name:k.name,m.name=Q.xF(b.name,l),m.origin_name=l,m.dg_parent={uuid:b.uuid},D(m),c[m.uuid]=m,f[h.uuid]=m.uuid,h.uuid=m.uuid,e&&e[k.uuid]&&(m.b4w_cluster_data=e[k.uuid]);for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],k.dupli_group&&(h=k.dupli_group,e=d[h.uuid],m=ra.V(e),
m.name=ra.Is(e.name+"_CLONE"),m.uuid=ma.aG("Group"+m.name),d[m.uuid]=m,h.uuid=m.uuid,v(m.objects,k,c,d,k.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){h=a[g];k=c[h.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(ta.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);m=k.constraints;for(h=0;h<m.length;h++)b=m[h],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(d=b.bones,h=0;h<d.length;h++)if(e=
d[h].constraints)for(m=0;m<e.length;m++)b=e[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=k.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(h=0;h<k.length;h++)b=k[h],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var p in f)sb[p]=f[p]}function D(a){a.uuid=ma.aG("Object"+a.name)}function F(a,b){a.action&&N(a,"action",b);if(a.nla_tracks)for(var c=0;c<a.nla_tracks.length;c++)for(var d=
a.nla_tracks[c],e=0;e<d.strips.length;e++)d.strips[e].action&&N(d.strips[e],"action",b)}function n(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&N(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in sb&&(e.lamp.uuid=sb[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&N(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||N(e,"image",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];I(f,"from_node",c);I(f,"to_node",
c);x(f,"from_socket",f.from_node.outputs);x(f,"to_socket",f.to_node.inputs)}(c=a.animation_data)&&F(c,b)}function N(a,b,c){a[b]&&((c=c[a[b].uuid])||ta.error("Dangling link found:",b,a),a[b]=c)}function I(a,b,c){c=ra.keysearch("name",a[b].name,c);a[b]=c}function x(a,b,c){c=ra.keysearch("identifier",a[b].identifier,c);a[b]=c}function J(a,b,d,e,f,g){var h=[],k=[],l={};e=a.images;for(var m=Ma.LF(),n=ya(b.wi),p=0;p<e.length;p++){var Q=e[p],v=Q.uuid;if(v){var q=ra.Ji(n+Q.filepath),r=pa.vx(q),u=r[1].toLowerCase(),
x=Q.source;if("FILE"===x){x=Q.Fg?pa.AT_ARRAYBUFFER:pa.AT_IMAGE_ELEMENT;if(!pa.DN(u)){ta.error('image "'+Q.name+'" has unsupported format or broken path.');continue}Ra.PA&&Ga.use_min50&&(q=A(r))}else if("MOVIE"===x)if(Ga.os)q=r[0]+".altconv.seq",x=pa.AT_SEQ_VIDEO_ELEMENT;else{x=Ha.detect_video_container(u);if(""==x){ta.error("failed to load video file (unsupported format)",q);continue}q=x!=u?r[0]+".altconv."+x:r[0]+"."+r[1];x=pa.AT_VIDEO_ELEMENT}else{ta.error('Image "'+Q.name+'" has unsupported format "'+
x+'".');continue}v in l||(l[v]=[]);for(r=0;r<m.length;r++)u=m[r],(!Ma.BQ(u)&&u.Lk==Q.Fg&&u.ym==v||b.lg)&&l[v].push(u);Q.Fg&&Ga.assets_gzip_available&&(x=pa.AT_ARRAYBUFFER_ZIP,q+=".gz");l[v].length&&h.push({id:v,type:x,url:q,ze:b.lg})}}if(h.length){var L=0,w=function(e,f,m,n){if(e){if(b.lg)f=m;else{f=l[f];for(var p=0;p<f.length;p++){var Q=f[p];if(m==pa.AT_SEQ_VIDEO_ELEMENT)Q.ms=e.Bh,Ma.Ls(Q,e.images,b.id);else if(Ma.Ls(Q,e,b.id),"ENVIRONMENT_MAP"==Q.source&&b.Kb)for(var v=0;v<a.scenes.length;v++)Aa.Ux(a.scenes[v]);
Ma.fU(Q)}f=f[0].Lk}m==pa.AT_VIDEO_ELEMENT||m==pa.AT_SEQ_VIDEO_ELEMENT?(m==pa.AT_VIDEO_ELEMENT?(f=e.videoWidth,e=e.videoHeight):(f=e.images[0].width,e=e.images[0].height),ta.log("%cLOAD VIDEO "+f+"x"+e,"color: #"+(2048<f||2048<e?"a00":1024<f||1024<e?"aa0":"0a0"),n),-1==n.indexOf(zb)&&ta.warn("video",n,"is not from app root.")):c(e,n,!0,f)}else{a:{e=b.lg;n=n.split("?v")[0];m=pa.vx(n);if("gz"==m[1])n=m[0],m=pa.AT_ARRAYBUFFER;else if("dds"==m[1]||"pvr"==m[1])for(n=m[0],m=pa.AT_IMAGE_ELEMENT,p=l[f],Q=
0;Q<p.length;Q++)p[Q].Lk="";else if(-1!=n.indexOf(".min50"))n=n.split(".min50"),n=n[0]+n[1],m=pa.AT_IMAGE_ELEMENT;else{f=null;break a}f={id:f,type:m,url:n,ze:e}}f&&(ta.warn("Trying to load fallback image",f.url),k.push(f))}f=++L/(h.length+k.length);g(b,d,f)},z=function(){k.length?(pa.enqueue(k,w,z),k.length=0):(ta.log("%cLOADED ALL IMAGES","color: #0a0"),f(b,d))};pa.enqueue(h,w,z)}else f(b,d)}function A(a){return"dds"==a[1]?(a=pa.vx(a[0]),a[0]+".min50."+a[1]+".dds"):a[0]+".min50."+a[1]}function C(a,
b,c,d,e){a=Aa.gv();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var g=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(g=!1);ha.bW(f,g,b.id)}}e(b,c)}function R(a,b,c,d,e,f){a=ya(b.wi);var g=[],h={};d=Ba.get_all_objects("ALL",b.id);for(var k=0;k<d.length;k++){var l=d[k];if(H(l)){var n=l.ea.Nc;"BACKGROUND_MUSIC"==Ha.$z(l)?(n=ra.Xu(),b.iA=!0):"NONE"!=Ha.$z(l)&&Ga.qA&&(b.pA=!0);if(!(n in h)){h[n]=[];var p=ra.Ji(a+l.ea.wi);switch(Ha.BI(l)){case Ha.qy:var Q=pa.AT_AUDIOBUFFER;break;case Ha.KC:Q=pa.AT_AUDIO_ELEMENT}m(g,
n,Q,p,b.lg)}h[n].push(l)}}if(g.length){var v=0;pa.enqueue(g,function(a,d,e,k){if(a)for(ta.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(zb)&&ta.warn("sound",k,"is not from app root."),d=h[d],e=0;e<d.length;e++)Ha.gW(d[e],a);a=++v/g.length;f(b,c,a)},function(){ta.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function m(a,b,c,d,e){var f=pa.vx(d),g=f[1].toLowerCase(),h=Ha.detect_audio_container(g);""!=h?(d=h!=g?f[0]+".altconv."+h:f[0]+"."+f[1],a.push({id:b,type:c,url:d,ze:e})):ta.error("failed to load audio file (unsupported format)",
d)}function H(a){return Q.is_speaker(a)&&Ha.BI(a)!=Ha.LC}function U(a,b,c){a=Ba.Ob(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];Q.is_speaker(d)&&(Ha.IR(d)||c)&&Ha.play_def(d)}}function O(a,b){for(var c=a.J.Np,d=0;d<c.length;d++){var e=c[d].J;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.Xs||(Ma.reset_video(e),Ma.play_video(e))}}function V(a,b,c,d,e){ha.start();ta.log("%cSTART NLA","color: #0a0");e(b,c)}function ia(a,b,c,d,e){for(var f=c.lod_levels.length,g=0;g<f;g++){var h=
c.lod_levels[g],k=h.object;if(k){var l=e.OG.indexOf(c);if(-1==l){e.OG.push(c);var m={tw:[],eH:[],NG:[],HB:[],dB:[]};e.Yv.push(m)}else m=e.Yv[l];var n=m.tw.indexOf(k);-1!=l&&-1!=n?(m.HB[n].push(a),m.dB[n].push(b)):(l=ra.Dq(k),l.name=c.name+"_LOD_"+String(g+1),l.b4w_cluster_data=c.b4w_cluster_data,D(l),l.lod_levels=[],d&&(l.dg_parent=d),m.tw.push(k),m.eH.push(l),m.NG.push(h),m.HB.push([a]),m.dB.push([b]))}}if(b=c.dupli_group)for(b=b.objects,d=0;d<b.length;d++)ia(a,b,b[d],c,e)}function na(a,b){var c=
b.objects,d=c.indexOf(a);-1<d&&c.splice(d,1);for(d=0;d<c.length;d++)(b=c[d].dupli_group)&&na(a,b)}function T(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!Da.HN(a.scenes[f])){d=!1;break}d&&(e(b,c),ta.log("%cPHYSICS READY","color: #0a0"))}function ja(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.Kb)var g=Da.Sw(f);else g=Da.Sw(hb)||Da.Sw(f),f=hb;if(Ob.enabled&&g)for(g=0;g<gb.length;g++)for(var h=Ba.Ob(f,gb[g],b.id),k=0;k<h.length;k++){var l=h[k];l.v.ce==b.id&&(Da.append_object(l,
f),b.JG&&Da.va(l)&&Da.disable_simulation(l))}}e(b,c)}function ea(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var l=h[k];if(l.J.sd){var m=l.J.sd.nl;if(m&&"FILE"===m.source){var l=m.uuid,n=ra.Ji(ya(b.wi)+m.filepath);e.push({id:l,type:m.Fg?pa.AT_ARRAYBUFFER:pa.AT_IMAGE_ELEMENT,url:n});g[l]=m}}}e.length?pa.enqueue(e,function(a,d,e,f){if(a){c(a,f,!0);e=[];f=Ma.LF();for(var k=0;k<f.length;k++){var l=f[k];l.uri===d&&e.push(l)}for(d=0;d<e.length;d++)Ma.Ls(e[d],a,b.id);for(d=0;d<
h.length;d++)if(e=h[d],e.J.sd&&(f=e.J.sd.nl,f===m)){var l=a,n=document.createElement("canvas");f=m.size[0];k=m.size[1];n.width=f;n.height=k;n=n.getContext("2d");n.drawImage(l,0,0);l=n.getImageData(0,0,f,k).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=k;for(var k=new Float32Array(f),p=0;p<f;p++)k[p]=n[1]*l[4*p+2]+n[2]*l[4*p+3];e.J.RB=k}}else for(a=g[d],d=0;d<h.length;d++)e=h[d],f=e.J.sd.nl,f===a&&(e.J.sd.nl=null,ta.warn("image",f.filepath," was not found. Disabling water shore effects."))},
function(){f(b,d)}):f(b,d)}function qa(a,b,d,e,f){e=a.scenes[0];a=[];for(var g=[Na.gt,Na.Yp,Na.ht,Na.Dy],h=0;h<g.length;h++){var k=Aa.Pb(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=pa.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:h,url:va.Ze.smaa_search_texture_path,ze:b.lg});e.push({id:"AREA_TEXTURE",type:h,url:va.Ze.smaa_area_texture_path,ze:b.lg});for(h=0;h<a.length;h++)if(g=a[h],g.type==Na.Yp){a=g.$a;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==g.to)var l=g.Ua;else if("u_area_tex"==g.to)var m=
g.Ua;break}e.length?pa.enqueue(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?l:m,d.source="IMAGE",Ma.Ls(d,a,b.id),Ma.KB(d,Ma.R,Ma.R))},function(){f(b,d)}):f(b,d)}else f(b,d)}function Z(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.Kb||(e=hb);for(var f=Ba.Ob(e,"LAMP",b.id),g=0;g<f.length;g++){var h=f[g];h.v.ce==b.id&&d.Ky.push({jb:e,obj:h})}f=Ba.Ob(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&h.v.ce==b.id&&(b.JG&&Q.is_mesh(h)&&Aa.$l(h,!0),d.Ky.push({jb:e,obj:h}))}}
function aa(a,b,c,d,e,f){var g=d.Ky;e=d.kH;if(g.length){a=g[e].obj;var h=g[e].jb;e=Q.Da(a,h);Aa.append_object(h,a);a.anchor&&!h.J.anaglyph_use&&W.append(a);d=++d.kH/g.length;a.v.bG&&Aa.zq(a,!0);g=e.rj;if(-1!=a.v.be&&g){var k=S.copy(a.v.te.S,vb);Aa.kJ(g,k)}g=a.fs;if(g.length&&h.J.Qh)for(h=Fa.get_trans_view(a.v.C),a=Fa.get_quat_view(a.v.C),e=e.Mi,k=0;k<e.length;k++)Aa.mJ(e[k],h,a),Q.nJ(g,e[k].F.wc)}else d=1;f(b,c,d)}function X(a,b,c,d,e){if(b.Kb){a=Aa.Fh();Aa.Ux(a);d=Aa.gv();for(var f=0;f<d.length;f++){var g=
d[f];Aa.Ux(g);Aa.qT(g,a)}Aa.set_active(a)}else Aa.pJ(hb);a=Ba.get_all_objects("ALL",b.id);Ba.WV(a);e(b,c)}function fa(a,b,c,d,e){if(b.Kb)for(a=Aa.gv(),d=0;d<a.length;d++)for(var f=a[d],g=Ba.Ob(f,"WORLD",0),h=0;h<g.length;h++)Aa.BR(f,g[h]),Aa.Ux(f);e(b,c)}function Ca(a,b,c,d,e){if(b.Kb)for(a=Aa.gv(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&La.CR(f,b.id)}e(b,c)}function ca(a,b,c,d,e){if(b.Kb)for(d=0;d<a.scenes.length;d++)O(a.scenes[d],b.id),U(a.scenes[d],b.id,!1);else O(hb,b.id),U(hb,
b.id,!1);e(b,c)}function Y(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;Ga.media_auto_activation&&(b.lA||b.iA||b.pA)?nb||za(a,e,b,c):e(b,c)}function za(a,b,c,d){var e=ob.parentElement;Pb=e.style.zIndex;e.style.zIndex="999";nb=document.createElement("div");nb.style.position="relative";nb.style.height="88px";nb.style.width="88px";var f=Math.round(ob.offsetWidth/2-44);nb.style.top=Math.round(ob.offsetHeight/2-44).toString()+"px";nb.style.left=f.toString()+"px";nb.style.backgroundImage=
"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
nb.style.backgroundSize="88px";Va=document.createElement("div");Va.style.position="relative";Va.style.height=ob.offsetHeight.toString()+"px";Va.style.width=ob.offsetWidth.toString()+"px";Va.style.background="rgba(0, 0, 0, 0.5)";Va.style.zIndex="999";e.appendChild(Va);Va.appendChild(nb);Eb=function(){c.lA&&(Ma.play(),Ma.pause(),Ma.reset());if(c.iA){if(c.Kb)for(var e=0;e<a.scenes.length;e++)U(a.scenes[e],c.id,!0);else U(hb,c.id,!0);Ha.pause()}c.pA&&Ha.wH();P();b(c,d)};da.add_click_listener(nb,Eb)}function P(){if(nb){var a=
ob.parentElement;a.style.zIndex=Pb;da.remove_click_listener(nb,Eb);Va.removeChild(nb);a.removeChild(Va);nb=Va=null;Pb=0}}function ya(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ba(a){sa.is_animated(a)&&sa.remove(a);L.BT(a);Ba.clear_outline_anim(a);K.check_sensor_manifold(a)&&K.remove_sensor_manifold(a);Da.va(a)&&Da.remove_object(a);Aa.JH(a);Q.is_speaker(a)&&Ha.XU(a);W.is_anchor(a)&&W.remove(a)}function oa(a){var b=sa.HF(a);return(a=b&&b.parent==a?null:a.parent||b)?1+oa(a):
0}var W=t("__anchors"),sa=t("__animation"),pa=t("__assets"),ga=t("__batch"),va=t("__config"),xa=t("__constraints"),K=t("__controls"),Oa=t("__texcomp"),Qa=t("__debug"),wa=t("__extensions"),da=t("__input"),ka=t("__loader"),la=t("__material"),ma=t("__md5"),ha=t("__nla"),La=t("__logic_nodes"),L=t("__particles"),Xa=t("__nodemat"),Ba=t("__objects"),Q=t("__obj_util"),Da=t("__physics"),ta=t("__print"),Ta=t("__quat"),Wa=t("__reformer"),rb=t("__renderer"),Aa=t("__scenes"),Ha=t("__sfx"),Ea=t("__shaders"),Na=
t("__subscene"),Ja=t("__tbn"),Ma=t("__textures"),Ia=t("__time"),ua=t("__transform"),Fa=t("__tsr"),ra=t("__util"),S=t("__vec3"),Ya=t("__vec4"),ab=va.Sl,Ga=va.K,Ra=va.ae,Ob=va.L,Ib=va.ea,Ua=null,Ka=null,zb="",hb=null,sb={},vb=new Float32Array(3),fc=new Float32Array(4),Db=new Float32Array(4),Rc=Ja.create(),nb=null,Va=null,Pb=0,Za=!1,Eb=null,$c=["LAMP"],gb=["MESH","CAMERA","EMPTY"],Ab=["BSDF_GLOSSY","BSDF_DIFFUSE","BSDF_TRANSPARENT"],ob=null;a.is_primary_loaded=function(a){return ka.is_primary_loaded(a)};
a.update=function(){ka.cW(Ua)};a.KU=function(a){ob=a};a.TV=function(a,b){if(nb){Va.style.height=b.toString()+"px";Va.style.width=a.toString()+"px";var c=Math.round(a/2-44);nb.style.top=Math.round(b/2-44).toString()+"px";nb.style.left=c.toString()+"px"}};a.load=function(a,c,d,g,h){var m={load_main:{Lb:ka.Cg,Sb:!1,inputs:[],Tb:!1,$b:500,mc:!1,cc:b},duplicate_objects:{Lb:ka.re,Sb:!1,inputs:["load_main"],Tb:!1,$b:50,mc:!1,cc:G},load_binaries:{Lb:ka.Cg,Sb:!1,inputs:["load_main"],Tb:!1,$b:500,mc:!1,cc:f},
wait_for_shaders:{Lb:ka.re,Sb:!1,inputs:[],Tb:!1,$b:50,mc:!0,vk:k},prepare_bindata:{Lb:ka.re,Sb:!1,inputs:["duplicate_objects","load_binaries"],Tb:!1,$b:100,mc:!1,cc:q},prepare_bpy_data:{Lb:ka.re,Sb:!1,inputs:["duplicate_objects","prepare_bindata"],Tb:!1,$b:100,mc:!1,cc:u},process_objects:{Lb:ka.re,Sb:!1,inputs:["prepare_bpy_data"],Tb:!1,$b:150,mc:!1,cc:E},process_scenes:{Lb:ka.re,Sb:!1,inputs:["process_objects","wait_for_shaders"],Tb:!1,$b:300,mc:!1,cc:l},load_smaa_textures:{Lb:ka.Cg,Sb:!1,inputs:["process_scenes"],
Tb:!1,$b:30,mc:!0,cc:qa},load_shoremap:{Lb:ka.Cg,Sb:!1,inputs:["process_scenes"],Tb:!1,$b:30,mc:!0,cc:ea},load_images:{Lb:ka.Cg,Sb:!0,inputs:["process_scenes"],Tb:!0,$b:500,mc:!1,cc:J},update_scenes_nla:{Lb:ka.re,Sb:!1,inputs:["process_scenes","load_images"],Tb:!1,$b:50,mc:!1,cc:C},wait_physics_workers:{Lb:ka.re,Sb:!1,inputs:["load_shoremap"],Tb:!1,$b:20,mc:!1,vk:T},add_physics_objects:{Lb:ka.re,Sb:!1,inputs:["wait_physics_workers"],Tb:!1,$b:50,mc:!1,cc:ja},add_objects:{Lb:ka.re,Sb:!1,inputs:["add_physics_objects"],
Tb:!1,$b:600,mc:!1,cc:Z,vk:aa,xq:X,yq:{Ky:[],kH:0}},init_cube_sky_dynamic_props:{Lb:ka.re,Sb:!1,inputs:["add_objects","load_images"],Tb:!1,$b:50,mc:!1,cc:fa},init_logic_nodes:{Lb:ka.re,Sb:!1,inputs:["update_scenes_nla","add_objects"],Tb:!1,$b:50,mc:!1,cc:Ca},load_speakers:{Lb:ka.Cg,Sb:!0,inputs:["add_objects"],Tb:!0,$b:100,mc:!1,cc:R},mobile_media_start:{Lb:ka.re,Sb:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Tb:!0,$b:5,mc:!1,cc:Y,vk:Y},synchronize_media:{Lb:ka.re,
Sb:!0,inputs:["mobile_media_start"],Tb:!0,$b:50,mc:!1,cc:ca},start_nla:{Lb:ka.re,Sb:!0,inputs:["mobile_media_start"],Tb:!1,$b:5,mc:!0,cc:V}},n=ka.Zz();n||(n=ka.PE(),Ua={},Ka={},sb={});Ua[n.Mf.length]={};return ka.TE(m,a,c,d,e,g||Ib.LD,Ga.do_not_load_resources,h,!1)};a.unload=function(a){var b=ka.Zz();if(!b||!b.Mf.length||a&&!ka.pV(b.Mf[a]))ta.error("Unable to unload data!");else{if(0==a)ta.log("%cUNLOAD ALL","color: #00a"),W.cleanup(),sa.cleanup(),Ha.cleanup(),ga.cleanup(),Aa.cleanup(),ka.cleanup(),
K.cleanup(),Da.cleanup(),Ba.cleanup(),ra.cleanup(),rb.cleanup(),Xa.cleanup(),Ea.cleanup(),wa.cleanup(),pa.cleanup(),Ma.cleanup(),La.cleanup(),L.cleanup(),da.cleanup(),Qa.cleanup(),Ka=null,sb={},Ua=hb=null,Za=!1;else{ta.log("%cUNLOAD DATA "+a,"color: #00a");sa.zT(a);for(var b=Ba.get_all_objects("ALL",Ba.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];Q.get_object_data_id(d)!=a&&Ba.Ro(d,!1,!1,!1)}b=Ba.get_all_objects("ALL",a);for(c=b.length-1;0<=c;c--)d=b[c],ba(d),Ba.remove_object(d);b=Ba.get_all_objects("ALL",
Ba.DATA_ID_ALL);for(c=0;c<b.length;c++)Ba.Ro(b[c],!0,!0,!0)}ha.cleanup(a);P()}};a.yH=ba;a.set_debug_resources_root=function(a){zb=a};a.activate_media=function(){Za||Ga.media_auto_activation||(Ma.play(),Ma.pause(),Ma.reset(),U(hb,Ba.DATA_ID_ALL,!0),Ha.pause(),Ga.qA&&Ha.wH(),Za=!0)};a.reset=function(){ob=null};a.prefetch=function(a,c,d){var g={load_main:{Lb:ka.Cg,Sb:!1,inputs:[],Tb:!1,$b:500,mc:!1,cc:b},load_binaries:{Lb:ka.Cg,Sb:!1,inputs:["load_main"],Tb:!1,$b:500,mc:!1,cc:f},load_images:{Lb:ka.Cg,
Sb:!1,inputs:["load_main"],Tb:!1,$b:500,mc:!1,cc:J},preload_sounds:{Lb:ka.Cg,Sb:!1,inputs:["load_main"],Tb:!1,$b:500,mc:!1,cc:y}},h=ka.Zz();h||(h=ka.PE(),Ua={},Ka={},sb={});Ua[h.Mf.length]={};return ka.TE(g,a,c,d,e,!1,Ga.do_not_load_resources,!1,!0)};a.unfetch=function(){pa.NN()}};b4w.module.__batch=function(a,t){function e(a){a={type:a,zb:"",id:0,ce:0,Eq:-1,Zk:"",ou:-1,Tn:-1,Rq:0,uf:0,Dk:[],ka:[],Lf:[],pf:[],Xb:[],pj:[],Vi:null,Oc:{},pb:null,Za:ba.FR(),ie:"",jq:[],la:null,df:ga.Ak(),cf:!1,tj:!1,qu:!1,num_vertices:0,num_triangles:0,Mv:0,Nv:0,Lc:!1,lv:0,Bj:0,jd:new Float32Array(3),tf:new Float32Array(16),dj:!1,kf:!1,rb:!1,fb:!1,ai:!1,Oa:!1,xc:!1,we:!1,$e:!1,Ge:!1,Td:!1,ke:!1,Rd:!1,Qd:!1,zh:pa.An,ff:!1,Rg:!1,vj:!1,cg:!1,mg:fa.By,ng:0,Ij:0,Jj:0,Uk:b(),be:-1,Nd:-1,rv:!1,vv:0,sv:0,
wv:0,xv:0,uv:new Float32Array(3),tv:new Float32Array(3),rr:!1,xd:0,Ad:0,ee:1,reflect_factor:0,ak:0,If:1,parallax_scale:0,ui:0,Hg:1,Oo:0,Om:0,md:0,gh:0,zd:new Float32Array(2),He:new Float32Array(3),kh:new Float32Array(3),me:new Float32Array(3),ic:new Float32Array(4),Dh:new Float32Array(2),Im:null,Bo:null,Cr:null,Br:null,vb:!1,wireframe_edge_color:va.create(),Qf:!1,water_dynamic:!1,wn:!1,ky:!1,ly:0,my:0,jy:0,Gl:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,Qu:new Float32Array(2),Pu:new Float32Array(2),
er:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),Pj:null,Rj:!1,Ej:!1,zu:!1,Ha:null,Lm:0,Ql:null,Rr:null,Kh:[],Ff:[],je:[],Ef:[],sb:T.hG(),Bl:!1,Vd:null,Mg:!0,iG:0,Qo:new Float32Array(3)};a.ic[3]=1;a.fb=!0;a.Lm=1;a.Uk.so=-1;return a}function c(a){var c=e(a.type);c.zb=a.zb;c.id=a.id;c.Eq=a.Eq;c.Zk=a.Zk;c.ou=a.ou;c.Tn=a.Tn;c.Rq=a.Rq;c.uf=a.uf;c.Dk=[];c.ka=a.ka.slice();c.Lf=a.Lf.slice();c.pf=a.pf.slice();c.Xb=a.Xb.slice();c.pj=a.pj.slice();c.Vi=ga.V(a.Vi);
c.Oc=ga.V(a.Oc);c.pb=a.pb;c.Za=ba.SN(a.Za);c.ie=a.ie;c.jq=P.ON(a.jq);c.la=a.la;c.cf=a.cf;c.tj=a.tj;c.qu=a.qu;c.num_vertices=a.num_vertices;c.num_triangles=a.num_triangles;c.Mv=a.Mv;c.Nv=a.Nv;c.lv=a.lv;c.Bj=a.Bj;c.jd=a.jd;c.tf=a.tf;c.dj=a.dj;c.kf=a.kf;c.rb=a.rb;c.fb=a.fb;c.ai=a.ai;c.Oa=a.Oa;c.xc=a.xc;c.we=a.we;c.$e=a.$e;c.Ge=a.Ge;c.Td=a.Td;c.ke=a.ke;c.Rd=a.Rd;c.Qd=a.Qd;c.Lc=a.Lc;c.zh=a.zh;c.ff=a.ff;c.Rg=a.Rg;c.vj=a.vj;c.cg=a.cg;c.mg=a.mg;c.ng=a.ng;c.Ij=a.Ij;c.Jj=a.Jj;var d=a.Uk,f=b();f.Qs=d.Qs;f.Qe=
d.Qe;f.Wt=d.Wt;f.ti=d.ti;f.so=d.so;f.ro=d.ro;f.qo=d.qo;f.Hw=d.Hw;c.Uk=f;c.be=a.be;c.Nd=a.Nd;c.rv=a.rv;c.vv=a.vv;c.sv=a.sv;c.wv=a.wv;c.xv=a.xv;va.copy(a.uv,c.uv);va.copy(a.tv,c.tv);c.rr=a.rr;c.xd=a.xd;c.Ad=a.Ad;c.ee=a.ee;c.reflect_factor=a.reflect_factor;c.ak=a.ak;c.If=a.If;c.parallax_scale=a.parallax_scale;c.ui=a.ui;c.Hg=a.Hg;c.Oo=a.Oo;c.Om=a.Om;c.md=a.md;c.gh=a.gh;c.zd[0]=a.zd[0];c.zd[1]=a.zd[1];va.copy(a.He,c.He);va.copy(a.kh,c.kh);va.copy(a.me,c.me);xa.copy(a.ic,c.ic);c.Dh.set(a.Dh);c.Im=ga.V(a.Im);
a.Bo&&(c.Bo=new Float32Array(a.Bo),c.Cr=new Float32Array(a.Cr),c.Br=new Float32Array(a.Br));c.vb=a.vb;va.copy(a.wireframe_edge_color,c.wireframe_edge_color);c.Qf=a.Qf;c.water_dynamic=a.water_dynamic;c.wn=a.wn;c.ky=a.ky;c.ly=a.ly;c.my=a.my;c.jy=a.jy;c.Gl=a.Gl;c.shallow_water_col_fac=a.shallow_water_col_fac;c.shore_water_col_fac=a.shore_water_col_fac;c.foam_factor=a.foam_factor;c.Qu.set(a.Qu);c.Pu.set(a.Pu);c.er.set(a.er);va.copy(a.shallow_water_col,c.shallow_water_col);va.copy(a.shore_water_col,c.shore_water_col);
c.Pj=ga.V(a.Pj);c.Rj=a.Rj;c.Ej=a.Ej;c.zu=a.zu;a.Ha&&(c.Ha=Ca.BE(a.Ha));c.Lm=a.Lm;a.Ql&&(c.Ql=new Float32Array(a.Ql));c.Rr=ga.V(a.Rr);c.Kh=a.Kh.slice();c.Ff=a.Ff.slice();c.je=a.je.slice();c.Ef=a.Ef.slice();T.ME(a.sb,c.sb);c.Bl=a.Bl;c.Mg=a.Mg;c.Qo=a.Qo;return c}function b(){return{Qs:!1,Qe:0,ti:0,so:0,ro:0,qo:0,Hw:0,Wt:1}}function f(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.zb=a.rb?a.ai?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.zb=a.Ge?"CAST":"RECEIVE";break;case "COLOR_ID":a.zb=
a.ai?"COLOR_ID_XRAY":"COLOR_ID"}}function k(a,b,c){var d=[],f=a.Fa,g=h(c,b,!b.ve,!1),k=a.data,l=f.kc,m=Array(l.length),n=Array(l.length),p=[],v=ya.jc(c,oa.Nb),Q=!1;v&&(Q=v.Km.length?!0:!1);for(var q=0;q<g.length;q++)for(var r=g[q],L=0;L<l.length;L++){var w=l[L];if(!na(f,L)&&!pa.$F(k,L))if("PHYSICS"==r&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)p.push(pa.Ku(k,L,[],b.hi,{},null));else if(!w.Bi||Q){var z=e(r);"MAIN"==r?m[L]=z:"DEBUG_VIEW"==r&&(n[L]=z);z.Eq=a.b4w_cluster_data.cluster_id;if(C(z,
w)&&u(z,w)){"SHADOW"==r&&m[L]&&(z.xc=m[L].xc);z.zh=b.cf||b.we?pa.at:pa.An;D(z,b);N(z,a.particle_systems);if("DYNAMIC"==b.type||"COLOR_ID"==z.type)z.Zk=ia(z,b,a.uuid);z.vj=a.b4w_do_not_cull;"MAIN"==z.type&&(z.cg=a.b4w_caustics);x(z,"DISABLE_FOG",("COLOR_ID"!=r&&"SHADOW"!=r&&a.b4w_disable_fogging)|0);var y=pa.Ku(k,L,z.pj,b.hi,z.Oc,z.Vi);!w.ne||"a_shade_tangs"in y.fa[0]||(x(z,"CALC_TBN",1),I(z,"a_tbn"));w.Bi&&(y=Ca.oT(y));R(z);d.push({ya:z,qg:b,Ft:b,Vd:y,ah:[w.name],le:[a]})}}}if(p.length){z=e("PHYSICS");
z.zb="NAVMESH";z.Zk=ia(z,b,a.uuid);for(var y=pa.NI(p),F=[],q=0;q<l.length;q++)F.push(l[q].name);R(z);d.push({ya:z,qg:b,Ft:b,Vd:y,ah:F,le:[a]})}for(q=0;q<n.length;q++)n[q]&&(n[q].Tn=m[q].id,R(n[q]));var ha=a.particle_systems;if(0<ha.length){for(var t=!1,La=!1,q=0;q<ha.length;q++){var E=ha[q],B=E.settings;B.use_render_emitter&&d.length&&(t=!0);"HAIR"!=B.type||"OBJECT"!=B.render_type&&"GROUP"!=B.render_type&&E.transforms.length||(La=!0);if(t&&La)break}var Da;if(d.length)Da=d[0];else{var G=e("TMP");N(G,
ha);var J=pa.Ku(k,0,G.pj,b.hi,G.Oc,G.Vi);Da={ya:G,Vd:J}}var ma=Da,H=ma.ya.Oc,M;if(La){var V;if(1<l.length){for(var P={},Xa=0;Xa<ha.length;Xa++){var ta=ha[Xa].settings;if("HAIR"==ta.type&&("OBJECT"==ta.render_type||"GROUP"==ta.render_type)){var Y=ta.b4w_vcol_from_name,Ba=ta.b4w_vcol_to_name;""!==Y&&""!==Ba&&(P[Y]=ga.V(H[Y]))}}"a_bending_col_main"in H&&(P.a_bending_col_main=ga.V(H.a_bending_col_main));"a_bending_col_detail"in H&&(P.a_bending_col_detail=ga.V(H.a_bending_col_detail));V=pa.nF(k,[],P)}else V=
ma.Vd;M=V}else M=null;for(var O=M,T=a.Fa,U=[],ca=a.particle_systems,W=a.data,aa=0;aa<ca.length;aa++){var Z=ca[aa],xa=Z.settings;if(xa.count)if("EMITTER"==xa.type){if("DYNAMIC"==b.type){var X=e("PARTICLES");X.sb.Pe=b.ra;X.sb.nf=b.Ab;X.sb.rf=b.pc;var ja,qa=Z.settings.material-1;qa>=T.kc.length&&(ea.warn('Wrong material used for rendering particle system "'+Z.name+'"'),qa=0);ja=qa;var da=T.kc[ja];if(!na(T,ja)&&("HALO"===Z.settings.render_type&&"HALO"==da.type&&(X.rr=!0),u(X,da))){var la=X,ka=T,wa=Z.settings;
switch(wa.b4w_billboard_align){case "VIEW":x(la,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":x(la,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":x(la,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":x(la,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:ga.I("Wrong billboard align value")}x(la,"BILLBOARD",0);var Oa=wa.b4w_enable_soft_particles&&fa.oE(ka,wa);x(la,"SOFT_PARTICLES",0<wa.b4w_particles_softness&&Oa&&K.ru?1:0);x(la,"SOFT_STRENGTH",ba.W(wa.b4w_particles_softness));
ba.pa(la.Za,"WORLD_SPACE","WORLD"==wa.b4w_coordinate_system?1:0);X.we=!0;X.vj=a.b4w_do_not_cull;X.Zk=ia(X,b,T.name+"_"+xa.uuid);Ca.vO(X,Z,da);var Qa=Ca.mQ(X,W,Z,T.v);Ca.ZV(Qa,X,xa.count);Ca.YV(T);D(X,T.v);R(X);U.push({ya:X,qg:b,Ft:b,Vd:Qa,ah:[da.name],le:[a]})}}}else if("HAIR"==xa.type){var kb=ga.Cv(Z.seed),ib=za.pE(K.EA)&&!xa.b4w_initial_rand_rotation&&!xa.b4w_hair_billboard,Cb=4;ib&&(Cb=8);if(Z.transforms.length)var fb=Z.transforms;else for(var gc=pa.Rz(O,xa.count,!1,kb),fb=new Float32Array(gc.length*
Cb),lb=0;lb<gc.length;lb++){var Ic=.75+.5*ga.fh(kb);fb[lb*Cb]=gc[lb][0];fb[lb*Cb+1]=gc[lb][1];fb[lb*Cb+2]=gc[lb][2];fb[lb*Cb+3]=Ic;ib&&(fb[lb*Cb+4]=1,fb[lb*Cb+5]=0,fb[lb*Cb+6]=0,fb[lb*Cb+7]=0)}var Tc=ya.jc(c,oa.Zi)?!0:!1;if("OBJECT"==xa.render_type){var Jc=[h(c,xa.dupli_object.Fa.v,!b.ve,!0)],ad=A(a,b,H,O,[xa.dupli_object],Jc,[fb],xa,Z,Tc,kb,!1);U.push.apply(U,ad)}else if("GROUP"==xa.render_type){for(var lc=xa.dupli_group.objects,Jc=[],lb=0;lb<lc.length;lb++){var bd=h(c,lc[lb].Fa.v,!b.ve,!0);Jc.push(bd)}for(var Uc=
!1,mc=[],lb=0;lb<lc.length;lb++)mc.push(lc[lb].Fa);if(xa.use_whole_group){for(var cd,tb=fb,rc=mc,Vc=ib,sc=Cb,Fb={},Rb=new Float32Array([0,0,0,1]),mb=0;mb<tb.length;mb+=sc)for(var Sa=0;Sa<rc.length;Sa++){var Xb=va.create(),dd=sa.get_scale(rc[Sa].v.C),Wc=sa.get_trans_view(rc[Sa].v.C);va.scale(Wc,dd,Xb);var ic=va.clone([tb[mb],tb[mb+1],tb[mb+2]]);Fb[Sa]||(Fb[Sa]=new Float32Array(tb.length));Vc&&(Fb[Sa][mb+4]=Rb[0]=tb[mb+4],Fb[Sa][mb+5]=Rb[1]=tb[mb+5],Fb[Sa][mb+6]=Rb[2]=tb[mb+6],Fb[Sa][mb+7]=Rb[3]=tb[mb+
7],ga.sB(Rb,Rb),ga.tV(Xb,Rb,Xb));va.add(ic,Xb,ic);Fb[Sa][mb]=ic[0];Fb[Sa][mb+1]=ic[1];Fb[Sa][mb+2]=ic[2];Fb[Sa][mb+3]=tb[mb+3]}cd=Fb;Uc=!0}else{var Kc;if(xa.use_group_count){for(var Sb=fb,Lc=mc,nc=xa.dupli_weights,Mc=kb,Tb=ib,Hb=Cb,pb={},oc=[],jb=0;jb<Lc.length;jb++)for(var Xc=Lc[jb],ed=Xc.Ed||Xc.name,Nc=0;Nc<nc.length;Nc++){var wb=nc[Nc];ed==wb.name&&oc.push(wb)}nc.length!=oc.length&&ea.error("dupli weights match failed");for(jb=0;jb<Sb.length;jb+=Hb){for(var xb,Ub=oc,Yb=[0],Kb=0;Kb<Ub.length;Kb++)Yb[Kb+
1]=Yb[Kb]+Ub[Kb].count;for(var jc=Yb[Yb.length-1]*ga.fh(Mc),Lb=0,Kb=0;Kb<Yb.length;Kb++)if(jc>=Yb[Kb]&&jc<Yb[Kb+1]){Lb=Kb;break}xb=Lb;pb[xb]=pb[xb]||[];pb[xb].push(Sb[jb],Sb[jb+1],Sb[jb+2],Sb[jb+3]);Tb&&pb[xb].push(Sb[jb+4],Sb[jb+5],Sb[jb+6],Sb[jb+7])}for(xb in pb)pb[xb]=new Float32Array(pb[xb]);Kc=pb}else{for(var ub=fb,Pa=kb,Zb=ib,Nb=Cb,bb=mc.length,$a={},$b=0;$b<ub.length;$b+=Nb){var kc=Math.floor(bb*ga.fh(Pa));$a[kc]=$a[kc]||[];$a[kc].push(ub[$b],ub[$b+1],ub[$b+2],ub[$b+3]);Zb&&$a[kc].push(ub[$b+
4],ub[$b+5],ub[$b+6],ub[$b+7])}for(kc in $a)$a[kc]=new Float32Array($a[kc]);Kc=$a}cd=Kc}ad=A(a,b,H,O,lc,Jc,cd,xa,Z,Tc,kb,Uc);U.push.apply(U,ad)}"INSTANCE"==xa.b4w_wind_bend_inheritance&&T.v.Me&&ea.warn('Emitter object "'+T.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else ga.I("Unknown particle settings type")}t?d.push.apply(d,U):d=U}return d}function q(a){for(var b=[],c=[],d={},e=
0;e<a.length;e++){var f=a[e].ya,g=null;if(f.id in d){var h=d[f.id],k=c[h].ya;m(f,function(a){m(k,function(b){ga.iV(a,b)&&1!=a.iG&&(g=c[h])})});if(!g){do f.id++;while(d[f.id])}}g||(g={ya:f,oH:[],ND:[],QI:[],le:[],IH:[],ah:[]},d[f.id]=c.length,c.push(g));if(a[e].Vd&&a[e].Vd.Va){g.oH.push(a[e].qg);g.ND.push(a[e].Ft);g.QI.push(a[e].Vd);for(var l=0;l<a[e].le.length;l++)f=a[e].le[l],-1==g.IH.indexOf(f.uuid)&&(g.le.push(f),g.IH.push(f.uuid));for(l=0;l<a[e].ah.length;l++)f=a[e].ah[l],-1==g.ah.indexOf(f)&&
g.ah.push(f)}g.ah.sort()}for(e=0;e<c.length;e++){var f=c[e].ya,n=c[e].oH,p=c[e].ND,v=c[e].QI;a="DYNAMIC"==p[0].type||"COLOR_ID"==f.type?p[0]:fa.kz(p[0]);if("STATIC"==a.type&&"COLOR_ID"!=f.type)for(l=0;l<n.length;l++){var q=n[l],r=p[l],d=v[l],Q=sa.identity(La);q.Jg&&!q.nq?(q=sa.mo(q.C,ha),sa.set_transcale(q,Q)):sa.copy(q.C,Q);r.Qk?d.We||(r.Jg?pa.lV(d,Q):pa.bC(d,Q)):pa.bC(d,Q);if(r.Qk)x(f,"AU_QUALIFIER","GLSL_IN");else if(1<c[e].le.length){q={};if(r.Me||r.Jg)q.au_center_pos=[Q[0],Q[1],Q[2]];r.Me&&(q.au_wind_bending_amp=
[r.Rf],q.au_wind_bending_freq=[r.Sf],q.au_detail_bending_amp=[r.wf],q.au_detail_bending_freq=[r.xf],q.au_branch_bending_amp=[r.qf]);pa.kV(d,q);x(f,"AU_QUALIFIER","GLSL_IN")}else a.Rt.set(Q.subarray(0,3)),x(f,"AU_QUALIFIER","uniform")}if(0==v.length)d=pa.Yg(ga.Is("%empty"));else if(1==v.length)d=v[0];else{d=[];for(l=0;l<v.length;l++)pa.OR(v[l])||d.push(l);if(d.length<v.length)for(l=0;l<d.length;l++)pa.Ax(v[d[l]]);d=pa.NI(v)}if("STATIC"==a.type){if("COLOR_ID"!=f.type){v=[];for(l=0;l<c[e].le.length;l++)T.Nz(c[e].le[l].Fa.v.OD,
v);T.Sy(v,0,v.length,a.uh);T.ni(a.uh,a.ra);a.tk=T.cu(ga.f32(v),!0);T.Pn(a.tk,a.Ab);a.te=T.eu(a.tk);T.zk(a.te,a.pc)}a.Dj&&(l=c[e].le[0].b4w_cluster_data,l.cluster_center?a.Ir.set(l.cluster_center):a.Ir.set(a.te.S))}"PARTICLES"!=f.type&&(l=d.$c,a.Jg?(T.ni(a.ra,f.sb.Pe),T.Pn(a.Ab,f.sb.nf),T.zk(a.pc,f.sb.rf),f.Bl=!1):(T.ni(l.ra,f.sb.Pe),T.Pn(l.Ab,f.sb.nf),a.pc.ib<l.pc.ib?"STATIC"==a.type&&"COLOR_ID"!=f.type?T.zk(a.te,f.sb.rf):T.zk(a.pc,f.sb.rf):T.zk(l.pc,f.sb.rf),f.Bl=T.lG(f.sb.nf,f.sb.rf)));b.push({ya:f,
v:a,Vd:d,ah:c[e].ah,le:c[e].le})}return b}function h(a,b,c,d){var e=[];d||(b.ll&&ya.jc(a,oa.Ne)||b.Yc&&ya.jc(a,oa.qh))&&e.push("COLOR_ID");c&&(e.push("MAIN"),e.push("NODES_GLOW"),ya.jc(a,oa.ph)&&e.push("DEBUG_VIEW"),ya.jc(a,oa.Wf)&&e.push("SHADOW"),ya.jc(a,oa.Zi)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.Ge||b.Rd)for(a=null,b.Ge&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.Rd&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a?a=ga.IM(a,b):a=b),b=a,a=0;a<b.length;a++)c=e.indexOf(b[a]),
-1!==c&&e.splice(c,1);return e}function u(a,b){var c;switch(a.type){case "MAIN":if(b.ve)c=!1;else{if(b.Bg&&"HALO"!=b.type)z(a,b,"MAIN");else{d(a,b);a.Oa=b.Oa;a.ai=b.Tj&&"OPAQUE"!=b.lb&&"CLIP"!=b.lb&&"ALPHA_ANTIALIASING"!=b.lb;a.md=b.md;a.kh.set([1,1,1]);var e=b.yg;a.ic.set(b.ic);a.ic[3]=b.alpha;if(b.Bi){U(a,"lens_flares.glslv","lens_flares.glslf");I(a,"a_position");I(a,"a_texcoord");var f=W.ye(e[0]),h=e[0].texture;O(a,f,"u_sampler",h.name)}else{U(a,"main.glslv","main_stack.glslf");b.xc||(c=X.rz(b.Nc,
b.name,{xc:b.xc,Te:b.Te,af:b.af,ne:b.ne}),a.Za.Ye=X.Iq(c));var k=r("use_map_color_diffuse",e),l=r("use_map_color_spec",e),m=r("use_map_normal",e),n=r("use_map_mirror",e),q=r("use_stencil",e);c=k[0];l=l[0];m=m[0];n=n[0];k=k[1];e=q[0]&&r("use_rgb_to_intensity",e)[0];if(c){h=c.texture;switch(c.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}f=W.ye(c);O(a,f,"u_colormap0",h.name);a.ui=c.diffuse_color_factor;
c.use_map_alpha?a.Hg=c.alpha_factor:a.Hg=0;a.kh.set(c.scale)}q=c&&c==l;l&&(q||(h=l.texture,f=W.ye(l),O(a,f,"u_specmap0",h.name)),a.ak=l.specular_color_factor);if(m&&(h=m.texture,I(a,"a_tbn"),f=W.ye(m),O(a,f,"u_normalmap0",h.name),a.Oo=m.normal_factor,h.b4w_use_map_parallax&&K.Bw)){var f=ba.W(h.b4w_parallax_steps),u=ba.W(h.b4w_parallax_lod_dist);x(a,"PARALLAX",1);x(a,"PARALLAX_STEPS",f);x(a,"PARALLAX_LOD_DIST",u);a.parallax_scale=h.b4w_parallax_scale}n&&(h=n.texture,f=W.ye(n),O(a,f,"u_mirrormap",h.name),
a.Om=n.mirror_factor);if(n=c&&k&&e?1:0)f=W.ye(k),h=k.texture,O(a,f,"u_colormap1",h.name),f=W.ye(e),h=e.texture,O(a,f,"u_stencil0",h.name);(h=c||l||m)&&a.kh.set(h.scale);x(a,"TEXTURE_SPEC",void 0==l?0:1);x(a,"ALPHA_AS_SPEC",q?1:0);x(a,"TEXTURE_STENCIL_ALPHA_MASK",n);I(a,"a_position");I(a,"a_tbn");(c||l||m)&&I(a,"a_texcoord");if(b.da.Di){a.Qf=!0;a.water_dynamic=b.da.is_dynamic;b.da.shore_smoothing&&!a.rb?(ea.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.wn=!1):a.wn=
"REFLECT"!=a.zb?b.da.shore_smoothing:!1;U(a,"water.glslv","water.glslf");n=X.rz(b.Nc,b.name,{xc:!1,Te:b.Te,af:b.af,ne:b.ne});a.Za.Ye=X.Iq(n);I(a,"a_position");K.SJ?(I(a,"a_polyindex"),a.fb=!0,va.set(0,0,0,a.wireframe_edge_color),qa.aA()?x(a,"DEBUG_WIREFRAME",1):x(a,"DEBUG_WIREFRAME",2)):x(a,"DEBUG_WIREFRAME",0);q=b.yg;n=r("use_map_normal",q);f=r("use_map_mirror",q)[0];n.length&&(h=n[0].texture,O(a,W.ye(n[0]),"u_normalmap0",h.name),a.Gl=b.da.norm_uv_velocity);x(a,"NUM_NORMALMAPS",n.length);a.Pj=Array(n.length);
for(h=0;h<n.length;h++)a.Pj[h]=new Float32Array(2),a.Pj[h].set([n[h].scale[0],n[h].scale[1]]);f&&(u=W.ye(f),h=f.texture,O(a,u,"u_mirrormap",h.name),a.Om=f.mirror_factor);f=null;if(K.io)for(h=0;h<q.length;h++){var Q=q[h];if(!0===Q.texture.b4w_water_foam){f=Q;break}}f&&(x(a,"FOAM",1),u=W.ye(f),h=f.texture,O(a,u,"u_foam",h.name),a.foam_factor=b.da.foam_factor,a.Qu.set(h.b4w_foam_uv_freq),a.Pu.set(h.b4w_foam_uv_magnitude),a.er[0]=f.scale[0],a.er[1]=f.scale[1]);for(h=0;h<q.length;h++)if(Q=q[h],!0===Q.texture.b4w_shore_dist_map){var L=
Q;break}L&&K.st&&(q=W.ye(L),h=L.texture,O(a,q,"u_shore_dist_map",h.name),x(a,"SHORE_PARAMS",1),L=Q.texture.b4w_shore_boundings,x(a,"MAX_SHORE_DIST",ba.W(Q.texture.b4w_max_shore_dist)),x(a,"SHORE_MAP_SIZE_X",ba.W(L[0]-L[1])),x(a,"SHORE_MAP_SIZE_Y",ba.W(L[2]-L[3])),x(a,"SHORE_MAP_CENTER_X",ba.W((L[0]+L[1])/2)),x(a,"SHORE_MAP_CENTER_Y",ba.W((L[2]+L[3])/2)));b.da.Gv?(x(a,"GENERATED_MESH",1),a.ky=!0,a.ly=b.da.rw,a.my=b.da.sw,a.jy=b.da.tu):(I(a,"a_tbn"),(f||n.length)&&I(a,"a_texcoord"),x(a,"GENERATED_MESH",
0));if(b.da.is_dynamic){var Q=ba.W(b.da.dst_noise_scale0),L=ba.W(b.da.dst_noise_scale1),n=ba.W(b.da.dst_noise_freq0),q=ba.W(b.da.dst_noise_freq1),h=ba.W(b.da.dir_min_shore_fac),f=ba.W(b.da.dir_freq),u=ba.W(b.da.dir_noise_scale),w=ba.W(b.da.dir_noise_freq),F=ba.W(b.da.dir_min_noise_fac),ha=ba.W(b.da.dst_min_fac),A=ba.W(b.da.waves_hor_fac);x(a,"DST_NOISE_SCALE_0",Q);x(a,"DST_NOISE_SCALE_1",L);x(a,"DST_NOISE_FREQ_0",n);x(a,"DST_NOISE_FREQ_1",q);x(a,"DIR_MIN_SHR_FAC",h);x(a,"DIR_FREQ",f);x(a,"DIR_NOISE_SCALE",
u);x(a,"DIR_NOISE_FREQ",w);x(a,"DIR_MIN_NOISE_FAC",F);x(a,"DST_MIN_FAC",ha);x(a,"WAVES_HOR_FAC",A)}M(a,b);E(a,b);a.shallow_water_col.set(b.da.Zw);a.shore_water_col.set(b.da.bx);a.shallow_water_col_fac=b.da.$w;a.shore_water_col_fac=b.da.cx;x(a,"ABSORB",ba.W(b.da.absorb_factor));x(a,"SSS_STRENGTH",ba.W(b.da.sss_strength));x(a,"SSS_WIDTH",ba.W(b.da.sss_width))}"HALO"===b.type&&(U(a,"halo.glslv","halo.glslf"),y(a,b),a.pj=["a_position"]);b.ne&&(x(a,"USE_TBN_SHADING",1),I(a,"a_shade_tangs"));x(a,"TEXCOORD",
0);x(a,"NORMAL_TEXCOORD",0);c&&g(a,c,"TEXTURE_COLOR0_CO");k&&g(a,k,"TEXTURE_COLOR1_CO");e&&g(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");l&&g(a,l,"TEXTURE_SPEC_CO");m&&g(a,m,"TEXTURE_NORM_CO");x(a,"SHADELESS",b.xc?1:0);a.xc=b.xc}x(a,"ALPHA","OPAQUE"===b.lb?0:1);x(a,"ALPHA_CLIP","CLIP"===b.lb?1:0);x(a,"DOUBLE_SIDED_LIGHTING",b.Cp?1:0);b.Rs?(x(a,"VERTEX_COLOR",1),I(a,"a_color")):x(a,"VERTEX_COLOR",0);a.xd=b.xd;a.ee=b.ee;a.Ad=b.Ad;a.me.set(b.me);a.If=b.If;M(a,b);E(a,b);b.zr?x(a,"WETTABLE",1):x(a,"WETTABLE",
0);p(a,b);b.Gm&&!a.rb?(ea.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.Rj=!1):a.Rj=b.Gm;a.gh=b.gh}c=!0}break;case "NODES_GLOW":c=z(a,b,"GLOW");break;case "SHADOW":if(b.Bi||b.da.Di||b.ve||"HALO"==b.type)c=!1;else if(d(a,b),a.Oa=b.Oa,a.rb)c=!1;else{!b.Bg||"CLIP"!=b.lb&&"ALPHA_ANTIALIASING"!=b.lb?U(a,"shadow.glslv","shadow.glslf"):z(a,b,"SHADOW");xa.set(0,0,0,b.alpha,a.ic);I(a,"a_position");I(a,"a_tbn");x(a,"ALPHA","OPAQUE"===b.lb?0:1);a.kh.set([1,1,1]);l=r("use_map_color_diffuse",
b.yg)[0];if(!l||"CLIP"!=b.lb&&"ALPHA_ANTIALIASING"!=b.lb)x(a,"TEXTURE_COLOR",0);else{switch(l.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.kh.set(l.scale);x(a,"TEXTURE_COLOR",1);I(a,"a_texcoord");c=W.ye(l);l=l.texture;"IMAGE"!=c.source&&"ENVIRONMENT_MAP"!=c.source&&"CANVAS"!=c.source&&"NONE"!=c.source||O(a,c,"u_colormap0",l.name)}c=!0}break;case "PHYSICS":c=b.nd;l=b.da;c.Bp?(a.Ui=c.Ui,a.Jb=
c.Jb,a.li=c.li,a.ki=c.ki,a.mi=c.mi,a.Sg=c.Sg,a.Ng=c.Ng,c=!0):l.Di?(a.Qf=!0,a.FW=l.is_dynamic,a.dst_noise_scale0=l.dst_noise_scale0,a.dst_noise_scale1=l.dst_noise_scale1,a.dst_noise_freq0=l.dst_noise_freq0,a.dst_noise_freq1=l.dst_noise_freq1,a.dir_min_shore_fac=l.dir_min_shore_fac,a.dir_freq=l.dir_freq,a.dir_noise_scale=l.dir_noise_scale,a.dir_noise_freq=l.dir_noise_freq,a.dir_min_noise_fac=l.dir_min_noise_fac,a.dst_min_fac=l.dst_min_fac,a.waves_hor_fac=l.waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.Bi||
"HALO"==b.type)c=!1;else{m=c=b.lb;"ALPHA_ANTIALIASING"==m&&(m="CLIP",b.lb="CLIP");d(a,b);a.Oa=b.Oa;a.ff=!1;a.fb=!0;a.rb=!1;a.ai=b.Tj&&"OPAQUE"!=m&&"CLIP"!=m;b.Bg&&"CLIP"==m?z(a,b,"COLOR_ID"):U(a,"color_id.glslv","color_id.glslf");xa.set(0,0,0,b.alpha,a.ic);I(a,"a_position");x(a,"ALPHA","OPAQUE"===m?0:1);a.kh.set([1,1,1]);l=r("use_map_color_diffuse",b.yg)[0];x(a,"ALPHA_CLIP","CLIP"===m?1:0);if(l&&"CLIP"==m){switch(l.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.kh.set(l.scale);x(a,"TEXTURE_COLOR",1);I(a,"a_texcoord");m=W.ye(l);l=l.texture;"IMAGE"!=m.source&&"ENVIRONMENT_MAP"!=m.source&&"CANVAS"!=m.source&&"NONE"!=m.source||O(a,m,"u_colormap0",l.name)}else x(a,"TEXTURE_COLOR",0);b.lb=c;c=!0}break;case "GRASS_MAP":!b.Si.zo||b.ve?c=!1:(d(a,b),a.Oa=b.Oa,a.rb=!1,a.ff=!1,a.fb=!0,U(a,"grass_map.glslv","grass_map.glslf"),I(a,"a_position"),c=b.Si.ar?b.Si.ar:null,l=b.Si.$q?b.Si.$q:null,a.Oc.a_grass_size={vm:!0,
src:[]},c?(a.Oc.a_grass_size.src.push({name:c,Zg:4}),x(a,"DYNAMIC_GRASS_SIZE",1)):x(a,"DYNAMIC_GRASS_SIZE",0),a.Oc.a_grass_color={vm:!0,src:[]},l?(a.Oc.a_grass_color.src.push({name:l,Zg:7}),x(a,"DYNAMIC_GRASS_COLOR",1)):x(a,"DYNAMIC_GRASS_COLOR",0),x(a,"GRASS_TEXTURE_SIZE",ba.W(Qa.qr)),c=!0);break;case "DEBUG_VIEW":c=v(a,b);break;case "PARTICLES":a:if(b.ve)c=!1;else{c=b.yg;if(a.rr)U(a,"particle_system.glslv","particle_system_stack.glslf"),x(a,"HALO_PARTICLES",1),y(a,b);else{l={xc:!1,Te:b.Te,af:b.af,
ne:b.ne};if(b.Bg){U(a,"particle_system.glslv","particle_system.glslf");z(a,b,"PARTICLES");c=!0;break a}U(a,"particle_system.glslv","particle_system_stack.glslf");l=X.rz(b.Nc,b.name,l);a.Za.Ye=X.Iq(l);if(c=r("use_map_color_diffuse",c)[0]){x(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":x(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ui=c.diffuse_color_factor;c.use_map_alpha?a.Hg=c.alpha_factor:a.Hg=0;O(a,W.ye(c),
"default"+String(a.ka.length),c.texture.name)}}a.ic.set(b.ic);a.ic[3]=b.alpha;a.xd=b.xd;a.ee=b.ee;a.Ad=b.Ad;a.me.set(b.me);a.If=b.If;I(a,"a_position");I(a,"a_tbn");x(a,"ALPHA","OPAQUE"===b.lb?0:1);x(a,"ALPHA_CLIP","CLIP"===b.lb?1:0);x(a,"PARTICLES_SHADELESS",b.xc?1:0);M(a,b);E(a,b);d(a,b);a.Oa=b.Oa;a.ai=b.Tj&&"OPAQUE"!=b.lb&&"CLIP"!=b.lb&&"ALPHA_ANTIALIASING"!=b.lb;a.md=b.md;c=!0}break;default:ga.I("Wrong batch type: "+a.type)}return c}function y(a,b){var c=b.po;x(a,"NUM_RINGS",c.Pw);x(a,"NUM_LINES",
c.Tv);x(a,"NUM_STARS",c.xx);x(a,"SKY_STARS",c.Kv?1:0);a.vv=c.size;a.sv=c.sr/20;a.uv.set(c.Qw);a.tv.set(c.Vv);a.wv=1/c.yx;a.xv=c.zx;a.rv=!0}function g(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":x(a,c,"TEXTURE_COORDS_UV_ORCO");x(a,"TEXCOORD",1);break;case "NORMAL":x(a,c,"TEXTURE_COORDS_NORMAL");x(a,"NORMAL_TEXCOORD",1);break;default:x(a,c,"TEXTURE_COORDS_NONE")}}function d(a,b){switch(b.lb){case "ALPHA_ANTIALIASING":a.rb=!1;a.ff=!1;a.fb=!0;a.dj=!1;a.kf=!0;break;case "ALPHA_SORT":a.rb=!0;
a.ff=!0;a.fb=!0;a.dj=!1;a.kf=!1;break;case "ALPHA":a.rb=!0;a.ff=!1;a.fb=!0;a.dj=!1;a.kf=!1;break;case "CLIP":a.rb=!1;a.ff=!1;a.fb=!0;a.dj=!0;a.kf=!1;break;case "ADD":a.rb=!0;a.ff=!1;a.fb=!1;a.dj=!1;a.kf=!1;break;case "OPAQUE":a.rb=!1;a.ff=!1;a.fb=!0;a.dj=!1;a.kf=!1;break;default:ga.I("Unknown alpha blend mode: "+b.lb)}}function r(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.J&&c.push(f)}return c}function p(a,b){var c=b.Zm;a.reflect_factor=c.reflect_factor;a.Dh[0]=
c.fresnel;a.Dh[1]=1-c.fresnel_factor/5}function M(a,b){var c,d=0;switch(b.af){case "PHONG":case "COOKTORR":c=b.dn;break;case "WARDISO":c=b.sx;break;case "TOON":c=b.tx;d=b.ux;break;case "BLINN":c=b.rx;d=b.dn;break;default:ea.error("unsupported specular shader: "+b.af+' (material "'+b.name+'")'),c=b.dn}a.He[0]=b.vs;a.He[1]=c;a.He[2]=d}function E(a,b){switch(b.Te){case "LAMBERT":a.zd[0]=0;a.zd[1]=0;break;case "OREN_NAYAR":a.zd[0]=b.Rw;a.zd[1]=0;break;case "FRESNEL":a.zd[0]=b.uu;a.zd[1]=b.vu;break;case "MINNAERT":a.zd[0]=
b.nu;a.zd[1]=0;break;case "TOON":a.zd[0]=b.wu;a.zd[1]=b.xu;break;default:ea.error("unsupported diffuse shader: "+b.Te+' (material "'+b.name+'")'),a.zd[0]=0,a.zd[1]=0}}function z(a,b,c){if(!b.Bg||b.ve)return!1;var e;switch(c){case "MAIN":U(a,"main.glslv","main.glslf");e=!1;break;case "GLOW":U(a,"main.glslv","main.glslf");e=!0;break;case "SHADOW":U(a,"shadow.glslv","shadow.glslf");e=!1;break;case "COLOR_ID":U(a,"color_id.glslv","color_id.glslf"),e=!1}c=X.GE(b.Md,b.Nc,!1,b.name,c);if(!c.Aa)return ea.error('Failed to create node graph for material "'+
b.name+'", disable nodes'),G(a,b),!0;a.ie=c.id;a.vb=!0;x(a,"NODES",1);x(a,"DOUBLE_SIDED_LIGHTING",b.Cp?1:0);I(a,"a_position");b.Yx&&I(a,"a_orco_tex_coord");d(a,b);a.Oa=b.Oa;a.md=b.md;e?(x(a,"ALPHA",1),x(a,"ALPHA_CLIP",0)):(x(a,"ALPHA","OPAQUE"===b.lb?0:1),x(a,"ALPHA_CLIP","CLIP"===b.lb?1:0));a.ai=b.Tj&&"OPAQUE"!=b.lb&&"CLIP"!=b.lb&&"ALPHA_ANTIALIASING"!=b.lb;a.Ad=b.Ad;a.xd=b.xd;p(a,b);b.zr?x(a,"WETTABLE",1):x(a,"WETTABLE",0);var f=null,g=!1;Z.ba(c.Aa,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=
d.data.name,h=d.data.value;a.Vi||(a.Vi={});a.Vi[h]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=d.data.name;a.Oc[e]={vm:!0,src:[{name:d.data.value}]};h=0;if("GEOMETRY_VC"==d.type)h=7;else for(var k=0;k<d.outputs.length;k++){var l="RGB".indexOf(d.outputs[k].identifier);-1<l&&(h|=1<<2-l)}a.Oc[e].src[0].Zg=h;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":I(a,"a_tbn");break;case "TEX_COORD_OB":x(a,"USE_MODEL_TSR_INVERSE",
1);break;case "TEX_COORD_WI":x(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":d.data.value.ne&&(x(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&I(a,"a_shade_tangs"));I(a,"a_tbn");g=!0;break;case "BSDF_BEGIN":g=!0;I(a,"a_tbn");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT_CUBE":case "TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case "TEXTURE_ENVIRONMENT_MIRROR_BALL":e=d.data.name;h=d.data.rq;k=d.data.value;O(a,k,e,h);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":x(a,"CALC_TBN_SPACE",1);I(a,"a_tbn");
d.data&&(e=d.data.name,h=d.data.rq,k=d.data.value,O(a,k,e,h));break;case "NORMAL_MAP":I(a,"a_tbn");switch(Number(d.Wa[0][1])){case X.SK:x(a,"CALC_TBN_SPACE",1);break;case X.RK:case X.QK:x(a,"USE_MODEL_TSR",1)}break;case "LAMP":d.data&&(a.Im=d.data);break;case "B4W_REFRACTION":a.rb?a.Rj=!0:(a.Rj=!1,ea.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));x(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":f||(f=d.data.Ua);break;case "PARTICLE_INFO":"PARTICLES"==
a.type&&d.data&&(a.Rr=d.data);break;case "VECT_TRANSFORM":switch(Number(d.Wa[1][1])){case X.rD:x(a,"USE_MODEL_TSR_INVERSE",1);break;case X.qD:x(a,"USE_VIEW_TSR",1);break;case X.pD:x(a,"USE_MODEL_TSR",1);break;case X.oD:x(a,"USE_MODEL_TSR",1);x(a,"USE_VIEW_TSR",1);break;case X.nD:x(a,"USE_VIEW_TSR_INVERSE",1);break;case X.mD:x(a,"USE_MODEL_TSR_INVERSE",1),x(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":x(a,"USE_MODEL_TSR",1);a.Qo[1]=b.Li;a.Qo[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":x(a,
"USE_VIEW_TSR",1);break;case "B4W_REFLECT":x(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":case "DISPLACEMENT_BUMP":I(a,"a_tbn");qa.aA()?x(a,"USE_DERIVATIVES_EXT",1):ea.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+b.name+'" material.');break;case "BSDF_TRANSPARENT":a.rb=!0;a.Rj=!0;break;case "BSDF_GLOSSY":case "BSDF_DIFFUSE":x(a,"USE_BSDF_SKY_DIM",1),qa.RF()&&x(a,"USE_TEXTURE_LOD_EXT",1)}});f&&O(a,f,"u_nodes_texture");g||(a.xc=!0);e=a.Za.Ye=X.Iq(c.Aa);
B(c.Aa,a);c=a.Ff;for(var h=a.Ef,k=0;k<e.length;k++){var l=e[k];switch(l.id){case "VALUE":var m=l.So[0];if(m)for(var n=0;n<c.length;n+=3)if(c[n]==m){l.Wa.push(["VALUE_ROW_IND",c[n+1]]);l.Wa.push(["VALUE_COL_IND",c[n+2]]);break}break;case "RGB":if(m=l.So[0])for(n=0;n<h.length;n+=2)if(h[n]==m){l.Wa.push(["RGB_IND",h[n+1]]);break}}}x(a,"NUM_VALUES",a.Kh.length/4);x(a,"NUM_RGBS",a.je.length);return!0}function l(a,b){var c=b.J.Il;if(""!=c.ie){a.vb=!0;a.ie=c.ie;var d=X.fv(c.ie).Aa;if(d){var e=null;Z.ba(d,
function(b,c){switch(c.type){case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case "TEXTURE_ENVIRONMENT_MIRROR_BALL":O(a,c.data.value,c.data.name,c.data.rq);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":e||(e=c.data.Ua);break;case "VECT_TRANSFORM":switch(Number(c.Wa[1][1])){case X.rD:x(a,"USE_MODEL_TSR_INVERSE",1);break;case X.qD:x(a,"USE_VIEW_TSR",1);break;case X.pD:x(a,"USE_MODEL_TSR",1);break;case X.oD:x(a,"USE_MODEL_TSR",1);x(a,"USE_VIEW_TSR",1);break;case X.nD:x(a,"USE_VIEW_TSR_INVERSE",
1);break;case X.mD:x(a,"USE_MODEL_TSR_INVERSE",1),x(a,"USE_VIEW_TSR_INVERSE",1)}break;case "B4W_VECTOR_VIEW":x(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":x(a,"USE_VIEW_TSR_INVERSE",1)}});e&&O(a,e,"u_nodes_texture");c=a.Za.Ye=X.Iq(d);B(d,a);for(var d=a.Ff,f=a.Ef,g=0;g<c.length;g++){var h=c[g];switch(h.id){case "VALUE":var k=h.So[0];if(k)for(var l=0;l<d.length;l+=3)if(d[l]==k){h.Wa.push(["VALUE_ROW_IND",d[l+1]]);h.Wa.push(["VALUE_COL_IND",d[l+2]]);break}break;case "RGB":if(k=h.So[0])for(l=0;l<f.length;l+=
2)if(f[l]==k){h.Wa.push(["RGB_IND",f[l+1]]);break}}}x(a,"NUM_VALUES",a.Kh.length/4);x(a,"NUM_RGBS",a.je.length)}else ea.error('Failed to create node graph for world "'+b.world.name+'", disable nodes'),G(a,b.world.name)}}function B(a,b){var c=[],d=[],e=[],f=[];w(a,c,d,e,f);b.Kh=c;b.Ff=d;b.je=e;b.Ef=f}function w(a,b,c,d,e){Z.ba(a,function(a,f){if("VALUE"==f.type){var g=""+f.name;b.push(f.outputs[0].Ga);var h=c.length/3;c.push(g,parseInt(h/4),parseInt(h%4))}else"RGB"==f.type&&(g=""+f.name,h=f.outputs[0].Ga.slice(0,
3),d.push(h[0],h[1],h[2]),e.push(g,e.length/2))});a=b.length+4-b.length%4;for(var f=b.length;f<a;f++)b.push(0)}function G(a,b){switch(a.type){case "SHADOW":U(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":U(a,"color_id.glslv","color_id.glslf");break;default:U(a,"main.glslv","main_stack.glslf")}x(a,"SHADELESS",1);I(a,"a_position");I(a,"a_tbn");xa.set(1,0,1,1,a.ic);b&&(x(a,"ALPHA","OPAQUE"===b.lb?0:1),x(a,"ALPHA_CLIP","CLIP"===b.lb?1:0),x(a,"VERTEX_COLOR",0),a.md=b.md,d(a,b),a.Oa=b.Oa);return!0}
function v(a,b){if(b&&(b.Bi||b.ve))return!1;U(a,"debug_view.glslv","debug_view.glslf");I(a,"a_position");I(a,"a_tbn");I(a,"a_polyindex");a.fb=!0;va.set(0,0,0,a.wireframe_edge_color);return!0}function D(a,b){a.ce=b.ce;if("PHYSICS"!==a.type){"DYNAMIC"==b.type||"COLOR_ID"==a.type?(b.Qk?x(a,"AU_QUALIFIER","GLSL_IN"):x(a,"AU_QUALIFIER","uniform"),x(a,"STATIC_BATCH",0)):(x(a,"AU_QUALIFIER","GLSL_IN"),x(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(qa.aA()?x(a,"WIREFRAME_QUALITY",1):x(a,"WIREFRAME_QUALITY",
0),a.tj?(x(a,"DEBUG_SPHERE",1),a.qu?x(a,"DEBUG_SPHERE_DYNAMIC",1):x(a,"DEBUG_SPHERE_DYNAMIC",0)):x(a,"DEBUG_SPHERE",0),x(a,"ALPHA",1));b.cf&&"PARTICLES"!=a.type&&!b.Qk&&(a.cf=b.cf);b.Me?(""!==b.Kj?(a.Oc.a_bending_col_main={vm:!0,src:[{name:b.Kj,Zg:4}]},I(a,"a_bending_col_main"),""!==b.Se.CA&&""!==b.Se.BA&&""!==b.Se.iB?(a.Oc.a_bending_col_detail={vm:!0,src:[{name:b.Se.CA,Zg:4},{name:b.Se.BA,Zg:2},{name:b.Se.iB,Zg:1}]},I(a,"a_bending_col_detail"),I(a,"a_tbn"),x(a,"DETAIL_BEND",1)):x(a,"DETAIL_BEND",
0),x(a,"MAIN_BEND_COL",1)):x(a,"MAIN_BEND_COL",0),b.Wl?x(a,"BEND_CENTER_ONLY",1):x(a,"BEND_CENTER_ONLY",0),x(a,"WIND_BEND",1)):x(a,"WIND_BEND",0);x(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.nq|0);b.Jg?x(a,"BILLBOARD",1):x(a,"BILLBOARD",0);b.Jg&&b.Qk?x(a,"HAIR_BILLBOARD",1):x(a,"HAIR_BILLBOARD",0);b.oq?x(a,"BILLBOARD_SPHERICAL",1):x(a,"BILLBOARD_SPHERICAL",0);switch(b.pq){case "RANDOM":x(a,"BILLBOARD_RANDOM",1);x(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":x(a,"BILLBOARD_RANDOM",0);x(a,"BILLBOARD_JITTERED",
1);break;default:x(a,"BILLBOARD_RANDOM",0),x(a,"BILLBOARD_JITTERED",0)}b.Lc&&K.st?x(a,"DYNAMIC_GRASS",1):x(a,"DYNAMIC_GRASS",0);a.Lc=b.Lc;"PARTICLES"!=a.type&&(a.we=b.we);a.$e=b.$e;a.Ge=b.Ge;a.Td=b.Td&&!a.xc&&!(a.rb&&K.Ez);K.ks?("MAIN"==a.type&&a.Td||"SHADOW"==a.type)&&x(a,"RGBA_SHADOWS",1):x(a,"RGBA_SHADOWS",0);a.ke=b.ke;a.Rd=b.Rd;a.Qd=b.Qd;a.Qo[0]=b.Li;a.mg=b.mg;a.ng=b.ng;a.Ij=b.Ij;a.Jj=b.Jj;a.be=b.be;a.Nd=b.Nd;b.Sk?(I(a,"a_influence"),x(a,"SKINNED",1),K.ex?(x(a,"DISABLE_TANGENT_SKINNING",1),x(a,
"FRAMES_BLENDING",0)):(x(a,"DISABLE_TANGENT_SKINNING",0),b.sm?x(a,"FRAMES_BLENDING",1):x(a,"FRAMES_BLENDING",0)),x(a,"MAX_BONES",b.Ih)):(x(a,"SKINNED",0),x(a,"FRAMES_BLENDING",0),x(a,"DISABLE_TANGENT_SKINNING",0));b.ad?(x(a,"VERTEX_ANIM",1),K.JJ?x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):x(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):x(a,"VERTEX_ANIM",0);b.Sk&&b.ad&&ga.I("Skinning and vertex animation are mutually exlusive")}}function F(a,b,c){if(b.length){for(var d=fa.hv(b,K.ssao&&c.b4w_enable_ssao),
e=a.Za,f=a.Im,g=0,h=0;h<a.Za.Ye.length;h++){var k=a.Za.Ye[h];if("LIGHTING_LAMP"==k.id){var l=b[g++%b.length],m=l.Db,p=fa.Da(l,c);if("SPOT"==m.type||"POINT"==m.type)var v=Math.cos(m.en/2);if("SPOT"==m.type)var q=m.xs*(1-v);l=d.indexOf(l);k.Wa=[["LAMP_TYPE",m.type],["LAMP_IND",p.Hr],["LAMP_SPOT_SIZE",ba.W(v||.01)],["LAMP_SPOT_BLEND",ba.W(q||.01)],["LAMP_LIGHT_DIST",ba.W(m.distance)],["LAMP_USE_SPHERE",m.BC?1:0],["LAMP_SHADOW_MAP_IND",l]]}else if("LAMP"==k.id&&f)for(var p=k.Wa[0][1],r=0;r<b.length;r++)if(l=
b[r],f[l.Nc]==p){m=l.Db;if("SPOT"==m.type||"POINT"==m.type)v=Math.cos(m.en/2);"SPOT"==m.type&&(q=m.xs*(1-v));k.Wa.push(["LAMP_TYPE",m.type],["LAMP_SPOT_SIZE",ba.W(v||.01)],["LAMP_SPOT_BLEND",ba.W(q||.01)],["LAMP_LIGHT_DIST",ba.W(m.distance)],["LAMP_USE_SPHERE",m.BC?1:0])}}if(f){c=0;for(var u in f)c++;a.Bo=new Float32Array(3*c);a.Cr=new Float32Array(3*c);a.Br=new Float32Array(3*c);ba.pa(e,"NUM_LAMP_LIGHTS",c);for(h=0;h<b.length;h++)n(a,b[h])}}}function n(a,b){if(b.Nc in a.Im){var c=a.Im[b.Nc],d=sa.get_trans_view(b.v.C);
a.Bo.set(d,3*c);a.Cr.set(b.Db.direction,3*c);a.Br.set(b.Db.Gq,3*c)}}function N(a,b){for(var c=0;c<b.length;c++){var d=b[c].settings.b4w_vcol_from_name,e=b[c].settings.b4w_vcol_to_name;""!==d&&""!==e&&(a.Oc[d]={vm:!1,src:[{name:d,Zg:7}]})}}function I(a,b){var c=a.pj;-1==c.indexOf(b)&&c.push(b);a.pj=c.sort()}function x(a,b,c){ba.pa(a.Za,b,c)}function J(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.zb?a.la=pa.OI(b,pa.An,[]):(0<b.kb.length&&pa.mV(b,b.fa[0]),a.Vd=b);else{var c=a.zh;a.rv&&"PARTICLES"!=a.type&&
(b=pa.OP(b));a.ky&&(b=ca.kQ(a.ly,a.my,a.jy));c=pa.OI(b,c,a.Oc);a.la=c;a.we||a.ff||a.cf||(c.fe=null,c.gc.length=0);c=b.fa.length;a.num_vertices=b.Va*c;var d;a:switch(a.zh){case pa.An:case pa.Sp:case pa.at:d=!0;break a;default:d=!1}d?pa.NR(b)?a.num_triangles=b.xa.length/3*c:a.num_triangles=b.Va/3*c:a.num_triangles=0}}function A(a,b,c,d,f,g,h,k,l,m,n,p){var v=a.Fa,q=[],r=k.b4w_dynamic_grass;if(!m&&r)return q;for(var L="INSTANCE"==k.b4w_wind_bend_inheritance,z="INSTANCE"==k.b4w_shadow_inheritance,w="INSTANCE"==
k.b4w_reflection_inheritance,y=[],F=[],ha=0;ha<f.length;ha++){var A=f[ha].Fa.v,t=fa.kz(b);t.Jg=k.b4w_hair_billboard;t.pq=k.b4w_hair_billboard_type;t.oq="SPHERICAL"==k.b4w_hair_billboard_geometry;t.Lc=r;t.Qk=!0;L?(t.Me=A.Me,t.yn=A.yn,t.Sf=A.Sf,t.xf=A.xf,t.Kj=A.Kj,t.wf=A.wf,t.qf=A.qf,t.Rf=A.Rf,t.Se=A.Se,t.Wl=!1):(t.Me=v.v.Me,t.yn=v.v.yn,t.Sf=v.v.Sf,t.xf=v.v.xf,t.Kj=v.v.Kj,t.wf=v.v.wf,t.qf=v.v.qf,t.Rf=v.v.Rf,t.Se=v.v.Se,t.Wl=!0);z?(t.$e=A.$e,t.Ge=A.Ge,t.Td=A.Td):(t.$e=v.v.$e,t.Ge=v.v.Ge,t.Td=v.v.Td);
w?(t.ke=A.ke,t.Rd=A.Rd,t.Qd=A.Qd,t.be=A.be,t.Nd=A.Nd,t.Rh=A.Rh):(t.ke=v.v.ke,t.Rd=v.v.Rd,t.Qd=v.v.Qd,t.be=v.v.be,t.Nd=v.v.Nd,t.Rh=v.v.Rh);y.push(t);var La=h[ha];La||(La=new Float32Array);p&&ga.Cv(l.seed,n);var E=new Float32Array(3),Q=new Float32Array([0,0,0,1]),B=[],G=za.pE(K.EA)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,J=4;G&&(J=8);for(var ma=0;ma<La.length;ma+=J){E[0]=La[ma];E[1]=La[ma+1];E[2]=La[ma+2];var H=La[ma+3]*sa.get_scale(A.C);if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var I=
new Float32Array([ga.fh(n),ga.fh(n),ga.fh(n)]);va.normalize(I,I);break;case "Z":I=new Float32Array([0,0,1]);break;default:ga.I("Unsupported random rotation type: "+k.b4w_rotation_type)}Y.setAxisAngle(I,k.b4w_rand_rotation_strength*(2*Math.PI*ga.fh(n)-Math.PI),Q)}else if(G&&(Q.set(La.subarray(ma+4,ma+8)),ga.sB(Q,Q),!k.use_whole_group))if(k.use_rotation_dupli){var M=sa.get_quat_view(A.C);Y.multiply(Q,M,Q)}else Y.multiply(Q,da,Q);var V=sa.set_sep(E,H,Q,sa.create());B.push(V)}F.push(B)}for(var N={},P=
0,ha=0;ha<f.length;ha++)for(var Xa=f[ha].Fa.kc,ma=0;ma<Xa.length;ma++)Xa[ma].name in N?N[Xa[ma].name]++:(N[Xa[ma].name]=1,P++);for(var P=P?P:1,Da={},ha=0;ha<f.length;ha++){var Ba=f[ha],O=g[ha],t=y[ha],T={};t.Me&&(T.au_wind_bending_amp=[t.Rf],T.au_wind_bending_freq=[t.Sf],T.au_detail_bending_freq=[t.xf],T.au_detail_bending_amp=[t.wf],T.au_branch_bending_amp=[t.qf],t.Rf=0,t.Sf=0,t.xf=0,t.wf=0,t.qf=0);B=F[ha];if(B.length){for(var U=Ba.data,Xa=Ba.Fa.kc,ta=Array(Xa.length),ba=Array(Xa.length),ma=0;ma<
Xa.length;ma++)if(!na(v,ma)&&!pa.$F(U,ma))for(var ya=0;ya<O.length;ya++){var ca=O[ya],W=e(ca),Ta=Xa[ma];"MAIN"==ca?ta[ma]=W:"DEBUG_VIEW"==ca&&(ba[ma]=W);W.Eq=a.b4w_cluster_data.cluster_id;if(C(W,Ta)&&u(W,Ta)){"SHADOW"==ca&&ta[ma]&&(W.xc=ta[ma].xc);W.zh=pa.An;D(W,t);W.Zk=ia(W,t,k.uuid);W.vj=a.b4w_do_not_cull||k.b4w_dynamic_grass;"MAIN"==W.type&&(W.cg=a.b4w_caustics);x(W,"DISABLE_FOG",("COLOR_ID"!=ca&&"SHADOW"!=ca&&a.b4w_disable_fogging)|0);"JITTERED"==k.b4w_hair_billboard_type&&(W.Mv=k.b4w_hair_billboard_jitter_amp,
W.Nv=k.b4w_hair_billboard_jitter_freq);r&&(W.lv=k.b4w_dynamic_grass_scale_threshold);L||(delete W.Oc.a_bending_col_main,delete W.Oc.a_bending_col_detail);var oa=pa.Ku(U,ma,W.pj,b.hi,W.Oc,W.Vi),xa=v.v.C,X=!0;if(1<N[Ta.name]){var Z=0,aa;for(aa in oa.fa)Z++;X=oa.xa.length*B.length*Z*N[Ta.name]>2E5*P}var Wa=K.CD&&X&&"PHYSICS"!=W.type;if(Wa){W.iG=k.use_whole_group?2:1;var ja=pa.TN(oa);pa.eE(oa,ja,B);ja.We={Fs:B,ZB:xa,GI:"STATIC"==b.type,Bx:T,To:{},Bu:r};if(t.Me&&t.Wl){var Aa=va.fromValues(0,0,0);sa.transform_vec3(Aa,
v.v.C,Aa);for(var qa=[],rb=0;rb<B.length;rb++)qa.push(Aa[0],Aa[1],Aa[2]);ja.We.To.a_emitter_center={lc:3,data:qa}}pa.eE(oa,oa,B);"STATIC"==b.type&&pa.bN(ja.$c,xa)}else{var Ea=ja=pa.yS(oa,T,B),la=B;Ea.wa.au_center_pos=new Float32Array(3*Ea.Va);for(var Na=la.length,Ha=Ea.Va/Na,ka=0;ka<Na;ka++)for(var wa=la[ka],Ja=3*Ha*ka,Oa=0;Oa<Ha;Oa++)Ea.wa.au_center_pos[Ja+3*Oa]=wa[0],Ea.wa.au_center_pos[Ja+3*Oa+1]=wa[1],Ea.wa.au_center_pos[Ja+3*Oa+2]=wa[2];ja=Ea;if(t.Me&&t.Wl){var Qa=ja,Ca=v.v.C;Qa.wa.a_emitter_center=
new Float32Array(3*Qa.Va);var Ma=va.fromValues(0,0,0);sa.transform_vec3(Ma,Ca,Ma);for(var tb=0;tb<Qa.Va;tb++)Qa.wa.a_emitter_center[3*tb]=Ma[0],Qa.wa.a_emitter_center[3*tb+1]=Ma[1],Qa.wa.a_emitter_center[3*tb+2]=Ma[2];ja=Qa}}var rc=k.b4w_vcol_from_name,Vc=k.b4w_vcol_to_name,sc=W,Fb=c,Rb=!L,mb=U,Sa=[];if(""!==rc&&""!==Vc){var Xb,dd=void 0,Wc=Vc,ic=sc.Oc,Kc=[];for(dd in ic)for(var Sb=ic[dd].src,Lc=0,nc=0;nc<Sb.length;nc++){var Mc=Sb[nc].Zg;Wc==Sb[nc].name&&Kc.push(dd,Mc,Lc);Lc+=ga.$m(Mc)}Xb=Kc;if(0<
Xb.length)for(var Tb=0;Tb<Xb.length;Tb+=3)Sa.push({br:rc,Du:7,Cw:Xb[Tb],Dw:Xb[Tb+1],Au:Xb[Tb+2]});else pa.nR(sc.pj,"a_color")&&Vc==mb.active_vcol_name&&Sa.push({br:rc,Du:7,Cw:"a_color",Dw:7,Au:0})}Rb&&("a_bending_col_main"in Fb&&Sa.push({br:"a_bending_col_main",Du:4,Cw:"a_bending_col_main",Dw:4,Au:0}),"a_bending_col_detail"in Fb&&Sa.push({br:"a_bending_col_detail",Du:7,Cw:"a_bending_col_detail",Dw:7,Au:0}));for(var Hb=ja,pb=B,oc=d,jb=Sa,Xc=W.Oc,ed=Wa,Nc=!1,wb=0;wb<jb.length;wb++){var xb=jb[wb].br,
Ub=oc.wa[xb];if(Ub&&0<Ub.length){Nc=!0;break}}if(ed)var Yb=Hb.We.To;if(Nc){var Kb,jc=v.v.ra,Lb=oc.fa[0].a_position,ub=pb,Pa=Da,Zb=new Float32Array(3),Nb=new Float32Array(3),bb=new Uint32Array(ub.length);if(!("verts_indices"in Pa)){Pa.nj=new Float32Array(3);Pa.hj=new Float32Array(3);Pa.CC=new Uint32Array(Lb.length/3);Pa.Or=new Uint32Array(Lb.length/3);Pa.nj[0]=(jc.max_x-jc.min_x)/20;Pa.nj[1]=(jc.max_y-jc.min_y)/20;Pa.nj[2]=(jc.max_z-jc.min_z)/20;Pa.hj[0]=jc.min_x;Pa.hj[1]=jc.min_y;Pa.hj[2]=jc.min_z;
for(var $a=0;$a<Lb.length/3;$a++){var $b=Lb[3*$a+1],kc=Lb[3*$a+2],Cc=ga.trunc((Lb[3*$a]-Pa.hj[0])/Pa.nj[0]),Yc=ga.trunc(($b-Pa.hj[1])/Pa.nj[1]),xc=ga.trunc((kc-Pa.hj[2])/Pa.nj[2]),Cc=ga.clamp(Cc,0,19),Yc=ga.clamp(Yc,0,19),xc=ga.clamp(xc,0,19);Pa.CC[$a]=$a;Pa.Or[$a]=xc*Math.pow(20,2)+20*Yc+Cc}pa.VU(Pa.Or,Pa.CC,pa.Ey,!0);Pa.sn=new Uint32Array(Math.pow(20,3));for($a=0;$a<Pa.Or.length;$a++)Pa.sn[Pa.Or[$a]]++;delete Pa.Or;for($a=1;$a<Pa.sn.length;$a++)Pa.sn[$a]+=Pa.sn[$a-1]}for(var tc=0;tc<ub.length;tc++){Zb[0]=
ub[tc][0];Zb[1]=ub[tc][1];Zb[2]=ub[tc][2];for(var qb=1E10,yc=-1,fd=ga.trunc((Zb[0]-Pa.hj[0])/Pa.nj[0]),Zc=ga.trunc((Zb[1]-Pa.hj[1])/Pa.nj[1]),cb=ga.trunc((Zb[2]-Pa.hj[2])/Pa.nj[2]),fd=ga.clamp(fd,0,19),Zc=ga.clamp(Zc,0,19),cb=ga.clamp(cb,0,19),Vb=cb*Math.pow(20,2)+20*Zc+fd,ac=Pa.sn[Vb],bc=0==Vb?0:Pa.sn[Vb-1];bc<ac;bc++){var Dc=Pa.CC[bc];Nb[0]=Lb[3*Dc];Nb[1]=Lb[3*Dc+1];Nb[2]=Lb[3*Dc+2];va.sub(Nb,Zb,Nb);var Wb=va.sqrLen(Nb);Wb<=qb&&(qb=Wb,yc=Dc)}if(-1==yc)for(bc=0;bc<Lb.length/3;bc++)Nb[0]=Lb[3*bc],
Nb[1]=Lb[3*bc+1],Nb[2]=Lb[3*bc+2],va.sub(Nb,Zb,Nb),Wb=va.sqrLen(Nb),Wb<=qb&&(qb=Wb,yc=bc);bb[tc]=yc}Kb=bb;for(var nd=Hb.Va/pb.length,wb=0;wb<jb.length;wb++){var db=jb[wb].Cw,eb=jb[wb].Dw,xb=jb[wb].br,Bd=jb[wb].Du,Ub=oc.wa[xb];switch(db){case "a_bending_col_main":var Oc=1;break;case "a_bending_col_detail":Oc=3;break;case "a_color":Oc=3;break;default:for(var uc=Oc=0;uc<Xc[db].src.length;uc++)Oc+=ga.$m(Xc[db].src[uc].Zg)}if(Ub&&0<Ub.length){var td=ga.$m(Bd),Qd=ga.$m(eb),Cd=Bd&eb,gd=ga.OH(Cd);Cd!=eb&&
ea.error("Wrong color extraction from "+xb+" to "+db+".");if(ed)for(Yb[db]={lc:Oc,data:[]},uc=0;uc<pb.length;uc++)for(Dd=Kb[uc],ud=Dd*td,hc=0;hc<gd.length;hc++)gd[hc]&&(Ec=ga.Zo(Bd,hc),Yb[db].data.push(Ub[ud+Ec]));else{if("a_bending_col_main"==db||"a_bending_col_detail"==db)Hb.wa[db]=new Float32Array(Hb.Va*Qd);for(uc=0;uc<pb.length;uc++){var Dd=Kb[uc],ud=Dd*td,Ed=uc*nd*Oc;if(-1!=Dd)for(var zc=0;zc<nd;zc++)for(var hd=zc*Oc,hc=0;hc<gd.length;hc++)if(gd[hc]){var Ec=ga.Zo(Bd,hc);Hb.wa[db][Ed+hd+(jb[wb].Au+
ga.Zo(eb,hc))]=Ub[ud+Ec]}}}}else Hb.wa[db]=new Float32Array(0)}}ja=Hb;x(W,"USE_INSTANCED_PARTCLS",ja.We?1:0);R(W);q.push({ya:W,qg:b,Ft:t,Vd:ja,ah:[Ta.name],le:[a]})}}for(ma=0;ma<ba.length;ma++)ba[ma]&&(ba[ma].Tn=ta[ma].id,R(ba[ma]))}}return q}function C(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=X.nE(b));return c}function R(a){m(a,function(a){a.id=0;a.id=ga.fE(a)})}function m(a,b){for(var c=null,d=null,e=[],f=0;f<a.ka.length;f++){var g=a.ka[f],h=g.Lg;h&&(c||(c={}),c[f]=h,g.Lg=null);if(h=g.eb)d||(d={}),
d[f]=h,g.eb=null;e.push(g.jH);g.jH=0}g=a.sb;a.sb=null;h=a.df;a.df=null;var k=a.la;a.la=null;var l=a.Vd;a.Vd=null;b(a);a.la=k;a.Vd=l;a.df=h;a.sb=g;if(c)for(f in c)a.ka[f].Lg=c[f];if(d)for(f in d)a.ka[f].eb=d[f];for(f=0;f<a.ka.length;f++)a.ka[f].jH=e[f]}function H(a,b,c,d){var f=e("DEBUG_VIEW");U(f,"debug_view.glslv","debug_view.glslf");f.tj=!0;f.fb=!0;f.Zk=ia(f,a,b);f.qu=c;D(f,a);R(f);if(d.Bl){a=d.sb.nf;var g=va.create();b=ca.Qz(1,g);c=va.fromValues(va.length(a.Qa),va.length(a.Ra),va.length(a.Sa));
pa.TH(b,c,g);var g=va.normalize(a.Qa,ka),h=va.normalize(a.Ra,la),k=va.normalize(a.Sa,ma);!c[0]&&c[1]&&c[2]?va.cross(h,k,g):!c[1]&&c[0]&&c[2]?va.cross(k,g,h):!c[2]&&c[0]&&c[1]&&va.cross(g,h,k);c=ga.DP(g,h,k,L);aa.invert(c,c);c=Y.fromMat3(c,ha);sa.set_quat(c,La);sa.set_scale(1,La);sa.set_trans(a.S,La);pa.bC(b,La)}else a=d.sb.rf,b=ca.Qz(a.ib,a.S);T.ME(d.sb,f.sb);pa.Ax(b,1,!0);b.wa.a_polyindex=pa.Ju(b);J(f,b);return f}function U(a,b,c){a.Za.Of=b;a.Za.xe=c;ba.kU(a.Za)}function O(a,b,c,d){d=d||"";-1==a.Lf.indexOf(c)&&
(a.ka.push(b),a.Lf.push(c),a.pf.push(d));a.pb&&P.KD(a)}function V(a){a.Za||ga.I("No shaders info for batch "+a.name);a.pb=ba.DQ(a.Za);var b=a.Za;if(b.status===ba.lD){var c=a.pb.attributes,d=a.la.Eb,e;for(e in c)d[e]||ga.I('missing data for "'+e+'" attribute')}b.status&ba.cK&&ea.error("Texture limit exceeded for shader - "+b.xe+', materials: "'+a.Xb.join(", ")+'". Maximum texture count: '+Oa.MA+", actual texture count: "+b.Hx);b.status&ba.bK&&ea.error("Fragment uniform limit exceeded for shader - "+
b.xe+', materials: "'+a.Xb.join(", ")+'". ');b.status&ba.fK&&ea.error("Vertex uniform limit exceeded for shader - "+b.Of+', materials: "'+a.Xb.join(", ")+'". ');b.status&ba.eK&&ea.error("Vertex attribute limit exceeded for shader - "+b.Of+', materials: "'+a.Xb.join(", ")+'". Maximum attribute count: '+Oa.NA+", actual attribute count: "+b.At);b.status&ba.dK&&("MAIN"!=a.type||a.vb||ea.error("Varying limit exceeded for shader - "+a.Za.xe+', materials: "'+a.Xb.join(", ")+'"'),"MAIN"==a.type&&a.vb||"NODES_GLOW"==
a.type)&&(d=c=0,a.Vi&&(c=ga.Aj(a.Vi)),a.Oc&&(d=ga.Aj(a.Oc)),ea.error("Varying limit exceeded for node shader - "+a.Za.xe+", uv: "+c+", vc: "+d+', materials: "'+a.Xb.join(", ")+'"'));b.status&ba.$J&&ea.error("Shader compilation/linking error: "+b.Of+", "+b.xe+', materials: "'+a.Xb.join(", ")+'"');return a.Za.status===ba.lD?(P.MM(a.pb),P.zt(a),P.KD(a),!0):!1}function ia(a,b,c){return"NAVMESH"==a.zb?c:b.we?"_odd_id_"+ga.gJ():c}function na(a,b){return 0<=b&&b<a.Xe.Cm.length&&a.Xe.Cm[b]}var T=t("__boundings"),
ja=t("__config"),ea=t("__print"),qa=t("__extensions"),Z=t("__graph"),aa=t("__mat3"),X=t("__nodemat"),fa=t("__obj_util"),Ca=t("__particles"),ca=t("__primitives"),Y=t("__quat"),za=t("__reformer"),P=t("__renderer"),ya=t("__scenegraph"),ba=t("__shaders"),oa=t("__subscene"),W=t("__textures"),sa=t("__tsr"),pa=t("__geometry"),ga=t("__util"),va=t("__vec3"),xa=t("__vec4"),K=ja.K,Oa=ja.xh,Qa=ja.ap,wa=ja.cG,da=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),ka=new Float32Array(3),la=new Float32Array(3),
ma=new Float32Array(3),ha=new Float32Array(4),La=sa.create(),L=aa.create(),Xa={},Ba=new Float32Array(24);a.RM=function(a){return Xa[a]||null};a.SM=function(a,b){Xa[a]=b};a.PN=c;a.BF=function(a,b,c,d){var e;e=a.J.Aa;for(var g=[],h=0;h<b.length;h++){var l=b[h],m=l.Fa;m.xr||g.push.apply(g,k(l,m.v,e))}e=q(g);for(g=0;g<e.length;g++)if(h=e[g].ya,h.Xb=e[g].ah,J(h,e[g].Vd),F(h,c,a),"STATIC"==e[g].v.type&&"COLOR_ID"!=h.type){var l=ga.Is("%meta%"+h.type+"%"+h.Xb.join("%")+"%"),n=fa.Oq(l,"MESH");fa.IS(n,e[g].v);
fa.vt(n,a);fa.Zf(n,a,h);d.push(n);if("MAIN"==h.type)for(m=0;m<e[g].le.length;m++)l=e[g].le[m].Fa,l.Jr.push(n)}else l=e[g].le[0].Fa,fa.Zf(l,a,h);if(K.debug_view){for(g=0;g<e.length;g++)if(c=e[g].v,"DYNAMIC"==c.type&&(l=e[g].le[0].Fa,h=e[g].ya,"MAIN"==h.type)){for(var m=fa.Da(l,a),n=m.Y,p=!1,m=0;m<n.length;m++)n[m].tj&&(p=!0);p||(c=H(c,l.name,!0,h),fa.Zf(l,a,c))}for(g=0;g<d.length;g++)l=d[g],c=l.v,m=fa.Da(l,a),h=m.Y[0],"MAIN"==h.type&&(c=H(c,l.name,!1,h),fa.Zf(l,a,c));for(g=0;g<e.length;g++)h=e[g].ya,
"DEBUG_VIEW"==h.type&&(h.ou=g)}for(g=0;g<b.length;g++)for(m=fa.Da(b[g].Fa,a),n=m.Y,m=0;m<n.length;m++)f(n[m]);for(g=0;g<d.length;g++)for(m=fa.Da(d[g],a),n=m.Y,m=0;m<n.length;m++)f(n[m])};a.yM=function(a,b,d){var g=a.J.Il,h=e("MAIN");U(h,"sky.glslv","sky.glslf");h.Ej=!0;if(b.procedural_skydome)x(h,"PROCEDURAL_SKYDOME",1),h.zu=!0;else{var k=g.cn,l=ya.jc(a.J.Aa,oa.qe).F.hc;O(h,l,"u_sky");k&&(x(h,"WO_SKYTEX",1),k.invert&&x(h,"MTEX_NEGATIVE",1),k.BJ&&x(h,"MTEX_RGBTOINT",1),x(h,"BLENDTYPE",k.XD),k.wJ&&
x(h,"WOMAP_BLEND",1),k.xJ&&x(h,"WOMAP_HORIZ",1),k.zJ&&x(h,"WOMAP_ZENUP",1),k.yJ&&x(h,"WOMAP_ZENDOWN",1));g.mn&&x(h,"WO_SKYBLEND",1);g.nn&&x(h,"WO_SKYPAPER",1);g.on&&x(h,"WO_SKYREAL",1)}b.ke&&(h.ke=!0,b.Rd&&(h.Rd=!0));I(h,"a_position");b=ca.oQ();J(h,b);f(h);h.vj=!0;R(h);fa.Zf(d,a,h);ya.jc(a.J.Aa,oa.ph)&&(g=c(h),g.type="DEBUG_VIEW",g.zb="",v(g),x(g,"DEBUG_VIEW_SPECIAL_SKYDOME",1),b.wa.a_polyindex=pa.Ju(b),J(g,b),g.Tn=h.id,R(g),fa.Zf(d,a,g))};a.fu=function(a,b,d){var e=fa.Da(a,d).Y,f=[],g=ya.jc(b,oa.$d),
h=ya.jc(b,oa.ud),k=ya.jc(b,oa.qh);b=ya.jc(b,oa.Ne);for(var l=0;l<e.length;l++){var m=e[l],n=null;"SHADOW"==m.type&&"RECEIVE"==m.zb&&m.$e&&(n=c(m),n.zb="CAST");"MAIN"!=m.type&&"PARTICLES"!=m.type||!g&&!h||!m.ke||(n=c(m),n.zb="REFLECT",n.Rj=!1,n.ff&&(n.ff=!1,n.fb=!1),n.Ha=m.Ha);"COLOR_ID"==m.type&&k&&a.v.Yc&&(b&&a.v.ll?(n=c(m),n.zb="OUTLINE"):m.zb="OUTLINE");n&&(n.Rg=!0,R(n),f.push(n))}for(e=0;e<f.length;e++)fa.Zf(a,d,f[e])};a.TJ=function(a,b,c){return(b=c*(b.max_z-b.min_z))?.5*(Math.sqrt(2*Math.sqrt(4*
b*Math.tan(a)+1)+2)/2-1)/b:0};a.HW=function(a,b,c){b=c*(b.max_z-b.min_z);if(!b)return 0;a=2*b*a;return Math.atan((Math.pow(a+1,4)-Math.pow(a+1,2))/b)};a.TM=function(a){var b=T.Re();b.max_x=a.max_x;b.min_x=a.min_x;b.max_y=a.max_y;b.min_y=a.min_y;b.max_z=a.max_z;b.min_z=a.min_z;return b};a.DV=G;a.CV=F;a.rU=n;a.JD=function(a,b){x(a,"CSM_SECTION1",0);x(a,"CSM_SECTION2",0);x(a,"CSM_SECTION3",0);x(a,"NUM_CAST_LAMPS",0);if(b){x(a,"NUM_CAST_LAMPS",b.Hh.length);K.$v&&x(a,"MAC_OS_SHADOW_HACK",1);for(var c=
1;c<b.csm_num;c++)x(a,"CSM_SECTION"+String(c),1);x(a,"SHADOW_TEX_RES",ba.W(b.csm_resolution));x(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);x(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else x(a,"SHADOW_TEX_RES",0),x(a,"CSM_FADE_LAST_CASCADE",0),x(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.xb=x;a.hd=function(a,b){return ba.KQ(a.Za,b)};a.AV=J;a.BV=R;a.PV=function(a,b){a.sb.Pe=T.Sy(b,0,b.length,a.sb.Pe);var c=T.mF(a.sb.Pe,Ba);a.sb.nf=T.cu(c,!0);a.sb.rf=T.eu(a.sb.nf);a.Bl=T.lG(a.sb.nf,
a.sb.rf)};a.xt=U;a.rk=O;a.KT=function(a,b,c){c=a.Lf.indexOf(c);-1<c&&(a.ka[c]=b)};a.CO=function(a,b){var c=e("MAIN");c.rb=!0;xa.set(b[0],b[1],b[2],.5,c.ic);c.zh=pa.Sp;J(c,a);U(c,"main.glslv","main_stack.glslf");x(c,"SHADELESS",1);V(c);return c};a.Hc=V;a.AF=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],g=e("LINE");U(g,"line.glslv","line.glslf");g.rb=!0;g.vj=!0;var h=ca.qQ();J(g,h);f(g);fa.vt(d,a);fa.Zf(d,a,g);V(g)}};a.vN=function(a){return a.pb.Sr.length?a.pb.nB.u_cube_fog?!0:!1:!1};a.lO=function(){var a=
e("DEPTH_PACK");a.Oa=!0;a.fb=!1;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");V(a);return a};a.gu=function(a){var b=e("POSTPROCESSING");U(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":x(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":x(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":x(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":case "X_BLOOM_BLUR":case "Y_BLOOM_BLUR":x(b,
"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":x(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":x(b,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":x(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":x(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:ga.I("Wrong postprocessing effect: "+a)}x(b,"SHADOW_USAGE","NO_SHADOWS");b.Oa=!0;b.fb=!1;a=ca.gd();J(b,a);V(b);return b};a.FO=
function(a){var b=e("SSAO");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");x(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.fn);x(b,"SSAO_HEMISPHERE",a.mp?1:0);x(b,"SHADOW_USAGE","NO_SHADOWS");a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=W.Bk(W.rh,!1);
c.source="NODE_TEX";W.Ls(c,a,0);O(b,c,"u_ssao_special_tex");V(b);return b};a.GO=function(a){var b=e("SSAO_BLUR");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");x(b,"SSAO_BLUR_DEPTH",a.jp?1:0);x(b,"SHADOW_USAGE","NO_SHADOWS");V(b);return b};a.gO=function(a){var b=e("COC");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");x(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":x(b,"COC_TYPE",
"COC_ALL");break;case "COC_FOREGROUND":x(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":x(b,"COC_TYPE","COC_COMBINE")}x(b,"SHADOW_USAGE","NO_SHADOWS");V(b);return b};a.mO=function(a){var b=e("DOF");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");a.F.dof_bokeh?x(b,"DOF_TYPE","DOF_BOKEH"):(x(b,"DOF_TYPE","DOF_SIMPLE"),x(b,"DEPTH_RGBA",1));x(b,"SHADOW_USAGE","NO_SHADOWS");V(b);return b};a.uO=function(){var a=e("OUTLINE");a.fb=!1;a.Oa=
!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");V(a);return a};a.oO=function(){var a=e("GLOW_COMBINE");a.fb=!1;a.Oa=!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");V(a);return a};a.pO=function(a,b,c){var d=e("GOD_RAYS");d.fb=!1;d.Oa=!0;var f=ca.jQ();J(d,f);U(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");x(d,"DEPTH_RGBA",a?1:0);x(d,"WATER_EFFECTS",b?1:0);x(d,"STEPS_PER_PASS",ba.W(c,
1));x(d,"SHADOW_USAGE","NO_SHADOWS");V(d);return d};a.qO=function(){var a=e("GOD_RAYS_COM");a.fb=!1;a.Oa=!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");x(a,"SAFARI_CANVAS_ALPHA_HACK",K.SH?1:0);V(a);return a};a.iO=function(a,b){var c=e("SKY");c.fb=!1;c.Oa=!1;var d=ca.tQ();J(c,d);""!=b.ix?(U(c,"skybox.glslv","node_skybox.glslf"),x(c,"IS_WORLD",1),l(c,a)):b.procedural_skydome?(U(c,"skybox.glslv","proc_skybox.glslf"),x(c,"WATER_EFFECTS",1)):
(U(c,"skybox.glslv","tex_skybox.glslf"),a&&(d=a.J.Il,d.kx&&O(c,W.ye(d.kx),"u_sky_texture",d.kx.texture.name),d.cn&&x(c,"WO_SKYTEX",1)),b.hx&&x(c,"MTEX_NEGATIVE",1),b.px&&x(c,"MTEX_RGBTOINT",1),x(c,"BLENDTYPE",b.gx),b.lx&&x(c,"WOMAP_BLEND",1),b.mx&&x(c,"WOMAP_HORIZ",1),b.ox&&x(c,"WOMAP_ZENUP",1),b.nx&&x(c,"WOMAP_ZENDOWN",1),b.mn&&x(c,"WO_SKYBLEND",1),b.nn&&x(c,"WO_SKYPAPER",1),b.on&&x(c,"WO_SKYREAL",1));V(c);return c};a.rM=function(a,b){var c=ya.jc(a.J.Aa,oa.qe);c&&fa.Zf(b,a,c.Xa[0].Ia[0].ya)};a.cO=
function(a){var b=e("ANTIALIASING");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");K.CH?(x(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),x(b,"AA_QUALITY",a.Vu)):x(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");V(b);return b};a.DO=function(a){var b=e("SMAA"),c=ca.gd();J(b,c);U(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");x(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");x(b,"SMAA_PASS",a);x(b,"SMAA_PREDICATION",0);x(b,"SMAA_REPROJECTION",0);
V(b);b.fb=!1;b.Oa=!0;return b};a.hO=function(){var a=e("COMPOSITING");a.fb=!1;a.Oa=!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");V(a);return a};a.tO=function(){var a=e("MOTION_BLUR");a.Oa=!0;a.fb=!1;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");V(a);return a};a.HO=function(a){var b=e("STEREO");b.Oa=!0;b.fb=!1;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");
x(b,"ANAGLYPH","ANAGLYPH"===a?1:0);x(b,"DISTOR_SCALE",wa.nonwebvr.gF);V(b);return b};a.rO=function(){var a=e("LUMINANCE");a.fb=!1;a.Oa=!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");V(a);return a};a.dO=function(){var a=e("LUMINANCE");a.fb=!1;a.Oa=!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");V(a);return a};a.sO=function(a){var b=e("LUMINANCE_X_BLUR");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,
"postprocessing/postprocessing.glslv","postprocessing/luminance_truncated.glslf");a&&ba.pa(b.Za,"ADAPTIVE_BLOOM",1);V(b);return b};a.fO=function(a){var b=e("BLOOM");b.fb=!1;b.Oa=!0;var c=ca.gd();J(b,c);U(b,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");if(1==a)var d="BLUR_PASS_1";else 2==a?d="BLUR_PASS_2":3==a?d="BLUR_PASS_3":4==a?d="BLUR_PASS_4":5==a&&(d="BLUR_PASS_5");ba.pa(b.Za,"BLUR_PASS_NUM",d);V(b);return b};a.eP=function(){var a=e("VELOCITY");a.fb=!1;a.Oa=!0;var b=
ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");V(a);return a};a.bO=function(){var a=e("ANCHOR_VISIBILITY");a.fb=!0;a.Oa=!0;a.zh=pa.Sp;U(a,"anchors.glslv","anchors.glslf");var b=ca.zF(1);J(a,b);x(a,"ANCHOR_NUM",1);V(a);a.Ql=new Float32Array(3);return a};a.wO=function(){var a=e("PERFORMANCE");a.fb=!1;a.Oa=!0;var b=ca.gd();J(a,b);U(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");V(a);return a};a.zV=function(a,b){var c=b.length/3;
if(c!=a.Ql.length/3){var d=ca.zF(c);J(a,d);x(a,"ANCHOR_NUM",c);V(a)}a.Ql=b};a.$u=function(a){if(!a.O.length)return null;a=a.O[0];return a.Y.length?a.Y[0]:null};a.Lu=function(a,b){for(var c=a.O[0].Y,d=0;d<c.length;d++)if("MAIN"==c[d].type&&-1!=c[d].Xb.indexOf(b))return c[d];return null};a.ab=function(a,b,c){a=a.O[0].Y;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].Rg&&-1!=a[d].Xb.indexOf(b))return a[d];return null};a.hg=function(a,b,c){a=a.O[0].Y;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].Rg&&
-1!=a[d].Xb.indexOf(b))return a[d];return null};a.yA=function(a,b,c,d){a=a.O[0].Y;for(var e=0;e<a.length;e++){var f=a[e];if(-1!=f.Xb.indexOf(b)&&(!d||f.type==d)&&c(f))break}};a.VX=function(a,b){for(var c=a.O[0].Y,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.mr=function(a,b){for(var c=(b?fa.Da(a,b):a.O[0]).Y,d=0;d<c.length;d++)if("SKY"==c[d].type)return c[d];return null};a.AE=function(a){var b=a.ka;a.ka=[];for(var c=0;c<b.length;c++)W.zE(b[c]);a.ka=b;a.la&&a.la.Mg&&pa.JN(a.la);a.Mg&&a.df.length&&
P.MN(a);a.pb&&a.pb.Mg&&ba.LN(a.pb);a.ie&&(b=X.fv(a.ie))&&b.yE&&X.KN(a.ie)};a.sQ=ia;a.cleanup=function(){Xa={}}};b4w.module.__nodemat=function(a,t){function e(a,b,f,g,h){var m="";Ta.La()&&(m=Ta.get_active().uuid);m=E(b,h,m);if(m in Ea)return Ea[m];var n={Aa:null,id:m,yE:!0};f||(Ja={},Ma=0);if("SHADOW"!=h&&"COLOR_ID"!=h){b=L.create();for(var q=a.nodes,u=0;u<q.length;u++)if(null==T(b,q[u],0,g,h))return Ea[m]=null,n;if(f&&-1==V(a,b,"GROUP_OUTPUT","group"))return n;u=xa(b);q=f?a.links:a.links.slice();if(!K(b,q,u))return n;if(f)return n.Aa=b,n;for(u=0;u<q.length;u++){f=q[u];for(var x=D(f.from_node,b),w=D(f.to_node,
b),y=0;y<x.length;y++)for(var ha=0;ha<w.length;ha++){var t=x[y],A=w[ha],La=L.Ya(b,t),J=L.Ya(b,A);if(!ga(b,t,A,La,J,f))return Ea[m]=null,n}}v(b);u=!1;q=-1;"GLOW"==h?q=V(a,b,"B4W_GLOW_OUTPUT","material",!0):(q=V(a,b,"OUTPUT","material",!1,!0),-1==q&&(q=V(a,b,"OUTPUT_MATERIAL","material",!1,!0)),-1==q&&(q=V(a,b,"OUTPUT_WORLD","material",!1,!0),u=!0));-1==q&&(b=l(),q=0);F(b);a=L.sl(b,q,L.nk);u?(d(a),r(a,h),p(a),M(a)):(c(a,g),k(a,g));B(a);N(a);H(a);G(a,g,h);la(a)}else g=e(a,b,f,g,"MAIN"),g=L.clone(g.Aa,
function(a){var b=Wa.Dq(a);b.inputs=Wa.V(a.inputs);b.outputs=Wa.V(a.outputs);return b}),q=V(a,g,"OUTPUT","material",!1,!0),-1==q&&(q=V(a,g,"OUTPUT_MATERIAL","material",!1,!0)),z(g,q),a=L.sl(g,q,L.nk),B(a);n.Aa=a;return Ea[m]=n}function c(a,c){var d=[];L.ba(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({Ee:a,node:b})});for(var e=0;e<d.length;++e){var f=d[e].Ee,g=d[e].node,h=L.zj(a);L.th(a,h,g.data.AS);var k=L.zj(a);L.th(a,k,g.data.BS);L.Ec(a,h,k,[4,2]);for(var l={5:["LIGHTING_APPLY",
10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},m=L.zi(a,f),n=[],p=[],v=[],q={},r=0;r<m;r++){var u=L.jg(a,f,r);u in q||(q[u]=0);var x=L.Mc(a,u,f,q[u]++);n.push([u,f,x]);var z=l[x[1]];if(z)switch(z[0]){case "MATERIAL_END":p.push([u,k,[x[0],z[1]]]);break;case "LIGHTING_APPLY":v.push([u,[x[0],z[1]]])}else p.push([u,h,x])}b(a,g.data.value,h,k,v,c);for(r=0;r<n.length;r++)L.Sh(a,n[r][0],n[r][1],n[r][2]);for(r=0;r<p.length;r++)L.Ec(a,p[r][0],p[r][1],p[r][2]);g=
L.rg(a,f);h=[];l=[];m={};for(r=0;r<g;r++)n=L.Ug(a,f,r),n in m||(m[n]=0),x=L.Mc(a,f,n,m[n]++),h.push([f,n,x]),l.push([k,n,x]);for(r=0;r<h.length;r++)L.Sh(a,h[r][0],h[r][1],h[r][2]);for(r=0;r<l.length;r++)L.Ec(a,l[r][0],l[r][1],l[r][2]);L.Hf(a,f)}}function b(a,b,c,d,e,g){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=T(a,h,0,g,null),l=k;f(a,c,k,"E");f(a,c,k,"A");f(a,c,k,"D");k=Ta.get_active();k=Q.Ob(k,"LAMP",Q.DATA_ID_ALL);if(!b.xc)for(var m,n,p,v=0;v<k.length;v++){p=k[v].Db;h={name:"LIGHTING_LAMP",
type:"LIGHTING_LAMP"};m=T(a,h,0,g,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=T(a,h,0,g,null);f(a,l,n,"color");f(a,l,n,"specular");f(a,m,n,"ldir");f(a,c,n,"normal");f(a,c,n,"D");f(a,c,n,"S");f(a,m,n,"lcolorint");f(a,c,m,"shadow_factor");l="SPECULAR_"+b.af;h={name:l,type:l,use_tangent_shading:b.ne};l=T(a,h,0,g,null);f(a,m,l,"ldir");f(a,m,l,"lfac");f(a,c,l,"normal");f(a,l,n,"sfactor");f(a,m,l,"norm_fac");f(a,c,l,"sp_params");l="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Te;h={name:l,type:l,
use_tangent_shading:b.ne};p=T(a,h,0,g,null);f(a,m,p,"ldir");f(a,m,p,"lfac");f(a,c,p,"normal");f(a,m,p,"norm_fac");f(a,p,n,"lfactor");"DIFFUSE_LAMBERT"!=l&&f(a,c,p,"dif_params");for(m=0;m<e.length;m++)L.Ec(a,e[m][0],n,e[m][1]);l=n}f(a,l,d,"color");f(a,l,d,"specular")}function f(a,b,c,d){for(var e=L.Ya(a,b),f=-1,g=L.Ya(a,c).inputs,h=0;h<g.length;h++)if(d==g[h].identifier){f=h;break}if(-1!=f){for(var k=-1,e=e.outputs,h=0;h<e.length;h++)if(d==e[h].identifier){k=h;break}-1!=k&&(L.Ec(a,b,c,[k,f]),e[k].Ja=
!0,g[f].Ja=!0)}}function k(a,b){var c=[];L.ba(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({Ee:a,node:b})});for(var d=0;d<c.length;++d){var e=c[d].Ee,f=c[d].node,g=!1,h=!1,k=L.zj(a);L.th(a,k,f.data.XS);for(var l=L.zi(a,e),m=[],n=[],p={},v=0;v<l;v++){var r=L.jg(a,e,v);r in p||(p[r]=0);var u=L.Mc(a,r,e,p[r]++);m.push([r,e,u]);switch(u[1]){case 0:g=!0;n.push([r,k,u]);break;case 2:var h=!0,x=L.zj(a);L.th(a,x,f.data.tP);n.push([r,x,[u[0],0]])}}for(v=0;v<m.length;v++)L.Sh(a,m[v][0],m[v][1],m[v][2]);
for(v=0;v<n.length;v++)L.Ec(a,n[v][0],n[v][1],n[v][2]);L.Hf(a,e);g?(h&&q(a,k,x),y(a,b)):(e=L.Ya(a,k),a.Z=[0,e],a.Ca=[])}}function q(a,b,c){b=L.sl(a,b,L.nk);var d=u(b);if(d.length){c=L.sl(a,c,L.nk);c=L.clone(c,na,pa);L.ba(c,function(a,b){b.name="displacement%join%"+b.name});L.FD(c,b,[],[]);var e=-1;L.ba(b,function(a,b){if("DISPLACEMENT_BUMP"==b.type)return e=a,1});for(c=0;c<d.length;c++){var g=d[c],k=L.Ya(b,g);f(b,e,g,"Normal");h(k)}}a.Z=b.Z;a.Ca=b.Ca}function h(a){a=a.Wa;for(var b=0;b<a.length;b++){var c=
a[b];"USE_NORMAL_IN"==c[0]&&(c[1]=1)}}function u(a){var b=[];L.ba(a,function(a,c){for(var d=!1,e=c.inputs,f=0;f<e.length;f++)if("Normal"==e[f].identifier){d=!e[f].Ja;break}d&&b.push(a)});return b}function y(a,b){var c=[];L.ba(a,function(a,b){"OUTPUT_SURFACE"==b.type&&c.push({Ee:a,node:b})});var d=[];c.length&&L.ba(a,function(a,b){"MIX_SHADER"==b.type&&d.push({Ee:a,node:b})});for(var e=0;e<c.length;++e){var f=c[e].Ee,h=c[e].node,k=L.zj(a);L.th(a,k,h.data.eN);var l=L.zj(a);L.th(a,l,h.data.fN);L.Ec(a,
k,l,[4,2]);for(var m=L.zi(a,f),n=[],p=[],v={},q=0;q<m;q++){var r=L.jg(a,f,q),u=L.Ya(a,r);r in v||(v[r]=0);var x=L.Mc(a,r,f,v[r]++);n.push([r,f,x]);p.push([r,k,x]);if("BSDF_GLOSSY"==u.type||"BSDF_DIFFUSE"==u.type||"MIX_SHADER"==u.type||"EMISSION"==u.type||"BSDF_TRANSPARENT"==u.type)for(p.push([r,k,[1,1]]),p.push([r,k,[2,2]]),p.push([r,k,[3,3]]),p.push([r,k,[4,4]]),p.push([r,k,[5,5]]),p.push([r,k,[6,6]]),p.push([r,k,[7,7]]),p.push([r,k,[8,8]]),p.push([r,k,[9,9]]),p.push([r,k,[10,10]]),r=0;r<d.length;++r)for(var u=
d[r].Ee,x=L.zi(a,u),z=0;z<x;z++){var w=L.jg(a,u,z),y=L.Ya(a,w),ha=L.Mc(a,w,u,0);0==ha[1]||"BSDF_GLOSSY"!=y.type&&"BSDF_DIFFUSE"!=y.type&&"MIX_SHADER"!=y.type&&"EMISSION"!=y.type&&"BSDF_TRANSPARENT"!=y.type||(y=1==ha[1]?3:13,p.push([w,u,[1,y]]),p.push([w,u,[2,y+1]]),p.push([w,u,[3,y+2]]),p.push([w,u,[4,y+3]]),p.push([w,u,[5,y+4]]),p.push([w,u,[6,y+5]]),p.push([w,u,[7,y+6]]),p.push([w,u,[8,y+7]]),p.push([w,u,[9,y+8]]),p.push([w,u,[10,y+9]]))}}g(a,h.data.value,k,l,b);p.push([l,f,[0,0]]);for(q=0;q<n.length;q++)L.Sh(a,
n[q][0],n[q][1],n[q][2]);for(q=0;q<p.length;q++)L.Ec(a,p[q][0],p[q][1],p[q][2])}}function g(a,b,c,d,e){var g=[],h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=T(a,h,0,e,null),l=k;f(a,c,k,"E");f(a,c,k,"A");f(a,c,k,"D");for(var k=Ta.get_active(),k=Q.Ob(k,"LAMP",Q.DATA_ID_ALL),m,n,p=0;p<k.length;p++){h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};m=T(a,h,0,e,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=T(a,h,0,e,null);f(a,l,n,"color");f(a,l,n,"specular");f(a,m,n,"ldir");f(a,c,n,"normal");
f(a,c,n,"D");f(a,c,n,"S");f(a,m,n,"lcolorint");f(a,c,m,"shadow_factor");l=b.gN;h={name:l,type:l};l=T(a,h,0,e,null);f(a,m,l,"ldir");f(a,m,l,"lfac");f(a,c,l,"normal");f(a,m,l,"norm_fac");f(a,c,l,"bsdf_params");f(a,l,n,"lfactor");f(a,l,n,"sfactor");for(l=0;l<g.length;l++)L.Ec(a,g[l][0],n,g[l][1]);l=n}f(a,c,d,"bsdf_params");f(a,c,d,"d_color");f(a,c,d,"s_color");f(a,c,d,"e_color");f(a,c,d,"emission");f(a,c,d,"a_color");f(a,c,d,"alpha");f(a,l,d,"color");f(a,l,d,"specular")}function d(a){var b=[];L.ba(a,
function(a,c){"OUTPUT_WORLD"==c.type&&b.push({Ee:a,node:c})});for(var c=0;c<b.length;++c){var d=b[c].Ee,e=b[c].node,f=L.zj(a);L.th(a,f,e.data.YS);for(var e=L.zi(a,d),g=[],h=[],k={},l=0;l<e;l++){var m=L.jg(a,d,l);m in k||(k[m]=0);var n=L.Mc(a,m,d,k[m]++);g.push([m,d,n]);switch(n[1]){case 0:h.push([m,f,n])}}for(l=0;l<g.length;l++)L.Sh(a,g[l][0],g[l][1],g[l][2]);for(l=0;l<h.length;l++)L.Ec(a,h[l][0],h[l][1],h[l][2]);L.Hf(a,d)}}function r(a,b){var c=[];L.ba(a,function(a,b){"MIX_SHADER"!=b.type&&"ADD_SHADER"!=
b.type||c.push({Ee:a,node:b})});if(c.length)for(var d={name:"RGB_WORLD_NODE",type:"RGB_WORLD_NODE",factor:.5},e=0;e<c.length;e++){var f=c[e].Ee,g=c[e].node;d.name=g.name;d.fac=g.inputs[0].Ga;d.fac_is_linked=g.inputs[0].Ja;d.color1_is_linked=g.inputs[1].Ja;d.color2_is_linked=g.inputs[2].Ja;switch(g.type){case "ADD_SHADER":d.type="ADD_WORLD_RGB";break;case "MIX_SHADER":d.type="MIX_WORLD_RGB"}for(var g=T(a,d,0,"",b),h=L.zi(a,f),k=[],l=[],m={},n=0;n<h;n++){var p=L.jg(a,f,n);p in m||(m[p]=0);var v=L.Mc(a,
p,f,m[p]++);k.push([p,f,v]);l.push([p,g,v])}for(n=0;n<k.length;n++)L.Sh(a,k[n][0],k[n][1],k[n][2]);for(n=0;n<l.length;n++)L.Ec(a,l[n][0],l[n][1],l[n][2]);h=L.rg(a,f);k=[];l=[];m={};for(n=0;n<h;n++)p=L.Ug(a,f,n),p in m||(m[p]=0),v=L.Mc(a,f,p,m[p]++),k.push([f,p,v]),l.push([g,p,v]);for(n=0;n<k.length;n++)L.Sh(a,k[n][0],k[n][1],k[n][2]);for(n=0;n<l.length;n++)L.Ec(a,l[n][0],l[n][1],l[n][2]);L.Hf(a,f)}}function p(a){var b=-1,c=[],d=[],e="OUTPUT_WORLD_SURFACE BACKGROUND RGB VALUE ADD_WORLD_RGB MIX_WORLD_RGB TEXTURE_ENVIRONMENT_EQUIRECTANGULAR TEXTURE_ENVIRONMENT_MIRROR_BALL GEOMETRY_NO GEOMETRY_TRN GEOMETRY_GL GEOMETRY_IN TEXTURE_COLOR TEX_COORD_GE TEX_COORD_OB TEX_COORD_NO COMBRGB COMBHSV CURVE_RGB CURVE_VEC B4W_LINEAR_TO_SRGB B4W_NORMAL_VIEW B4W_VECTOR_VIEW B4W_SRGB_TO_LINEAR B4W_REFLECT B4W_CLAMP B4W_TIME B4W_SMOOTHSTEP NORMAL MAPPING MATH_ADD MATH_SUBTRACT MATH_MULTIPLY MATH_DIVIDE MATH_SINE MATH_COSINE MATH_TANGENT MATH_ARCSINE MATH_ARCCOSINE MATH_ARCTANGENT MATH_POWER MATH_LOGARITHM MATH_MINIMUM MATH_MAXIMUM MATH_ROUND MATH_LESS_THAN MATH_GREATER_THAN MATH_MODULO MATH_ABSOLUTE MIX_RGB_MIX MIX_RGB_ADD MIX_RGB_MULTIPLY MIX_RGB_SUBTRACT MIX_RGB_SCREEN MIX_RGB_DIVIDE MIX_RGB_DIFFERENCE MIX_RGB_DARKEN MIX_RGB_LIGHTEN MIX_RGB_OVERLAY MIX_RGB_DODGE MIX_RGB_BURN MIX_RGB_HUE MIX_RGB_SATURATION MIX_RGB_VALUE MIX_RGB_COLOR MIX_RGB_SOFT_LIGHT MIX_RGB_LINEAR_LIGHT SEPRGB SEPHSV VALTORGB VECT_TRANSFORM VECT_MATH_ADD VECT_MATH_SUBTRACT VECT_MATH_AVERAGE VECT_MATH_DOT_PRODUCT VECT_MATH_CROSS_PRODUCT VECT_MATH_NORMALIZE".split(" ");
L.ba(a,function(a,d){switch(e.indexOf(d.type)){case -1:c.push({Ee:a,node:d});break;case 0:b=a}});for(var f=0;f<c.length;f++)for(var g=c[f].Ee,h=L.rg(a,g),k={},l=0;l<h;l++){var m=L.Ug(a,g,l);m in k||(k[m]=0);var n=L.Mc(a,g,m,k[m]++);d.push([g,m,n])}for(f=0;f<d.length;f++)L.Sh(a,d[f][0],d[f][1],d[f][2]);d.length&&(d=L.sl(a,b,L.nk),a.Z=d.Z,a.Ca=d.Ca)}function M(a){var b=-1,c=[],d=[];L.ba(a,function(a,d){switch(d.type){case "ADD_WORLD_RGB":case "MIX_WORLD_RGB":var e={Ee:a,node:d};c.push(e);break;case "OUTPUT_WORLD_SURFACE":b=
a,e={Ee:a,node:d},c.push(e)}});for(var e=0;e<c.length;e++)for(var f=c[e].Ee,g=c[e].node,h=L.zi(a,f),k={},l=0;l<h;l++){var m=L.jg(a,f,l),n=L.Ya(a,m);m in k||(k[m]=0);var p=L.Mc(a,m,f,k[m]++);"OUTPUT_WORLD_SURFACE"!=g.type&&0==p[1]||"ADD_WORLD_RGB"==n.type||"MIX_WORLD_RGB"==n.type||"BACKGROUND"==n.type||d.push([m,f,p])}for(e=0;e<d.length;e++)L.Sh(a,d[e][0],d[e][1],d[e][2]);d.length&&(d=L.sl(a,b,L.nk),a.Z=d.Z,a.Ca=d.Ca)}function E(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+
c+"00";default:return a+c+"10"}}function z(a,b){L.mh(a,function(c,d,e){var f=L.Ya(a,d);d==b&&"Color"==f.inputs[e[1]].identifier&&L.Sh(a,c,d,e)})}function l(){var a=L.create();L.th(a,0,{data:null,Wa:[],$:[],inputs:[{Ga:new Float32Array([0,0,0]),identifier:"Color",Ja:!1,name:"Color"},{Ga:1,identifier:"Alpha",Ja:!1,name:"Alpha"}],outputs:[],type:"OUTPUT",Le:[]});return a}function B(a){L.ba(a,function(b,c){for(var d=c.inputs,e=c.outputs,f=0;f<d.length;f++)w(a,d[f],b,f,1);for(f=0;f<e.length;f++)w(a,e[f],
b,f,0)})}function w(a,b,c,d,e){if(b.Ja){var f=!0;L.mh(a,function(a,b,g){if(!e&&a==c&&g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.Ja=!1)}}function G(a,b,c){var d=[];L.mh(a,function(e,f,g){var h=L.Ya(a,e),k=L.Ya(a,f),h=Wa.is_vector(h.outputs[g[0]].Ga),k=Wa.is_vector(k.inputs[g[1]].Ga);if(h!=k){var l,m={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!k?l=ia("vector_to_scalar","B4W_VECTOSCAL",[m],[n]):!h&&k&&(l=ia("scalar_to_vector",
"B4W_SCALTOVEC",[n],[m]));T(a,l,0,b,c);d.push([e,f,a.Z[a.Z.length-2],g])}});for(var e=0;e<d.length;++e)L.Sh(a,d[e][0],d[e][1],d[e][3]),L.Ec(a,d[e][0],d[e][2],[d[e][3][0],0]),L.Ec(a,d[e][2],d[e][1],[0,d[e][3][1]])}function v(a){var b=[];L.ba(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":L.mh(a,function(e,f,g){var h=L.Ya(a,f);e==c&&"MATERIAL_EXT"==h.type&&"Translucency"==d.outputs[g[0]].name&&b.push(e,f,[g[0]+1,g[1]+1])})}});for(var c=0;c<b.length;c+=3)L.Ec(a,b[c],b[c+1],b[c+2])}function D(a,
b){var c=[];L.ba(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;Wa.I("Node not found")}function F(a){var b=[];L.ba(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type)n(a,d,e);else if("REROUTE"==e.type){for(var f=L.jg(a,d,0),g=L.rg(a,d),h=[],k=[],l=[],m=0;m<g;m++){var p=L.Ug(a,d,m),v=k.indexOf(p),q=L.Mc(a,d,p,0<=v?l[v]:0);if(q){var q=q[1],r=e.inputs[0].Ga,q=L.Ya(a,p).inputs[q];switch(typeof r){case "number":if("object"==
typeof q.Ga)for(var u=q.Ga,q=0;q<u.length;q++)u[q]=r;else"number"==typeof q.Ga&&(q.Ga=r);break;case "object":if("object"==typeof q.Ga)for(u=q.Ga,q=0;q<u.length;q++)u[q]=r[q];else"number"==typeof q.Ga&&(q.Ga=.35*r[0]+.45*r[1]+.2*r[2])}}r=e.outputs;for(q=0;q<r.length;q++)r[q].Ga=e.inputs[0].Ga;-1!=v?l[v]+=1:(k.push(p),l.push(1),h.push(d,p))}if(-1!=f)for(e=L.Mc(a,f,d,0)[0],m=0;m<k.length;m++)for(q=0;q<l[m];q++)g=L.Mc(a,d,k[m],q)[1],L.Ec(a,f,k[m],[e,g]);for(m=0;m<h.length;m+=2)L.kl(a,h[m],h[m+1],-1)}}}
function n(a,b,c){var d;a:{d=a.Ca;for(var e=0;e<d.length;e+=3)if(d[e+1]==b&&1==d[e+2][1]){d=d[e];break a}d=-1}-1!=d&&(e=L.Ya(a,d),c.data=e.data,L.kl(a,d,b,-1),0==L.rg(a,d)&&(b=L.jg(a,d,0),-1!=b&&L.kl(a,b,d,-1),L.Hf(a,d)));c.inputs.splice(1,1)}function N(a){J(a);R(a);I(a)}function I(a){var b={};L.ba(a,function(a,c){if("GEOMETRY_UV"==c.type||"UVMAP"==c.type||"TEX_COORD_UV"==c.type){var d=c.data.value;d in b||(b[d]=[]);b[d].push(a,c)}});for(var c in b){var d=b[c];if(2<d.length)for(var e=x(c),e=T(a,e,
0,"",void 0),f=L.Ya(a,e),g=0;g<d.length;g+=2){for(var h=d[g],k=d[g+1],l=[],m={},n=L.rg(a,h),p=0;p<n;p++){var v=L.Ug(a,h,p);v in m||(m[v]=0);var q=L.Mc(a,h,v,m[v]);m[v]++;l.push(h,v,q);q=q.splice(0,q.length);switch(k.type){case "GEOMETRY_UV":q[0]=0;f.outputs[0].Ja=!0;break;case "UVMAP":case "TEX_COORD_UV":q[0]=1,f.outputs[1].Ja=!0}L.Ec(a,e,v,q)}for(p=0;p<l.length;p+=3)L.kl(a,l[p],l[p+1],0);L.Hf(a,h)}}}function x(a){var b=ia("merged_uv","UV_MERGED",[],[{default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,
name:"UV_geom"},{default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"}]);b.uv_layer=a;return b}function J(a){var b=[];L.ba(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(m(f,k.$f)){for(var g=[],
h=L.rg(a,e),l=0;l<h;l++){var n=L.Ug(a,e,l),p=L.Mc(a,e,n,0);g.push(e,n,p);L.Ec(a,k.id,n,p)}for(l=0;l<g.length;l+=3)L.kl(a,g[l],g[l+1],0);L.Hf(a,e);g=!1;break}}g&&(k={id:e,$f:f},c.push(k))}}function A(a){for(var b={},c=0;c<a.Z.length;c+=2){var d=a.Z[c];b[d]={hq:{},qG:!1}}for(c=0;c<a.Ca.length;c+=3)b[a.Ca[c+1]].hq[a.Ca[c]]=!0;for(d in b)C(d,b);for(d in b)b[d]=Object.keys(b[d].hq).map(function(a){return parseInt(a,10)});return b}function C(a,b){var c=b[a];if(!c.qG){var d=Wa.V(c),e;for(e in c.hq){C(e,
b);var c=b[e],f;for(f in c.hq)d.hq[f]=!0}d.qG=!0;b[a]=d}}function R(a){var b=[];L.ba(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=A(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<d.length;k++){var l=d[k];if(!(3<=l.Fo.length||!m(g,l.$f)||-1<c[f].indexOf(l.id)||-1<c[l.id].indexOf(f))){for(var n=!1,p=0;p<l.Fo.length;p++){var v=l.Fo[p].id;if(-1<c[f].indexOf(v)||-1<c[v].indexOf(f)){n=!0;break}}if(!n){for(var k=[],v=L.zi(a,f),q=
{},p=0;p<v;p++)n=L.jg(a,f,p),n in q||(q[n]=0),h=L.Mc(a,n,f,q[n]++),k.push(n,f,h);for(var v=[],q=L.rg(a,f),r={},p=0;p<q;p++)n=L.Ug(a,f,p),n in r||(r[n]=0),h=L.Mc(a,f,n,r[n]++),v.push(f,n,h);h=k.concat(v);for(p=0;p<h.length;p+=3)L.kl(a,h[p],h[p+1],0);L.Hf(a,f);p={id:f,$f:g,BP:k,CP:v};l.Fo.push(p);h=!1;break}}}h&&(l={id:f,$f:g,Fo:[]},d.push(l))}for(e=0;e<d.length;e++){l=d[e];c=l.Fo.length;for(k=0;k<c;k++){g=l.Fo[k];p=g.$f;f=g.BP;g=g.CP;l.$f.inputs[k+1].Ja=p.inputs[0].Ja;l.$f.inputs[k+1].Ga=p.inputs[0].Ga;
l.$f.outputs[2*(k+1)].Ja=p.outputs[0].Ja;l.$f.outputs[2*(k+1)].Ga=p.outputs[0].Ga;l.$f.outputs[2*(k+1)+1].Ja=p.outputs[1].Ja;l.$f.outputs[2*(k+1)+1].Ga=p.outputs[1].Ga;for(p=0;p<f.length;p+=3)n=f[p],h=f[p+2],h[1]+=k+1,L.Ec(a,n,l.id,h);for(p=0;p<g.length;p+=3)n=g[p+1],h=g[p+2],h[0]+=2*(k+1),L.Ec(a,l.id,n,h);l.$f.Wa.push(["USE_uv"+(k+2),1])}L.Hf(a,l.id);L.th(a,l.id,l.$f)}}}function m(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":for(var c=
a.Wa,d=-1,e=0;e<c.length;e++){var f=c[e];if("USE_NORMAL_IN"==f[0]){d=f[1];break}}c=b.Wa;f=-1;for(e=0;e<c.length;e++){var g=c[e];if("USE_NORMAL_IN"==g[0]){f=g[1];break}}return d===f;case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.Lt==b.data.Lt&&a.data.value.ym==b.data.value.ym;case "VALUE":case "RGB":return a.Ed==b.Ed;default:return!1}}function H(a){var b=
[],c=[];L.ba(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});U(a,b);O(a,c)}function U(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],k=[[],[],[]],l=L.rg(a,d),m=0;m<l;m++){var n=L.Ug(a,d,m);if("SEPRGB"!=L.Ya(a,n).type){f=!1;break}g.push(d,n);for(var p={},v=L.rg(a,n),f=0;f<v;f++){var q=L.Ug(a,n,f);q in p||(p[q]=0);var r=L.Mc(a,n,q,p[q]++);g.push(n,q);k[r[0]].push(d,q,r)}h.push(n);f=!0}if(f){for(m=d=l=0;m<k.length;m++)k[m].length&&(l++,
d|=1<<2-m);if(l){e.type+=l;e.outputs=[];for(m=0;m<k.length;m++)if(k[m].length)for(e.outputs.push({Ga:0,identifier:"RGB"[m],Ja:!0,name:"RGB"[m]}),f=0;f<k[m].length;f+=3)k[m][f+2][0]=Wa.Zo(d,m);for(m=0;m<g.length;m+=2)L.kl(a,g[m],g[m+1],0);for(m=0;m<h.length;m++)L.Hf(a,h[m]);for(m=0;m<k.length;m++)for(f=0;f<k[m].length;f+=3)L.Ec(a,k[m][f],k[m][f+1],k[m][f+2])}}}}function O(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,f=[],g=L.rg(a,d),h=0;h<g;h++){var k=L.Ug(a,d,h);if("B4W_REFLECT"==L.Ya(a,
k).type){var l=L.Mc(a,d,k,0),m=L.Mc(a,d,k,1);l&&1==l[1]||m&&1==m[1]?e=!1:f.push(d,k)}else e=!1}for(h=0;h<f.length;h+=2)g=a,l=f[h],k=f[h+1],m=L.Ya(g,k),m.type+="_WORLD",L.kl(g,l,k,0),m.inputs.splice(0,1),l=L.jg(g,k,0),l!=L.Cy&&(L.Mc(g,l,k,0)[1]=0);e&&L.Hf(a,d)}}function V(a,b,c,d,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];e?"GROUP"==k.type&&k.node_tree_name==c&&(g=k):k.type==c&&(g=k)}return g?D(g,b)[0]:(f||Da.error('No "'+c+'" node in node '+d),-1)}function ia(a,b,c,d){return{name:a,
type:b,inputs:c,outputs:d}}function na(a){var b={name:"",Ed:"",type:"",Le:[],inputs:[],outputs:[],$:[],data:null,Wa:[]};b.name=a.name;b.Ed=a.Ed;b.type=a.type;for(var c=b.Le,d=a.Le,e=0;e<d.length;e++)c.push(sa(d[e]));c=b.$;d=a.$;for(e=0;e<d.length;e++)c.push(sa(d[e]));c=b.inputs;d=a.inputs;for(e=0;e<d.length;e++)c.push(ya(d[e]));c=b.outputs;d=a.outputs;for(e=0;e<d.length;e++)c.push(ya(d[e]));c=b.Wa;d=a.Wa;for(e=0;e<d.length;e++)c.push(d[e].slice());b.data=a.data;return b}function T(a,b,c,d,e){var f=
b.name,g=b.name,h=b.type,k=[],l=[],m=[],n=[],p=null,v=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":l=
ba(b);m=oa(b);Da.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":l=ba(b);m=oa(b);break;case "MIX_SHADER":l.push(ca(b,"Fac"));var q=ca(b,"Shader"),m=q.Ja;l.push(q);(q=ca(b,"Shader_001"))||(q=ca(b,"Shader.001"));var r=q.Ja;l.push(q);l.push(P("d_color1","d_color1",[0,0,0],m));l.push(P("d_roughness1","d_roughness1",0,m));l.push(P("s_color1","s_color1",[0,0,0],m));l.push(P("s_roughness1","s_roughness1",0,m));l.push(P("metalness1","metalness1",0,m));l.push(P("normal1",
"normal1",[0,0,0],m));l.push(P("e_color1","e_color1",[0,0,0],m));l.push(P("emission1","emission1",0,m));l.push(P("a_color1","a_color1",[0,0,0],m));l.push(P("alpha1","alpha1",1,m));l.push(P("d_color2","d_color2",[0,0,0],r));l.push(P("d_roughness2","d_roughness2",0,r));l.push(P("s_color2","s_color2",[0,0,0],r));l.push(P("s_roughness2","s_roughness2",0,r));l.push(P("metalness2","metalness2",0,r));l.push(P("normal2","normal2",[0,0,0],r));l.push(P("e_color2","e_color2",[0,0,0],r));l.push(P("emission2",
"emission2",0,r));l.push(P("a_color2","a_color2",[0,0,0],r));l.push(P("alpha2","alpha2",1,r));m=Y(b,"Shader");q=m.Ja;m=[m,P("d_color","d_color",[0,0,0],q),P("d_roughness","d_roughness",0,q),P("s_color","s_color",[0,0,0],q),P("s_roughness","s_roughness",0,q),P("metalness","metalness",0,q),P("normal","normal",[0,0,0],q),P("e_color","e_color",[0,0,0],q),P("emission","emission",0,q),P("a_color","a_color",[0,0,0],q),P("alpha","alpha",1,q)];break;case "OBJECT_INFO":var l=ba(b),m=[],q=Y(b,"Location"),r=
Y(b,"Object Index"),u=Y(b,"Material Index"),x=Y(b,"Random");m.push(q);m.push(r);m.push(u);m.push(x);v.push(["USE_LOCATION_OUT",q.Ja|0]);v.push(["USE_OBJ_IND_OUT",r.Ja|0]);v.push(["USE_MAT_IND_OUT",u.Ja|0]);v.push(["USE_RANDOM_OUT",x.Ja|0]);break;case "UVMAP":(q=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=Z("param_"+h+"_a"),r=Z("param_"+h+"_v"),k.push(W(p)),k.push(W(r)),n.push(W(r)),p={name:p,value:q});m=oa(b);break;case "UV_MERGED":p=Z("param_UV_MERGED_a");r=Z("param_UV_MERGED_v");k.push(W(p));
k.push(W(r));m.push(Y(b,"UV_geom"));m.push(Y(b,"UV_cycles"));n.push(W(r));p={name:p,value:b.uv_layer};break;case "CAMERA":l=[];m=oa(b);break;case "COMBRGB":case "COMBHSV":l=ba(b);m=oa(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==h?(ma(b,0,0)&&v.push(["READ_R",1]),ma(b,1,0)&&v.push(["READ_G",1]),ma(b,2,0)&&v.push(["READ_B",1]),ma(b,3,0)&&v.push(["READ_A",1])):(ma(b,0,-1)&&v.push(["READ_R",1]),ma(b,1,-1)&&v.push(["READ_G",1]),ma(b,2,-1)&&v.push(["READ_B",1]));l=ba(b);m=oa(b);p={value:b};
break;case "PARTICLE_INFO":l=ba(b);m=oa(b);for(r=0;r<b.outputs.length;r++){var u=b.outputs[r],x=u.identifier,z=W("v_param_PART_INFO_"+x.replace(" ",""));if(u.is_linked)switch(x){case "Size":v.push(["PART_INFO_SIZE",ta.W(1)]);break;case "Age":v.push(["PART_INFO_AGE",ta.W(1)]);break;case "Lifetime":v.push(["PART_INFO_LT",ta.W(1)]);break;case "Location":v.push(["PART_INFO_LOC",ta.W(1)]);break;case "Index":p=q=W("a_param_PART_INFO_"+u.identifier.replace(" ",""));v.push(["PART_INFO_IND",ta.W(1)]);break;
case "Velocity":v.push(["PART_INFO_VEL",ta.W(1)]);break;case "Angular Velocity":v.push(["PART_INFO_A_VEL",ta.W(1)])}"Age"!=x&&"Lifetime"!=x&&"Size"!=x&&(k.push(z),n.push(z))}q&&k.push(q);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!aa(b))return!0;h=X(b,c);if(!h)return Da.error("Geometry output is not supported"),null;switch(h){case "GEOMETRY_UV":(q=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=Z("param_GEOMETRY_UV_a"),r=Z("param_GEOMETRY_UV_v"),k.push(W(p)),k.push(W(r)),n.push(W(r)),p={name:p,value:q});
m.push(Y(b,"UV"));break;case "GEOMETRY_VC":(q=b.color_layer)||(h="EMPTY_VC");"EMPTY_VC"!=h&&(p=Z("param_GEOMETRY_VC_a"),r=Z("param_GEOMETRY_VC_v"),k.push(W(p)),k.push(W(r)),n.push(W(r)),p={name:p,value:q});m.push(Y(b,"Vertex Color"));break;case "GEOMETRY_NO":l.push(P("Normal","Normal",[0,0,0],!1));v.push(["USE_NORMAL_IN",0]);m.push(Y(b,"Normal"));break;case "GEOMETRY_TRN":h="GEOMETRY_NO";l.push(P("Normal","Normal",[0,0,0],!1));m.push(Y(b,"True Normal"));v.push(["USE_NORMAL_IN",0]);Da.warn("Geometry True Normal output is not fully supported.");
break;case "GEOMETRY_FB":m.push(Y(b,"Front/Back"));break;case "GEOMETRY_VW":m.push(Y(b,"View"));break;case "GEOMETRY_GL":m.push(Y(b,"Global")||Y(b,"Position"));break;case "GEOMETRY_LO":m.push(Y(b,"Local"));break;case "GEOMETRY_OR":q=Z("param_GEOMETRY_OR_v");k.push(W(q));m.push(Y(b,"Orco"));n.push(W(q));break;case "GEOMETRY_IN":m.push(Y(b,"Incoming"));break;case "GEOMETRY_BF":m.push(Y(b,"Backfacing"))}break;case "TEX_COORD":if(!aa(b))return!0;h=fa(b,c);switch(h){case "TEX_COORD_UV":(q=b.uv_layer)||
(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=Z("param_TEX_COORD_UV_a"),r=Z("param_TEX_COORD_UV_v"),k.push(W(p)),k.push(W(r)),n.push(W(r)),p={name:p,value:b.uv_layer});m.push(Y(b,"UV"));break;case "TEX_COORD_NO":m.push(Y(b,"Normal"));break;case "TEX_COORD_GE":q=Z("param_TEX_COORD_GE_v");k.push(W(q));m.push(Y(b,"Generated"));n.push(W(q));break;case "TEX_COORD_OB":m.push(Y(b,"Object"));break;case "TEX_COORD_CA":m.push(Y(b,"Camera"));break;case "TEX_COORD_WI":m.push(Y(b,"Window"));break;case "TEX_COORD_RE":m.push(Y(b,
"Reflection"))}break;case "GROUP":q=b.node_tree_name;switch(q){case "B4W_LINEAR_TO_SRGB":if(!ja(b,[1],[1])){p=ea(b,d,e);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!ja(b,[1],[1])){p=ea(b,d,e);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!ja(b,[1],[1])){p=ea(b,d,e);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!ja(b,[1,1],[1])){p=ea(b,d,e);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!ja(b,[1,0],[1])){p=ea(b,d,e);break}h="B4W_REFRACTION";
break;case "B4W_PARALLAX":if(!ja(b,[1,1,0,0,0],[1])){p=ea(b,d,e);break}r=Z("param_B4W_PARALLAX_texture");n.push(W(r));h="B4W_PARALLAX";break;case "B4W_CLAMP":if(!ja(b,[1],[1])){p=ea(b,d,e);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!ja(b,[0,0,0,0,0],[0])){p=ea(b,d,e);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!ja(b,[],[0])){p=ea(b,d,e);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!ja(b,[0,0,0],[0])){p=ea(b,d,e);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";
break;default:p=ea(b,d,e)}l=ba(b);m=oa(b);"B4W_TRANSLUCENCY"==q&&(q=P("TranslucencyParams","TranslucencyParams",[0,0,0,0]),q.Ja=m[0].Ja,m.push(q));break;case "LAMP":(q=b.lamp)?(q.uuid in Ja?v.push(["LAMP_INDEX",String(Ja[q.uuid])]):(Ja[q.uuid]=Ma,v.push(["LAMP_INDEX",String(Ma++)])),p=Ja):(Da.error("There is no lamp in node: "+b.name),v.push(["LAMP_INDEX",-1]));m.push(Y(b,"Color"));m.push(Y(b,"Light Vector"));m.push(Y(b,"Distance"));m.push(Y(b,"Visibility Factor"));break;case "LIGHTING_AMBIENT":l=
[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0)];m=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":m=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("dif_params","dif_params",[0,0],!0),P("sp_params","sp_params",[0,0],!0),P("shadow_factor","shadow_factor",0,!0),P("translucency_color","translucency_color",0,!0),P("translucency_params","translucency_params",[0,
0,0,0],!0)];break;case "LIGHTING_END":l=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":l=[P("shadow_factor","shadow_factor",0,!0)];m=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("lcolorint","lcolorint",[0,0,0],!0),P("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":l=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0)];m=[P("lfactor","lfactor",0,!0)];v.push(["MAT_USE_TBN_SHADING",
b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":l=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("dif_params","dif_params",[0,0],!0)];m=[P("lfactor","lfactor",0,!0)];v.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":l=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),
P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("sp_params","sp_params",[0,0],!0)];m=[P("sfactor","sfactor",0,!0)];v.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":l=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("sp_params","sp_params",[0,0],!0)];m=[P("sfactor","sfactor",0,!0)];v.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":l=
[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("bsdf_params","bsdf_params",[0,0,0,0],!0)];m=[P("lfactor","lfactor",0,!0),P("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":l=[P("color","color",[0,0,0,0],!0),P("specular","specular",[0,0,0],!0),P("lfactor","lfactor",0,!0),P("sfactor","sfactor",0,!0),P("ldir","ldir",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("translucency_params","translucency_params",[0,0,0,0],!0),P("D",
"D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("lcolorint","lcolorint",[0,0,0],!0),P("translucency_color","translucency_color",0,!0)];m=[P("color","color",[0,0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;case "NORMAL":l=ba(b);m=oa(b);q=Y(b,"Normal");n.push(W(Z("param_NORMAL_Normal"),q.Ga,3));break;case "MAPPING":q=b.vector_type;h="MAPPING";l.push(ca(b,"Vector"));m.push(Y(b,"Vector"));var r=Wa.f32(b.rotation),u=Wa.f32(b.scale),x=Wa.f32(b.translation),z=Xa.create(),w=Wa.IP(r,Xa.create());"TEXTURE"==
q&&(u[0]=u[0]||1,u[1]=u[1]||1,u[2]=u[2]||1);Xa.multiply(w,new Float32Array([u[0],0,0,0,u[1],0,0,0,u[2]]),z);z=Wa.zS(z,Ba.create());switch(q){case "POINT":z[12]=x[0];z[13]=x[1];z[14]=x[2];break;case "TEXTURE":z[12]=x[0];z[13]=x[1];z[14]=x[2];z=Ba.invert(z,z);break;case "NORMAL":Ba.invert(z,z),Ba.transpose(z,z)}switch(q){case "NORMAL":v.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":v.push(["MAPPING_TRS_MATRIX_DEF",1]);v.push(["MAPPING_TRS_MATRIX",ta.W(z,16)]);break;case "POINT":0!==rb.length(r)?(v.push(["MAPPING_TRS_MATRIX_DEF",
1]),v.push(["MAPPING_TRS_MATRIX",ta.W(z,16)])):(0!==rb.length(u)&&(v.push(["MAPPING_SCALE_DEF",1]),v.push(["MAPPING_SCALE",ta.W(u,3)])),0!==rb.length(x)&&(v.push(["MAPPING_TRANS_DEF",1]),v.push(["MAPPING_TRANS",ta.W(x,3)])));break;case "VECTOR":0!==rb.length(r)?(v.push(["MAPPING_TRS_MATRIX_DEF",1]),v.push(["MAPPING_TRS_MATRIX",ta.W(z,16)])):0!==rb.length(u)&&(v.push(["MAPPING_SCALE_DEF",1]),v.push(["MAPPING_SCALE",ta.W(u,3)]))}b.use_min&&(v.push(["MAPPING_MIN_CLIP_DEF",1]),v.push(["MAPPING_MIN_CLIP",
ta.W(b.min,3)]));b.use_max&&(v.push(["MAPPING_MAX_CLIP_DEF",1]),v.push(["MAPPING_MAX_CLIP",ta.W(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":var p=[],q=[],r=[],u=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("dif_params","dif_params",[0,0],!0),P("sp_params","sp_params",[0,0],!0),P("shadow_factor","shadow_factor",0,!0)],x=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0),P("normal","normal",[0,0,
0],!0)],z=[Y(b,"Color"),Y(b,"Alpha"),Y(b,"Normal")],w=[],y=ca(b,"Color");y.Ga.splice(3);r.push(y);l.push(y);y=ca(b,"Spec");y.Ga.splice(3);r.push(y);l.push(y);(y=ca(b,"DiffuseIntensity"))||(y=ca(b,"Refl"));y.Ga=b.diffuse_intensity;r.push(y);l.push(y);var ha=ca(b,"Normal");ha.Ga.splice(3);r.push(ha);l.push(ha);"MATERIAL_EXT"==h?((y=ca(b,"Emit"))||(y=P("Emit","Emit",0)),r.push(y),l.push(y),(y=ca(b,"Translucency"))?(y.Ga=0,y.name="Translucency",y.identifier="Translucency"):y=P("Translucency","Translucency",
0),l.push(y),(y=ca(b,"Translucency"))?(y.Ga=[0,0,0,0],y.name="TranslucencyParams",y.identifier="TranslucencyParams"):y=P("TranslucencyParams","TranslucencyParams",[0,0,0,0]),l.push(y),m=ca(b,"Reflectivity"),y=ca(b,"Ray Mirror"),m?(y=m,m="Reflectivity"):y?m="Ray Mirror":(y=m,m="Reflectivity"),y||(y=P(m,m,0)),l.push(y),x.push(y),(y=ca(b,"SpecTra"))||(y=P("SpecTra","SpecTra",0)),l.push(y),x.push(y),(y=ca(b,"Alpha"))||(y=P("Alpha","Alpha",b.alpha)),l.push(y),x.push(y),z.push(Y(b,"Diffuse")),z.push(Y(b,
"Spec")),p.push(["MATERIAL_EXT",1]),q.push(["MATERIAL_EXT",1])):(r.push(P("emit_intensity","emit_intensity",0)),x.push(P("reflect_factor","reflect_factor",0)),x.push(P("specular_alpha","specular_alpha",0)),x.push(P("alpha_in","alpha_in",0)),z.push(P("diffuse_out","diffuse_out",0)),z.push(P("spec_out","spec_out",0)),p.push(["MATERIAL_EXT",0]),q.push(["MATERIAL_EXT",0]));w.push(W(Z("param_MATERIAL_alpha"),b.alpha));w.push(W(Z("param_MATERIAL_spec_alpha"),b.specular_alpha));m=z;p.push(["USE_MATERIAL_NORMAL",
ha.Ja|0]);b.use_diffuse&&(p.push(["USE_MATERIAL_DIFFUSE",1]),q.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&q.push(["USE_MATERIAL_SPECULAR",1]);var y=[],F=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":ha=b.specular_hardness;break;case "WARDISO":ha=b.specular_slope;break;case "TOON":ha=b.specular_toon_size;F=b.specular_toon_smooth;break;case "BLINN":ha=b.specular_ior;F=b.specular_hardness;break;default:Da.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+
'")'),ha=b.specular_hardness}var t,A;switch(b.diffuse_shader){case "LAMBERT":A=t=0;break;case "OREN_NAYAR":t=b.roughness;A=0;break;case "FRESNEL":t=b.diffuse_fresnel;A=b.diffuse_fresnel_factor;break;case "MINNAERT":t=b.darkness;A=0;break;case "TOON":t=b.diffuse_toon_size;A=b.diffuse_toon_smooth;break;default:Da.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),A=t=0}y.push(W(Z("param_MATERIAL_diffuse"),[t,A],2));y.push(W(Z("param_MATERIAL_spec"),[b.specular_intensity,
ha,F],3));p.push(["SHADELESS_MAT",b.use_shadeless?1:0]);ha={name:b.name,value:{af:b.specular_shader,Te:b.diffuse_shader,xc:b.use_shadeless,ne:b.use_tangent_shading}};p={name:b.name,value:{af:b.specular_shader,Te:b.diffuse_shader,xc:b.use_shadeless,ne:b.use_tangent_shading},AS:{name:"material_begin",type:"MATERIAL_BEGIN",inputs:r,outputs:u,$:y,data:ha,Wa:p,Le:[]},BS:{name:"material_end",type:"MATERIAL_END",inputs:x,outputs:z,$:w,data:ha,Wa:q,Le:[]}};break;case "BSDF_DIFFUSE":l=ba(b);v.push(["USE_NORMAL_IN",
l[2].Ja|0]);m=Y(b,"BSDF");r=m.Ja;m=[m,P("d_color","d_color",[0,0,0],r),P("d_roughness","d_roughness",0,r),P("s_color","s_color",[0,0,0],r),P("s_roughness","s_roughness",0,r),P("metalness","metalness",0,r),P("normal","normal",[0,0,0],r),P("e_color","e_color",[0,0,0],r),P("emisson","emisson",0,r),P("a_color","a_color",[0,0,0],r),P("alpha","alpha",1,r)];break;case "BSDF_GLOSSY":l=ba(b);v.push(["USE_NORMAL_IN",l[2].Ja|0]);m=Y(b,"BSDF");r=m.Ja;m=[m,P("d_color","d_color",[0,0,0],r),P("d_roughness","d_roughness",
0,r),P("s_color","s_color",[0,0,0],r),P("s_roughness","s_roughness",0,r),P("metalness","metalness",1,r),P("normal","normal",[0,0,0],r),P("e_color","e_color",[0,0,0],r),P("emisson","emisson",0,r),P("a_color","a_color",[0,0,0],r),P("alpha","alpha",1,r)];break;case "BSDF_TRANSPARENT":l=ba(b);m=Y(b,"BSDF");r=m.Ja;m=[m,P("d_color","d_color",[0,0,0],r),P("d_roughness","d_roughness",0,r),P("s_color","s_color",[0,0,0],r),P("s_roughness","s_roughness",0,r),P("metalness","metalness",0,r),P("normal","normal",
[0,0,0],r),P("e_color","e_color",[0,0,0],r),P("emisson","emisson",0,r),P("a_color","a_color",[0,0,0],r),P("alpha","alpha",1,r)];break;case "EMISSION":l=ba(b);m=Y(b,"Emission");q=m.Ja;m=[m,P("d_color","d_color",[0,0,0],q),P("d_roughness","d_roughness",0,q),P("s_color","s_color",[0,0,0],q),P("s_roughness","s_roughness",0,q),P("metalness","metalness",1,q),P("normal","normal",[0,0,0],q),P("e_color","e_color",[0,0,0],q),P("emisson","emisson",1,q),P("a_color","a_color",[0,0,0],r),P("alpha","alpha",1,r)];
break;case "MATH":switch(b.operation){case "ADD":h="MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h="MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h=
"MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h="MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h="MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return Da.error("Unsupported MATH operation: "+b.operation),null}v.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);l=ba(b);m=oa(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h="MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;
case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h="MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h="MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";
break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h="MIX_RGB_LINEAR_LIGHT";break;default:return Da.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}v.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);l=ba(b);m=oa(b);break;case "MIX_WORLD_RGB":case "ADD_WORLD_RGB":l=[P("Factor","Factor",b.fac,b.fac_is_linked),P("Color1","Color1",[0,0,0],b.color1_is_linked),P("Color2","Color1",[0,0,0],b.color2_is_linked)];m=[P("Color","Color",[0,0,
0],!0)];break;case "OUTPUT":l=ba(b);m=[];break;case "OUTPUT_MATERIAL":l=ba(b);m=[];p=ca(b,"Surface");q=p.Ja;p={name:"output_surface",type:"OUTPUT_SURFACE",inputs:[p],outputs:[],$:[],data:{value:{gN:"BSDF_COMPUTE"},eN:{name:"bsdf_begin",type:"BSDF_BEGIN",inputs:[p,P("d_color","d_color",[0,0,0],q),P("d_roughness","d_roughness",0,q),P("s_color","s_color",[0,0,0],q),P("s_roughness","s_roughness",0,q),P("metalness","metalness",0,q),P("normal","normal",[0,0,0],q),P("e_color","e_color",[0,0,0],q),P("emission",
"emission",0,q),P("a_color","a_color",[0,0,0],q),P("alpha","alpha",0,q)],outputs:[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("bsdf_params","bsdf_params",[0,0,0,0],!0),P("shadow_factor","shadow_factor",0,!0),P("d_color","d_color",[0,0,0],!0),P("s_color","s_color",[0,0,0],!0),P("e_color","e_color",[0,0,0],!0),P("emission","emission",0,!0),P("a_color","a_color",[0,0,0],!0),P("alpha","alpha",0,!0)],$:[],data:null,Wa:[],Le:[]},
fN:{name:"bsdf_end",type:"BSDF_END",inputs:[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("bsdf_params","bsdf_params",[0,0,0,0],!0),P("d_color","d_color",[0,0,0],!0),P("s_color","s_color",[0,0,0],!0),P("e_color","e_color",[0,0,0],!0),P("emission","emission",0,!0),P("a_color","a_color",[0,0,0],!0),P("alpha","alpha",0,!0)],outputs:[P("color","color",[0,0,0],q)],$:[],data:null,Wa:[],Le:[]}},Wa:[],Le:[]};p={name:b.name,XS:p,tP:{name:"displacement_bump",
type:"DISPLACEMENT_BUMP",inputs:[P("Height","Height",0,!0)],outputs:[P("Normal","Normal",[0,0,0],!1)],$:[],data:null,Wa:[],Le:[]}};break;case "OUTPUT_WORLD":l=ba(b);m=oa(b);p=ca(b,"Surface");p={name:"output_world_surface",type:"OUTPUT_WORLD_SURFACE",inputs:[p],outputs:[],$:[],data:null,Wa:[],Le:[]};p={name:b.name,YS:p};break;case "RGB":q=b.name;q={name:"-1",value:q};n.push(q);m.push(Y(b,"Color"));break;case "SEPRGB":case "SEPHSV":l=ba(b);m=oa(b);break;case "TEX_ENVIRONMENT":(q=b.image)?(h="TEXTURE_ENVIRONMENT_"+
b.projection,"NONE"==b.color_space?v.push(["NON_COLOR",1]):v.push(["NON_COLOR",0]),l.push(ca(b,"Vector")),v.push(["USE_VECTOR_IN",l[0].Ja|0]),m.push(Y(b,"Color")),r=Z("param_TEXTURE_texture"),n.push(W(r)),p=Aa.Bk(Aa.rh,!1),p.repeat=!0,p.source="IMAGE",Ia.Oy&&(p.anisotropic_filtering=16),Aa.DD(p,q),p={rq:b.name,Lt:"",name:r,value:p}):h="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(q=b.image){h="TEXTURE_COLOR";"NONE"==b.color_space?v.push(["NON_COLOR",1]):v.push(["NON_COLOR",0]);v.push(["CONVERT_UV",0]);
for(r=0;4>r;++r)r?(y=P("Vector"+r,"Vector"+r,[0,0,0],!1),u=P("Color"+r,"Color"+r,[0,0,0],!1),x=P("Alpha"+r,"Alpha"+r,0,!1)):(y=ca(b,"Vector"),u=Y(b,"Color"),x=Y(b,"Alpha")),l.push(y),m.push(u),m.push(x);r=Z("param_TEXTURE_texture");n.push(W(r));p=Aa.Bk(Aa.rh,!1);p.repeat="REPEAT"==b.extension;p.source="IMAGE";Aa.DD(p,q);p={rq:b.name,Lt:"",name:r,value:p}}else h="TEXTURE_EMPTY";break;case "TEXTURE":h=Ca(b);if("TEXTURE_EMPTY"==h)m.push(Y(b,"Color")),m.push(Y(b,"Normal")),m.push(Y(b,"Value"));else if("TEXTURE_ENVIRONMENT_CUBE"==
h)l.push(ca(b,"Vector")),m.push(Y(b,"Color")),m.push(Y(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return Da.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==h&&(q=!1,r=b.texture.image,!r||"Non-Color"!=r.colorspace_settings_name&&"Non-Colour Data"!=r.colorspace_settings_name||(q=!0),v.push(["NON_COLOR",Number(q)]),v.push(["CONVERT_UV",1]));for(r=0;4>r;++r)q="TEXTURE_COLOR"==h?"Color":"Normal",r?(y=P("Vector"+r,"Vector"+r,[0,0,0],!1),u=
P(q+r,q+r,[0,0,0],!1),x=P("Value"+r,"Value"+r,0,!1)):(y=ca(b,"Vector"),u=Y(b,q),x=Y(b,"Value")),l.push(y),m.push(u),m.push(x)}"TEXTURE_EMPTY"!=h&&(r=Z("param_TEXTURE_texture"),n.push(W(r)),p=b.texture.J,p={rq:b.texture.name,Lt:b.texture.uuid,name:r,value:p});break;case "VALTORGB":l=ba(b);m=oa(b);p={value:b};q=b.color_ramp.interpolation;"CONSTANT"!=q&&"LINEAR"!=q&&Da.warn("Color Ramp node is not fully supported.");break;case "VALUE":h="VALUE";q=b.name;q={name:"-1",value:q};n.push(q);m.push(Y(b,"Value"));
break;case "VECT_MATH":switch(b.operation){case "ADD":h="VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h="VECT_MATH_NORMALIZE";break;default:return Da.error("Unsupported VECT_MATH operation: "+b.operation),null}l=ba(b);m=oa(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":v.push(["VECTOR_TYPE",ta.W(0)]);
break;case "VECTOR":v.push(["VECTOR_TYPE",ta.W(1)]);break;case "NORMAL":v.push(["VECTOR_TYPE",ta.W(2)]);break;default:return Da.error("Unsupported VECT_TRANSFORM vector_type: "+b.vector_type),null}l=b.convert_from;m=b.convert_to;if("WORLD"==l)if("WORLD"==m)l=0;else if("OBJECT"==m)l=1;else if("CAMERA"==m)l=2;else return Da.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==l)if("WORLD"==m)l=3;else if("OBJECT"==m)l=4;else if("CAMERA"==m)l=5;else return Da.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else if("CAMERA"==l)if("WORLD"==m)l=6;else if("OBJECT"==m)l=7;else if("CAMERA"==m)l=8;else return Da.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else return Da.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;v.push(["CONVERT_TYPE",ta.W(l)]);l=ba(b);m=oa(b);break;case "NORMAL_MAP":switch(b.space){case "TANGENT":q=0;break;case "OBJECT":q=1;break;case "WORLD":q=2;break;case "BLENDER_OBJECT":q=3;break;case "BLENDER_WORLD":q=4;break;default:return Da.error("Unsupported NORMAL_MAP space: "+
b.space),null}v.push(["SPACE",ta.W(q)]);l.push(ca(b,"Strength"));l.push(ca(b,"Color"));l.push(P("Normal","Normal",[0,0,0],!1));v.push(["USE_NORMAL_IN",0]);m.push(Y(b,"Normal"));break;case "FRESNEL":ha=ca(b,"Normal");l.push(ca(b,"IOR"));l.push(ha);m.push(Y(b,"Fac"));v.push(["USE_FRESNEL_NORMAL",ha.Ja|0]);break;case "LAYER_WEIGHT":ha=ca(b,"Normal");l.push(ca(b,"Blend"));l.push(ha);m=oa(b);v.push(["USE_NORMAL_IN",ha.Ja|0]);break;case "BUMP":ha=ca(b,"Normal");v.push(["INVERT",b.invert?1:0]);v.push(["USE_NORMAL_IN",
ha.Ja|0]);l=ba(b);m=oa(b);break;case "BACKGROUND":l=ba(b);m=oa(b);break;default:l=ba(b),m=oa(b)}g={name:f,Ed:g,type:h,Le:k,inputs:l,outputs:m,$:n,data:p,Wa:v};f=L.zj(a);L.th(a,f,g);if(!(g="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=b.type)){a:{g=b.outputs;for(k=h=0;k<g.length;k++)if(g[k].is_linked&&h++>c){g=!0;break a}g=!1}g=!g}return g||null!=T(a,b,++c,d,e)?f:null}function ja(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof
Array!=k)return Da.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return Da.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function ea(a,b,c){var d=a.node_group.node_tree,f={},g;for(g in d)if("links"==g||"nodes"==g){f[g]=[];for(var h=0;h<d[g].length;h++){f[g][h]={};for(var k in d[g][h])if("links"==
g){f[g][h][k]={};for(var l in d[g][h][k])f[g][h][k][l]=qa(d[g][h][k][l])}else f[g][h][k]=qa(d[g][h][k])}}else f[g]=qa(d[g]);h=a.node_tree_name;if("B4W_REPLACE"==h||"B4W_LEVELS_OF_QUALITY"==h)d=ia("Group input","GROUP_INPUT",[],a.inputs),g=ia("Group output","GROUP_OUTPUT",a.outputs,[]),h="B4W_REPLACE"==h||"B4W_LEVELS_OF_QUALITY"==h&&(Ia.quality==ha.P_LOW||Ia.rF)?{from_node:d,from_socket:d.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:d,from_socket:d.outputs[0],to_node:g,to_socket:g.inputs[0]},
f.nodes=[d,g],f.links=[h];d=a.name;g=f.nodes;h=f.links;for(k=0;k<g.length;k++)g[k].name=va(g[k].type,d,g[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=va(h[k].from_node.type,d,h[k].from_node.name),h[k].to_node.name=va(h[k].to_node.type,d,h[k].to_node.name);return{QS:e(f,a.node_group.uuid,!0,b,c).Aa,RS:f.links}}function qa(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Wa.Dq(a):a}function Z(a){Ha[a]||(Ha[a]=0);var b=a+"_"+Ha[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ha[a]++;
return b}function aa(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function X(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";
case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function fa(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}
function Ca(a){if(!a.texture||!a.texture.J)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:Wa.I("Unknown texture output")}}if(c)return d&&Da.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==
a.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR"}function ca(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return za(e)}return null}function Y(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return za(e)}return null}function za(a){var b=a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=Wa.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Ja:d,Ga:a}}function P(a,b,c,d){return{name:a,identifier:b,Ja:d,Ga:c}}function ya(a){return P(a.name,
a.identifier,a.Ga,a.Ja)}function ba(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=za(a.inputs[c]);d.Ga.length&&d.Ga.splice(3);b.push(d)}return b}function oa(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=za(a.outputs[c]);b.push(d)}return b}function W(a,b,c){b=null===b||void 0===b?null:ta.W(b,c);return{name:a,value:b}}function sa(a){return{name:a.name,value:a.value}}function pa(a){return a.slice()}function ga(a,b,c,d,e,f){var g=[],h=f.from_socket.identifier;f=f.to_socket.identifier;var k=d.outputs;
for(d=0;d<k.length;d++)if(k[d].identifier==h){g.push(d);break}e=e.inputs;for(d=0;d<e.length;d++)if(e[d].identifier==f){g.push(d);break}2==g.length&&L.Ec(a,b,c,g);return!0}function va(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function xa(a){var b=[];L.ba(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function K(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.QS,f=c[d].data.RS;if(!e)return!1;L.ba(e,function(b,c){L.th(a,L.zj(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);
ka(c[d],b,a)}return!0}function Oa(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function Qa(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}
function wa(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function da(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],g,h=0;h<c.inputs.length;h++)if(f.from_socket.identifier==c.inputs[h].identifier){g=c.inputs[h].Ga;break}for(var h=f,k=b,l=g,m=D(h.to_node,k),n=0;n<m.length;n++)for(var p=L.Ya(k,m[n]),v=0;v<p.inputs.length;v++){var q=p.inputs[v];if(q.identifier==h.to_socket.identifier){p=q.Ga instanceof Object?0:1;if((l instanceof Object?
0:1)==p)q.Ga=l;else switch(p){case 0:q=q.Ga;q[0]=q[1]=q[2]=l;break;case 1:q.Ga=(l[0]+l[1]+l[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function ka(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],k=0;k<b.length;k++){var l=b[k];Oa(l.from_node,d,l,e,g,h);Oa(l.to_node,d,l,f,g,h)}f=Qa(b,f,g);e=Qa(b,h,e);wa(b,f);da(b,c,a,f);if(e.length){var m;L.ba(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});da(b,c,m,e)}}function la(a){var b=[],c=[];L.ba(a,function(a,d){switch(d.type){case "VALTORGB":b.push(d);
break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=Aa.MP(b,Aa.ZJ);for(var g=0;g<b.length;g++)b[g].Wa.push(["NODE_TEX_ROW",ta.W((d+.5)/f)]),d++}if(c.length)for(e=Aa.QP(c,Aa.NC),g=0;g<c.length;g++)c[g].Wa.push(["NODE_TEX_ROW",ta.W((d+.5)/f)]),d++;g=null;a&&e?(g=new Uint8Array(a.length+e.length),g.set(a),g.set(e,a.length)):a?g=a:g=e;a=g?Aa.NE(g,Aa.NC):null;for(g=0;g<b.length;g++)b[g].data.Ua=a;for(g=0;g<c.length;g++)c[g].data.Ua=a}function ma(a,b,
c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var ha=t("__config"),La=t("__debug"),L=t("__graph"),Xa=t("__mat3"),Ba=t("__mat4"),Q=t("__objects"),Da=t("__print"),ta=t("__shaders"),Ta=t("__scenes"),Wa=t("__util"),rb=t("__vec3"),Aa=t("__textures"),Ha={},Ea={},Na={},Ja={},Ma=0,Ia=ha.K;a.lX=0;a.rD=1;a.qD=2;a.pD=3;a.kX=4;a.oD=5;a.nD=6;a.mD=7;a.jX=8;a.SK=0;a.RK=1;a.cX=2;a.QK=3;a.bX=4;a.fv=function(a){return Ea[a]};a.KN=function(a){delete Ea[a]};
a.GE=e;a.rz=function(a,c,d){var e=Ta.get_active();a=E(a,"MAIN",e.uuid);if(a in Na)return Na[a];var e=L.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=T(e,f,0,c,null),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=T(e,f,0,c,null);b(e,d,g,f,[[g,[8,10]],[g,[9,6]]],c);B(e);return Na[a]=e};a.Iq=function(a){var b=[],c={};Ha={};var d=L.kC(a);L.ba(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],k=[],l=[],m=0;m<d.inputs.length;m++){var n=d.inputs[m];if(n.Ja)e.push(null),f.push(null);else{e.push(Z("in_"+
d.type+"_"+n.identifier.replace(/\./g,"")));var p=ta.W(n.Ga,0);Ia.OB&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==n.identifier||"Value_001"==n.identifier||"Value.001"==n.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==n.identifier||"Vector.001"==n.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(n=p,n=n.replace(/(,)/g,
"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),p=n=n.replace(/\s+/g,""));f.push(p)}}for(m=0;m<d.outputs.length;m++)n=d.outputs[m],n.Ja?g.push(null):g.push(Z("out_"+d.type+"_"+n.identifier.replace(/\./g,"")));for(m=0;m<d.$.length;m++)n=d.$[m],h.push(n.name),k.push(n.value);for(m=0;m<d.Le.length;m++)l.push(d.Le[m].name);e={id:d.type,inputs:e,rA:f,outputs:g,$:h,So:k,Le:l,Wa:JSON.parse(JSON.stringify(d.Wa))};b.push(e);c[a]=
e});L.mh(d,function(a,b,e){var f=L.Ya(d,a),g=f.outputs[e[0]];a=c[a].outputs;b=c[b].inputs;f=a[e[0]]||Z("out_"+f.type+"_"+g.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.nE=function(a){if(a.Md)for(var b=0;b<a.Md.nodes.length;b++){var c=a.Md.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.tZ=function(a,b){Da.log("\n================ MATERIAL: "+b+" ================\n"+La.SS(a)+"\n============================================================")};a.cleanup=
function(){for(var a in Ea)delete Ea[a];for(a in Na)delete Na[a];for(var b in Ja)delete Ja[b];Ma=0};a.$Q=function(a){var b=-1;L.ba(a,function(a,c){if("TEXTURE_ENVIRONMENT_EQUIRECTANGULAR"==c.type||"TEXTURE_ENVIRONMENT_MIRROR_BALL"==c.type)b=Math.max(b,c.data.value.height)});return b}};b4w.module.__animation=function(a,t){function e(a,b){var c=a.na[b];c&&c.Nu&&c.cr&&(c.cr=!1,c.Nu(a,b))}function c(a,b,c){c=a.na[c];c.type=30;var d=b.za,e=b.gb-d+1;c.start=d;c.length=e;c.dg=d;c.gj=b.name;for(e=d=0;e<a.ad.length;e++){var f=a.ad[e];if(f==b)break;else d+=f.gb-f.za+1}c.EJ=d}function b(a,b){a.type=50;a.gj=b.name;a.start=b.za;a.length=b.gb-a.start;b.cyclic||(a.length+=b.Fr)}function f(a){return a.replace(/_B4W_BAKED$/,"")}function k(a,b){return{Io:a,action:b}}function q(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.J.type&&b.push(k(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var f=e.node_group.node_tree;if(f){var g=c.slice();g.push(e.name);q(f,b,g)}}}}function h(a){return na.is_mesh(a)&&a.v.ad?!0:!1}function u(a,b,c){var d=a.na;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.dg=b,g(a,0,c,!0))}else if(e=d[c])e.dg=b,g(a,0,c,!0)}function y(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function g(a,b,c,d){E(a,b,c,d);e(a,c);a.v.fj&&(G(a,
b),l(a,b))}function d(a,b,c,d){var e=c.frame_range;if(e[0]>e[1])return ea.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var f=c.J,g=a.na[d];g.gj=c.name;g.Iy=e;g.AD=f.uH;g.yD=f.TD;g.oj.set(f.oj);g.start=e[0];g.length=e[1]-e[0];g.dg=e[0];switch(f.type){case 10:if(na.is_armature(a)){g.type=10;var h=r(a,b,c);if(!h){for(var h=a.v.Kg,e=[],k=[],l=[],m=[],n=c.J.aB,q=0;q<n;q++){for(var u in h){var x=h[u],z=x.Gs,y=c.J.Yy[u];y?Y.copy(y.subarray(8*q,8*q+8),z):Y.identity(z);
x.Qx=!1}x=v(h);e.push(x.trans);k.push(x.Mb);l.push(x.kj);m.push(x.jj)}h={trans:e,Mb:k,kj:l,jj:m};a.Ll.push(c,b?b.join("%join%"):null,h)}g.trans=h.trans;g.Mb=h.Mb;g.jj=h.jj;g.kj=h.kj;b=h;g=a.v;h=g.fp;e=a.na[d];u=e.TB;a:{k=g.dx;for(l=0;l<k.length;l+=2)if(c==k[l]){k=k[l+1];break a}k=null}if(k)e.TB=k;else{for(e=0;e<h.length;e++){k=h[e].hi;l=[];m=[];n=b.trans;q=b.Mb;for(x=0;x<n.length;x++)z=D(n[x],q[x],k),l.push(z.trans),m.push(z.Mb);u.push({trans:l,Mb:m})}g.dx.push(c,u)}g.fj&&(b=g.fi,d>b[1]?(g=b[1],b[1]=
d,b[0]=g):d>b[0]&&d<b[1]&&(b[0]=d),p(a))}break;case 40:na.is_speaker(a)&&(g.volume=f.$.volume||null,g.pitch=f.$.pitch||null,g.type=40);break;case 70:na.is_lamp(a)&&(g.color=f.$.color||null,g.fg=f.$.energy||null,g.type=70);break;case 60:if("MESH"==a.type||"WORLD"==a.type){g.type=60;u=na.is_world(a);e=[];k=[];l=[];m=[];n=[];c=c.J;q=b?b[0]:null;for(h in c.$){x=b;z=h.match(/"(.*?)"/)[1];if(x&&1<x.length){for(var y=x[1],L=2;L<x.length;L++)y=y+"%join%"+x[L];y+="%join%"+z}else y=z;x=y;for(z=0;z<a.O.length;z++)for(y=
a.O[z].Y,L=0;L<y.length;L++){var w=y[L];if(u||!q||-1!=w.Xb.indexOf(q)){var F=w.Ef,t;t=h;var ha=x,A=c,E=k,La=e,B=w.Ff;if(B){for(var G=!1,J=0;J<B.length;J+=3)ha==B[J]&&(La.push(4*B[J+1]+B[J+2]),E.push(new Float32Array(A.$[t])),G=!0);t=G}else t=!1;ha=h;A=x;E=c;La=m;B=l;if(F){G=!1;for(J=0;J<F.length;J+=2)A==F[J]&&(B.push(F[J+1]),La.push(new Float32Array(E.$[ha])),G=!0);F=G}else F=!1;(t||F)&&n.push(w)}}}g.Ff=e;g.gH=k;g.Ef=l;g.fH=m;g.No=n}break;case 20:if(h=f.$.tsr){g.type=20;u=r(a,b,c);if(!u){u=c.J.aB;
e=[];k=[];for(l=0;l<u;l++)e.push(h.subarray(8*l,8*l+4)),k.push(h.subarray(8*l+4,8*l+8));u={trans:e,Mb:k};a.Ll.push(c,b?b.join("%join%"):null,u)}g.trans=u.trans;g.Mb=u.Mb;T.bB(a)&&T.hW(a,g.trans[0],g.Mb[0])}else return ea.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:na.is_world(a)&&(g.fg=f.$["light_settings.environment_energy"]||null,g.Ld=f.$.horizon_color||null,g.Yd=f.$.zenith_color||null,g.fog_intensity=f.$["mist_settings.intensity"]||null,g.fog_depth=
f.$["mist_settings.depth"]||null,g.fog_start=f.$["mist_settings.start"]||null,g.fog_height=f.$["mist_settings.height"]||null,g.pm=f.$.b4w_fog_color||null,g.type=80)}na.is_armature(a)&&10!=f.type&&M(a,d);return!0}function r(a,b,c){a=a.Ll;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}function p(a){var b=a.v.fi;if(-1!=b[0]&&-1!=b[1]){var c=a.na;a=c[b[1]].dg;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.dg;d=Math.floor(a);b.dg=d+e}}function M(a,b){var c=
a.v.fi,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.na;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function E(a,b,c,d){if((c=a.na[c])&&null!=c.type&&(c.play||d)){var e=a.v,f=c.dg,g=c.start,h=c.length,f=f+c.speed*b*Ca.Dd(),k=c.type,l=c.speed;if(0<=l&&f>=g+h||0>l&&f<g)switch(d||(c.cr=!0),c.behavior){case 10:0<=l?f=(f-g)%h+g:f=g+h-1E-6;break;case 20:0<=l?f=g:f=g+h-1E-6;c.play=!1;break;case 30:0<=l?f=g+h-1E-6:f=g,c.play=!1}c.dg=f;switch(k){case 10:if(!e.fj){d=z(c);
b=d[0];var m=d[1];d=d[2];e.Pd=c.Mb[b];e.Fe=c.Mb[m];e.Wd=c.trans[b];e.Ke=c.trans[m];e.Af=d;d=e.fp;c=c.TB;for(var n=0;n<d.length;n++){var p=d[n],q=c[n];p.Pd=q.Mb[b];p.Fe=q.Mb[m];p.Wd=q.trans[b];p.Ke=q.trans[m];p.Af=e.Af}ca.T(a)}break;case 20:d=z(c);var e=W,m=d[0],n=d[1],p=d[2],q=c.trans,v=q[m][1],f=q[m][2],g=q[n][1],h=q[n][2];e[0]=(1-p)*q[m][0]+p*q[n][0];e[1]=(1-p)*v+p*g;e[2]=(1-p)*f+p*h;m=K;f=d[0];n=d[1];p=d[2];q=c.Mb;v=Oa;v[0]=q[f][0];v[1]=q[f][1];v[2]=q[f][2];v[3]=q[f][3];f=Qa;f[0]=q[n][0];f[1]=
q[n][1];f[2]=q[n][2];f[3]=q[n][3];qa.slerp(v,f,p,m);n=d[2];p=c.trans;d=(1-n)*p[d[0]][3]+n*p[d[1]][3];a.parent&&a.Ew&&(n=da,Y.set_sep(e,d,m,n),Y.multiply(a.Ew,n,n),Y.Qb(n,e),Y.tb(n,m),d=Y.get_scale(n));c.tC&&(n=sa,ca.get_translation(a,n),za.smooth_v(e,n,b,c.tC,e));c.tB&&(n=Oa,ca.get_rotation(a,n),za.zI(m,n,b,c.tB,m));f=c.oj;f[0]&&ca.set_translation_rel(a,e);f[1]&&ca.set_rotation_rel(a,m);f[2]&&ca.set_scale_rel(a,d);ca.T(a);ja.sync_transform(a);break;case 30:d=c.dg-c.start;0>d&&(d=0);d>=c.length&&(d=
c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.EJ;oa[0]=a+c;oa[1]=b+c;oa[2]=d;d=oa;e.$x=d[0];e.ay=d[2];break;case 40:d=z(c);b=d[0];e=d[1];d=d[2];c.volume&&X.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&X.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-g)/Ca.Dd():f/Ca.Dd();T.GU(a,c.gj,b);break;case 60:d=z(c);b=d[0];e=d[1];d=d[2];v=c.gH;f=c.Ff;m=c.fH;n=c.Ef;p=c.No;for(c=0;c<f.length;c++)for(g=v[c],q=f[c],h=(1-d)*g[b]+d*g[e],g=
0;g<p.length;g++)p[g].Kh[q]=h;for(c=0;c<n.length;c++)for(v=m[c],q=n[c],v=P.lerp(v.subarray(3*b,3*b+3),v.subarray(3*e,3*e+3),d,W),g=0;g<p.length;g++)p[g].je[3*q]=v[0],p[g].je[3*q+1]=v[1],p[g].je[3*q+2]=v[2];na.is_world(a)&&aa.Tx(a);break;case 70:d=z(c);b=d[0];e=d[1];d=d[2];f=c.oj;(h=c.fg)&&f[0]&&ia.set_light_energy(a.Db,(1-d)*h[b]+d*h[e]);(c=c.color)&&f[1]&&(W[0]=(1-d)*c[3*b]+d*c[3*e],W[1]=(1-d)*c[3*b+1]+d*c[3*e+1],W[2]=(1-d)*c[3*b+2]+d*c[3*e+2],ia.set_light_color(a.Db,W));g=a.O;for(c=0;c<g.length;c++)aa.NV(a,
g[c].jb);break;case 80:d=z(c);b=d[0];e=d[1];d=d[2];f=c.oj;g=a.O;l=aa.Pb(g[0].jb,fa.Nb);h=c.fg;h=f[0]?(1-d)*h[b]+d*h[e]:l.fg;k=c.Ld;f[1]?(W[0]=(1-d)*k[3*b]+d*k[3*e],W[1]=(1-d)*k[3*b+1]+d*k[3*e+1],W[2]=(1-d)*k[3*b+2]+d*k[3*e+2],k=W):k=l.Ld;var r=c.Yd;f[2]?(sa[0]=(1-d)*r[3*b]+d*r[3*e],sa[1]=(1-d)*r[3*b+1]+d*r[3*e+1],sa[2]=(1-d)*r[3*b+2]+d*r[3*e+2],l=sa):l=l.Yd;r=c.fog_intensity;f[3]&&(m=(1-d)*r[b]+d*r[e]);r=c.fog_depth;f[4]&&(n=(1-d)*r[b]+d*r[e]);r=c.fog_start;f[5]&&(p=(1-d)*r[b]+d*r[e]);r=c.fog_height;
f[6]&&(q=(1-d)*r[b]+d*r[e]);c=c.pm;f[7]&&(K[0]=(1-d)*c[3*b]+d*c[3*e],K[1]=(1-d)*c[3*b+1]+d*c[3*e+1],K[2]=(1-d)*c[3*b+2]+d*c[3*e+2],v=K);for(c=0;c<g.length;c++)b=a.O[c].jb,(f[0]||f[1]||f[2])&&aa.set_environment_colors(b,h,k,l),f[3]&&aa.bI(b,m),f[4]&&aa.$H(b,n),f[5]&&aa.cI(b,p),f[6]&&aa.aI(b,q),f[7]&&aa.set_fog_color_density(b,v);break;default:za.I("Unknown animation type:"+k)}}}function z(a){var b=a.Iy[0],c=a.Iy[1]-b,b=a.dg-b;0>b&&(b=0);b>=c&&(b=c);b/=a.AD;c=Math.floor(b);a=a.yD[c]?b-c:0;b=Math.ceil(c+
a);oa[0]=c;oa[1]=b;oa[2]=a;return oa}function l(a,b){var c=a.v,d=c.lf,e=c.fi,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var g=a.na[f];if(g.play||0==b||c.Jh){var h=z(g),k=h[0],l=h[1];c.Af=h[2];var h=g.Mb[k],m=g.Mb[l],n=g.trans[k],p=g.trans[l]}else d=1}else d=1;e=a.na[e];if(e.play||0==b||c.Jh){var f=z(e),q=f[0],v=f[1];c.Af=f[2]}else if(-1!=f&&g.play)d=0;else return;var f=e.Mb[q],r=e.Mb[v],u=e.trans[q],x=e.trans[v];if(1!=d||c.Jh)if(0!=d||c.Jh){d=c.Kg;if(c.Jh&&!c.wl&&!c.hl){c.wl=new Float32Array(c.Wd.length);
c.hl=new Float32Array(c.Pd.length);for(var y in d)h=d[y],h.Vm||w(c,h)}for(y in d)h=d[y],h.Vm||B(c,h,g,e,k,l,q,v)}else c.Pd.set(h),c.Fe.set(m),c.Wd.set(n),c.Ke.set(p);else c.Pd.set(f),c.Fe.set(r),c.Wd.set(u),c.Ke.set(x);ca.T(a);O.eW(a)}}function B(a,b,c,d,e,f,g,h){var k=b.Vm,l=a.lf,m=K,n=Oa,p=pa,q=ga,v=Qa,r=wa,u=va,x=xa,z=4*b.gi,y=d.jj[g],w=d.kj[g],F=d.jj[h],t=d.kj[h];if(!a.Jh)var A=c.jj[e],L=c.kj[e],ha=c.jj[f],E=c.kj[f];for(var G=0;4>G;G++)n[G]=y[z+G],q[G]=w[z+G],r[G]=F[z+G],x[G]=t[z+G],a.Jh?(m[G]=
a.hl[z+G],p[G]=a.wl[z+G],v[G]=a.hl[z+G],u[G]=a.wl[z+G]):(m[G]=A[z+G],p[G]=L[z+G],v[G]=ha[z+G],u[G]=E[z+G]);qa.slerp(m,n,l,m);za.Ht(p,q,l,p);Y.set_transcale(p,da);Y.set_quat(m,da);k&&Y.multiply(k.Sx,da,da);Y.copy(da,b.Sx);Y.multiply(da,b.wC,da);Y.mo(da,p);Y.tb(da,m);qa.slerp(v,r,l,v);za.Ht(u,x,l,u);Y.set_transcale(u,da);Y.set_quat(v,da);k&&Y.multiply(k.Rx,da,da);Y.copy(da,b.Rx);Y.multiply(da,b.wC,da);Y.mo(da,u);Y.tb(da,v);for(G=0;4>G;G++)a.Pd[z+G]=m[G],a.Wd[z+G]=p[G],a.Fe[z+G]=v[G],a.Ke[z+G]=u[G];
b=b.su;for(G=0;G<b.length;G++)B(a,b[G],c,d,e,f,g,h)}function w(a,b){for(var c=4*b.gi,d=b.Vm,e=a.lf,f=pa,g=K,h=ga,k=Oa,l=0;4>l;l++)f[l]=a.Wd[c+l],g[l]=a.Pd[c+l],h[l]=a.Ke[c+l],k[l]=a.Fe[c+l];Y.set_transcale(f,da);Y.set_quat(g,da);Y.multiply(da,b.Xh,da);Y.copy(da,b.Sx);d&&(Y.invert(d.Sx,ka),Y.multiply(ka,da,da));Y.mo(da,f);Y.tb(da,g);Y.set_transcale(h,da);Y.set_quat(k,da);Y.multiply(da,b.Xh,da);Y.copy(da,b.Rx);d&&(Y.invert(d.Rx,ka),Y.multiply(ka,da,da));Y.mo(da,h);Y.tb(da,k);qa.slerp(g,k,e,g);za.Ht(f,
h,e,f);for(l=0;4>l;l++)a.hl[c+l]=g[l],a.wl[c+l]=f[l];c=b.su;for(l=0;l<c.length;l++)w(a,c[l])}function G(a,b){var c=a.v,d=c.lf,e=c.In;if(0!=e){!c.Jh||c.wl||c.hl||(d=c.lf=0);var d=c.Hn-d,f=e*b;za.sign(d)==za.sign(e)&&Math.abs(f)<Math.abs(d)?c.lf+=f:(c.lf=c.Hn,c.In=0,c.ej&&(c.ej(),c.ej=null),c.Jh&&(c.wl=null,c.hl=null,c.Jh=!1))}}function v(a){var b=[],c=[],d=[],e=[],f=new Float32Array(4),g=new Float32Array(4),h;for(h in a){var k=a[h],l=f,m=g,n=k.St,p=n[n.length-1],q=p.vC;p.Qx||Y.identity(q);for(p=n.length-
1;0<=p;p--){var v=n[p],r=v.vC;if(v.Qx)q=r;else{var u=v.Xh,x=v.Gs;Y.invert(u,da);Y.multiply(x,da,da);Y.multiply(u,da,da);Y.multiply(q,da,r);q=r;v.Qx=!0}}n=v.vC;l[0]=n[0];l[1]=n[1];l[2]=n[2];l[3]=n[3];m[0]=n[4];m[1]=n[5];m[2]=n[6];m[3]=n[7];qa.normalize(m,m);l=k.gi;Y.multiply(k.yp,k.Gs,da);for(k=0;4>k;k++)m=4*l+k,b[m]=f[k],c[m]=g[k],d[m]=da[k],e[m]=da[k+4]}return{trans:b,Mb:c,kj:d,jj:e}}function D(a,b,c){var d=[],e=[],f;for(f in c)for(var g=c[f],h=g.gi,g=g.Cz,k=0;4>k;k++){var l=4*g+k,m=4*h+k;d[l]=a[m];
e[l]=b[m]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,Mb:e}}function F(a){var b=a.J,c;if(b.Yy)c=10;else if(b.$)if("volume"in b.$||"pitch"in b.$)c=40;else{var d;a:{if(d=a.J.$)for(var e in d)if(-1!=e.indexOf("nodes")){d=!0;break a}d=!1}if(d)c=60;else{var f;a:{if(a.J.$){d=a.fcurves;for(f in d)if("color"==f&&!d[f][3]){f=!0;break a}if("energy"==f){f=!0;break a}}f=!1}if(f)c=70;else if(f=a.J.$,"light_settings.environment_energy"in f||"horizon_color"in f||"zenith_color"in f||"mist_settings.intensity"in
f||"mist_settings.depth"in f||"mist_settings.start"in f||"mist_settings.height"in f||"b4w_fog_color"in f)c=80;else{a:{if(a.J.$)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}}else c=0;b.type=c}function n(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function N(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function I(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=
b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function x(a,b,c,d,e,f,g){var h=a+(b-a)/2,k=J(h,d,e,f,g)-c;return.02>Math.abs(k)?h:0<k?x(a,h,c,d,e,f,g):x(h,b,c,d,e,f,g)}function J(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function A(a,
b){var c={type:null,gj:null,Iy:null,AD:0,yD:null,oj:new Int8Array(8),Mb:null,trans:null,jj:null,kj:null,TB:[],play:!1,behavior:20,dg:0,start:0,length:0,tC:0,tB:0,cr:!1,EJ:null,speed:1,volume:null,pitch:null,color:null,fg:null,Yd:null,Ld:null,fog_intensity:null,fog_depth:null,fog_start:null,fog_height:null,pm:null,gH:[],Ff:[],fH:[],Ef:[],No:null};if(!a.na.length)for(var d=0;8>d;d++)a.na.push(null);a.na[b]=c;-1==la.indexOf(a)&&la.push(a)}function C(a,b){ca.T(a);ja.sync_transform(a);g(a,0,b,!0)}function R(a,
e,f,g){g=g||0;if(na.is_mesh(a)){var h=m(a,f);if(h)return A(a,g),c(a,h,g),C(a,g),!0;if((h=H(a,f))&&"EMITTER"==h.zw){A(a,g);e=h.name;f=g;for(var h=a.O,k=0;k<h.length;k++)for(var l=h[k].Y,n=0;n<l.length;n++){var p=l[n].Ha;p&&p.name==e&&b(a.na[f],p)}C(a,g);return!0}}if(h=za.keysearch("name",f,ma)||za.keysearch("name",f+"_B4W_BAKED",ma)){A(a,g);if(d(a,e,h,g))return C(a,g),!0;a.na[g]=null}ea.error('Unsupported object: "'+a.name+'" or animation name: "'+f+'"');return!1}function m(a,b){for(var c=0;c<a.ad.length;c++){var d=
a.ad[c];if(d.name===b)return d}return null}function H(a,b){for(var c=a.O,d=0;d<c.length;d++)for(var e=c[d].Y,f=0;f<e.length;f++){var g=e[f].Ha;if(g&&g.name===b)return g}return null}function U(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var O=t("__armature"),V=t("__config"),ia=t("__lights"),na=t("__obj_util"),T=t("__particles"),ja=t("__physics"),ea=t("__print"),qa=t("__quat"),Z=t("__reformer"),aa=t("__scenes"),X=t("__sfx"),fa=t("__subscene"),
Ca=t("__time"),ca=t("__transform"),Y=t("__tsr"),za=t("__util"),P=t("__vec3"),ya=V.Sl,ba=V.xh;a.sK=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.dL=70;a.cL=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var oa=Array(3),W=new Float32Array(3),sa=
new Float32Array(3),pa=new Float32Array(4),ga=new Float32Array(4),va=new Float32Array(4),xa=new Float32Array(4),K=new Float32Array(4),Oa=new Float32Array(4),Qa=new Float32Array(4),wa=new Float32Array(4),da=Y.create(),ka=Y.create(),la=[],ma=[];a.MF=function(){return za.trunc((ba.ew-50)/4)};a.frame_to_sec=function(a){return a/Ca.Dd()};a.update=function(a){for(var b=0;b<la.length;b++){for(var c=la[b],d=0;8>d;d++)E(c,a,d);c.v.fj&&(G(c,a),l(c,a))}for(b=0;b<la.length;b++)for(c=la[b],d=0;8>d&&c.na.length;d++)e(c,
d)};a.vQ=function(){return ma};a.get_anim_names=function(a){var b=[];if(h(a))for(var c=0;c<a.ad.length;c++)b.push(a.ad[c].name);for(var d=[],c=0;c<ma.length;c++){var e=ma[c],g=e.J;20==g.type?d.push(e):60!=e.J.type||"MESH"!=a.type&&"WORLD"!=a.type?10==g.type&&"ARMATURE"==a.type?d.push(e):40==g.type&&"SPEAKER"==a.type?d.push(e):80==g.type&&"WORLD"==a.type&&d.push(e):d.push(e)}for(c=0;c<d.length;c++)b.push(f(d[c].name));if(T.bB(a)&&T.lH(a))for(a=a.O,c=0;c<a.length;c++)for(d=a[c].Y,e=0;e<d.length;e++)(g=
d[e].Ha)&&b.push(g.name);return b};a.MI=f;a.get_anim_type=function(a,b){var c=a.na[b];return c?c.type:0};a.apply_def=function(a){for(var e=0,f=a.O,g=0;g<f.length;g++)for(var k=f[g].Y,l=0;l<k.length;l++){var m=k[l].Ha;m&&"EMITTER"==m.zw&&!k[l].Rg&&(A(a,e),b(a.na[e],m),C(a,e),m.cyclic?a.na[e].behavior=10:a.na[e].behavior=a.Rl,e++)}f=a.jm.slice();for(g=0;g<f.length;g++)l=f[g],k=l.Io,l=l.action,A(a,e),d(a,k,l,e)?(C(a,e),a.na[e].behavior=a.Rl,e++):a.na[e]=null;h(a)&&(A(a,e),c(a,a.ad[0],e),C(a,e),a.na[e].behavior=
a.Rl)};a.Ny=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:za.I("Wrong animation behavior")}};a.zQ=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.Md;e&&q(e,b,[d.name])}return b};a.AQ=function(a){var b=[],c=a.node_tree;c&&q(c,b,[a.name]);return b};a.gG=k;a.play=function(a,b,c){y(a.na,c,function(a){a.play=!0;b?a.Nu=b:a.Nu=null;a.cr=!1});a.v.fj&&p(a)};a.stop=function(a,b){y(a.na,b,function(a){a.play=
!1;a.Nu=null;a.cr=!1})};a.is_play=function(a,b){var c=a.na;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=u;a.set_first_frame=function(a,b){b=b||0;y(a.na,b,function(c){u(a,c.start,b)})};a.Vz=function(a,b){var c=a.na[b];return c&&c.dg?c.dg:0};a.is_cyclic=function(a,b){var c=a.na[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){y(a.na,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.na[b];return c&&c.behavior};
a.apply_smoothing=function(a,b,c,d){y(a.na,d,function(a){a.tC=b||0;a.tB=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.na[c]=null;else a.na[b]=null;a.v.fj&&M(a,b)};a.UV=g;a.nH=function(a){if("ARMATURE"==a.type||a.yt||"WORLD"==a.type)return!0;for(var b=0;b<a.jm.length;b++){var c=a.jm[b].action.J.type;if(20==c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return T.bB(a)&&T.lH(a)||"MESH"==a.type&&a.ad.length?!0:!1};a.ZD=function(a){if(U(a))return!0;
if(a.Gn)for(var b=0;b<a.Gn.length;b++){var c=a.Gn[b].action.J.type;if(20==c||60==c&&"MESH"==a.type)return!0}return T.dN(a)&&T.cN(a)||"MESH"==a.type&&a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return!!a.na.length};a.pP=function(a,b){for(var c=a.Ll,d=[],e=0;e<c.length;e+=3)(60!=c[e].J.type||null!==c[e+1]&&c[e+1].split("%join%")[0]!=b)&&d.push(c[e],c[e+1],c[e+2]);a.Ll=d};a.mN=v;a.PP=D;a.nM=function(a){function b(a,b){for(var c=0;c<b;c++){var d=a.subarray(8*c+4,8*c+8);qa.normalize(d,
d)}}function c(a,b){if(-1<a.indexOf("location"))var c=0,d=b;else-1<a.indexOf("rotation_quaternion")?(c=4,d=0==b?3:b-1):-1<a.indexOf("scale")?(c=3,d=0):(c=0,d=b);return c+d}function d(a,b,c,d,g){if(-1<c.search(e)){a=b;c=c.split('"')[1];var h=f}else 8==g?(c="tsr",h=f):1<g?h=new Float32Array(g):h=0;if(!a[c]){g=a;b=c;if("object"==typeof h&&h.length)for(var k=h.length,l=new Float32Array(d*k),m=0;m<d;m++)for(var n=0;n<k;n++)l[m*k+n]=h[n];else if("number"==typeof h)for(l=new Float32Array(d),m=0;m<d;m++)l[m]=
h;else za.I("Wrong storage default value");g[b]=l}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=Y.create(),g=a.J={type:0,aB:0,uH:0,$:null,Yy:null,TD:null,oj:new Int8Array(8)};g.uH=1/ya.rm;var h=a.fcurves,k={},l={},m=0,p;for(p in h){var q=h[p],v;for(v in q){var r=q[v],u=r.Yf;Z.uN(r,a);r=r.num_channels;m||(m=u.length);for(var r=d(k,l,p,m,r),x=r.length/m,z=c(p,v|0),y=0;y<m;y++)r[y*x+z]=u[y]}}if(za.Aj(k)){for(var w in k)"tsr"==w&&b(k[w],m);g.$=k}if(za.Aj(l)){for(var t in l)b(l[t],m);g.Yy=l}g.aB=
m;g.TD=a.dM;"tsr"in k&&n(h,g.oj);("color"in k||"energy"in k)&&N(h,g.oj);("light_settings.environment_energy"in k||"horizon_color"in k||"zenith_color"in k||"mist_settings.intensity"in k||"mist_settings.depth"in k||"mist_settings.start"in k||"mist_settings.height"in k||"b4w_fog_color"in k)&&I(h,g.oj);F(a);ma.push(a)};a.yQ=function(a,b){return(b-a)*ya.rm+1};a.HM=function(a,b,c,d,e,f){var g=new Float32Array(2),h=new Float32Array(2),k=new Float32Array(2),l=new Float32Array(2),m=b[1],n=b[2],p=b[a.last_frame_offset+
1];a=b[a.last_frame_offset+2];for(var q=0,v=0,r=null;e<=f;e++)if(e<m)for(var u=0;u<ya.rm;u++)c[q++]=n;else if(e>p)for(u=0;u<ya.rm;u++)c[q++]=a;else{var z=b[v],y=3;0===z&&(y+=2);0===r&&(y+=2);var w=2===z?0:1;if(b[v+1]==b[v+y+1])r=z,v+=y;else{u=0;e==b[v+1]&&(w&&(d[q]=1),c[q]=b[v+2],q++,u++);if(e==p)for(;u<ya.rm;u++)c[q++]=a;else for(g[0]=b[v+1],g[1]=b[v+2],0!==z?(h[0]=0,h[1]=0):0===r?(h[0]=b[v+5],h[1]=b[v+6]):(h[0]=b[v+3],h[1]=b[v+4]),0!==z?(k[0]=0,k[1]=0):(k[0]=b[v+y+3],k[1]=b[v+y+4]),l[0]=b[v+y+1],
l[1]=b[v+y+2];u<ya.rm;u++){var F=e+u/ya.rm;switch(z){case 0:var t,A,E,B=g,G=h,L=k,D=l,ma=[],C=[];ma[0]=B[0]-G[0];ma[1]=B[1]-G[1];C[0]=D[0]-L[0];C[1]=D[1]-L[1];t=D[0]-B[0];E=Math.abs(ma[0]);A=Math.abs(C[0]);E+A&&E+A>t&&(t/=E+A,G[0]=B[0]-t*ma[0],G[1]=B[1]-t*ma[1],L[0]=D[0]-t*C[0],L[1]=D[1]-t*C[1]);w&&(d[q]=1);c[q]=J(x(0,1,F,g[0],h[0],k[0],l[0]),g[1],h[1],k[1],l[1]);q++;break;case 1:w&&(d[q]=1);B=g[0];G=g[1];L=(l[1]-G)/(l[0]-B);c[q]=L*F+(G-L*B);q++;break;case 2:w&&(d[q]=1);c[q]=b[v+2];q++;break;default:za.I("Unknown keyframe interpolation mode: "+
z)}}e+1==b[v+y+1]&&(r=z,v+=y)}}};a.apply=R;a.EM=function(a,b,c,e){e=e||0;var f=za.keysearch("uuid",c,ma);if(f){A(a,e);if(d(a,b,f,e)){C(a,e);return}a.na[e]=null}ea.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.FJ=function(a,b){var c=za.keysearch("name",b,ma)||za.keysearch("name",b+"_B4W_BAKED",ma);if(c){if(0==c.J.type)return!1}else if(!(H(a,b)||na.is_mesh(a)&&m(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.na,d=0;d<c.length;d++){var e=c[d];if(e&&
f(e.gj)==f(b))return d}return-1};a.xQ=function(a,b){var c=a.na[b];return c&&c.gj?f(c.gj):null};a.remove=function(a){a.na.length=0;a=la.indexOf(a);-1!=a&&la.splice(a,1)};a.zT=function(a){for(var b=ma.length-1;0<=b;b--)ma[b].eM==a&&ma.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.na.length)return R(a,null,b,0)?0:-1;for(var c=0;c<a.na.length;c++)if(!a.na[c])return R(a,null,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c,d){a=a.v;a.In=(b-a.lf)/c;a.Hn=b;a.ej&&a.ej();a.ej=d};a.mix_from_cur_pos=
function(a,b,c,d){a=a.v;a.fi[1]=b;a.In=1/c;a.Hn=1;a.ej&&a.ej();a.ej=d;a.wl=null;a.hl=null;a.Jh=!0};a.set_speed=function(a,b,c){y(a.na,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.na[b].speed};a.get_anim_start_frame=function(a,b){return a.na[b].start};a.get_anim_length=function(a,b){return a.na[b].length};a.cleanup=function(){la.length=0;ma.length=0};a.SP=function(a){var b=(a[0]||a[1]||a[2]).Yf.length,c=K,d=W,e=!!a[0];e||(a[0]={Yf:new Float32Array(b),num_channels:8});var f=!!a[1];
f||(a[1]={Yf:new Float32Array(b),num_channels:8});var g=!!a[2];g||(a[2]={Yf:new Float32Array(b),num_channels:8});a[3]={Yf:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].Yf[h]:0,d[1]=f?a[1].Yf[h]:0,d[2]=g?a[2].Yf[h]:0,za.euler_to_quat(d,c),a[0].Yf[h]=c[3],a[1].Yf[h]=c[0],a[2].Yf[h]=c[1],a[3].Yf[h]=c[2]};a.HF=U;a.RU=function(a,b){for(var c=7,d=0,e=0;e<ma.length;e++){var f=ma[e];if(f.name==b){d=f.J.type;break}}0==d&&(m(a,b)?d=30:(e=H(a,b))&&"EMITTER"==e.zw&&(d=50));for(e=0;8>e;e++)if(f=
a.na[e]){if(f.type==d)return e}else e<c&&(c=e);return c}};b4w.module.__time=function(a,t){function e(){return-1!==c.Sl.Tu?c.Sl.Tu:y}var c=t("__config"),b=0,f=0,k=[],q=0,h=0,u=[],y=-1,g=0;a.lI=function(a){b=a;f=performance.now();for(a=0;a<k.length;a++){var c=k[a];b>c.Kz&&(k.splice(a,1),a--,c.callback())}for(a=0;a<u.length;a++){var c=u[a],d=1-(c.Kz-b)/c.duration,d=Math.min(d,1);c.callback(c.from+d*(c.to-c.from));1==d&&(u.splice(a,1),a--)}};a.get_timeline=function(){return b};a.lU=function(a){g=a};a.IQ=function(){return g};a.set_timeout=function(a,c){var d;
q++;d=q;k.push({id:d,callback:a,Kz:b+(performance.now()-f+c)/1E3});return d};a.clear_timeout=function(a){for(var b=0;b<k.length;b++)if(k[b].id==a){k.splice(b,1);break}};a.clear_animation=function(a){for(var b=u.length;b--;)if(u[b].id==a){u.splice(b,1);break}};a.animate=function(a,c,e,f){e/=1E3;var d;h++;d=h;u.push({id:d,callback:f,from:a,to:c,Kz:b+e,duration:e});f(a);return d};a.reset=function(){f=b=0;k.length=0;h=q=u.length=0};a.Dd=e;a.oU=function(a){y=a};a.get_frame=function(a){return a*e()}};b4w.module.__transform=function(a,t){function e(a,b){d.Vg(a)?l.set_trans(b,d.Tg(a)):l.set_trans(b,a.v.C)}function c(a,b){var c=a.v;if(d.Vg(a)){l.set_quat(b,c.C);var e=d.Yu(a),e=l.invert(e,F);l.multiply(e,c.C,d.Tg(a))}else l.set_quat(b,c.C)}function b(a,b){d.Vg(a)?l.set_quat(b,d.Tg(a)):l.set_quat(b,a.v.C)}function f(a,b){l.tb(a.v.C,b);return b}function k(a,b){d.Vg(a)?l.tb(d.Tg(a),b):l.tb(a.v.C,b);return b}function q(a,b){d.Vg(a)?l.copy(b,d.Tg(a)):l.copy(b,a.v.C)}function h(a,b){d.Vg(a)?l.copy(d.Tg(a),
b):l.copy(a.v.C,b);return b}function u(a){var b=a.v,c=a.O,e=a.type;"CAMERA"==e&&g.jJ(a);d.KV(a,N);"CAMERA"==e&&g.IV(a);y.On(b.ra,b.C,b.uh);y.Kt(b.pc,b.C,b.te);for(var f=0;f<c.length;f++)for(var h=c[f].Y,k=0;k<h.length;k++)M.tJ(h[k],b.C,c[f].bg[k]);switch(e){case "MESH":a.cH&&l.invert(a.v.C,a.v.py);if(h=a.yt)l.invert(h.v.C,F),l.multiply(F,b.C,F),l.mo(F,b.gq),l.tb(F,b.fq);b.gr=!0;break;case "CAMERA":for(f=0;f<c.length;f++)g.JV(a,c[f]);break;case "SPEAKER":z.ZU(a,N,I);break;case "LAMP":r.OV(a)}for(var h=
l.Qb(b.C,G),n=l.tb(b.C,D),f=0;f<c.length;f++)if(k=c[f],k.Ev){var q=k.jb,v=q.J;switch(e){case "MESH":b.$e&&E.JB(q);v=k.rj;null!=b.be&&v&&E.kJ(v,h);break;case "EMPTY":p.MV(a);break;case "CAMERA":if(E.get_active()==q&&E.Jk(q)==a){E.ZT(q);if(v.Zc){(v.Zc.enable_csm||v.Zc.AP)&&E.JB(q);var x=M.Da(a,q).ha[0];E.dW(x,v.Aa)}z.nS(q,h,n,N,I)}break;case "LAMP":E.Ks(a,q)}v=k.Mi;x=a.fs;if(x.length)for(k=0;k<v.length;k++){var w=v[k].F;E.mJ(v[k],h,n);M.nJ(x,w.wc);g.IU(w,E.Jk(q));B.nm(w.rd,w.Eh)}}b=a.ue;for(f=0;f<b.length;f++)u(b[f]);
a=a.pz;for(f=0;f<a.length;f++)b=a[f],h=b[0],d.FV(h,b[1])}var y=t("__boundings"),g=t("__camera"),d=t("__constraints"),r=t("__lights"),p=t("__objects"),M=t("__obj_util"),E=t("__scenes"),z=t("__sfx"),l=t("__tsr"),B=t("__util"),w=t("__vec3"),G=new Float32Array(3),v=new Float32Array(3),D=new Float32Array(4),F=l.create(),n=l.create(),N=0,I=0;a.update=function(a){N=a;I++};a.set_translation=function(a,b){var c=a.v;if(d.Vg(a)){l.set_trans(b,c.C);var e=d.Yu(a),e=l.invert(e,F);l.multiply(e,c.C,d.Tg(a))}else l.set_trans(b,
c.C)};a.set_translation_rel=e;a.get_translation=function(a,b){l.Qb(a.v.C,b);return b};a.get_translation_rel=function(a,b){d.Vg(a)?l.Qb(d.Tg(a),b):l.Qb(a.v.C,b);return b};a.set_rotation=c;a.set_rotation_rel=b;a.get_rotation=f;a.get_rotation_rel=k;a.set_rotation_euler=function(a,b){var d=B.euler_to_quat(b,D);c(a,d)};a.set_rotation_euler_rel=function(a,c){var d=B.euler_to_quat(c,D);b(a,d)};a.get_rotation_euler=function(a,b){var c=f(a,D);return b=B.quat_to_euler(c,b)};a.get_rotation_euler_rel=function(a,
b){var c=k(a,D);return b=B.quat_to_euler(c,b)};a.set_scale=function(a,b){var c=a.v;if(d.Vg(a)){var c=d.Tg(a),e=l.get_scale(d.Yu(a));l.set_scale(b/e,c)}else l.set_scale(b,c.C)};a.set_scale_rel=function(a,b){var c=a.v;d.Vg(a)?l.set_scale(b,d.Tg(a)):l.set_scale(b,c.C)};a.get_scale=function(a){return l.get_scale(a.v.C)};a.get_scale_rel=function(a){return d.Vg(a)?l.get_scale(d.Tg(a)):l.get_scale(a.v.C)};a.set_tsr=function(a,b){l.copy(b,a.v.C);if(d.Vg(a)){var c=d.Yu(a),c=l.invert(c,F);l.multiply(c,a.v.C,
d.Tg(a))}};a.set_tsr_rel=q;a.get_tsr=function(a,b){return l.copy(a.v.C,b)};a.get_tsr_rel=h;a.get_object_size=function(a){var b=a.v;a=b.ij;var c=l.get_scale(b.C),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){b?(a=a.v,w.copy(a.te.S,c)):(a=a.v,b=a.ij,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,l.transform_vec3(c,a.C,c));return c};a.move_local=function(a,b,c,d){var f=h(a,F),g=G;g[0]=
b;g[1]=c;g[2]=d;l.transform_vec3(g,f,g);e(a,g)};a.EB=function(a,b){var c=h(a,F),d=l.set_quat(b,l.identity(n));l.multiply(c,d,d);q(a,d)};a.T=u;a.distance=function(a,b){var c=l.Qb(a.v.C,G),d=l.Qb(b.v.C,v);return w.dist(c,d)};a.Nr=function(a,b){var c=l.Qb(a.v.C,G);return w.dist(c,b)}};b4w.module.__tsr=function(a,t){function e(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function f(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function k(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function q(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6];
b=b[7];var p=a[0]*g,q=a[1]*g,r=a[2]*g;a=b*p+k*r-l*q;var g=b*q+l*p-h*r,u=b*r+h*q-k*p,p=-h*p-k*q-l*r;c[0]=a*b+p*-h+g*-l-u*-k;c[1]=g*b+p*-k+u*-h-a*-l;c[2]=u*b+p*-l+a*-k-g*-h;c[0]+=d;c[1]+=e;c[2]+=f;return c}var h=t("__mat4"),u=t("__quat"),y=t("__util"),g=t("__vec3"),d=Math.sin(-Math.PI/4),r=-d,p=new Float32Array(3),M=new Float32Array(4),E=new Float32Array(16);a.create=e;a.clone=function(a){var c=e();b(a,c);return c};a.from_values=function(a,b,c,d,f,g,h,k){var l=e();l[0]=a;l[1]=b;l[2]=c;l[3]=d;l[4]=f;
l[5]=g;l[6]=h;l[7]=k;return l};a.fm=c;a.aY=function(a){var d=c();b(a,d);return d};a.wY=function(a,b,d,e,f,g,h,k){var l=c();l[0]=a;l[1]=b;l[2]=d;l[3]=e;l[4]=f;l[5]=g;l[6]=h;l[7]=k;return l};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=f;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set_quat=function(a,
b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.Qb=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=function(a){return a[3]};a.mo=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.get_quat_view=function(a){return a.subarray(4,8)};a.tb=k;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],f=a[2];M[0]=a[4];M[1]=a[5];M[2]=a[6];M[3]=a[7];u.invert(M,M);var g=M[0],h=M[1],k=M[2],l=M[3],d=d*c,
e=e*c,p=f*c,f=l*d+h*p-k*e,q=l*e+k*d-g*p,r=l*p+g*e-h*d,d=-g*d-h*e-k*p;b[0]=-(f*l+d*-g+q*-k-r*-h);b[1]=-(q*l+d*-h+r*-g-f*-k);b[2]=-(r*l+d*-k+f*-h-q*-g);b[3]=c;b[4]=g;b[5]=h;b[6]=k;b[7]=l;return b};a.to_mat4=function(a,b){var c=a[3];h.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var c=y.HA(a,p),d=y.UG(a),e=y.matrix_to_quat(a,M);f(c,d,e,b);return b};a.multiply=function(a,b,c){q(b,a,c);c[3]=a[3]*b[3];var d=a[4],e=a[5],f=a[6];
a=a[7];var g=b[4],h=b[5],k=b[6];b=b[7];c[4]=d*b+a*g+e*k-f*h;c[5]=e*b+a*h+f*g-d*k;c[6]=f*b+a*k+d*h-e*g;c[7]=a*b-d*g-e*h-f*k;return c};a.uV=function(a,b,c){var d=b[3];b=h.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),E);for(var e=0;12>e;e++)b[e]*=d;h.multiply(b,a,c);return c};a.transform_vec3=q;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var h=b[5],k=b[6];b=b[7];var l=a*a+h*h+k*k+b*b,l=l?1/l:0;a=-a*l;h=-h*l;k=-k*l;b*=l;var l=b*e+h*g-k*f,p=b*f+
k*e-a*g,q=b*g+a*f-h*e,e=-a*e-h*f-k*g;c[0]=l*b+e*-a+p*-k-q*-h;c[1]=p*b+e*-h+q*-a-l*-k;c[2]=q*b+e*-k+l*-h-p*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[0],g=b[1],h=b[2],k=b[3],l=b[4],p=b[5],q=b[6];b=b[7];for(var r=0;r<e;r+=3){var u=a[r]*k,y=a[r+1]*k,w=a[r+2]*k,m=b*u+p*w-q*y,z=b*y+q*u-l*w,t=b*w+l*y-p*u,u=-l*u-p*y-q*w;c[d+r]=m*b+u*-l+z*-q-t*-p;c[d+r+1]=z*b+u*-p+t*-l-m*-q;c[d+r+2]=t*b+u*-q+m*-p-z*-l;c[d+r]+=f;c[d+r+1]+=g;c[d+r+2]+=h}return c};
a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],k=b[6];b=b[7];for(var l=0;l<e;l+=3){var p=a[l]*f,q=a[l+1]*f,r=a[l+2]*f,u=b*p+h*r-k*q,y=b*q+k*p-g*r,w=b*r+g*q-h*p,p=-g*p-h*q-k*r;c[d+l]=u*b+p*-g+y*-k-w*-h;c[d+l+1]=y*b+p*-h+w*-g-u*-k;c[d+l+2]=w*b+p*-k+u*-h-y*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var h=a[0]*d,k=a[1]*d,l=a[2]*d;a=b*h+f*l-g*k;var d=b*k+g*h-e*l,p=b*l+e*k-f*h,h=-e*h-f*k-g*l;c[0]=a*b+h*-e+d*-g-p*-f;c[1]=
d*b+h*-f+p*-e-a*-g;c[2]=p*b+h*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],k=b[6];b=b[7];for(var l=0;l<e;l+=4){var p=a[l]*f,q=a[l+1]*f,r=a[l+2]*f,u=b*p+h*r-k*q,y=b*q+k*p-g*r,w=b*r+g*q-h*p,p=-g*p-h*q-k*r;c[d+l]=u*b+p*-g+y*-k-w*-h;c[d+l+1]=y*b+p*-h+w*-g-u*-k;c[d+l+2]=w*b+p*-k+u*-h-y*-g;c[d+l+3]=a[l+3]}return c};a.bJ=function(a,b,c){b=k(b,M);u.multiply(b,a,c)};a.vV=function(a,b,c,d){d=d||0;b=k(b,M);y.vT(a,b,c,d)};a.translate=function(a,b,
c){var d=a[3],e=a[4],f=a[5],g=a[6],h=a[7],k=b[0]*d,l=b[1]*d,p=b[2]*d;b=h*k+f*p-g*l;var d=h*l+g*k-e*p,q=h*p+e*l-f*k,k=-e*k-f*l-g*p;c[0]=a[0]+b*h+k*-e+d*-g-q*-f;c[1]=a[1]+d*h+k*-f+q*-e-b*-g;c[2]=a[2]+q*h+k*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,d){g.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);u.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.oY=function(a,b,c,d){var e=a.subarray(0,
3),f=b.subarray(0,3),g=d.subarray(0,3);g[0]=f[0]*(c+1)-e[0]*c;g[1]=f[1]*(c+1)-e[1]*c;g[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;u.normalize(e,e);return d};a.HR=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],h=a[5],k=a[6],l=a[7];e[4]=.5*(c*l+f*k-d*h);e[5]=.5*(f*l+d*g-c*k);e[6]=.5*(d*
l+c*h-f*g);e[7]=.5*(-c*g-f*h-d*k);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)};a.RZ=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var c=a[4],e=a[5],f=a[6],g=a[7];b[4]=c*r+g*d;b[5]=e*r+f*d;b[6]=f*r-e*d;b[7]=g*r-c*d};a.QZ=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__util=function(a,t){function e(a){return 0<a?1:0>a?-1:0}function c(a,b,c){var d=a[0],e=a[1];a=a[2];var f=Math.cos(d/2),g=Math.cos(e/2),h=Math.cos(a/2),k=Math.sin(d/2),e=Math.sin(e/2),l=Math.sin(a/2);if(-1<wa.indexOf(b))var m=Math.cos((d+a)/2),n=Math.sin((d+a)/2),p=Math.cos((d-a)/2),q=Math.sin((d-a)/2),v=Math.cos((a-d)/2),r=Math.sin((a-d)/2);switch(b){case 0:c[0]=g*n;c[1]=e*p;c[2]=e*q;c[3]=g*m;break;case 1:c[0]=e*q;c[1]=g*n;c[2]=e*p;c[3]=g*m;break;case 2:c[0]=e*p;c[1]=e*q;c[2]=g*n;c[3]=
g*m;break;case 3:c[0]=g*n;c[1]=e*r;c[2]=e*v;c[3]=g*m;break;case 4:c[0]=e*v;c[1]=g*n;c[2]=e*r;c[3]=g*m;break;case 5:c[0]=e*r;c[1]=e*v;c[2]=g*n;c[3]=g*m;break;case 6:c[0]=k*g*h+f*e*l;c[1]=f*e*h-k*g*l;c[2]=f*g*l+k*e*h;c[3]=f*g*h-k*e*l;break;case 7:c[0]=f*g*l+k*e*h;c[1]=k*g*h+f*e*l;c[2]=f*e*h-k*g*l;c[3]=f*g*h-k*e*l;break;case 8:c[0]=f*e*h-k*g*l;c[1]=f*g*l+k*e*h;c[2]=k*g*h+f*e*l;c[3]=f*g*h-k*e*l;break;case 9:c[0]=k*g*h-f*e*l;c[1]=f*g*l-k*e*h;c[2]=f*e*h+k*g*l;c[3]=f*g*h+k*e*l;break;case 10:c[0]=f*e*h+k*
g*l;c[1]=k*g*h-f*e*l;c[2]=f*g*l-k*e*h;c[3]=f*g*h+k*e*l;break;case 11:c[0]=f*g*l-k*e*h,c[1]=f*e*h+k*g*l,c[2]=k*g*h-f*e*l,c[3]=f*g*h+k*e*l}return c}function b(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];switch(b){case 0:c[0]=Math.atan2(d*e+f*a,e*a-d*f);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*e-f*a,d*f+e*a);break;case 1:c[0]=Math.atan2(d*a+e*f,f*a-d*e);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(e*f-d*a,d*e+f*a);break;case 2:c[0]=Math.atan2(d*f+e*a,d*a-e*f);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*
f-e*a,d*a+e*f);break;case 3:c[0]=Math.atan2(d*f-e*a,d*e+f*a);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*f+e*a,f*a-d*e);break;case 4:c[0]=Math.atan2(d*e-f*a,d*a+e*f);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(d*e+f*a,d*a-e*f);break;case 5:c[0]=Math.atan2(e*f-d*a,d*f+e*a);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*a+e*f,e*a-d*f);break;case 6:c[0]=Math.atan2(2*(d*a-e*f),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*f+e*a));c[2]=Math.atan2(2*(f*a-d*e),1-2*(e*e+f*f));break;case 7:b=d*e+f*a;.499999<b?
(c[0]=0,c[1]=Math.PI/2,c[2]=2*Math.atan2(d,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=-2*Math.atan2(d,a)):(c[0]=Math.atan2(2*(e*a-d*f),1-2*(e*e+f*f)),c[1]=Math.asin(2*(d*e+f*a)),c[2]=Math.atan2(2*(d*a-e*f),1-2*(d*d+f*f)));break;case 8:c[0]=Math.atan2(2*(f*a-d*e),1-2*(d*d+f*f));c[1]=Math.asin(2*(d*a+e*f));c[2]=Math.atan2(2*(e*a-d*f),1-2*(d*d+e*e));break;case 9:c[0]=Math.atan2(2*(d*a+e*f),1-2*(d*d+f*f));c[1]=Math.asin(2*(f*a-d*e));c[2]=Math.atan2(2*(d*f+e*a),1-2*(e*e+f*f));break;case 10:c[0]=Math.atan2(2*
(d*f+e*a),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*a-e*f));c[2]=Math.atan2(2*(d*e+f*a),1-2*(d*d+f*f));break;case 11:b=e*a-d*f,.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=-2*Math.atan2(f,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=2*Math.atan2(f,a)):(c[0]=Math.atan2(2*(d*e+f*a),1-2*(e*e+f*f)),c[1]=Math.asin(2*(e*a-d*f)),c[2]=Math.atan2(2*(d*a+e*f),1-2*(d*d+e*e)))}return c}function f(a,b){var c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]),h=Math.sin(a[2]),k=c*e,l=c*h,m=f*e,
n=f*h;b[0]=d*e;b[1]=d*h;b[2]=-g;b[3]=g*m-l;b[4]=g*n+k;b[5]=d*f;b[6]=g*k+n;b[7]=g*l-m;b[8]=d*c;return b}function k(a,b,c){c||(c=new Float32Array(3));m.transformQuat(b,a,c);return c}function q(a,b){b||(b=new Float32Array(4));N.fromMat4(a,fa);var c=fa[0],d=fa[3],e=fa[6],f=fa[1],g=fa[4],h=fa[7],k=fa[2],l=fa[5],m=fa[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,k=Math.sqrt(k*k+l*l+m*m)||1;fa[0]/=c;fa[3]/=c;fa[6]/=c;fa[1]/=f;fa[4]/=f;fa[7]/=f;fa[2]/=k;fa[5]/=k;fa[8]/=k;R.fromMat3(fa,b);R.normalize(b,
b);return b}function h(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function u(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=u(a[d],c);break;case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:for(d=0;d<a.length;d++)c=y(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=u(a[d],c);break;
case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:c=y(0,c);break;default:l("Wrong object constructor:",a.constructor)}else c=y(0,c);return c;case "number":return y(a,c);case "boolean":return y(a|0,c);case "string":return g(a,c);case "function":case "undefined":return y(0,c)}}function y(a,b){var c=b;ba[0]=a;c=(c<<5)-c+oa[0];c&=c;c=(c<<5)-c+oa[1];return c&c}function g(a,b){for(var c=b,d=0;d<a.length;d++)c=(c<<
5)-c+a.charCodeAt(d),c&=c;return c}function d(a){return(34*a+1)*a%289}function r(a){return a-Math.floor(a)}function p(a){return M((34*a+5)*a)}function M(a){return a-289*Math.floor(a/289)}function E(a){return a-7*Math.floor(a/7)}function z(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function l(a){a&&J.error.apply(J,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function B(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function w(a){return B(a,0,2*Math.PI)}function G(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!v(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!v(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function v(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return G(a,b);default:return!0}}function D(a,b,c){var d=V,e=m.dot(a,b);-.9999999>e?(m.cross(ga,a,d),1E-6>m.length(d)&&m.cross(va,a,d),m.normalize(d,d),R.setAxisAngle(d,Math.PI,c)):(m.cross(a,b,d),c.set(d),c[3]=1+e,R.normalize(c,c));return c}function F(a){if(""==a)return".";
var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function n(a,b,c){var d=Math.sqrt(a[0]*a[0]+a[1]*a[1]);1E-6<d?(b[0]=Math.atan2(a[5],a[8]),b[1]=Math.atan2(-a[2],d),b[2]=Math.atan2(a[1],a[0]),c[0]=Math.atan2(-a[5],-a[8]),c[1]=Math.atan2(-a[2],-d),c[2]=Math.atan2(-a[1],
-a[0])):(b[0]=Math.atan2(-a[7],a[4]),b[1]=Math.atan2(-a[2],d),b[2]=0,m.copy(b,c))}var N=t("__mat3"),I=t("__mat4"),x=t("__math"),J=t("__print"),A=t("__tbn"),C=t("__tsr"),R=t("__quat"),m=t("__vec3"),H=t("__vec4"),U=0,O={},V=new Float32Array(3),ia=new Float32Array(3),na=new Float32Array(3),T=new Float32Array(3),ja=new Float32Array(3),ea=new Float32Array(3),qa=new Float32Array(3),Z=new Float32Array(3),aa=new Float32Array(4),X=new Float32Array(4),fa=new Float32Array(9),Ca=new Float32Array(9),ca=new Float32Array(9),
Y=new Float32Array(16),za=new Float32Array(16),P=R.create(),ya=R.create(),ba=new Float64Array(1),oa=new Uint32Array(ba.buffer),W=new Float32Array([0,0,0,1]),sa=new Float32Array([0,0,0,1,0,0,0,1]),pa=new Float32Array([1,1,1]),ga=new Float32Array([1,0,0]),va=new Float32Array([0,1,0]),xa=new Float32Array([0,0,1]),K=new Float32Array([-1,0,0]),Oa=new Float32Array([0,-1,0]),Qa=new Float32Array([0,0,-1]),wa=[0,1,2,4,5],da=Math.floor(44488.07041494893),ka=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,
0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Gy=new Float32Array([0,0,0]);a.et=W;a.fX=sa;a.Hy=pa;a.AXIS_X=ga;a.AXIS_Y=va;a.AXIS_Z=xa;a.AXIS_MX=K;a.AXIS_MY=Oa;a.AXIS_MZ=Qa;a.XYX=0;a.YZY=1;a.ZXZ=2;a.XZX=3;a.YXY=4;a.ZYZ=5;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=11;a.gK=
ka;a.ry=1;a.Xp=2;a.Yi=4;a.RC=4;a.ge=function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d};a.f32=function(a){return new Float32Array(a)};a.qF=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.wV=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.BN=function(){return 255==(new DataView((new Uint16Array([255])).buffer)).getUint16(0,
!0)};a.IM=function(a,b){var c=[],d={},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=e;a.kZ=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.iZ=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.WQ=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==
b)return c;return-1};a.DM=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.YX=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.rV=function(a,b,c,d){d||(d=new Float32Array(16));I.identity(d);d[12]=a;d[13]=b;d[14]=c};var la=1;a.wT=function(){la=(69069*la+5)%Math.pow(2,32);return Math.round(la/65536)%32768/32767};a.fV=function(a){la=a};a.fh=function(a){var b=a[0]%da*48271-3399*Math.floor(a[0]/da);a[0]=0<b?b:b+2147483647;
return(a[0]-1)/2147483646};a.Cv=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){var d=V;d[0]=a[2];d[1]=a[1];d[2]=a[0];c(d,11,b);return b};a.ordered_angles_to_quat=c;a.quat_to_ordered_angles=b;a.IP=f;a.quat_to_euler=function(a,c){var d=b(a,11,V);c[0]=d[2];c[1]=d[1];c[2]=d[0];return c};a.quat_to_dir=k;a.dir_to_quat=function(a,b,c){c||(c=new Float32Array(4));a=m.normalize(a,V);var d=m.dot(b,a);a=m.cross(b,a,ia);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/
2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.sV=function(a,b,c,d){d||(d=new Float32Array(4));m.transformQuat(c,b,d);d[3]=-m.dot(a,d)};a.sP=function(a){var b=C.get_quat_view(a.v.C),c=V;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;m.transformQuat(c,b,c);ia[0]=0;ia[1]=0;ia[2]=-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;m.transformQuat(c,b,c);ia[0]=0;ia[1]=0;ia[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,m.transformQuat(c,b,c),ia[0]=0,ia[1]=1,ia[2]=0}c[1]=0;m.normalize(c,c);a=m.dot(c,
ia);return Math.acos(a)*(0<-c[0]*ia[2]?-1:1)};a.Ht=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.gJ=function(){U++;return U.toString(10)};a.Is=function(a){O[a]||(O[a]=0);var b=a+O[a];O[a]++;return b};a.pi=function(){return{a_position:new Float32Array(0),a_tbn:A.create(0)}};a.V=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;switch(c){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=
new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.V(b[d]);break;default:for(d in c=new c,b)b.hasOwnProperty(d)&&(c[d]=a.V(b[d]))}return c};a.Dq=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a.hasOwnProperty(c))if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=new d(a[c]);break;case Array:b[c]=
a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=q;a.HA=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.UG=function(a){aa[0]=.577350269189626;aa[1]=.577350269189626;aa[2]=.577350269189626;aa[3]=0;H.transformMat4(aa,a,aa);return H.length(aa)};a.nm=function(a,b){var c=b.left,d=b.right,e=b.top,f=b.bottom,g=b.near,k=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-a[4];d[2]=a[11]-a[8];d[3]=
a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];f[0]=a[3]+a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];g[0]=a[3]+a[2];g[1]=a[7]+a[6];g[2]=a[11]+a[10];g[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];h(c);h(d);h(e);h(f);h(g);h(k)};a.aV=function(a,b,c){return c<-x.point_plane_dist(a,b.near)||c<-x.point_plane_dist(a,b.left)||c<-x.point_plane_dist(a,b.right)||c<-x.point_plane_dist(a,b.top)||c<-x.point_plane_dist(a,b.bottom)||c<-x.point_plane_dist(a,
b.far)?!0:!1};a.EP=function(a,b,c,d,e){var f=m.dot(c,b.far),g=m.dot(d,b.far),h=m.dot(e,b.far),f=Math.sqrt(f*f+g*g+h*h);if(f<-x.point_plane_dist(a,b.near)||f<-x.point_plane_dist(a,b.far))return!0;f=m.dot(c,b.left);g=m.dot(d,b.left);h=m.dot(e,b.left);if(Math.sqrt(f*f+g*g+h*h)<-x.point_plane_dist(a,b.left))return!0;f=m.dot(c,b.right);g=m.dot(d,b.right);h=m.dot(e,b.right);if(Math.sqrt(f*f+g*g+h*h)<-x.point_plane_dist(a,b.right))return!0;f=m.dot(c,b.top);g=m.dot(d,b.top);h=m.dot(e,b.top);if(Math.sqrt(f*
f+g*g+h*h)<-x.point_plane_dist(a,b.top))return!0;f=m.dot(c,b.bottom);g=m.dot(d,b.bottom);h=m.dot(e,b.bottom);return Math.sqrt(f*f+g*g+h*h)<-x.point_plane_dist(a,b.bottom)?!0:!1};a.Wo=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.$Z=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*
k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k}return c};a.vT=function(a,b,c,d){d=d||0;for(var e=a.length,f=0;f<e;f+=4){P[0]=a[f];P[1]=a[f+1];P[2]=a[f+2];P[3]=a[f+3];var g=0<P[3];R.multiply(b,P,P);(g&&0>P[3]||!g&&0<P[3])&&H.scale(P,-1,P);c[d+f]=P[0];c[d+f+1]=P[1];c[d+f+2]=P[2];c[d+f+3]=P[3]}};a.tW=function(a,b,c){c||(c=new Float32Array(3));aa[0]=a[0];aa[1]=a[1];aa[2]=a[2];aa[3]=0;H.transformMat4(aa,b,aa);c[0]=aa[0];c[1]=aa[1];c[2]=aa[2]};a.qY=function(a,b){var c=a.length;c||l("flatten(): Wrong or empty array");
var d=a[0].length;d||l("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.uW=function(a){for(var b=[],c=0;c<a.length;c+=3)b[c/3]=new Float32Array([a[c],a[c+1],a[c+2]]);return b};a.Gt=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.Gt(b,c,d,f-1):b[f]<c?a.Gt(b,c,f+1,e):f};a.wk=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0};a.bY=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-
b[d])>c)return!1;return!0};a.BZ=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.uV=function(a,b,c,d,e){e||(e=new Float32Array(16));b=I.fromRotationTranslation(c,d,Y);I.multiply(b,a,e);return e};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=I.fromRotationTranslation(c,d,Y);1!==b&&(d=I.identity(za),b=m.set(b,b,b,V),I.scale(d,b,d),I.multiply(c,d,c));m.transformMat4(a,c,e);return e};a.TZ=function(a,
b,c,d,e){e||(e=new Float32Array(4));b=I.fromRotationTranslation(c,d,Y);H.transformMat4(a,b,e);return e};a.cZ=function(a,b,c,d,e){e||(e=new Float32Array(3));b=I.fromRotationTranslation(c,d,Y);I.invert(b,b);m.transformMat4(a,b,e);return e};a.SZ=function(a,b,c){c||(c=new Float32Array(16));I.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.oZ=function(b,c,d){a.HA(b,c);c[3]=a.UG(b);q(b,d)};a.KX=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};
a.ST=function(a,b,c,d){d||(d=new Float32Array(3));var e=V;m.subtract(b,a,e);m.transformQuat(e,c,e);m.subtract(b,e,d)};a.lQ=function(){var a=V;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16);I.lookAt(a,[-1,0,0],[0,-1,0],b);I.scale(b,[-1,1,1],b);I.scale(b,[-1,1,-1],c);I.lookAt(a,[0,-1,0],[0,0,-1],d);I.scale(d,[1,1,-1],d);I.scale(d,[1,-1,-1],e);I.lookAt(a,[0,0,-1],[0,-1,0],f);I.scale(f,
[-1,1,1],f);I.scale(f,[-1,1,-1],g);return[b,c,d,e,f,g]};a.pQ=function(){var a=V;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16);I.lookAt(a,[1,0,0],[0,-1,0],b);I.scale(b,[-1,1,-1],c);I.lookAt(a,[0,1,0],[0,0,1],d);I.scale(d,[1,-1,-1],e);I.lookAt(a,[0,0,1],[0,-1,0],f);I.scale(f,[-1,1,-1],g);return[b,c,d,e,f,g]};a.fE=function(a){return u(a,0)};a.hash_code=u;a.SY=g;a.zS=function(a,b){b[15]=
1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.deg_to_rad=function(a){return a*Math.PI/180};a.rad_to_deg=function(a){return 180*
a/Math.PI};a.UB=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),e=Math.floor(a[1]+b),f=.211324865405187*c+.211324865405187*e,b=a[0]-c+f;a=a[1]-e+f;var g=b>a?1:0,h=1-g,f=b+.211324865405187-g,k=a+.211324865405187-h,l=b+-.577350269189626,m=a+-.577350269189626,c=c%289,e=e%289,n=Math.max(.5-(b*b+a*a),0),p=Math.max(.5-(f*f+k*k),0),q=Math.max(.5-(l*l+m*m),0),v=2*r(.024390243902439*d(d(e)+c))-1,g=2*r(.024390243902439*d(d(e+h)+c+g))-1,u=2*r(.024390243902439*d(d(e+1)+c+1))-
1,c=Math.abs(v)-.5,e=Math.abs(g)-.5,h=Math.abs(u)-.5,v=v-Math.floor(v+.5),g=g-Math.floor(g+.5),u=u-Math.floor(u+.5);return 130*(n*n*n*n*(1.79284291400159-.85373472095314*(v*v+c*c))*(v*b+c*a)+p*p*p*p*(1.79284291400159-.85373472095314*(g*g+e*e))*(g*f+e*k)+q*q*q*q*(1.79284291400159-.85373472095314*(u*u+h*h))*(u*l+h*m))};a.kE=function(a){var b=1/7,c=b/2,d=M(Math.floor(a[0])),e=M(Math.floor(a[1])),f=r(a[0]);a=r(a[1]);var g=f-.5,h=f-1.5,f=a-.5;a-=1.5;var k=p(d),l=p(d+1),m=k,d=l,k=p(k+e),l=p(l+e),m=p(m+
e+1),d=p(d+e+1),e=g+.7*(E(k)*b+c),n=h+.7*(E(l)*b+c),g=g+.7*(E(m)*b+c),h=h+.7*(E(d)*b+c),k=f+.7*(E(Math.floor(k*b))*b+c),f=f+.7*(E(Math.floor(l*b))*b+c),m=a+.7*(E(Math.floor(m*b))*b+c),b=a+.7*(E(Math.floor(d*b))*b+c);return Math.min(e*e+k*k,n*n+f*f,g*g+m*m,h*h+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=m.transformQuat(b,a,V);b=c[0];var f=c[1];c=c[2];var g=fa;g[0]=f*f+c*c;g[1]=-f*b;g[2]=-c*b;g[3]=-b*f;g[4]=b*b+c*c;g[5]=-c*f;g[6]=-b*c;g[7]=-f*c;g[8]=b*b+f*f;m.transformMat3(a,
g,a);m.normalize(a,a);R.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c,d;c=R.setAxisAngle([0,0,1],Math.PI,R.create());d=R.setAxisAngle([1,0,0],Math.PI/2,R.create());R.multiply(c,d,c);R.multiply(a,c,b);return b};a.cleanup=function(){U=0;O={}};a.clamp=z;a.smooth=function(a,b,c,d){return d?(c=Math.exp(-c/d),(1-c)*a+c*b):a};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));if(d)for(c=Math.exp(-c/d),d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*
b[d];else m.copy(a,e);return e};a.zI=function(a,b,c,d,e){e||(e=new Float32Array(a.length));d?R.slerp(a,b,Math.exp(-c/d),e):R.copy(a,e)};a.uA=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=N.fromQuat(a,fa),d=V;d[0]=c[6];d[1]=c[7];d[2]=c[8];d=m.cross(xa,d,d);m.normalize(d,d);var e=c[4];!b&&
0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);ia[0]=c[0];ia[1]=c[1];ia[2]=c[2];m.normalize(ia,ia);R.rotationTo(ia,d,X);R.multiply(X,a,a)};a.GF=function(a,b,c,d){c=c*b-.5;d=d*b-.5;var e=c-Math.floor(c),f=d-Math.floor(d);c=Math.floor(c);d=Math.floor(d);var g=b-1;return(a[d*b+c]*(1-e)+a[d*b+Math.min(c+1,g)]*e)*(1-f)+(a[Math.min(d+1,g)*b+c]*(1-e)+a[Math.min(d+1,g)*b+Math.min(c+1,g)]*e)*f};a.$m=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.OH=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&
(b[2-c]=1);return b};a.Zo=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.Xu=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.Aj=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){return a.length?a[Math.floor(Math.random()*a.length)]:null};a.horizontal_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];
c[1]=a[1]-b[1];c[2]=0;m.normalize(c,c)};a.tV=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*e,l=h*d-f*a,m=f*e-g*d;c[0]=d+2*k*b+2*(g*m-h*l);c[1]=e+2*l*b+2*(h*k-f*m);c[2]=a+2*m*b+2*(f*l-g*k)};a.assert=function(a){a||l("Assertion failed")};a.I=l;a.angle_wrap_periodic=B;a.angle_wrap_0_2pi=w;a.Yz=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.iV=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==
f;break;case "object":d=G(e,f)}if(!d)return!1}return!0};a.sB=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.wF=function(a){a++;132651<a&&J.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;return new Float32Array([b/51,Math.floor(a/51)/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d){aa.set(a);aa[3]=b;V[0]=c[3];V[1]=c[4];V[2]=c[5];X.set(V);X[3]=0;a=H.dot(aa,X);if(0==a)return null;m.copy(c,V);X.set(V);X[3]=1;a=-H.dot(aa,X)/a;d[0]=c[0]+a*c[3];d[1]=c[1]+
a*c[4];d[2]=c[2]+a*c[5];return d};a.dR=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.dY=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.RH=D;a.Zl=function(a,b,c){if(b==c)return c-a;a=w(a);b=w(b);c=w(c);b=2*Math.PI-b;c=w(c+b);a=w(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=z(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,
c){return b+a*(c-b)};a.JM=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.iY=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.IJ=function(a,b){for(var c=Math.max(a.length,b.length),d=0;d<c;d++){var f=e((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(f)return f}return 0};a.El=function(a){return a.join(".")};a.JI=function(a){return a.split(".").map(function(a){return a|0})};a.FI=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],
2.2);b[2]=Math.pow(a[2],2.2)};a.DA=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.Ji=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=F(b[1]),b.join("://")):F(a)};a.Aq=function(a){return!!parseInt(a.toString(2).substr(1),2)};a.DP=function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.Ak=function(){var a=[{}];a.length=0;return a};a.fo=function(a){a=Math.round(32767.5*
(a+1)-32768);return z(a?a:0,-32768,32767)};a.wI=function(a){return z((a+32768)/32767.5-1,-1,1)};a.fJ=function(a){return z(Math.round(255*a),0,255)};a.eJ=function(a){return z(a/255,0,1)};a.vP=function(a,b,c,d){var e=m.subtract(c,b,V),f=m.subtract(d,c,ia),g=m.subtract(b,d,na);b=m.subtract(a,b,T);c=m.subtract(a,c,ja);a=m.subtract(a,d,ea);d=m.cross(e,f,qa);if(0<=m.dot(m.cross(d,e,Z),b)&&0<=m.dot(m.cross(d,f,Z),c)&&0<=m.dot(m.cross(d,g,Z),a))return g=m.length(d),f=m.dot(d,b),Math.abs(f/g);e=m.scale(e,
z(m.dot(e,b)/m.length(e),0,1),Z);b=m.length(m.subtract(b,e,Z));f=m.scale(f,z(m.dot(f,c)/m.length(f),0,1),Z);f=m.length(m.subtract(c,f,Z));g=m.scale(g,z(m.dot(g,a)/m.length(g),0,1),Z);g=m.length(m.subtract(a,g,Z));return Math.min(Math.min(b,f),g)};a.TT=function(a,b,c,d,e){if(c||d){var f=R.identity(P);c&&(b=R.setAxisAngle(b,c,ya),R.multiply(f,b,f));a=R.copy(a,e);d&&(e=k(a,ga,V),d=R.setAxisAngle(e,d,ya),R.normalize(d,d),R.multiply(f,d,f));R.multiply(f,a,a);R.normalize(a,a)}};a.Mw=function(a,b,c,d){k(b,
d,ia);m.normalize(ia,ia);m.subtract(c,a,na);m.normalize(na,na);a=D(ia,na,aa);R.multiply(a,b,b);R.normalize(b,b)};a.tT=function(a,b,c,d){b=m.transformQuat(b,a,ia);var e=m.dot(d,c);d=m.scale(d,e,na);c=m.subtract(c,d,na);d=R.identity(P);m.normalize(c,c);.999999>Math.abs(m.dot(b,c))&&D(b,c,d);R.normalize(d,d);R.multiply(d,a,a)};a.DE=function(a,b){for(var c=2*Math.PI,d=[],e=0;3>e;e++)d[e]=a[e]-b[e],5.1<d[e]?(a[e]-=d[e]/c*c,d[e]=a[e]-b[e]):-5.1>d[e]&&(a[e]+=-d[e]/c*c,d[e]=a[e]-b[e]);3.2<Math.abs(d[0])&&
1.6>Math.abs(d[1])&&1.6>Math.abs(d[2])&&(a[0]=0<d[0]?a[0]-c:a[0]+c);3.2<Math.abs(d[1])&&1.6>Math.abs(d[2])&&1.6>Math.abs(d[0])&&(a[1]=0<d[1]?a[1]-c:a[1]+c);3.2<Math.abs(d[2])&&1.6>Math.abs(d[0])&&1.6>Math.abs(d[1])&&(a[2]=0<d[2]?a[2]-c:a[2]+c)};a.DB=function(a,b,c){b=f(b,fa);a=f(a,Ca);a=N.multiply(a,b,ca);b=V;n(a,b,ia);m.copy(Math.abs(b[0])+Math.abs(b[1])+Math.abs(b[2])>Math.abs(ia[0])+Math.abs(ia[1])+Math.abs(ia[2])?ia:b,c)};a.uT=function(a,b,c){a=N.fromQuat(a,fa);var d=V;n(a,d,ia);m.copy(Math.abs(d[0]-
b[0])+Math.abs(d[1]-b[1])+Math.abs(d[2]-b[2])>Math.abs(ia[0]-b[0])+Math.abs(ia[1]-b[1])+Math.abs(ia[2]-b[2])?ia:d,c);return c}};b4w.module.__sfx=function(a,t){function e(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(na){return B.error('Unable to initialize AudioContext: "'+na+'". The audio is disabled.'),null}if(b.createGain)return b;B.warn("deprecated WebAudio implementation");return null}B.warn("WebAudio is not supported");return null}function c(a,c,d){var e=a.ea;if("NONE"!=e.behavior){var f=e.loop,g=e.pitch;if(e.src&&(f||0<=d)){e.Ry=Math.floor(5E4*Math.random());var l=R.currentTime+
c,l=Math.max(0,l);e.Jf=l;e.state=20;var n=m.Qc;"POSITIONAL"==e.behavior&&"none"==n.Vq&&(e.behavior="BACKGROUND_SOUND");b(a,m.Qc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){c=R.createBufferSource();c.buffer=e.src;c.playbackRate.value=g;if(f){e.nc&&e.nc.disconnect();e.Ud&&e.Ud.disconnect();c.loop=!0;c.loopStart=e.PG;if(c.loopEnd=e.Zv)d=R.createBufferSource(),d.buffer=e.src,d.playbackRate.value=g,e.Ud=d,d.connect(e.Od);c.start(l);e.duration=0}else f=c.buffer?c.buffer.duration:0,d>f?
(f=l+d+e.Ue,c.loop=!0,c.start(l),c.stop(f),e.duration=d):(c.loop=!1,c.start(l),e.duration=f);c.connect(e.Od);e.nc=c;k(e);q(e);h(e)}else"BACKGROUND_MUSIC"==e.behavior&&(G.clear_timeout(e.Uy),G.clear_timeout(e.Vy),d=function(){var b=a.ea,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.nc=b.nc||R.createMediaElementSource(c),b.nc.connect(b.Od),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():e.Uy=G.set_timeout(d,1E3*c),f?e.duration=0:e.duration=z(a));u(e,l)}}}function b(a,b){var c=a.ea;if(!c.Od){var d=
v.get_trans_view(a.v.C),e=v.get_quat_view(a.v.C);if(N.hw){var f=R.createBiquadFilter();f.type="peaking"}else f=null;var g=R.createGain();switch(c.behavior){case "POSITIONAL":var h=R.createPanner();"string"!=typeof h.panningModel?(h.panningModel=h.EQUALPOWER,h.distanceModel=h.INVERSE_DISTANCE):(h.panningModel="equalpower",h.distanceModel=b.Vq);h.setPosition(d[0],d[1],d[2]);F.copy(d,c.AA);d=I;D.quat_to_dir(e,D.AXIS_MZ,d);h.setOrientation(d[0],d[1],d[2]);h.refDistance=c.dist_ref;h.maxDistance=c.dist_max;
h.rolloffFactor=c.attenuation;h.coneInnerAngle=c.HE;h.coneOuterAngle=c.IE;h.coneOuterGain=c.JE;var k=R.createGain();k.gain.value=E(c);f?(h.connect(f),f.connect(k)):h.connect(k);k.connect(g);c.Od=h;if(c.tn){var l=R.createGain();g.connect(l);l.connect(b.Od)}else l=null,g.connect(b.Od);break;case "BACKGROUND_SOUND":h=null;k=R.createGain();k.gain.value=E(c);f?(c.Od=f,f.connect(k)):c.Od=k;k.connect(g);c.tn?(l=R.createGain(),g.connect(l),l.connect(b.Od)):(l=null,g.connect(b.Od));break;case "BACKGROUND_MUSIC":l=
h=null,k=R.createGain(),k.gain.value=E(c),f?(c.Od=f,f.connect(k)):c.Od=k,k.connect(g),g.connect(b.Od)}c.jB=h;c.Ah=f;c.lo=k;c.Gk=g;c.uB=l}}function f(a){var b=a.ea;c(a,b.delay+b.cF*Math.random(),b.duration)}function k(a){var b=a.Ud||a.nc;D.ge(b.onended)&&(b.onended=function(){a.state=50})}function q(a){a.tn&&a.uB.gain.cancelScheduledValues(a.Jf);a.Vo&&(a.nc.playbackRate.cancelScheduledValues(a.Jf),a.Ud&&a.Ud.playbackRate.cancelScheduledValues(a.Jf));a.Ws=a.Jf}function h(a){if(a.tn||a.Vo){var b=a.uB,
c=a.nc,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Jf;U[0]=a.Ry;for(var f=0;5>f;){var g=a.pitch+a.Vo*D.fh(U);if(e>=a.Ws){if(a.tn){var h=1-D.clamp(a.tn,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Vo&&(c.playbackRate.setValueAtTime(g,e),a.Ud&&a.Ud.playbackRate.setValueAtTime(g,e));f++}e+=d/g}a.Ws=e-.001}}}function u(a,b){if(a.wj||a.Ue){var c=a.Gk;c.gain.cancelScheduledValues(b);a.wj?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.wj)):c.gain.setValueAtTime(1,b);a.Ue&&!a.loop&&
(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Ue))}}function y(a){"SPEAKER"!=a.type&&D.I("Wrong object type");var b=a.ea;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Gk,d=R.currentTime;b.Ue&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Ue));"BACKGROUND_MUSIC"==b.behavior?b.src&&(G.clear_timeout(b.Uy),G.clear_timeout(b.Vy),b.Vy=G.set_timeout(function(){var b=a.ea.src;b&&(b.currentTime&&(b.currentTime=0),
b.pause())},1E3*b.Ue)):(c=b.nc,c.onended=function(){},b.duration<c.buffer.duration?b.Ue&&20==b.state?c.stop(d+b.Ue):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Jf=0,b.lB=0,b.Nt=0);b.state=30}}function g(a){a=a.ea;if(20==a.state){var b=R.currentTime;a.lB=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(b>a.Jf?a.Nt=d(a,b):a.Nt=0,a.nc.onended=function(){},a.nc.stop(0),a.nc.disconnect(),q(a));a.state=40}}function d(a,b){U[0]=a.Ry;for(var c=a.nc.buffer.duration,d=a.Jf,e;d<b;)e=a.pitch+
a.Vo*D.fh(U),d+=c/e;return(c/e-(d-b))*e}function r(a){var b=a.ea;if(40==b.state){var c=R.currentTime;b.Jf+=c-b.lB;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.ea;var d=R.createBufferSource();d.loop=a.nc.loop;d.loopStart=a.nc.loopStart;d.loopEnd=a.nc.loopEnd;d.buffer=a.nc.buffer;d.playbackRate.value=a.nc.playbackRate.value;d.connect(a.Od);a.nc=d;a.Ud&&(d=R.createBufferSource(),d.loop=a.Ud.loop,d.buffer=a.Ud.buffer,d.playbackRate.value=a.Ud.playbackRate.value,d.connect(a.Od),a.Ud=d);b.Ws=
c;c=b.nc;k(b);c.start(b.Jf,b.Nt);h(b)}u(b,b.Jf);b.state=20}}function p(a,b,c){var d;d=b.wP;if(0<d){var e=b.$U;if(0!=F.dot(a.cy,a.cy)||0!=F.dot(b.Mm,b.Mm)){var f=F.subtract(a.AA,b.Gi,I),g=F.length(f);b=F.dot(f,b.Mm)/g;f=F.dot(f,a.cy)/g;g=e/d;b=Math.min(-b,g);f=Math.min(-f,g);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=D.smooth(d,a.EG,c,.3);a.nc.playbackRate.value=d;a.EG=d}}}function M(a){a=a.ea;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function E(a){return a.muted?
0:a.volume}function z(a){a=a.ea;return(a=a.src)?a.duration:0}var l=t("__config"),B=t("__print"),w=t("__quat"),G=t("__time"),v=t("__tsr"),D=t("__util"),F=t("__vec3"),n=l.K,N=l.ea,I=new Float32Array(3),x=new Float32Array(3),J=w.create(),A=[],C=[],R=null,m=null,H=[],U=[1],O=null;a.LC=10;a.qy=20;a.KC=30;a.BO=function(){return{Nc:-1,wi:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,HE:360,IE:360,JE:1,autoplay:!1,cyclic:!1,loop:!1,PG:0,Zv:0,delay:0,cF:0,tn:0,Vo:0,wj:0,
Ue:0,Jf:0,lB:0,Nt:0,duration:0,Ws:0,Ry:1,src:null,state:10,AA:new Float32Array(3),cy:new Float32Array(3),Fu:!1,EG:1,Uy:-1,Vy:-1,mm:0,Od:null,nc:null,Ud:null,jB:null,Ah:null,lo:null,Gk:null,uB:null,Al:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(A.push("ogg"),A.push("ogv"),A.push("oga")),""!=a.canPlayType("audio/mpeg")&&A.push("mp3"),""!=a.canPlayType("audio/mp4")&&(A.push("mp4"),A.push("m4v"),A.push("m4a")),
""!=a.canPlayType("audio/webm")&&A.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(C.push("ogv"),C.push("ogg"),C.push("oga")),""!=b.canPlayType("video/mp4")&&(C.push("m4v"),C.push("mp4")),""!=b.canPlayType("video/webm")&&C.push("webm"),""!=b.canPlayType("video/mpeg")&&C.push("mp3"))};a.PM=function(a){N.FC&&!R&&(R=e())&&B.log("%cINIT WEBAUDIO: "+R.sampleRate+"Hz","color: #00a");if(R){var b={Gi:new Float32Array(3),Mm:new Float32Array(3),Al:0},c=R.createGain(),d=R.createGain();b.lo=c;
b.Gk=d;c.connect(d);d.connect(R.destination);if(a.b4w_enable_dynamic_compressor){var d=R.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;d.threshold.value=f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.Kq=d;b.Od=d}else b.Kq=null,b.Od=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Vq="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Vq="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Vq=
"exponential";break;case "NONE":b.Vq="none";break;default:D.I("Wrong audio distance model")}b.wP=a.audio_doppler_factor;b.$U=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=E(b);b.mm=0}else b=null;a.Qc=b};a.dU=function(a){m=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<A.indexOf(a)?a:-1<A.indexOf("m4a")?"m4a":-1<A.indexOf("oga")?"oga":""};a.detect_video_container=function(a){a||(a="webm");return-1<C.indexOf(a)?a:-1<C.indexOf("m4v")?"m4v":-1<C.indexOf("webm")?
"webm":""};a.Ap=function(a,b){var c=a.data,d=b.ea;if(a.data.sound){d.Nc=a.data.sound.uuid;d.wi=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=R?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;R?(window.MediaElementAudioSourceNode?e=!0:(B.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!n.sE?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:D.I("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Fu=
c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;d.dist_max=c.distance_max||1E4;d.HE=c.cone_angle_inner;d.IE=c.cone_angle_outer;d.JE=c.cone_volume_outer;d.autoplay=c.b4w_auto_play;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.PG=c.b4w_loop_start;d.Zv=c.b4w_loop_end;d.delay=c.b4w_delay;d.cF=c.b4w_delay_random;d.tn=c.b4w_volume_random;d.Vo=c.b4w_pitch_random;d.wj=c.b4w_fade_in;d.Ue=c.b4w_fade_out;H.push(b)}};a.BI=function(b){"SPEAKER"!=
b.type&&D.I("Wrong object type");switch(b.ea.behavior){case "POSITIONAL":return a.qy;case "BACKGROUND_SOUND":return a.qy;case "BACKGROUND_MUSIC":return a.KC;case "NONE":return a.LC;default:D.I("Wrong speaker behavior")}};a.gW=function(a,b){var c=a.ea;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:D.I("Wrong speaker behavior")}};a.wH=function(){var a=R.createBufferSource();a.buffer=R.createBuffer(1,22050,22050);a.connect(R.destination);
a.start(0)};a.oP=function(a,b,c){R?R.decodeAudioData(a,b,c):c()};a.XU=function(a){y(a);a.ea=null;H.splice(H.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<H.length;a++){var b=H[a].ea;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.nc&&b.nc.disconnect(),b.Ud&&b.Ud.disconnect())}m&&m.Qc&&(a=m.Qc,a.Gi[0]=0,a.Gi[1]=0,a.Gi[2]=0,a.Mm[0]=0,a.Mm[1]=0,a.Mm[2]=0);m=null;H.splice(0);O=null};a.update=function(a){if(R&&H.length){for(var b=0;b<H.length;b++){var c=H[b],d=c.ea,e=d.nc,g=R.currentTime;!d.loop&&
20==d.state&&d.duration&&d.Jf+d.duration<g&&("BACKGROUND_MUSIC"==d.behavior||e&&!D.ge(e.onended))&&(d.state=50);d.cyclic&&50==d.state&&f(c);20==d.state&&3>d.Ws-g&&h(d)}O&&O.$j.length&&(-1==O.active||a>O.BD+O.hF[O.active])&&(b=O,-1<b.active&&y(b.$j[b.active]),c=-1==b.active&&b.random?Math.round(Math.random()*(b.$j.length-1)):b.random?(b.active+(1+Math.round(Math.random()*(b.$j.length-2))))%b.$j.length:(b.active+1)%b.$j.length,f(b.$j[c]),b.active=c,b.BD=a)}};a.play=c;a.play_def=f;a.stop=y;a.is_playing=
function(a){return 20==a.ea.state};a.WU=g;a.YU=r;a.loop_stop=function(a,b){var c=a.ea,d=c.Ud;if(M(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var e=R.currentTime+b;c.nc.stop(e);d.start(e,c.Zv)}};a.playrate=function(a,b){var c=a.ea;c.pitch=b;!M(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.nc.playbackRate.value=b,c.Ud&&(c.Ud.playbackRate.value=b),q(c),h(c))};a.get_playrate=function(a){return a.ea.pitch};a.cyclic=function(a,b){a.ea.cyclic=!!b};a.IR=function(a){return a.ea.autoplay};
a.is_cyclic=function(a){return a.ea.cyclic};a.nS=function(a,b,c,d,e){if(a=a.Qc){var f=I;f[0]=0;f[1]=0;f[2]=-1;F.transformQuat(f,c,f);x[0]=0;x[1]=1;x[2]=0;F.transformQuat(x,c,x);c=R.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(f[0],f[1],f[2],x[0],x[1],x[2]);if(d&&a.Al!=e){if(a.listener_stride)a.listener_stride=!1,F.copy(b,a.Gi);else for(c=a.Mm,c[0]=(b[0]-a.Gi[0])/d,c[1]=(b[1]-a.Gi[1])/d,c[2]=(b[2]-a.Gi[2])/d,F.copy(b,a.Gi),b=0;b<H.length;b++)c=H[b],f=c.ea,M(c)&&"POSITIONAL"==f.behavior&&
f.Fu&&p(f,a,d);a.Al=e}else F.copy(b,a.Gi)}};a.listener_stride=function(){var a=m.Qc;a&&(a.listener_stride=!0)};a.ZU=function(a,b,c){var d=a.ea;if(M(a)&&"POSITIONAL"==d.behavior){var e=v.Qb(a.v.C,I);a=v.tb(a.v.C,J);var f=d.jB;f.setPosition(e[0],e[1],e[2]);D.quat_to_dir(a,D.AXIS_MZ,x);f.setOrientation(x[0],x[1],x[2]);d.Fu&&(a=d.AA,b&&d.Al!=c?(d.LI?(F.copy(e,a),d.LI=!1):(f=d.cy,f[0]=(e[0]-a[0])/b,f[1]=(e[1]-a[1])/b,f[2]=(e[2]-a[2])/b,F.copy(e,a),p(d,m.Qc,b)),d.Al=c):F.copy(e,a))}};a.speaker_stride=function(a){var b=
a.ea;M(a)&&"POSITIONAL"==b.behavior&&b.Fu&&(b.LI=!0)};a.$z=function(a){return a.ea.behavior};a.check_active_speakers=function(){for(var a=0;a<H.length;a++)if(M(H[a]))return!0;return!1};a.wU=function(a){var b=m.Qc;b&&(b.volume=a,R&&(b.lo.gain.value=E(b)))};a.ZQ=function(){var a=m.Qc;return a?a.volume:0};a.set_volume=function(a,b){var c=a.ea;c.volume=b;M(a)&&(c.lo.gain.value=E(c))};a.get_volume=function(a){return a.ea.volume};a.mute=function(a,b){a.ea.muted=!!b;M(a)&&(a.ea.lo.gain.value=E(a.ea))};a.is_muted=
function(a){return a.ea.muted};a.NS=function(a){var b=m.Qc;b&&(b.muted=!!a,R&&(b.lo.gain.value=E(b)))};a.PR=function(){var a=m.Qc;return a?a.muted:!1};a.get_speaker_objects=function(){return H};a.pause=function(){for(var a=0;a<H.length;a++)g(H[a])};a.resume=function(){for(var a=0;a<H.length;a++)r(H[a])};a.set_compressor_params=function(a,b){if(a.Qc&&a.Qc.Kq){var c=a.Qc.Kq;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=
function(a){if(!a.Qc||!a.Qc.Kq)return null;a=a.Qc.Kq;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(M(a)){a=a.ea;var d=a.Gk,e=R.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.mm=c}};a.unduck=function(a){if(M(a)){a=a.ea;var b=a.Gk,c=R.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.mm);a.mm=0}};a.zP=function(a,b){if(R){var c=
m.Qc,d=c.Gk,e=R.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.mm=b}};a.xV=function(){if(R){var a=m.Qc,b=a.Gk,c=R.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.mm);a.mm=0}};a.apply_playlist=function(a,b,c){O={active:-1,BD:0,random:c,$j:[],hF:[]};for(c=0;c<a.length;c++){var d=a[c],e=z(d);0==e?B.warn("Ignoring speaker with zero duration: "+d.name):(y(d),d.ea.cyclic=!1,O.$j.push(d),O.hF.push(e+b))}};a.get_duration=z;
a.clear_playlist=function(){if(O)for(var a=O.$j,b=0;b<a.length;b++)y(a[b]);O=null};a.get_positional_params=function(a){return(a=a.ea)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.ea;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.jB;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=
function(a,b){var c=a.ea;c&&c.Ah&&(c.Ah.frequency.value=b.freq,c.Ah.Q.value=b.Q,c.Ah.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.ea)&&a.Ah?{freq:a.Ah.frequency.value,Q:a.Ah.Q.value,gain:a.Ah.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.ea;if(!a||!a.Ah)return null;a.Ah.getFrequencyResponse(b,c,d)};a.reset=function(){A.length=0;C.length=0;R=null}};b4w.module.__input=function(a,t){function e(a){var b=U.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b&&H())&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!e(a))return null;var c={type:a,tg:!1,eh:[],Lh:[],Lj:[],he:[],Mj:[],Nj:[],Ar:[],BG:[],Fj:[],gk:[],fk:[],ek:[],element:b,Ni:!0,fc:[],lw:new Float32Array(2),KS:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),gs:null,xn:null,Xi:null,td:null,orientation:ja.create(),
position:qa.create(),Ch:window.VRFrameData?new VRFrameData:null,XB:T.create(),xj:new Float32Array(4),yj:new Float32Array(4),Gh:0,di:0,ls:0,Hl:0,yi:0,ei:0,um:[],Ik:[0,0,0,0,0,0,0,0,0,0,0,0],uF:[0,0,0,0,0,0,0,0,0,0,0,0],Wu:[]};c.xj[0]=c.xj[1]=c.xj[2]=c.xj[3]=Math.PI/4;c.yj[0]=c.yj[1]=c.yj[2]=c.yj[3]=Math.PI/4;30==a||40==a||50==a?(c.tg=!!b,50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Ni=!1)):10==a?c.tg=!0:20==a&&f(c);return c}function b(b,d){10==b||20==b?d=window:d||(40==b?d=
document:d=O.get_container());for(var e=0;e<sa.length;e++)if(sa[e].type==b&&sa[e].element==d)return sa[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.Wu.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,a.GMPD_BUTTON_21,
a.GMPD_BUTTON_22,a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,a.GMPD_AXIS_11);e&&sa.push(e);return e}function f(a){20==a.type&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(b){0<b.length&&(a.td=b[0],a.tg=!0,a.td.getFrameData(a.Ch),a.gs&&a.gs())},function(){na.ia("WebVR displays are not found.");a.tg=!1}):navigator.getVRDevices?
(navigator.getVRDevices().then(function(b){u(a,b);b.length&&(a.tg=!0);a.gs&&a.gs()},function(){na.ia("WebVR devices are not found.");a.tg=!1}),q(a,X.webvr)):(k(a),a.tg=!0))}function k(a){var b=X.nonwebvr;a.Hl=b.Hl;a.yi=b.yi;a.ei=b.ei;q(a,b);a.Gh=b.Gh;a.di=b.di;a.ls=b.ls;h(a)}function q(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];
a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function h(a){var b=Math.atan(a.Gh/2/a.ls*X.nonwebvr.gF);b&&(a.xj[0]=a.yj[0]=Math.min(b,Math.PI/3));b&&(a.xj[1]=a.yj[3]=Math.min(b,Math.PI/3));b&&(a.xj[2]=a.yj[2]=Math.min(b,Math.PI/3));b&&(a.xj[3]=a.yj[1]=Math.min(b,Math.PI/3))}function u(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==
a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.xn=d;a.Xi=c}function y(a,b,c){switch(a.type){case 20:var e=d(a,0);if(e&1){var f="left"==b?a.xj:a.yj;Z.copy(f,c)}else if(f=a.td||a.xn)f=f.getEyeParameters(b),(f=f.fieldOfView||f.currentFieldOfView)?(c[0]=ea.deg_to_rad(f.upDegrees),c[1]=ea.deg_to_rad(f.rightDegrees),c[2]=ea.deg_to_rad(f.downDegrees),c[3]=ea.deg_to_rad(f.leftDegrees)):e&16&&(e=ca,"left"==b?ia.copy(a.Ch.leftProjectionMatrix,
e):ia.copy(a.Ch.rightProjectionMatrix,e),c[0]=Math.atan(-P[1]/P[2]),c[1]=Math.atan(-P[0]/P[2]),c[2]=Math.atan(P[1]/P[2]),c[3]=Math.atan(P[0]/P[2]));break;default:na.error("fov is undefined for device: ",a.type)}return c}function g(a,b,c){switch(a.type){case 20:a.td&&("left"==b?ia.copy(a.Ch.leftProjectionMatrix,c):"right"==b?ia.copy(a.Ch.rightProjectionMatrix,c):na.error("Unknown type of eye: ",b));break;default:na.error("Projection matrix is undefined for device: ",a.type)}return c}function d(a,b){switch(b){case 0:var c=
0;navigator.getVRDisplays&&(c|=8,a.Ch&&(c|=16));navigator.getVRDevices&&(c=aa.is_mobile_device?c|4:c|2);return c||1;case 23:var d=a.td||a.xn;return d?(c=d.getEyeParameters("left"),d=d.getEyeParameters("right"),a.td?d.offset[0]-c.offset[0]:d.eyeTranslation.x-c.eyeTranslation.x):a.Gh}}function r(a,c){if(a){for(var d=0;d<a.buttons.length;d++)c.um[d]=a.buttons[d].value||+a.buttons[d].pressed;if(a.axes)for(d=0;d<a.axes.length;d++)c.Ik[d]=a.axes[d];if(d=a.pose){var e=b(20).XB;d.position&&T.transform_vec3(d.position,
e,c.position);d.orientation&&T.bJ(d.orientation,e,c.orientation)}}}function p(a){for(var b=0;b<a.um;b++)a.um[b]=0;for(b=0;b<a.Ik.length;b++)a.uF[b]=a.Ik[b],a.Ik[b]=0;a.position.set(ea.Gy);a.orientation.set(ea.et)}function M(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function E(a){return null===a}function z(a,b,c,d){switch(b){case 130:c&&M(a.eh,c);if(d||a.Lh.every(E)&&a.eh.every(E))a.eh.length=0,a.Lh.length=0,b=a.fc.indexOf(141),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("deviceorientation",
B,!1));break;case 140:c&&M(a.Lh,c);if(d||a.Lh.every(E)&&a.eh.every(E))a.eh.length=0,a.Lh.length=0,b=a.fc.indexOf(141),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("deviceorientation",B,!1));break;case 50:c&&M(a.Lj,c);if(d||a.Lj.every(E))a.Lj.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("mousedown",D,!1));break;case 40:c&&M(a.he,c);if(d||a.he.every(E))a.he.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("mousemove",G,!1));
break;case 41:c&&M(a.he,c);if(d||a.he.every(E))a.he.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("mousemove",v,!1));break;case 60:c&&M(a.Mj,c);if(d||a.Mj.every(E))a.Mj.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("mouseout",F,!1),a.element.removeEventListener("mouseup",n,!1));break;case 70:c&&M(a.Nj,c);if(d||a.Nj.every(E))a.Nj.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("wheel",N,!1));break;
case 90:c&&M(a.Ar,c);if(d||a.Ar.every(E))a.Ar.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("keydown",I,!1));break;case 80:c&&M(a.Fj,c);if(d||a.Fj.every(E))a.Fj.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("keyup",x,!1));break;case 100:c&&M(a.gk,c);if(d||a.gk.every(E))a.gk.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("touchstart",J,!1));break;case 110:c&&M(a.fk,c);if(d||a.fk.every(E))a.fk.length=
0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("touchmove",A,!1));break;case 120:if(c&&M(a.ek,c),d||a.ek.every(E))a.ek.length=0,b=a.fc.indexOf(b),0<=b&&(a.fc.splice(b,1),a.element.removeEventListener("touchend",C,!1))}}function l(a,b){ea.ordered_angles_to_quat(a,ea.ZXY,b);if("orientation"in window)var c=ea.deg_to_rad(window.orientation);else"orientation"in window.screen?c=ea.deg_to_rad(window.screen.orientation.angle):c=0;c=ja.setAxisAngle(ea.AXIS_MZ,c,za);ja.multiply(b,
c,b);return b}function B(a){var c=P;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=ea.deg_to_rad(a.alpha),c[1]=ea.deg_to_rad(a.beta),c[2]=ea.deg_to_rad(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.Lh.length;d++){var e=a.Lh[d];e&&(qa.copy(c,ba),e(ba))}if(a.eh.length)for(c=l(c,Y),d=0;d<a.eh.length;d++)if(e=a.eh[d])ja.copy(c,oa),e(oa);for(d=0;d<a.eh.length;d++)a.eh[d]||a.eh.splice(d,1);for(d=0;d<a.Lh.length;d++)a.Lh[d]||a.Lh.splice(d,1)}function w(a,b){switch(a.type){case 30:a.lw[0]=
b.clientX,a.lw[1]=b.clientY,a.KS=b.which}}function G(a){if(!W||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);w(c,a);for(var d=0;d<c.he.length;d++){var e=c.he[d];e&&(ya[0]=a.clientX,ya[1]=a.clientY,e(ya))}c.Ni&&a.preventDefault();for(d=0;d<c.he.length;d++)c.he[d]||c.he.splice(d,1)}}function v(a){if(!W||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);w(c,a);for(var d=0;d<
c.he.length;d++){var e=c.he[d];if(e){if("number"==typeof a.movementX)var f=a.movementX,g=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,g=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,g=a.mozMovementY):g=f=0;ya[0]=f;ya[1]=g;e(ya)}}c.Ni&&a.preventDefault();for(d=0;d<c.he.length;d++)c.he[d]||c.he.splice(d,1)}}function D(a){if(!W||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);w(c,a);for(var d=
0;d<c.Lj.length;d++){var e=c.Lj[d];e&&e(a.which)}c.Ni&&(window.frameElement&&window.frameElement.focus(),a.preventDefault());for(d=0;d<c.Lj.length;d++)c.Lj[d]||c.Lj.splice(d,1)}}function F(a){!O.pG(a.relatedTarget)&&a.which&&n(a)}function n(a){if(!W||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);w(c,a);for(var d=0;d<c.Mj.length;d++){var e=c.Mj[d];e&&e(a.which)}c.Ni&&a.preventDefault();for(d=0;d<c.Mj.length;d++)c.Mj[d]||c.Mj.splice(d,
1)}}function N(a){for(var c=b(30,a.currentTarget),d=0;d<c.Nj.length;d++){var e=c.Nj[d];if(e){var f;f=a;var g=0;f.wheelDelta?f.wheelDelta%120?g=ea.sign(f.wheelDelta):g=f.wheelDelta/120:f.deltaY&&(g=f.deltaY%3?-ea.sign(f.deltaY):-f.deltaY/3);f=ea.clamp(100*g,-2E3,2E3);e(f)}}c.Ni&&a.preventDefault();for(d=0;d<c.Nj.length;d++)c.Nj[d]||c.Nj.splice(d,1)}function I(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.BG:c.Ar,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.Ni&&
a.preventDefault()}function x(a){for(var c=b(40,a.currentTarget),d=0;d<c.Fj.length;d++){var e=c.Fj[d];e&&e(a.keyCode)}c.Ni&&a.preventDefault();for(d=0;d<c.Fj.length;d++)c.Fj[d]||c.Fj.splice(d,1)}function J(a){for(var c=b(50,a.currentTarget),d=0;d<c.gk.length;d++){var e=c.gk[d];e&&e(a.targetTouches)}for(d=0;d<c.gk.length;d++)c.gk[d]||c.gk.splice(d,1)}function A(a){for(var c=b(50,a.currentTarget),d=0;d<c.fk.length;d++){var e=c.fk[d];e&&e(a.targetTouches)}c.Ni&&a.preventDefault();for(d=0;d<c.fk.length;d++)c.fk[d]||
c.fk.splice(d,1)}function C(a){for(var c=b(50,a.currentTarget),d=0;d<c.ek.length;d++){var e=c.ek[d];e&&e(a.targetTouches)}for(d=0;d<c.ek.length;d++)c.ek[d]||c.ek.splice(d,1)}function R(a){switch(a){case 0:a=60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function m(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),
document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}function H(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||
window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1}var U=t("__compat"),O=t("__container"),V=t("__config"),ia=t("__mat4"),na=t("__print"),T=t("__tsr"),ja=t("__quat"),ea=t("__util"),qa=t("__vec3"),Z=t("__vec4"),aa=V.K,X=V.cG,fa=T.create(),Ca=T.create(),ca=ia.create();a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.$s=60;a.vy=70;a.wy=80;a.xy=90;a.HMD_WEBVR_DESKTOP=2;a.HMD_WEBVR_MOBILE=4;a.HMD_NON_WEBVR=1;a.HMD_WEBVR1=8;a.HMD_WEBVR1_1=
16;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.PC=21;a.QC=22;a.HMD_EYE_DISTANCE=23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENS_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=29;a.ZW=30;a.$W=31;a.MOUSE_LOCATION=40;a.YC=41;a.MOUSE_DOWN_WHICH=50;a.MOUSE_UP_WHICH=60;a.MOUSE_WHEEL=70;a.KEYBOARD_UP=80;a.KEYBOARD_DOWN=90;a.XC=91;a.TOUCH_START=100;a.TOUCH_MOVE=110;a.TOUCH_END=120;a.GYRO_ORIENTATION_QUAT=130;a.GYRO_ORIENTATION_ANGLES=140;a.GMPD_BUTTON_0=
300;a.GMPD_BUTTON_1=301;a.GMPD_BUTTON_2=302;a.GMPD_BUTTON_3=303;a.GMPD_BUTTON_4=304;a.GMPD_BUTTON_5=305;a.GMPD_BUTTON_6=306;a.GMPD_BUTTON_7=307;a.GMPD_BUTTON_8=308;a.GMPD_BUTTON_9=309;a.GMPD_BUTTON_10=310;a.GMPD_BUTTON_11=311;a.GMPD_BUTTON_12=312;a.GMPD_BUTTON_13=313;a.GMPD_BUTTON_14=314;a.GMPD_BUTTON_15=315;a.GMPD_BUTTON_16=316;a.GMPD_BUTTON_17=317;a.GMPD_BUTTON_18=318;a.GMPD_BUTTON_19=319;a.GMPD_BUTTON_20=320;a.GMPD_BUTTON_21=321;a.GMPD_BUTTON_22=322;a.GMPD_BUTTON_23=323;a.GMPD_BUTTON_24=324;a.GMPD_BUTTON_25=
325;a.GMPD_TRACKPAD_BUTTON=300;a.GMPD_TRIGGER_BUTTON=301;a.GMPD_GRIPS_BUTTON=302;a.GMPD_MENU_BUTTON=303;a.GMPD_AXIS_0=326;a.GMPD_AXIS_1=327;a.GMPD_AXIS_2=328;a.GMPD_AXIS_3=329;a.GMPD_AXIS_4=330;a.GMPD_AXIS_5=331;a.GMPD_AXIS_6=332;a.GMPD_AXIS_7=333;a.GMPD_AXIS_8=334;a.GMPD_AXIS_9=335;a.GMPD_AXIS_10=336;a.GMPD_AXIS_11=337;var Y=ja.create(),za=ja.create(),P=qa.create(),ya=new Float32Array(2),ba=qa.create(),oa=ja.create(),W="ontouchstart"in document.documentElement,sa=[];a.can_use_device=e;a.init=function(){if("HMD"==
aa.stereo||"NONE"==aa.stereo&&aa.is_mobile_device){var a=b(20);a&&document.addEventListener("onvrdisplayconnect",function(b){a.td=b.display;a.tg=!0;a.td.getFrameData(a.Ch)})}};a.get_device_by_type_element=b;a.NT=f;a.switch_prevent_default=function(a,b){a.Ni=b};a.reset_device=function(a){switch(a.type){case 20:if(a.tg)if(a.td)a.td.resetPose();else if(a.Xi)for(var b=0;b<a.Xi.length;b++)a.Xi[b].resetSensor();break;default:na.error("reset_device() is undefined for device: ",a.type)}};a.get_vector_param=
function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:qa.copy(ea.et,c);if(a.td)c[0]=a.orientation[0],c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.Xi)for(b=0;b<a.Xi.length;b++){var d=a.Xi[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,c[2]=d.orientation.z,c[3]=d.orientation.w)}a=c;break a;default:na.error("orientation_quat is undefined for device: ",a.type),a=c}return a;case 20:a:switch(a.type){case 20:qa.copy(ea.Hy,
c);if(a.td)c[0]=a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.Xi)for(b=0;b<a.Xi.length;b++)d=a.Xi[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);a=c;break a;default:na.error("position is undefined for device: ",a.type),a=c}return a;case 21:return y(a,"left",c);case 22:return y(a,"right",c);case 30:return g(a,"left",c);case 31:return g(a,"right",c);case 40:case 41:return c[0]=a.lw[0],c[1]=
a.lw[1],c}};a.get_value_param=d;a.set_config=function(a,b,c){switch(a.type){case 20:if(d(a,0)&8)break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Gh=c;h(a);break;case 25:a.di=c;h(a);break;case 26:a.ls=c;h(a);break;case 27:a.Hl=c;h(a);break;case 28:a.yi=c;h(a);break;case 29:a.ei=c,h(a)}break;case 60:case 70:case 80:case 90:a.Wu[b]=c}};a.UQ=function(a,b){var c=b-300;return c<a.um.length?a.um[a.Wu[c]-300]:!1};a.TQ=function(a,b){return b-326<a.Ik.length?a.Ik[a.Wu[b-
300]-326]:0};a.get_gamepad_position=function(a,b){b.set(a.position);return b};a.get_gamepad_orientation=function(a,b){b.set(a.orientation);return b};a.update=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<sa.length;b++){var c=sa[b];switch(c.type){case 60:p(c);r(a[0],c);break;case 70:p(c);r(a[1],c);break;case 80:p(c);r(a[2],c);break;case 90:p(c);r(a[3],c);break;case 20:if(c.td){var d=c.td;if(c.Ch&&d.getFrameData(c.Ch)){var e=
c.Ch.pose,f=ea.HA(c.Ch.leftViewMatrix,P);c.Gh=2*qa.length(f)}else e=d.getPose();e&&(f=ja.setAxisAngle(ea.AXIS_X,Math.PI/2,Y),d.stageParameters&&d.stageParameters.sittingToStandingTransform?(d=T.from_mat4(d.stageParameters.sittingToStandingTransform,fa),T.identity(Ca),f=T.set_quat(f,Ca),d=T.multiply(f,d,c.XB)):(T.identity(fa),d=T.set_quat(f,c.XB)),e.orientation&&T.bJ(e.orientation,d,c.orientation),e.position&&T.transform_vec3(e.position,d,c.position))}}}};a.attach_param_cb=function(a,b,c){switch(b){case 130:a.eh.push(c);
b=141;break;case 140:a.Lh.push(c);b=141;break;case 50:a.Lj.push(c);break;case 40:case 41:a.he.push(c);break;case 60:a.Mj.push(c);break;case 70:a.Nj.push(c);break;case 90:a.Ar.push(c);break;case 91:a.BG.push(c);b=90;break;case 80:a.Fj.push(c);break;case 100:a.gk.push(c);break;case 110:a.fk.push(c);break;case 120:a.ek.push(c)}if(-1==a.fc.indexOf(b)&&(a.fc.push(b),a.tg))switch(b){case 50:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",D,!1);break;case 40:a.element.addEventListener("mousemove",
G,!1);break;case 41:a.element.addEventListener("mousemove",v,!1);break;case 60:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",F,!1),a.element.addEventListener("mouseup",n,!1));break;case 70:a.element.addEventListener("wheel",N,!1);break;case 90:a.element.addEventListener("keydown",I,!1);break;case 80:a.element.addEventListener("keyup",x,!1);break;case 100:a.element.addEventListener("touchstart",J,!1);break;case 110:a.element.addEventListener("touchmove",
A,!1);break;case 120:a.element.addEventListener("touchend",C,!1);break;case 141:a.element.addEventListener("deviceorientation",B,!1)}};a.detach_param_cb=function(a,b,c){z(a,b,c,!1)};a.mR=l;a.cleanup=function(){for(var a=0;a<sa.length;a++)for(var b=sa[a],c=0;c<b.fc.length;c++)z(b,b.fc[c],null,!0);sa.length=0};a.get_pressed_gmpd_btn=function(a){a=b(R(a));for(var c=0;c<a.um.length;c++)if(a.um[c])return c+300;return-1};a.get_moved_gmpd_axis=function(a){a=b(R(a));for(var c=0;c<a.Ik.length;c++)if(a.uF[c]-
a.Ik[c])return c+326;return-1};a.av=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.jR=function(){var a=b(20);return a&&a.td};a.iM=function(a){a.element.addEventListener("mousedown",function(){a.value||m(a)},!1)};a.add_click_listener=function(a,b){aa.is_mobile_device?a.addEventListener("touchend",b):a.addEventListener("mouseup",b)};a.remove_click_listener=function(a,b){aa.is_mobile_device?
a.removeEventListener("touchend",b):a.removeEventListener("mouseup",b)};a.check_fullscreen=H};b4w.module.__tbn=function(a,t){function e(a,b,c){a=u(a,b||0,c);r.normalize(a,c);return c}function c(a,b,c){c=c||0;var d=u(a,c,D),e=r.length(d),f=z.sign(d[3])*z.sign(b[3])||1;r.scale(b,f*e,d);3.1E-5>Math.abs(d[3])&&(d[3]=0<d[3]?3.1E-5:-3.1E-5);y(a,d,c);return a}function b(a,b){return z.sign(a[4*(b||0)+3])}function f(a,b,c){c=c||0;var d=u(a,c,D);0>z.sign(d[3])*b&&r.scale(d,-1,d);y(a,d,c)}function k(a,b,c){c=c||0;var d=u(a,c,D);r.normalize(d,d);r.scale(d,b,d);3.1E-5>Math.abs(d[3])&&(d[3]=0<d[3]?d[3]+
3.1E-5:d[3]-3.1E-5);y(a,d,c)}function q(a,b){var c=u(a,b||0,D);return r.length(c)}function h(a){a=0!==a?a||1:0;for(var b=new Float32Array(4*a),c=0;c<a;c++)b[4*c+3]=.5;return b}function u(a,b,c){c[0]=a[4*b];c[1]=a[4*b+1];c[2]=a[4*b+2];c[3]=a[4*b+3];return c}function y(a,b,c){a[4*c]=b[0];a[4*c+1]=b[1];a[4*c+2]=b[2];a[4*c+3]=b[3];return a}function g(a){return a.length/4}function d(a,d,h){for(var l=g(a),n=0;n<l;n++){var p=b(a,n),v=q(a,n),u=e(a,n,B),u=r.multiply(d,u,B);c(h,u,n);k(h,v,n);f(h,p,n)}}a.kD=
4;var r=t("__quat"),p=t("__tsr"),M=t("__vec3"),E=t("__vec4"),z=t("__util"),l=r.create(),B=r.create(),w=M.create(),G=M.create(),v=M.create(),D=E.create(),F=E.create();a.tm=function(a,b,d){var e=!(!b||!b.length),g=a.length/3;d=d||h(g);for(var n=0;n<g;++n){var p=w;p[0]=a[3*n];p[1]=a[3*n+1];p[2]=a[3*n+2];M.normalize(p,p);if(e){var q=F;q[0]=b[4*n];q[1]=b[4*n+1];q[2]=b[4*n+2];q[3]=b[4*n+3];M.normalize(q,q);var m=M.cross(q,p,G);M.normalize(m,m);var u=r.rotationTo(z.AXIS_Z,m,l),y=M.transformQuat(z.AXIS_Y,
u,v),y=r.rotationTo(y,p,B),u=r.multiply(y,u,l);r.normalize(u,u);y=.5;m=M.cross(p,m,v);if(3.1E-5<Math.abs(m[0]-q[0])||3.1E-5<Math.abs(m[1]-q[1])||3.1E-5<Math.abs(m[2]-q[2]))y=Math.acos(M.dot(p,q))/Math.PI;c(d,u,n);f(d,z.sign(q[3]),n);k(d,y,n)}else u=r.rotationTo(z.AXIS_Y,p,l),c(d,u,n)}return d};a.copy=function(a,b,c,d){if(0!==c){b=4*b||0;c=c||a.length;for(var e=0,f=0;e<4*c;e+=4,f+=4)d[f]=a[b+e],d[f+1]=a[b+e+1],d[f+2]=a[b+e+2],d[f+3]=a[b+e+3]}};a.tb=e;a.set_quat=c;a.bR=function(a,b,c){a=e(a,b,l);return M.transformQuat(z.AXIS_Y,
a,c)};a.create=h;a.identity=function(a){for(var b=0;b<a.length;b+=4)a[b]=0,a[b+1]=0,a[b+2]=0,a[b+3]=.5;return a};a.wm=u;a.Pi=y;a.ev=g;a.WA=d;a.aH=function(a,b,c){b=p.tb(b,l);d(a,b,c)};a.slerp=function(a,d,g,h){var n=b(d,0),p=e(a,0,l),v=e(d,0,B);a=q(a);d=q(d);p=r.slerp(p,v,g,B);r.normalize(p,p);c(h,p,0);k(h,g*(a-d)+d);f(h,n,0);return h};a.nw=function(a,d,g){var h=b(d,0),n=e(a,0,l),p=e(d,0,B);a=q(a,0);d=q(d,0);n=r.multiply(n,p,l);c(g,n,0);k(g,a+d-.5);f(g,h,0);return g};a.MS=function(a,d,g){var h=b(d,
0),n=e(a,0,l),p=e(d,0,B);a=q(a);d=q(d);p=r.invert(p,B);n=r.multiply(n,p,l);c(g,n,0);k(g,a-d+.5);f(g,h,0)}};b4w.module.__vec3=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new t(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new t(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var c=new t(3);c[0]=a;c[1]=b;c[2]=e;return c};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,k){k[0]=a;k[1]=b;k[2]=e;return k};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];
return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],
b[2]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,k){k[0]=a[0]+b[0]*e;k[1]=a[1]+b[1]*e;k[2]=a[2]+b[2]*e;return k};a.distance=function(a,b){var c=b[0]-a[0],e=b[1]-a[1],q=b[2]-a[2];return Math.sqrt(c*c+e*e+q*q)};a.dist=a.distance;a.squaredDistance=function(a,b){var c=b[0]-a[0],e=b[1]-a[1],q=b[2]-a[2];return c*c+e*e+q*q};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var c=a[0],e=a[1],q=a[2],c=c*c+e*e+q*q;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var c=a[0],f=a[1];a=a[2];var h=b[0],u=b[1];b=b[2];
e[0]=f*b-a*u;e[1]=a*h-c*b;e[2]=c*u-f*h;return e};a.lerp=function(a,b,e,k){var c=a[0],f=a[1];a=a[2];k[0]=c+e*(b[0]-c);k[1]=f+e*(b[1]-f);k[2]=a+e*(b[2]-a);return k};a.TY=function(a,b,e,k,q,h){var c=q*q,f=c*(2*q-3)+1,g=c*(q-2)+q,d=c*(q-1);q=c*(3-2*q);h[0]=a[0]*f+b[0]*g+e[0]*d+k[0]*q;h[1]=a[1]*f+b[1]*g+e[1]*d+k[1]*q;h[2]=a[2]*f+b[2]*g+e[2]*d+k[2]*q;return h};a.SD=function(a,b,e,k,q,h){var c=1-q,f=c*c,g=q*q,d=f*c,f=3*q*f,c=3*g*c;q=g*q;h[0]=a[0]*d+b[0]*f+e[0]*c+k[0]*q;h[1]=a[1]*d+b[1]*f+e[1]*c+k[1]*q;h[2]=
a[2]*d+b[2]*f+e[2]*c+k[2]*q;return h};a.random=function(a,b){a=a||1;var c=2*e()*Math.PI,k=2*e()-1,q=Math.sqrt(1-k*k)*a;b[0]=Math.cos(c)*q;b[1]=Math.sin(c)*q;b[2]=k*a;return b};a.transformMat4=function(a,b,e){var c=a[0],f=a[1];a=a[2];var h=b[3]*c+b[7]*f+b[11]*a+b[15],h=h||1;e[0]=(b[0]*c+b[4]*f+b[8]*a+b[12])/h;e[1]=(b[1]*c+b[5]*f+b[9]*a+b[13])/h;e[2]=(b[2]*c+b[6]*f+b[10]*a+b[14])/h;return e};a.transformMat3=function(a,b,e){var c=a[0],f=a[1];a=a[2];e[0]=c*b[0]+f*b[3]+a*b[6];e[1]=c*b[1]+f*b[4]+a*b[7];
e[2]=c*b[2]+f*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var c=a[0],f=a[1],h=a[2];a=b[0];var u=b[1],y=b[2];b=b[3];var g=b*c+u*h-y*f,d=b*f+y*c-a*h,r=b*h+a*f-u*c,c=-a*c-u*f-y*h;e[0]=g*b+c*-a+d*-y-r*-u;e[1]=d*b+c*-u+r*-a-g*-y;e[2]=r*b+c*-y+g*-u-d*-a;return e};a.rotateX=function(a,b,e,k){var c=[],f=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];f[0]=c[0];f[1]=c[1]*Math.cos(e)-c[2]*Math.sin(e);f[2]=c[1]*Math.sin(e)+c[2]*Math.cos(e);k[0]=f[0]+b[0];k[1]=f[1]+b[1];k[2]=f[2]+b[2];return k};a.rotateY=
function(a,b,e,k){var c=[],f=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];f[0]=c[2]*Math.sin(e)+c[0]*Math.cos(e);f[1]=c[1];f[2]=c[2]*Math.cos(e)-c[0]*Math.sin(e);k[0]=f[0]+b[0];k[1]=f[1]+b[1];k[2]=f[2]+b[2];return k};a.rotateZ=function(a,b,e,k){var c=[],f=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];f[0]=c[0]*Math.cos(e)-c[1]*Math.sin(e);f[1]=c[0]*Math.sin(e)+c[1]*Math.cos(e);f[2]=c[2];k[0]=f[0]+b[0];k[1]=f[1]+b[1];k[2]=f[2]+b[2];return k};a.forEach=function(){var c=a.create();return function(a,
e,k,q,h,u){var b;e||(e=3);k||(k=0);for(q?b=Math.min(q*e+k,a.length):b=a.length;k<b;k+=e)c[0]=a[k],c[1]=a[k+1],c[2]=a[k+2],h(c,u,c),a[k]=c[0],a[k+1]=c[1],a[k+2]=c[2];return a}}();a.angle=function(c,b){var e=a.fromValues(c[0],c[1],c[2]),k=a.fromValues(b[0],b[1],b[2]);a.normalize(e,e);a.normalize(k,k);e=a.dot(e,k);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new t(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new t(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,k){var c=new t(4);c[0]=a;c[1]=b;c[2]=e;c[3]=k;return c};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,k,q){q[0]=a;q[1]=b;q[2]=e;q[3]=k;return q};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,k){k[0]=a[0]+b[0]*e;k[1]=a[1]+b[1]*e;k[2]=a[2]+b[2]*e;k[3]=a[3]+b[3]*e;return k};a.distance=function(a,b){var c=b[0]-a[0],e=b[1]-a[1],q=b[2]-a[2],h=b[3]-a[3];return Math.sqrt(c*c+e*e+q*q+h*h)};a.dist=a.distance;a.squaredDistance=
function(a,b){var c=b[0]-a[0],e=b[1]-a[1],q=b[2]-a[2],h=b[3]-a[3];return c*c+e*e+q*q+h*h};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return Math.sqrt(b*b+c*c+e*e+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],c=a[1],e=a[2];a=a[3];return b*b+c*c+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var c=a[0],e=a[1],q=a[2],h=a[3],u=c*c+e*e+q*q+h*h;0<u&&(u=1/Math.sqrt(u),b[0]=c*u,b[1]=e*u,b[2]=q*u,b[3]=h*u);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,k){var c=a[0],f=a[1],u=a[2];a=a[3];k[0]=c+e*(b[0]-c);k[1]=f+e*(b[1]-f);k[2]=u+e*(b[2]-u);k[3]=a+e*(b[3]-a);return k};a.random=function(c,b){c=c||1;b[0]=e();b[1]=e();b[2]=e();b[3]=e();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,e){var c=a[0],f=a[1],h=
a[2];a=a[3];e[0]=b[0]*c+b[4]*f+b[8]*h+b[12]*a;e[1]=b[1]*c+b[5]*f+b[9]*h+b[13]*a;e[2]=b[2]*c+b[6]*f+b[10]*h+b[14]*a;e[3]=b[3]*c+b[7]*f+b[11]*h+b[15]*a;return e};a.transformQuat=function(a,b,e){var c=a[0],f=a[1],h=a[2],u=b[0],y=b[1],g=b[2];b=b[3];var d=b*c+y*h-g*f,r=b*f+g*c-u*h,p=b*h+u*f-y*c,c=-u*c-y*f-g*h;e[0]=d*b+c*-u+r*-g-p*-y;e[1]=r*b+c*-y+p*-u-d*-g;e[2]=p*b+c*-g+d*-y-r*-u;e[3]=a[3];return e};a.forEach=function(){var c=a.create();return function(a,e,k,q,h,u){var b;e||(e=4);k||(k=0);for(q?b=Math.min(q*
e+k,a.length):b=a.length;k<b;k+=e)c[0]=a[k],c[1]=a[k+1],c[2]=a[k+2],c[3]=a[k+3],h(c,u,c),a[k]=c[0],a[k+1]=c[1],a[k+2]=c[2],a[k+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,t){var e=t("__vec3"),c=t("__vec4"),b=t("__mat3"),f="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new f(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=e.create(),c=e.fromValues(1,0,0),f=e.fromValues(0,1,0);return function(h,k,g){var d=e.dot(h,k);if(-.9999999>d)return e.cross(c,h,b),1E-6>e.length(b)&&e.cross(f,h,b),e.normalize(b,b),a.setAxisAngle(b,Math.PI,g),g;if(.9999999<d)return g[0]=0,g[1]=0,g[2]=0,g[3]=1,g;e.cross(h,
k,b);g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=1+d;return a.normalize(g,g)}}();a.setAxes=function(){var c=b.create();return function(b,e,f,k){c[0]=e[0];c[3]=e[1];c[6]=e[2];c[1]=f[0];c[4]=f[1];c[7]=f[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,k),k)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var e=Math.sin(b);c[0]=e*a[0];c[1]=e*a[1];c[2]=e*a[2];c[3]=Math.cos(b);
return c};a.add=c.add;a.multiply=function(a,b,c){var e=a[0],f=a[1],g=a[2];a=a[3];var d=b[0],h=b[1],k=b[2];b=b[3];c[0]=e*b+a*d+f*k-g*h;c[1]=f*b+a*h+g*d-e*k;c[2]=g*b+a*k+e*h-f*d;c[3]=a*b-e*d-f*h-g*k;return c};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,c){b*=.5;var e=a[0],f=a[1],g=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*b+a*d;c[1]=f*b+g*d;c[2]=g*b-f*d;c[3]=a*b-e*d;return c};a.rotateY=function(a,b,c){b*=.5;var e=a[0],f=a[1],g=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*
b-g*d;c[1]=f*b+a*d;c[2]=g*b+e*d;c[3]=a*b-f*d;return c};a.rotateZ=function(a,b,c){b*=.5;var e=a[0],f=a[1],g=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*b+f*d;c[1]=f*b-e*d;c[2]=g*b+a*d;c[3]=a*b-g*d;return c};a.calculateW=function(a,b){var c=a[0],e=a[1],f=a[2];b[0]=c;b[1]=e;b[2]=f;b[3]=Math.sqrt(Math.abs(1-c*c-e*e-f*f));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,c,e){var f=a[0],g=a[1],d=a[2];a=a[3];var h=b[0],k=b[1],q=b[2];b=b[3];var u,t,l;t=f*h+g*k+d*q+a*b;0>t&&(t=-t,h=-h,k=-k,
q=-q,b=-b);1E-6<1-t?(u=Math.acos(t),l=Math.sin(u),t=Math.sin((1-c)*u)/l,c=Math.sin(c*u)/l):t=1-c;e[0]=t*f+c*h;e[1]=t*g+c*k;e[2]=t*d+c*q;e[3]=t*a+c*b;return e};a.NZ=function(){var b=a.create(),c=a.create();return function(e,f,k,g,d,q){a.slerp(e,g,d,b);a.slerp(f,k,d,c);a.slerp(b,c,2*d*(1-d),q);return q}}();a.invert=function(a,b){var c=a[0],e=a[1],f=a[2],g=a[3],d=c*c+e*e+f*f+g*g,d=d?1/d:0;b[0]=-c*d;b[1]=-e*d;b[2]=-f*d;b[3]=g*d;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var f=(e+1)%3,g=(e+2)%3,c=Math.sqrt(a[3*e+e]-a[3*f+f]-a[3*g+g]+1);b[e]=.5*c;c=.5/c;b[3]=(a[3*f+g]-a[3*g+f])*c;b[f]=(a[3*f+e]+a[3*e+f])*c;b[g]=(a[3*g+e]+a[3*e+g])*c}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new t(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new t(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],e=a[2],k=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=e;c[7]=k}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=a[4],u=a[5],y=a[6],g=a[7],d=a[8],r=d*h-u*g,p=-d*q+u*y,t=
g*q-h*y,E=b*r+e*p+k*t;if(!E)return null;E=1/E;c[0]=r*E;c[1]=(-d*e+k*g)*E;c[2]=(u*e-k*h)*E;c[3]=p*E;c[4]=(d*b-k*y)*E;c[5]=(-u*b+k*q)*E;c[6]=t*E;c[7]=(-g*b+e*y)*E;c[8]=(h*b-e*q)*E;return c};a.adjoint=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=a[4],u=a[5],y=a[6],g=a[7],d=a[8];c[0]=h*d-u*g;c[1]=k*g-e*d;c[2]=e*u-k*h;c[3]=u*y-q*d;c[4]=b*d-k*y;c[5]=k*q-b*u;c[6]=q*g-h*y;c[7]=e*y-b*g;c[8]=b*h-e*q;return c};a.determinant=function(a){var c=a[3],b=a[4],e=a[5],k=a[6],q=a[7],h=a[8];return a[0]*(h*b-e*q)+a[1]*
(-h*c+e*k)+a[2]*(q*c-b*k)};a.multiply=function(a,c,b){var e=a[0],k=a[1],q=a[2],h=a[3],u=a[4],y=a[5],g=a[6],d=a[7];a=a[8];var r=c[0],p=c[1],t=c[2],E=c[3],z=c[4],l=c[5],B=c[6],w=c[7];c=c[8];b[0]=r*e+p*h+t*g;b[1]=r*k+p*u+t*d;b[2]=r*q+p*y+t*a;b[3]=E*e+z*h+l*g;b[4]=E*k+z*u+l*d;b[5]=E*q+z*y+l*a;b[6]=B*e+w*h+c*g;b[7]=B*k+w*u+c*d;b[8]=B*q+w*y+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var e=a[0],k=a[1],q=a[2],h=a[3],u=a[4],y=a[5],g=a[6],d=a[7];a=a[8];var r=c[0];c=c[1];b[0]=e;b[1]=k;b[2]=q;
b[3]=h;b[4]=u;b[5]=y;b[6]=r*e+c*h+g;b[7]=r*k+c*u+d;b[8]=r*q+c*y+a;return b};a.rotate=function(a,c,b){var e=a[0],k=a[1],q=a[2],h=a[3],u=a[4],y=a[5],g=a[6],d=a[7];a=a[8];var r=Math.sin(c);c=Math.cos(c);b[0]=c*e+r*h;b[1]=c*k+r*u;b[2]=c*q+r*y;b[3]=c*h-r*e;b[4]=c*u-r*k;b[5]=c*y-r*q;b[6]=g;b[7]=d;b[8]=a;return b};a.scale=function(a,c,b){var e=c[0];c=c[1];b[0]=e*a[0];b[1]=e*a[1];b[2]=e*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.gQ=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.eQ=function(a,c){var b=Math.sin(a),e=Math.cos(a);c[0]=e;c[1]=b;c[2]=0;c[3]=-b;c[4]=e;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fQ=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=b+b,u=e+e,y=k+k,b=b*h,g=e*h,e=e*u,d=k*h,r=
k*u,k=k*y,h=q*h,u=q*u,q=q*y;c[0]=1-e-k;c[3]=g-q;c[6]=d+u;c[1]=g+q;c[4]=1-b-k;c[7]=r-h;c[2]=d-u;c[5]=r+h;c[8]=1-b-e;return c};a.normalFromMat4=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=a[4],u=a[5],y=a[6],g=a[7],d=a[8],r=a[9],p=a[10],t=a[11],E=a[12],z=a[13],l=a[14],B=a[15],w=b*u-e*h,G=b*y-k*h,v=b*g-q*h,D=e*y-k*u,F=e*g-q*u,n=k*g-q*y,N=d*z-r*E,I=d*l-p*E,d=d*B-t*E,x=r*l-p*z,r=r*B-t*z,p=p*B-t*l,t=w*p-G*r+v*x+D*d-F*I+n*N;if(!t)return null;t=1/t;c[0]=(u*p-y*r+g*x)*t;c[1]=(y*d-h*p-g*I)*t;c[2]=(h*r-u*
d+g*N)*t;c[3]=(k*r-e*p-q*x)*t;c[4]=(b*p-k*d+q*I)*t;c[5]=(e*d-b*r-q*N)*t;c[6]=(z*n-l*F+B*D)*t;c[7]=(l*v-E*n-B*G)*t;c[8]=(E*F-z*v+B*w)*t;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.dQ=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var t="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new t(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new t(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],e=a[2],k=a[3],q=a[6],h=a[7],u=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=e;c[9]=q;c[11]=a[14];c[12]=k;c[13]=
h;c[14]=u}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=a[4],u=a[5],y=a[6],g=a[7],d=a[8],r=a[9],p=a[10],t=a[11],E=a[12],z=a[13],l=a[14],B=a[15],w=b*u-e*h,G=b*y-k*h,v=b*g-q*h,D=e*y-k*u,F=e*g-q*u,n=k*g-q*y,N=d*z-r*E,I=d*l-p*E,x=d*B-t*E,J=r*l-p*z,A=r*B-t*z,C=p*B-t*l,R=w*C-G*A+v*J+D*x-F*I+n*N;if(!R)return null;
R=1/R;c[0]=(u*C-y*A+g*J)*R;c[1]=(k*A-e*C-q*J)*R;c[2]=(z*n-l*F+B*D)*R;c[3]=(p*F-r*n-t*D)*R;c[4]=(y*x-h*C-g*I)*R;c[5]=(b*C-k*x+q*I)*R;c[6]=(l*v-E*n-B*G)*R;c[7]=(d*n-p*v+t*G)*R;c[8]=(h*A-u*x+g*N)*R;c[9]=(e*x-b*A-q*N)*R;c[10]=(E*F-z*v+B*w)*R;c[11]=(r*v-d*F-t*w)*R;c[12]=(u*I-h*J-y*N)*R;c[13]=(b*J-e*I+k*N)*R;c[14]=(z*G-E*D-l*w)*R;c[15]=(d*D-r*G+p*w)*R;return c};a.adjoint=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=a[4],u=a[5],y=a[6],g=a[7],d=a[8],r=a[9],p=a[10],t=a[11],E=a[12],z=a[13],l=a[14],B=a[15];
c[0]=u*(p*B-t*l)-r*(y*B-g*l)+z*(y*t-g*p);c[1]=-(e*(p*B-t*l)-r*(k*B-q*l)+z*(k*t-q*p));c[2]=e*(y*B-g*l)-u*(k*B-q*l)+z*(k*g-q*y);c[3]=-(e*(y*t-g*p)-u*(k*t-q*p)+r*(k*g-q*y));c[4]=-(h*(p*B-t*l)-d*(y*B-g*l)+E*(y*t-g*p));c[5]=b*(p*B-t*l)-d*(k*B-q*l)+E*(k*t-q*p);c[6]=-(b*(y*B-g*l)-h*(k*B-q*l)+E*(k*g-q*y));c[7]=b*(y*t-g*p)-h*(k*t-q*p)+d*(k*g-q*y);c[8]=h*(r*B-t*z)-d*(u*B-g*z)+E*(u*t-g*r);c[9]=-(b*(r*B-t*z)-d*(e*B-q*z)+E*(e*t-q*r));c[10]=b*(u*B-g*z)-h*(e*B-q*z)+E*(e*g-q*u);c[11]=-(b*(u*t-g*r)-h*(e*t-q*r)+d*
(e*g-q*u));c[12]=-(h*(r*l-p*z)-d*(u*l-y*z)+E*(u*p-y*r));c[13]=b*(r*l-p*z)-d*(e*l-k*z)+E*(e*p-k*r);c[14]=-(b*(u*l-y*z)-h*(e*l-k*z)+E*(e*y-k*u));c[15]=b*(u*p-y*r)-h*(e*p-k*r)+d*(e*y-k*u);return c};a.determinant=function(a){var c=a[0],b=a[1],e=a[2],k=a[3],q=a[4],h=a[5],u=a[6],y=a[7],g=a[8],d=a[9],r=a[10],p=a[11],t=a[12],E=a[13],z=a[14];a=a[15];return(c*h-b*q)*(r*a-p*z)-(c*u-e*q)*(d*a-p*E)+(c*y-k*q)*(d*z-r*E)+(b*u-e*h)*(g*a-p*t)-(b*y-k*h)*(g*z-r*t)+(e*y-k*u)*(g*E-d*t)};a.multiply=function(a,c,b){var e=
a[0],k=a[1],q=a[2],h=a[3],u=a[4],y=a[5],g=a[6],d=a[7],r=a[8],p=a[9],t=a[10],E=a[11],z=a[12],l=a[13],B=a[14];a=a[15];var w=c[0],G=c[1],v=c[2],D=c[3];b[0]=w*e+G*u+v*r+D*z;b[1]=w*k+G*y+v*p+D*l;b[2]=w*q+G*g+v*t+D*B;b[3]=w*h+G*d+v*E+D*a;w=c[4];G=c[5];v=c[6];D=c[7];b[4]=w*e+G*u+v*r+D*z;b[5]=w*k+G*y+v*p+D*l;b[6]=w*q+G*g+v*t+D*B;b[7]=w*h+G*d+v*E+D*a;w=c[8];G=c[9];v=c[10];D=c[11];b[8]=w*e+G*u+v*r+D*z;b[9]=w*k+G*y+v*p+D*l;b[10]=w*q+G*g+v*t+D*B;b[11]=w*h+G*d+v*E+D*a;w=c[12];G=c[13];v=c[14];D=c[15];b[12]=w*e+
G*u+v*r+D*z;b[13]=w*k+G*y+v*p+D*l;b[14]=w*q+G*g+v*t+D*B;b[15]=w*h+G*d+v*E+D*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var e=c[0],k=c[1];c=c[2];var q,h,u,y,g,d,r,p,t,E,z,l;a===b?(b[12]=a[0]*e+a[4]*k+a[8]*c+a[12],b[13]=a[1]*e+a[5]*k+a[9]*c+a[13],b[14]=a[2]*e+a[6]*k+a[10]*c+a[14],b[15]=a[3]*e+a[7]*k+a[11]*c+a[15]):(q=a[0],h=a[1],u=a[2],y=a[3],g=a[4],d=a[5],r=a[6],p=a[7],t=a[8],E=a[9],z=a[10],l=a[11],b[0]=q,b[1]=h,b[2]=u,b[3]=y,b[4]=g,b[5]=d,b[6]=r,b[7]=p,b[8]=t,b[9]=E,b[10]=z,b[11]=l,
b[12]=q*e+g*k+t*c+a[12],b[13]=h*e+d*k+E*c+a[13],b[14]=u*e+r*k+z*c+a[14],b[15]=y*e+p*k+l*c+a[15]);return b};a.scale=function(a,c,b){var e=c[0],k=c[1];c=c[2];b[0]=a[0]*e;b[1]=a[1]*e;b[2]=a[2]*e;b[3]=a[3]*e;b[4]=a[4]*k;b[5]=a[5]*k;b[6]=a[6]*k;b[7]=a[7]*k;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,f){var e=b[0],q=b[1];b=b[2];var h=Math.sqrt(e*e+q*q+b*b),u,y,g,d,r,p,t,E,z,l,B,w,G,v,D,F,n,N,I,x;if(1E-7>Math.abs(h))return null;
h=1/h;e*=h;q*=h;b*=h;u=Math.sin(c);y=Math.cos(c);g=1-y;c=a[0];h=a[1];d=a[2];r=a[3];p=a[4];t=a[5];E=a[6];z=a[7];l=a[8];B=a[9];w=a[10];G=a[11];v=e*e*g+y;D=q*e*g+b*u;F=b*e*g-q*u;n=e*q*g-b*u;N=q*q*g+y;I=b*q*g+e*u;x=e*b*g+q*u;e=q*b*g-e*u;q=b*b*g+y;f[0]=c*v+p*D+l*F;f[1]=h*v+t*D+B*F;f[2]=d*v+E*D+w*F;f[3]=r*v+z*D+G*F;f[4]=c*n+p*N+l*I;f[5]=h*n+t*N+B*I;f[6]=d*n+E*N+w*I;f[7]=r*n+z*N+G*I;f[8]=c*x+p*e+l*q;f[9]=h*x+t*e+B*q;f[10]=d*x+E*e+w*q;f[11]=r*x+z*e+G*q;a!==f&&(f[12]=a[12],f[13]=a[13],f[14]=a[14],f[15]=a[15]);
return f};a.rotateX=function(a,c,b){var e=Math.sin(c);c=Math.cos(c);var k=a[4],q=a[5],h=a[6],u=a[7],y=a[8],g=a[9],d=a[10],r=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=k*c+y*e;b[5]=q*c+g*e;b[6]=h*c+d*e;b[7]=u*c+r*e;b[8]=y*c-k*e;b[9]=g*c-q*e;b[10]=d*c-h*e;b[11]=r*c-u*e;return b};a.rotateY=function(a,c,b){var e=Math.sin(c);c=Math.cos(c);var k=a[0],q=a[1],h=a[2],u=a[3],y=a[8],g=a[9],d=a[10],r=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=k*c-y*e;b[1]=q*c-g*e;b[2]=h*c-d*e;b[3]=u*c-r*e;b[8]=k*e+y*c;b[9]=q*e+g*c;b[10]=h*e+d*c;b[11]=u*e+r*c;return b};a.rotateZ=function(a,c,b){var e=Math.sin(c);c=Math.cos(c);var k=a[0],q=a[1],h=a[2],u=a[3],y=a[4],g=a[5],d=a[6],r=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=k*c+y*e;b[1]=q*c+g*e;b[2]=h*c+d*e;b[3]=u*c+r*e;b[4]=y*c-k*e;b[5]=g*c-q*e;b[6]=d*c-h*e;b[7]=r*c-u*e;return b};
a.gQ=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.fQ=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.eQ=function(a,c,b){var e=c[0],k=c[1];c=c[2];var q=Math.sqrt(e*e+k*k+c*c),h;if(1E-7>Math.abs(q))return null;q=1/q;e*=q;k*=q;c*=q;q=Math.sin(a);a=Math.cos(a);h=1-a;b[0]=e*e*h+a;b[1]=k*e*h+c*
q;b[2]=c*e*h-k*q;b[3]=0;b[4]=e*k*h-c*q;b[5]=k*k*h+a;b[6]=c*k*h+e*q;b[7]=0;b[8]=e*c*h+k*q;b[9]=k*c*h-e*q;b[10]=c*c*h+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.tY=function(a,c){var b=Math.sin(a),e=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=e;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=e;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.uY=function(a,c){var b=Math.sin(a),e=Math.cos(a);c[0]=e;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=e;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.vY=function(a,c){var b=Math.sin(a),e=Math.cos(a);c[0]=e;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=e;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var e=a[0],k=a[1],q=a[2],h=a[3],u=e+e,y=k+k,g=q+q;a=e*u;var d=e*y,e=e*g,r=k*y,k=k*g,q=q*g,u=h*u,y=h*y,h=h*g;b[0]=1-(r+q);b[1]=d+h;b[2]=e-y;b[3]=0;b[4]=d-h;b[5]=1-(a+q);b[6]=k+u;b[7]=0;b[8]=e+y;b[9]=k-u;b[10]=1-(a+r);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.rY=function(a,c,b,f){var e=a[0],q=a[1],h=a[2],u=a[3],y=e+e,g=q+q,d=h+h;a=e*y;var r=e*g,e=e*d,p=q*g,q=q*d,h=h*d,y=u*y,g=u*g,u=u*d,d=b[0],t=b[1];b=b[2];f[0]=(1-(p+h))*d;f[1]=(r+u)*d;f[2]=(e-g)*d;f[3]=0;f[4]=(r-u)*t;f[5]=(1-(a+h))*t;f[6]=(q+y)*t;f[7]=0;f[8]=(e+g)*b;f[9]=(q-y)*b;f[10]=(1-(a+p))*b;f[11]=0;f[12]=c[0];f[13]=c[1];f[14]=c[2];f[15]=1;return f};a.sY=function(a,c,b,f,k){var e=a[0],h=a[1],u=a[2],t=a[3],g=e+e,d=h+h,r=u+u;a=e*g;var p=e*d,e=e*r,M=h*d,h=h*r,u=u*r,g=t*g,d=t*d,t=
t*r,r=b[0],E=b[1];b=b[2];var z=f[0],l=f[1];f=f[2];k[0]=(1-(M+u))*r;k[1]=(p+t)*r;k[2]=(e-d)*r;k[3]=0;k[4]=(p-t)*E;k[5]=(1-(a+u))*E;k[6]=(h+g)*E;k[7]=0;k[8]=(e+d)*b;k[9]=(h-g)*b;k[10]=(1-(a+M))*b;k[11]=0;k[12]=c[0]+z-(k[0]*z+k[4]*l+k[8]*f);k[13]=c[1]+l-(k[1]*z+k[5]*l+k[9]*f);k[14]=c[2]+f-(k[2]*z+k[6]*l+k[10]*f);k[15]=1;return k};a.fromQuat=function(a,c){var b=a[0],e=a[1],k=a[2],q=a[3],h=b+b,u=e+e,t=k+k,b=b*h,g=e*h,e=e*u,d=k*h,r=k*u,k=k*t,h=q*h,u=q*u,q=q*t;c[0]=1-e-k;c[1]=g+q;c[2]=d-u;c[3]=0;c[4]=g-
q;c[5]=1-b-k;c[6]=r+h;c[7]=0;c[8]=d+u;c[9]=r-h;c[10]=1-b-e;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,f,k,q,h){var e=1/(c-a),t=1/(f-b),g=1/(k-q);h[0]=2*k*e;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*k*t;h[6]=0;h[7]=0;h[8]=(c+a)*e;h[9]=(f+b)*t;h[10]=(q+k)*g;h[11]=-1;h[12]=0;h[13]=0;h[14]=q*k*2*g;h[15]=0;return h};a.perspective=function(a,c,b,f,k){a=1/Math.tan(a/2);var e=1/(b-f);k[0]=a/c;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=a;k[6]=0;k[7]=0;k[8]=0;k[9]=0;k[10]=(f+b)*e;k[11]=-1;k[12]=
0;k[13]=0;k[14]=2*f*b*e;k[15]=0;return k};a.sZ=function(a,c,b,f){var e=Math.tan(a.upDegrees*Math.PI/180),q=Math.tan(a.downDegrees*Math.PI/180),h=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var u=2/(h+a),t=2/(e+q);f[0]=u;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=t;f[6]=0;f[7]=0;f[8]=-((h-a)*u*.5);f[9]=(e-q)*t*.5;f[10]=b/(c-b);f[11]=-1;f[12]=0;f[13]=0;f[14]=b*c/(c-b);f[15]=0;return f};a.ortho=function(a,c,b,f,k,q,h){var e=1/(a-c),t=1/(b-f),g=1/(k-q);h[0]=-2*e;h[1]=0;h[2]=0;h[3]=
0;h[4]=0;h[5]=-2*t;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=2*g;h[11]=0;h[12]=(a+c)*e;h[13]=(f+b)*t;h[14]=(q+k)*g;h[15]=1;return h};a.lookAt=function(e,c,b,f){var k,q,h,u,t,g,d,r,p=e[0],M=e[1];e=e[2];h=b[0];u=b[1];q=b[2];d=c[0];b=c[1];k=c[2];if(1E-7>Math.abs(p-d)&&1E-7>Math.abs(M-b)&&1E-7>Math.abs(e-k))return a.identity(f);c=p-d;b=M-b;d=e-k;r=1/Math.sqrt(c*c+b*b+d*d);c*=r;b*=r;d*=r;k=u*d-q*b;q=q*c-h*d;h=h*b-u*c;(r=Math.sqrt(k*k+q*q+h*h))?(r=1/r,k*=r,q*=r,h*=r):h=q=k=0;u=b*h-d*q;t=d*k-c*h;g=c*q-b*k;(r=Math.sqrt(u*
u+t*t+g*g))?(r=1/r,u*=r,t*=r,g*=r):g=t=u=0;f[0]=k;f[1]=u;f[2]=c;f[3]=0;f[4]=q;f[5]=t;f[6]=b;f[7]=0;f[8]=h;f[9]=g;f[10]=d;f[11]=0;f[12]=-(k*p+q*M+h*e);f[13]=-(u*p+t*M+g*e);f[14]=-(c*p+b*M+d*e);f[15]=1;return f};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.dQ=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function t(a,h){var k=a[0],q=a[1],g=a[2],d=a[3],k=c(k,q,g,d,h[0],7,-680876936),d=c(d,k,q,g,h[1],12,-389564586),g=c(g,d,k,q,h[2],17,606105819),q=c(q,g,d,k,h[3],22,-1044525330),k=c(k,q,g,d,h[4],7,-176418897),d=c(d,k,q,g,h[5],12,1200080426),g=c(g,d,k,q,h[6],17,-1473231341),q=c(q,g,d,k,h[7],22,-45705983),k=c(k,q,g,d,h[8],7,1770035416),d=c(d,k,q,g,h[9],12,-1958414417),g=c(g,d,k,q,h[10],17,-42063),q=c(q,g,d,k,h[11],22,-1990404162),k=c(k,q,g,d,h[12],7,1804603682),d=c(d,k,q,g,
h[13],12,-40341101),g=c(g,d,k,q,h[14],17,-1502002290),q=c(q,g,d,k,h[15],22,1236535329),k=b(k,q,g,d,h[1],5,-165796510),d=b(d,k,q,g,h[6],9,-1069501632),g=b(g,d,k,q,h[11],14,643717713),q=b(q,g,d,k,h[0],20,-373897302),k=b(k,q,g,d,h[5],5,-701558691),d=b(d,k,q,g,h[10],9,38016083),g=b(g,d,k,q,h[15],14,-660478335),q=b(q,g,d,k,h[4],20,-405537848),k=b(k,q,g,d,h[9],5,568446438),d=b(d,k,q,g,h[14],9,-1019803690),g=b(g,d,k,q,h[3],14,-187363961),q=b(q,g,d,k,h[8],20,1163531501),k=b(k,q,g,d,h[13],5,-1444681467),d=
b(d,k,q,g,h[2],9,-51403784),g=b(g,d,k,q,h[7],14,1735328473),q=b(q,g,d,k,h[12],20,-1926607734),k=e(q^g^d,k,q,h[5],4,-378558),d=e(k^q^g,d,k,h[8],11,-2022574463),g=e(d^k^q,g,d,h[11],16,1839030562),q=e(g^d^k,q,g,h[14],23,-35309556),k=e(q^g^d,k,q,h[1],4,-1530992060),d=e(k^q^g,d,k,h[4],11,1272893353),g=e(d^k^q,g,d,h[7],16,-155497632),q=e(g^d^k,q,g,h[10],23,-1094730640),k=e(q^g^d,k,q,h[13],4,681279174),d=e(k^q^g,d,k,h[0],11,-358537222),g=e(d^k^q,g,d,h[3],16,-722521979),q=e(g^d^k,q,g,h[6],23,76029189),k=
e(q^g^d,k,q,h[9],4,-640364487),d=e(k^q^g,d,k,h[12],11,-421815835),g=e(d^k^q,g,d,h[15],16,530742520),q=e(g^d^k,q,g,h[2],23,-995338651),k=f(k,q,g,d,h[0],6,-198630844),d=f(d,k,q,g,h[7],10,1126891415),g=f(g,d,k,q,h[14],15,-1416354905),q=f(q,g,d,k,h[5],21,-57434055),k=f(k,q,g,d,h[12],6,1700485571),d=f(d,k,q,g,h[3],10,-1894986606),g=f(g,d,k,q,h[10],15,-1051523),q=f(q,g,d,k,h[1],21,-2054922799),k=f(k,q,g,d,h[8],6,1873313359),d=f(d,k,q,g,h[15],10,-30611744),g=f(g,d,k,q,h[6],15,-1560198380),q=f(q,g,d,k,h[13],
21,1309151649),k=f(k,q,g,d,h[4],6,-145523070),d=f(d,k,q,g,h[11],10,-1120210379),g=f(g,d,k,q,h[2],15,718787259),q=f(q,g,d,k,h[9],21,-343485551);a[0]=k+a[0]&4294967295;a[1]=q+a[1]&4294967295;a[2]=g+a[2]&4294967295;a[3]=d+a[3]&4294967295}function e(a,b,c,e,f,d){b=(b+a&4294967295)+(e+d&4294967295)&4294967295;return(b<<f|b>>>32-f)+c&4294967295}function c(a,b,c,f,g,d,k){return e(b&c|~b&f,a,b,g,d,k)}function b(a,b,c,f,g,d,k){return e(b&f|c&~f,a,b,g,d,k)}function f(a,b,c,f,g,d,k){return e(c^(b|~f),a,b,g,
d,k)}var k="0123456789abcdef".split("");a.aG=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var e;for(e=64;e<=b.length;e+=64){var f,d=b.substring(e-64,e),q=[];for(f=0;64>f;f+=4)q[f>>2]=d.charCodeAt(f)+(d.charCodeAt(f+1)<<8)+(d.charCodeAt(f+2)<<16)+(d.charCodeAt(f+3)<<24);t(a,q)}b=b.substring(e-64);f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<b.length;e++)f[e>>2]|=b.charCodeAt(e)<<(e%4<<3);f[e>>2]|=128<<(e%4<<3);if(55<e)for(t(a,f),e=0;16>e;e++)f[e]=0;f[14]=8*c;t(a,
f);for(b=0;b<a.length;b++){c=a[b];e="";for(f=0;4>f;f++)e+=k[c>>8*f+4&15]+k[c>>8*f&15];a[b]=e}return a.join("")}};b4w.module.__pako_inflate=function(a){(function(a){var e;"undefined"!==typeof window?e=window:"undefined"!==typeof self?e=self:e=this;e.ZS=a()})(function(){return function e(a,b,f){function c(h){if(!b[h]){if(!a[h]){if(q)return q(h,!0);var k=Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k;}k=b[h]={exports:{}};a[h][0].call(k.exports,function(b){var d=a[h][1][b];return c(d?d:b)},k,k.exports,e,a,b,f)}return b[h].exports}for(var q=!1,h=0;h<f.length;h++)c(f[h]);return c}({1:[function(a,
c,b){a="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e])}}return a};b.xI=function(a,b){if(a.length===b)return a;if(a.subarray)return a.subarray(0,b);a.length=b;return a};var e={Ul:function(a,b,c,e,f){if(b.subarray&&a.subarray)a.set(b.subarray(c,
c+e),f);else for(var d=0;d<e;d++)a[f+d]=b[c+d]},pF:function(a){var b,c,e,f,d;b=e=0;for(c=a.length;b<c;b++)e+=a[b].length;d=new Uint8Array(e);b=e=0;for(c=a.length;b<c;b++)f=a[b],d.set(f,e),e+=f.length;return d}},k={Ul:function(a,b,c,e,f){for(var d=0;d<e;d++)a[f+d]=b[c+d]},pF:function(a){return[].concat.apply([],a)}};b.cU=function(a){a?(b.Jl=Uint8Array,b.Qp=Uint16Array,b.Rp=Int32Array,b.assign(b,e)):(b.Jl=Array,b.Qp=Array,b.Rp=Array,b.assign(b,k))};b.cU(a)},{}],2:[function(a,c,b){function e(a,b){if(65537>
b&&(a.subarray&&h||!a.subarray&&q))return String.fromCharCode.apply(null,k.xI(a,b));for(var c="",e=0;e<b;e++)c+=String.fromCharCode(a[e]);return c}var k=a("./common"),q=!0,h=!0,u=new k.Jl(256);for(a=0;256>a;a++)u[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;u[254]=u[254]=1;b.jV=function(a){var b,c,e,f,h,q=a.length,u=0;for(f=0;f<q;f++)c=a.charCodeAt(f),55296===(c&64512)&&f+1<q&&(e=a.charCodeAt(f+1),56320===(e&64512)&&(c=65536+(c-55296<<10)+(e-56320),f++)),u+=128>c?1:2048>c?2:65536>c?3:4;b=new k.Jl(u);
for(f=h=0;h<u;f++)c=a.charCodeAt(f),55296===(c&64512)&&f+1<q&&(e=a.charCodeAt(f+1),56320===(e&64512)&&(c=65536+(c-55296<<10)+(e-56320),f++)),128>c?b[h++]=c:(2048>c?b[h++]=192|c>>>6:(65536>c?b[h++]=224|c>>>12:(b[h++]=240|c>>>18,b[h++]=128|c>>>12&63),b[h++]=128|c>>>6&63),b[h++]=128|c&63);return b};b.TX=function(a){return e(a,a.length)};b.ZM=function(a){for(var b=new k.Jl(a.length),c=0,e=b.length;c<e;c++)b[c]=a.charCodeAt(c);return b};b.hN=function(a,b){var c,f,g,h,k=b||a.length,q=Array(2*k);for(c=f=
0;c<k;)if(g=a[c++],128>g)q[f++]=g;else if(h=u[g],4<h)q[f++]=65533,c+=h-1;else{for(g&=2===h?31:3===h?15:7;1<h&&c<k;)g=g<<6|a[c++]&63,h--;1<h?q[f++]=65533:65536>g?q[f++]=g:(g-=65536,q[f++]=55296|g>>10&1023,q[f++]=56320|g&1023)}return e(q,f)};b.sW=function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);for(c=b-1;0<=c&&128===(a[c]&192);)c--;return 0>c||!c?b:c+u[a[c]]>b?c:b}},{"./common":1}],3:[function(a,c){c.exports=function(a,c,e,q){var b=a&65535|0;a=a>>>16&65535|0;for(var f;0!==e;){f=2E3<e?2E3:
e;e-=f;do b=b+c[q++]|0,a=a+b|0;while(--f);b%=65521;a%=65521}return b|a<<16|0}},{}],4:[function(a,c){c.exports={sD:0,AX:1,tD:2,xX:3,ot:4,pX:5,EX:6,En:0,pt:1,cM:2,uX:-1,CX:-2,qX:-3,bM:-5,zX:0,nX:1,mX:9,rX:-1,vX:1,yX:2,BX:3,wX:4,sX:0,oX:0,DX:1,FX:2,tX:8}},{}],5:[function(a,c){var b=function(){for(var a,b=[],c=0;256>c;c++){a=c;for(var e=0;8>e;e++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}();c.exports=function(a,c,e,h){e=h+e;for(a^=-1;h<e;h++)a=a>>>8^b[(a^c[h])&255];return a^-1}},{}],6:[function(a,
c){c.exports=function(){this.VS=this.JW=this.time=this.text=0;this.Cd=null;this.Lz=0;this.oz=this.name="";this.rR=0;this.done=!1}},{}],7:[function(a,c){c.exports=function(a,c){var b,e,f,u,y,g,d,r,p,M,E,z,l,B,w,G,v,D,F,n,N,I,x,J;b=a.state;e=a.Yk;x=a.input;f=e+(a.ag-5);u=a.De;J=a.Oh;y=u-(c-a.yd);g=u+(a.yd-257);d=b.yu;r=b.Uf;p=b.mk;M=b.Tf;E=b.window;z=b.Kk;l=b.dd;B=b.Hj;w=b.km;G=(1<<b.Ei)-1;v=(1<<b.Zn)-1;a:do b:for(15>l&&(z+=x[e++]<<l,l+=8,z+=x[e++]<<l,l+=8),D=B[z&G];;){F=D>>>24;z>>>=F;l-=F;if(F=D>>>
16&255)if(F&16){n=D&65535;if(F&=15)l<F&&(z+=x[e++]<<l,l+=8),n+=z&(1<<F)-1,z>>>=F,l-=F;15>l&&(z+=x[e++]<<l,l+=8,z+=x[e++]<<l,l+=8);D=w[z&v];c:for(;;){F=D>>>24;z>>>=F;l-=F;F=D>>>16&255;if(F&16){D&=65535;F&=15;l<F&&(z+=x[e++]<<l,l+=8,l<F&&(z+=x[e++]<<l,l+=8));D+=z&(1<<F)-1;if(D>d){a.msg="invalid distance too far back";b.mode=30;break a}z>>>=F;l-=F;F=u-y;if(D>F){F=D-F;if(F>p&&b.GB){a.msg="invalid distance too far back";b.mode=30;break a}N=0;I=E;if(0===M){if(N+=r-F,F<n){n-=F;do J[u++]=E[N++];while(--F);
N=u-D;I=J}}else if(M<F){if(N+=r+M-F,F-=M,F<n){n-=F;do J[u++]=E[N++];while(--F);N=0;if(M<n){F=M;n-=F;do J[u++]=E[N++];while(--F);N=u-D;I=J}}}else if(N+=M-F,F<n){n-=F;do J[u++]=E[N++];while(--F);N=u-D;I=J}for(;2<n;)J[u++]=I[N++],J[u++]=I[N++],J[u++]=I[N++],n-=3;n&&(J[u++]=I[N++],1<n&&(J[u++]=I[N++]))}else{N=u-D;do J[u++]=J[N++],J[u++]=J[N++],J[u++]=J[N++],n-=3;while(2<n);n&&(J[u++]=J[N++],1<n&&(J[u++]=J[N++]))}}else if(F&64){a.msg="invalid distance code";b.mode=30;break a}else{D=w[(D&65535)+(z&(1<<
F)-1)];continue c}break}}else if(F&64){F&32?b.mode=12:(a.msg="invalid literal/length code",b.mode=30);break a}else{D=B[(D&65535)+(z&(1<<F)-1)];continue b}else J[u++]=D&65535;break}while(e<f&&u<g);n=l>>3;e-=n;l-=n<<3;a.Yk=e;a.De=u;a.ag=e<f?5+(f-e):5-(e-f);a.yd=u<g?257+(g-u):257-(u-g);b.Kk=z&(1<<l)-1;b.dd=l}},{}],8:[function(a,c,b){function e(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function k(){this.mode=0;this.Pv=!1;this.$h=0;this.mA=!1;this.total=this.check=this.yu=this.Uc=
0;this.head=null;this.Tf=this.mk=this.Uf=this.Op=0;this.window=null;this.Cd=this.offset=this.length=this.dd=this.Kk=0;this.km=this.Hj=null;this.Wg=this.Lr=this.Mo=this.bH=this.Zn=this.Ei=0;this.next=null;this.Ae=new d.Qp(320);this.Zs=new d.Qp(288);this.fF=this.GG=null;this.EW=this.back=this.GB=0}function q(a){var b;if(!a||!a.state)return-2;b=a.state;a.lC=a.Es=b.total=0;a.msg="";b.$h&&(a.Pl=b.$h&1);b.mode=1;b.Pv=0;b.mA=0;b.yu=32768;b.head=null;b.Kk=0;b.dd=0;b.Hj=b.GG=new d.Rp(852);b.km=b.fF=new d.Rp(592);
b.GB=1;b.back=-1;return 0}function h(a){var b;if(!a||!a.state)return-2;b=a.state;b.Uf=0;b.mk=0;b.Tf=0;return q(a)}function u(a,b){var c,d;if(!a||!a.state)return-2;d=a.state;0>b?(c=0,b=-b):(c=(b>>4)+1,48>b&&(b&=15));if(b&&(8>b||15<b))return-2;null!==d.window&&d.Op!==b&&(d.window=null);d.$h=c;d.Op=b;return h(a)}function y(a,b){var c;if(!a)return-2;c=new k;a.state=c;c.window=null;c=u(a,b);0!==c&&(a.state=null);return c}function g(a,b,c,e){var f=a.state;null===f.window&&(f.Uf=1<<f.Op,f.Tf=0,f.mk=0,f.window=
new d.Jl(f.Uf));e>=f.Uf?(d.Ul(f.window,b,c-f.Uf,f.Uf,0),f.Tf=0,f.mk=f.Uf):(a=f.Uf-f.Tf,a>e&&(a=e),d.Ul(f.window,b,c-e,a,f.Tf),(e-=a)?(d.Ul(f.window,b,c-e,e,0),f.Tf=e,f.mk=f.Uf):(f.Tf+=a,f.Tf===f.Uf&&(f.Tf=0),f.mk<f.Uf&&(f.mk+=a)));return 0}var d=a("../utils/common"),r=a("./adler32"),p=a("./crc32"),M=a("./inffast"),E=a("./inftrees"),z=!0,l,B;b.YY=h;b.ZY=u;b.$Y=q;b.WY=function(a){return y(a,15)};b.wR=y;b.vo=function(a,b){var c,f,h,k,q,u,x,y,w,G,R,m,H,U,O,V,ia,na,T=new d.Jl(4),ja=[16,17,18,0,8,7,9,6,
10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.Oh||!a.input&&0!==a.ag)return-2;c=a.state;12===c.mode&&(c.mode=13);q=a.De;h=a.Oh;x=a.yd;k=a.Yk;f=a.input;u=a.ag;y=c.Kk;w=c.dd;G=u;R=x;na=0;a:for(;;)switch(c.mode){case 1:if(0===c.$h){c.mode=13;break}for(;16>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}if(c.$h&2&&35615===y){c.check=0;T[0]=y&255;T[1]=y>>>8&255;c.check=p(c.check,T,2,0);w=y=0;c.mode=2;break}c.Uc=0;c.head&&(c.head.done=!1);if(!(c.$h&1)||(((y&255)<<8)+(y>>8))%31){a.msg="incorrect header check";
c.mode=30;break}if(8!==(y&15)){a.msg="unknown compression method";c.mode=30;break}y>>>=4;w-=4;H=(y&15)+8;if(0===c.Op)c.Op=H;else if(H>c.Op){a.msg="invalid window size";c.mode=30;break}c.yu=1<<H;a.Pl=c.check=1;c.mode=y&512?10:12;w=y=0;break;case 2:for(;16>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.Uc=y;if(8!==(c.Uc&255)){a.msg="unknown compression method";c.mode=30;break}if(c.Uc&57344){a.msg="unknown header flags set";c.mode=30;break}c.head&&(c.head.text=y>>8&1);c.Uc&512&&(T[0]=y&255,T[1]=y>>>8&
255,c.check=p(c.check,T,2,0));w=y=0;c.mode=3;case 3:for(;32>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.head&&(c.head.time=y);c.Uc&512&&(T[0]=y&255,T[1]=y>>>8&255,T[2]=y>>>16&255,T[3]=y>>>24&255,c.check=p(c.check,T,4,0));w=y=0;c.mode=4;case 4:for(;16>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.head&&(c.head.JW=y&255,c.head.VS=y>>8);c.Uc&512&&(T[0]=y&255,T[1]=y>>>8&255,c.check=p(c.check,T,2,0));w=y=0;c.mode=5;case 5:if(c.Uc&1024){for(;16>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.length=y;c.head&&
(c.head.Lz=y);c.Uc&512&&(T[0]=y&255,T[1]=y>>>8&255,c.check=p(c.check,T,2,0));w=y=0}else c.head&&(c.head.Cd=null);c.mode=6;case 6:if(c.Uc&1024&&(m=c.length,m>u&&(m=u),m&&(c.head&&(H=c.head.Lz-c.length,c.head.Cd||(c.head.Cd=Array(c.head.Lz)),d.Ul(c.head.Cd,f,k,m,H)),c.Uc&512&&(c.check=p(c.check,f,m,k)),u-=m,k+=m,c.length-=m),c.length))break a;c.length=0;c.mode=7;case 7:if(c.Uc&2048){if(0===u)break a;m=0;do H=f[k+m++],c.head&&H&&65536>c.length&&(c.head.name+=String.fromCharCode(H));while(H&&m<u);c.Uc&
512&&(c.check=p(c.check,f,m,k));u-=m;k+=m;if(H)break a}else c.head&&(c.head.name=null);c.length=0;c.mode=8;case 8:if(c.Uc&4096){if(0===u)break a;m=0;do H=f[k+m++],c.head&&H&&65536>c.length&&(c.head.oz+=String.fromCharCode(H));while(H&&m<u);c.Uc&512&&(c.check=p(c.check,f,m,k));u-=m;k+=m;if(H)break a}else c.head&&(c.head.oz=null);c.mode=9;case 9:if(c.Uc&512){for(;16>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}if(y!==(c.check&65535)){a.msg="header crc mismatch";c.mode=30;break}w=y=0}c.head&&(c.head.rR=
c.Uc>>9&1,c.head.done=!0);a.Pl=c.check=0;c.mode=12;break;case 10:for(;32>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}a.Pl=c.check=e(y);w=y=0;c.mode=11;case 11:if(0===c.mA)return a.De=q,a.yd=x,a.Yk=k,a.ag=u,c.Kk=y,c.dd=w,2;a.Pl=c.check=1;c.mode=12;case 12:if(5===b||6===b)break a;case 13:if(c.Pv){y>>>=w&7;w-=w&7;c.mode=27;break}for(;3>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.Pv=y&1;y>>>=1;--w;switch(y&3){case 0:c.mode=14;break;case 1:H=c;if(z){l=new d.Rp(512);B=new d.Rp(32);for(m=0;144>m;)H.Ae[m++]=
8;for(;256>m;)H.Ae[m++]=9;for(;280>m;)H.Ae[m++]=7;for(;288>m;)H.Ae[m++]=8;E(1,H.Ae,0,288,l,0,H.Zs,{dd:9});for(m=0;32>m;)H.Ae[m++]=5;E(2,H.Ae,0,32,B,0,H.Zs,{dd:5});z=!1}H.Hj=l;H.Ei=9;H.km=B;H.Zn=5;c.mode=20;if(6===b){y>>>=2;w-=2;break a}break;case 2:c.mode=17;break;case 3:a.msg="invalid block type",c.mode=30}y>>>=2;w-=2;break;case 14:y>>>=w&7;for(w-=w&7;32>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}if((y&65535)!==(y>>>16^65535)){a.msg="invalid stored block lengths";c.mode=30;break}c.length=y&65535;
w=y=0;c.mode=15;if(6===b)break a;case 15:c.mode=16;case 16:if(m=c.length){m>u&&(m=u);m>x&&(m=x);if(0===m)break a;d.Ul(h,f,k,m,q);u-=m;k+=m;x-=m;q+=m;c.length-=m;break}c.mode=12;break;case 17:for(;14>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.Mo=(y&31)+257;y>>>=5;w-=5;c.Lr=(y&31)+1;y>>>=5;w-=5;c.bH=(y&15)+4;y>>>=4;w-=4;if(286<c.Mo||30<c.Lr){a.msg="too many length or distance symbols";c.mode=30;break}c.Wg=0;c.mode=18;case 18:for(;c.Wg<c.bH;){for(;3>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.Ae[ja[c.Wg++]]=
y&7;y>>>=3;w-=3}for(;19>c.Wg;)c.Ae[ja[c.Wg++]]=0;c.Hj=c.GG;c.Ei=7;m={dd:c.Ei};na=E(0,c.Ae,0,19,c.Hj,0,c.Zs,m);c.Ei=m.dd;if(na){a.msg="invalid code lengths set";c.mode=30;break}c.Wg=0;c.mode=19;case 19:for(;c.Wg<c.Mo+c.Lr;){for(;;){O=c.Hj[y&(1<<c.Ei)-1];m=O>>>24;O&=65535;if(m<=w)break;if(0===u)break a;u--;y+=f[k++]<<w;w+=8}if(16>O)y>>>=m,w-=m,c.Ae[c.Wg++]=O;else{if(16===O){for(H=m+2;w<H;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}y>>>=m;w-=m;if(0===c.Wg){a.msg="invalid bit length repeat";c.mode=30;break}H=
c.Ae[c.Wg-1];m=3+(y&3);y>>>=2;w-=2}else if(17===O){for(H=m+3;w<H;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}y>>>=m;w-=m;H=0;m=3+(y&7);y>>>=3;w-=3}else{for(H=m+7;w<H;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}y>>>=m;w-=m;H=0;m=11+(y&127);y>>>=7;w-=7}if(c.Wg+m>c.Mo+c.Lr){a.msg="invalid bit length repeat";c.mode=30;break}for(;m--;)c.Ae[c.Wg++]=H}}if(30===c.mode)break;if(0===c.Ae[256]){a.msg="invalid code -- missing end-of-block";c.mode=30;break}c.Ei=9;m={dd:c.Ei};na=E(1,c.Ae,0,c.Mo,c.Hj,0,c.Zs,m);c.Ei=m.dd;
if(na){a.msg="invalid literal/lengths set";c.mode=30;break}c.Zn=6;c.km=c.fF;m={dd:c.Zn};na=E(2,c.Ae,c.Mo,c.Lr,c.km,0,c.Zs,m);c.Zn=m.dd;if(na){a.msg="invalid distances set";c.mode=30;break}c.mode=20;if(6===b)break a;case 20:c.mode=21;case 21:if(6<=u&&258<=x){a.De=q;a.yd=x;a.Yk=k;a.ag=u;c.Kk=y;c.dd=w;M(a,R);q=a.De;h=a.Oh;x=a.yd;k=a.Yk;f=a.input;u=a.ag;y=c.Kk;w=c.dd;12===c.mode&&(c.back=-1);break}for(c.back=0;;){O=c.Hj[y&(1<<c.Ei)-1];m=O>>>24;H=O>>>16&255;O&=65535;if(m<=w)break;if(0===u)break a;u--;
y+=f[k++]<<w;w+=8}if(H&&!(H&240)){U=m;V=H;for(ia=O;;){O=c.Hj[ia+((y&(1<<U+V)-1)>>U)];m=O>>>24;H=O>>>16&255;O&=65535;if(U+m<=w)break;if(0===u)break a;u--;y+=f[k++]<<w;w+=8}y>>>=U;w-=U;c.back+=U}y>>>=m;w-=m;c.back+=m;c.length=O;if(!H){c.mode=26;break}if(H&32){c.back=-1;c.mode=12;break}if(H&64){a.msg="invalid literal/length code";c.mode=30;break}c.Cd=H&15;c.mode=22;case 22:if(c.Cd){for(H=c.Cd;w<H;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.length+=y&(1<<c.Cd)-1;y>>>=c.Cd;w-=c.Cd;c.back+=c.Cd}c.EW=c.length;
c.mode=23;case 23:for(;;){O=c.km[y&(1<<c.Zn)-1];m=O>>>24;H=O>>>16&255;O&=65535;if(m<=w)break;if(0===u)break a;u--;y+=f[k++]<<w;w+=8}if(!(H&240)){U=m;V=H;for(ia=O;;){O=c.km[ia+((y&(1<<U+V)-1)>>U)];m=O>>>24;H=O>>>16&255;O&=65535;if(U+m<=w)break;if(0===u)break a;u--;y+=f[k++]<<w;w+=8}y>>>=U;w-=U;c.back+=U}y>>>=m;w-=m;c.back+=m;if(H&64){a.msg="invalid distance code";c.mode=30;break}c.offset=O;c.Cd=H&15;c.mode=24;case 24:if(c.Cd){for(H=c.Cd;w<H;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}c.offset+=y&(1<<
c.Cd)-1;y>>>=c.Cd;w-=c.Cd;c.back+=c.Cd}if(c.offset>c.yu){a.msg="invalid distance too far back";c.mode=30;break}c.mode=25;case 25:if(0===x)break a;m=R-x;if(c.offset>m){m=c.offset-m;if(m>c.mk&&c.GB){a.msg="invalid distance too far back";c.mode=30;break}m>c.Tf?(m-=c.Tf,H=c.Uf-m):H=c.Tf-m;m>c.length&&(m=c.length);U=c.window}else U=h,H=q-c.offset,m=c.length;m>x&&(m=x);x-=m;c.length-=m;do h[q++]=U[H++];while(--m);0===c.length&&(c.mode=21);break;case 26:if(0===x)break a;h[q++]=c.length;x--;c.mode=21;break;
case 27:if(c.$h){for(;32>w;){if(0===u)break a;u--;y|=f[k++]<<w;w+=8}R-=x;a.Es+=R;c.total+=R;R&&(a.Pl=c.check=c.Uc?p(c.check,h,R,q-R):r(c.check,h,R,q-R));R=x;if((c.Uc?y:e(y))!==c.check){a.msg="incorrect data check";c.mode=30;break}w=y=0}c.mode=28;case 28:if(c.$h&&c.Uc){for(;32>w;){if(0===u)break a;u--;y+=f[k++]<<w;w+=8}if(y!==(c.total&4294967295)){a.msg="incorrect length check";c.mode=30;break}w=y=0}c.mode=29;case 29:na=1;break a;case 30:na=-3;break a;case 31:return-4;default:return-2}a.De=q;a.yd=
x;a.Yk=k;a.ag=u;c.Kk=y;c.dd=w;if((c.Uf||R!==a.yd&&30>c.mode&&(27>c.mode||4!==b))&&g(a,a.Oh,a.De,R-a.yd))return c.mode=31,-4;G-=a.ag;R-=a.yd;a.lC+=G;a.Es+=R;c.total+=R;c.$h&&R&&(a.Pl=c.check=c.Uc?p(c.check,h,R,a.De-R):r(c.check,h,R,a.De-R));a.kP=c.dd+(c.Pv?64:0)+(12===c.mode?128:0)+(20===c.mode||15===c.mode?256:0);(0===G&&0===R||4===b)&&0===na&&(na=-5);return na};b.uR=function(a){if(!a||!a.state)return-2;var b=a.state;b.window&&(b.window=null);a.state=null;return 0};b.vR=function(a,b){var c;a&&a.state&&
(c=a.state,c.$h&2&&(c.head=b,b.done=!1))};b.xR=function(a,b){var c=b.length,d,e;if(!a||!a.state)return-2;d=a.state;if(0!==d.$h&&11!==d.mode)return-2;if(11===d.mode&&(e=r(1,b,c,0),e!==d.check))return-3;if(g(a,b,c,c))return d.mode=31,-4;d.mA=1;return 0};b.VY="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(a,c){var b=a("../utils/common"),e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,
258,0,0],k=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];c.exports=function(a,c,f,d,r,p,M,E){var g=E.dd,l,u,y,G,v,D,F,n,N,I,x,J,A,C=0,R,m=new b.Qp(16);v=new b.Qp(16);var H,U=0,O,V,ia;for(l=0;15>=l;l++)m[l]=0;for(u=0;u<d;u++)m[c[f+u]]++;
G=g;for(y=15;1<=y&&0===m[y];y--);G>y&&(G=y);if(!y)return r[p++]=20971520,r[p++]=20971520,E.dd=1,0;for(g=1;g<y&&0===m[g];g++);G<g&&(G=g);for(l=D=1;15>=l;l++)if(D<<=1,D-=m[l],0>D)return-1;if(0<D&&(0===a||1!==y))return-1;v[1]=0;for(l=1;15>l;l++)v[l+1]=v[l]+m[l];for(u=0;u<d;u++)0!==c[f+u]&&(M[v[c[f+u]]++]=u);0===a?(A=H=M,R=19):1===a?(A=e,C-=257,H=k,U-=257,R=256):(A=q,H=h,R=-1);u=n=0;l=g;J=p;d=G;v=0;I=-1;F=1<<G;x=F-1;if(1===a&&852<F||2===a&&592<F)return 1;for(;;){O=l-v;M[u]<R?(V=0,ia=M[u]):M[u]>R?(V=H[U+
M[u]],ia=A[C+M[u]]):(V=96,ia=0);D=1<<l-v;g=N=1<<d;do N-=D,r[J+(n>>v)+N]=O<<24|V<<16|ia|0;while(N);for(D=1<<l-1;n&D;)D>>=1;D?(n&=D-1,n+=D):n=0;u++;if(!--m[l]){if(l===y)break;l=c[f+M[u]]}if(l>G&&(n&x)!==I){0===v&&(v=G);J+=g;d=l-v;for(D=1<<d;d+v<y;){D-=m[d+v];if(0>=D)break;d++;D<<=1}F+=1<<d;if(1===a&&852<F||2===a&&592<F)return 1;I=n&x;r[I]=G<<24|d<<16|J-p|0}}n&&(r[J+n]=l-v<<24|4194304);E.dd=G;return 0}},{"../utils/common":1}],10:[function(a,c){c.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error",
"-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(a,c){c.exports=function(){this.input=null;this.lC=this.ag=this.Yk=0;this.Oh=null;this.Es=this.yd=this.De=0;this.msg="";this.state=null;this.kP=2;this.Pl=0}},{}],"/lib/inflate.js":[function(a,c,b){function e(a){if(!(this instanceof e))return new e(a);var b=this.options=h.assign({IN:16384,pe:0,to:""},a||{});b.raw&&0<=b.pe&&16>b.pe&&(b.pe=-b.pe,b.pe||(b.pe=-15));!(0<=b.pe&&
16>b.pe)||a&&a.pe||(b.pe+=32);15<b.pe&&48>b.pe&&!(b.pe&15)&&(b.pe|=15);this.Jz=0;this.msg="";this.ended=!1;this.Ut=[];this.gn=new d;this.gn.yd=0;a=q.wR(this.gn,b.pe);if(a!==y.En)throw Error(g[a]);this.sR=new r;q.vR(this.gn,this.sR)}function k(a,b){var c=new e(b);c.push(a,!0);if(c.Jz)throw c.msg||g[c.Jz];return c.result}var q=a("./zlib/inflate"),h=a("./utils/common"),u=a("./utils/strings"),y=a("./zlib/constants"),g=a("./zlib/messages"),d=a("./zlib/zstream"),r=a("./zlib/gzheader"),p=Object.prototype.toString;
e.prototype.push=function(a,b){var c=this.gn,d=this.options.IN,e=this.options.lY,f,g,k,r,F,n,E=!1;if(this.ended)return!1;g=b===~~b?b:!0===b?y.ot:y.sD;"string"===typeof a?c.input=u.ZM(a):"[object ArrayBuffer]"===p.call(a)?c.input=new Uint8Array(a):c.input=a;c.Yk=0;c.ag=c.input.length;do{0===c.yd&&(c.Oh=new h.Jl(d),c.De=0,c.yd=d);f=q.vo(c,y.sD);f===y.cM&&e&&("string"===typeof e?n=u.jV(e):"[object ArrayBuffer]"===p.call(e)?n=new Uint8Array(e):n=e,f=q.xR(this.gn,n));f===y.bM&&!0===E&&(f=y.En,E=!1);if(f!==
y.pt&&f!==y.En)return this.eB(f),this.ended=!0,!1;!c.De||0!==c.yd&&f!==y.pt&&(0!==c.ag||g!==y.ot&&g!==y.tD)||("string"===this.options.to?(k=u.sW(c.Oh,c.De),r=c.De-k,F=u.hN(c.Oh,k),c.De=r,c.yd=d-r,r&&h.Ul(c.Oh,c.Oh,k,r,0),this.pH(F)):this.pH(h.xI(c.Oh,c.De)));0===c.ag&&0===c.yd&&(E=!0)}while((0<c.ag||0===c.yd)&&f!==y.pt);f===y.pt&&(g=y.ot);if(g===y.ot)return f=q.uR(this.gn),this.eB(f),this.ended=!0,f===y.En;g===y.tD&&(this.eB(y.En),c.yd=0);return!0};e.prototype.pH=function(a){this.Ut.push(a)};e.prototype.eB=
function(a){a===y.En&&(this.result="string"===this.options.to?this.Ut.join(""):h.pF(this.Ut));this.Ut=[];this.Jz=a;this.msg=this.gn.msg};b.aX=e;b.vo=k;b.XY=function(a,b){b=b||{};b.raw=!0;return k(a,b)};b.VZ=k},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")});a.vo=window.ZS.vo};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"cond",f:[{a:"if",j:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",
D:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"include",D:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",j:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",o:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_VIEW_TSR",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",
f:[{a:"if",j:["USE_VIEW_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",
";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_OUTLINE",{a:"logic_negative_expr",o:1}],l:{a:"grp",
f:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE",
"REFL_CUBE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",j:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_LAMP"],l:{a:"grp",
f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_VALUE"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_RGB"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE",
"SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["USE_OUTLINE"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_OBJECT_INFO"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",
D:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NODES"],l:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["ALPHA_CLIP"],l:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_OUTLINE"],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},
{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",
c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"include",D:"scale_texcoord.glslv"},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",j:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["SMAA_JITTER"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION"],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["BILLBOARD_JITTERED"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",
";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL"],l:{a:"grp",f:[{a:"txt",
b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",j:["DETAIL_BEND"],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",j:["BEND_CENTER_ONLY"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",
";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",o:5}],
l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",
f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},
{a:"include",D:"skin.glslv"},{a:"include",D:"wind_bending.glslv"},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},{a:"logical_or_expr",o:6},
{a:"logical_and_expr",o:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",o:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:7}],l:{a:"grp",f:[{a:"txt",b:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 U = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 U = vec3 ( 0.0 ) ; vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CALC_TBN"],l:{a:"grp",f:[{a:"txt",b:"vec3 ac = normalize ( _ ( u_model_tsr , U ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",
o:5}],l:{a:"grp",f:[{a:"txt",b:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ; Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD_JITTERED",
{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aq , Z ) ;".split(" ")}]}}]},{a:"txt",b:"au aw = av ( O - ao , ao , V , ae , W , U , Z ) ; aw . ao = aq ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"au aw = av ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"ax ( aw . O , aw . ao , U , mat4 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ay = T ( a_tbn , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ay = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ax ( aw . O , aw . ao , ay , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2},{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],
l:{a:"grp",f:[{a:"txt",b:"A = az ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"h = aw . O ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",
"USE_NODE_BUMP",{a:"logical_or_expr",o:12}],l:{a:"grp",f:[{a:"txt",b:"j = aw . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:"B = aw . aB ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ap ( N , aw . O ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",f:[{a:"if",
j:["SMAA_JITTER"],l:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"l = aC ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ; }".split(" ")}]};
a["debug_view.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_IN vec3 aD ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float aE = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE_DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"const vec3 aF = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"const vec3 aF = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"const vec3 aG = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 aH = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 aI = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 aJ = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aK = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"float aP ( ) { float aL = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["WIREFRAME_QUALITY",0,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 aM = sign ( aD - vec3 ( 0.02 * aE ) ) ; if ( aM . x < 0.0 || aM . y < 0.0 || aM . z < 0.0 ) aL = 0.0 ;".split(" ")}]}},{a:"elif",j:["WIREFRAME_QUALITY",1,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["GLSL1"],l:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aN = fwidth ( aD ) ; vec3 aO = smoothstep ( vec3 ( 0.0 ) , aN * aE , aD ) ; aL = min ( min ( aO . x , aO . y ) , aO . z ) ; aL = clamp ( aL , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aL",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aQ = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE"],l:{a:"grp",f:[{a:"txt",b:"vec3 aM = sign ( aD - vec3 ( 0.02 * aE ) ) ; if ( aM . x < 0.0 || aM . y < 0.0 || aM . z < 0.0 ) { aQ = aF ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aL = aP ( ) ; aQ = vec3 ( mix ( u_wireframe_edge_color , aI , aL ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aL = aP ( ) ; aQ = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aL ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aL = aP ( ) ; if ( gl_FrontFacing ) aQ = mix ( u_wireframe_edge_color , aG , aL ) ; else aQ = mix ( u_wireframe_edge_color , aH , aL ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aR = u_cluster_id + u_debug_colors_seed + 2.0 ; aQ = vec3 ( fract ( aR * 19.73 ) , fract ( aR * 6.34 ) , fract ( aR * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aR = u_batch_debug_id_color + u_debug_colors_seed ; aQ = vec3 ( fract ( aR * 19.73 ) , fract ( aR * 6.34 ) , fract ( aR * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aS ; if ( u_debug_render_time_threshold > 0.0 ) aS = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aS = 1.0 ; float aT = clamp ( 2.0 * aS , 0.0 , 1.0 ) ; float aU = clamp ( 2.0 * aS - 1.0 , 0.0 , 1.0 ) ; float aV = aS ; aQ = mix ( aJ , aK , vec3 ( aT , aU , aV ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aW","(","aQ",")",";"]},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ; GLSL_IN float a_polyindex ;".split(" ")},
{a:"cond",f:[{a:"if",j:["USE_INSTANCED_PARTCLS"],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",j:["DETAIL_BEND"],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",j:["BEND_CENTER_ONLY"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",o:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],
l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","aD",";"]},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")},{a:"cond",f:[{a:"if",j:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform",
"vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"skin.glslv"},{a:"include",D:"wind_bending.glslv"},{a:"include",D:"dynamic_grass.glslv"}]}}]},{a:"txt",
b:"void main ( ) { if ( a_polyindex == 0.0 ) aD = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) aD = vec3 ( 0.0 , 0.0 , 1.0 ) ; else aD = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DEBUG_VIEW_SPECIAL_SKYDOME"],l:{a:"grp",f:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_INSTANCED_PARTCLS"],l:{a:"grp",f:[{a:"txt",b:"mat3 Z = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["STATIC_BATCH",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"Z = aY ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]}]}}]},{a:"txt",b:"mat3 N = u_view_tsr ; vec3 O = a_position ; vec4 S = R ( a_tbn ) ; vec3 U = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DEBUG_SPHERE"],l:{a:"grp",f:[{a:"txt",b:"au aw = av ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ; an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",o:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"elif",j:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",b:"au aw = aZ ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N , Z ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ; Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 a_ = aq ; Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , a_ , Z ) ;".split(" ")}]}}]},{a:"txt",b:"au aw = av ( O - ao , ao , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ; aw . ao = aq ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"au aw = av ( O , ao , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"txt",b:"ax ( aw . O , aw . ao , U , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",
D:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * bc ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};a["grass_map.glslf"]={a:"grp",
f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_SIZE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","bd",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","bd",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",
f:[{a:"txt",b:["GLSL_IN","vec3","bd",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_SIZE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","bd",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( bd , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",
b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , bd ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",
D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_SIZE"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_SIZE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","bd",";"]}]}},{a:"else",
l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","bd",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bd",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ;".split(" ")},{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , vec3 ( 0.0 ) ) ; Z = as ( u_camera_eye , aq , N , u_model_tsr ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]},{a:"txt",b:"au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ; aw . ao = aq ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , Z ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_SIZE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:"bd = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["bd","=","a_grass_size",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS_COLOR"],l:{a:"grp",f:[{a:"txt",b:["bd","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",f:[{a:"if",j:["SKY_STARS"],l:{a:"grp",f:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","be",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float bf ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",D:"color_util.glslf"},{a:"include",D:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 bi = bh ( ) ; vec3 aQ = bi . rgb ; float aM = bi . a ; aW ( aQ ) ; aX ( aQ , aM ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , aM ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",D:"std.glsl"},
{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float bf ;".split(" ")},
{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","be",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ; vec3 O = ap ( Z , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; bf = a_random_vals ;".split(" ")},{a:"cond",f:[{a:"if",j:["SKY_STARS"],l:{a:"grp",f:[{a:"txt",b:"mat3 bk = bj ( O , N ) ; mat3 bl = N ; bl [ 0 ] [ 0 ] = 0.0 ; bl [ 0 ] [ 1 ] = 0.0 ; bl [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"mat3 bk = bj ( O , N ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 bm = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bn = vec3 ( bm [ 0 ] , 0.0 , bm [ 1 ] ) ; vec3 bo = ap ( bk , bn ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SKY_STARS"],l:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ap ( bl , bo ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"be = vec4 ( bo , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ap ( N , bo ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aQ = GLSL_TEXTURE ( u_sampler , A ) ; aW ( aQ . rgb ) ; aX ( aQ . rgb , aQ . a ) ; GLSL_OUT_FRAG_COLOR = aQ ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 bp = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( _ ( u_view_tsr , bp ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bq = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bs = vec2 ( a_lf_bb_vertex . x / bq , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bt = 1.9 ; bs *= ( 1.0 + bt * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bs , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aQ = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aW ( aQ ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 N = u_view_tsr ; mat3 Z = u_model_tsr ; au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , Z ) ; vec4 bu = u_proj_matrix * vec4 ( ap ( N , aw . O ) , 1.0 ) ; bu . xyz /= bu . w ; vec4 bv = u_proj_matrix * vec4 ( ap ( N , aw . O + aw . U ) , 1.0 ) ; bv . xyz /= bv . w ; float bq = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bw = ( bv - bu ) . xy ; bw . x *= bq ; float bx = M_PI / 2.0 ; mat2 by = mat2 ( cos ( bx ) , sin ( bx ) , - sin ( bx ) , cos ( bx ) ) ; bw = by * bw ; bw = normalize ( bw ) ; vec2 bz = ( u_line_width / u_height ) * vec2 ( 1.0 / bq , 1.0 ) ; gl_Position = vec4 ( bu . xy + bw . xy * bz / 2.0 , bu . z , 1.0 ) ; gl_Position *= bu . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"USE_BSDF_SKY_DIM",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},
{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"USE_TEXTURE_LOD_EXT",b:["0"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"cond",f:[{a:"if",j:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"cond",f:[{a:"if",j:["GLSL1","USE_TEXTURE_LOD_EXT",{a:"logical_and_expr",o:2}],
l:{a:"grp",f:[{a:"extension",b:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"include",D:"math.glslv"},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"include",D:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CAUSTICS"],l:{a:"grp",f:[{a:"include",D:"caustics.glslf"}]}}]}]}}]},{a:"cond",f:[{a:"if",
j:["RGBA_SHADOWS"],l:{a:"grp",f:[{a:"include",D:"pack.glslf"}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
j:["GLSL1","USE_BSDF_SKY_DIM",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_bsdf_cube_sky_dim",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["CAUSTICS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",j:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",o:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",
j:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_VIEW_TSR",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_VIEW_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform",
"mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"txt",
b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},
{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform",
"vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW",
"u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",
{a:"logical_and_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float",
"u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{a:"non_equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_VALUE"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_RGB"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_OBJECT_INFO"],l:{a:"grp",
f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2},"SHADELESS",{a:"logic_negative_expr",o:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",o:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
o:2},{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",D:"nodes.glslf"},{a:"cond",
f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["NODES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2},"SHADELESS",{a:"logic_negative_expr",o:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",o:3},{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:"float bA = length ( i ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"float bB = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aQ = D ; float J = H ; vec3 U = F ; vec4 bC = G ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1},"WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WETTABLE"],l:{a:"grp",f:[{a:"txt",
b:"aQ = max ( aQ - sqrt ( 0.01 * - min ( bB , 0.0 ) ) , 0.5 * aQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CAUSTICS"],l:{a:"grp",f:[{a:"txt",b:"bD ( aQ , bB , u_time , bC , U , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bA ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["ALPHA_CLIP"],l:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"bE ( aQ , bA , C , bB ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"bE ( aQ , bA , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",
j:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float bF = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aQ = vec3 ( bF ) ;".split(" ")}]}}]},{a:"txt",b:"aQ = max ( vec3 ( 0.0 ) , aQ ) ; aW ( aQ ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};
a["main.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",
b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"include",D:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_INSTANCED_PARTCLS"],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",
f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",o:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",j:["DETAIL_BEND"],
l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",j:["BEND_CENTER_ONLY"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",
b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",o:9}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXCOORD"],l:{a:"grp",f:[{a:"txt",
b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2},"SHADELESS",{a:"logic_negative_expr",o:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",o:3},"SHADOW_USAGE",
"SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bG",";"]},
{a:"cond",f:[{a:"if",j:["TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bH",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},"REFRACTIVE",
"USE_POSITION_CLIP",{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE","NODES",{a:"logic_negative_expr",o:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_JITTER"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["BILLBOARD_JITTERED"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",j:["MAC_OS_SHADOW_HACK"],l:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",D:"dynamic_grass.glslv"},{a:"include",D:"shadow.glslv"},{a:"include",D:"skin.glslv"},
{a:"include",D:"wind_bending.glslv"},{a:"cond",f:[{a:"if",j:["NODES"],l:{a:"grp",f:[{a:"include",D:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["mat4","bI","=","u_view_refl_matrix",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"mat4 bI = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","N","=","u_view_tsr",";"]},{a:"cond",f:[{a:"if",j:["USE_INSTANCED_PARTCLS"],l:{a:"grp",f:[{a:"txt",
b:"mat3 Z = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["STATIC_BATCH",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"Z = aY ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]}]}}]},{a:"txt",b:["vec3","O","=","a_position",";"]},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"NODES",{a:"logic_negative_expr",o:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",o:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:14}],l:{a:"grp",f:[{a:"txt",b:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 bJ = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"NODES",{a:"logic_negative_expr",o:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:13}],l:{a:"grp",f:[{a:"txt",b:["vec3","U","=","bJ",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 U = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},{a:"elif",j:["NODES",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],
l:{a:"grp",f:[{a:"txt",b:"vec3 bK = ap ( Z , O ) ; vec3 ac = normalize ( _ ( Z , bJ ) ) ; vec3 C = bK - u_camera_eye ; vec3 W = cross ( C , ac ) ; vec3 V = cross ( ac , W ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CALC_TBN"],l:{a:"grp",f:[{a:"txt",b:"vec3 ac = normalize ( _ ( Z , bJ ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
o:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",o:10}],l:{a:"grp",f:[{a:"txt",b:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",o:8}],l:{a:"grp",f:[{a:"txt",b:"U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","DYNAMIC_GRASS",
"BILLBOARD",{a:"logical_or_expr",o:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"elif",j:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",b:"au aw = aZ ( O , V , ae , W , U , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N , Z ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"O = ( bI * vec4 ( O , 1.0 ) ) . xyz ; ao = ( bI * vec4 ( ao , 1.0 ) ) . xyz ; aq = ( bI * vec4 ( aq , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"Z = as ( u_camera_eye , aq , N , Z ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 a_ = aq ; Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , a_ , Z ) ;".split(" ")}]}}]},{a:"txt",b:"au aw = av ( O - ao , ao , V , ae , W , U , Z ) ; aw . ao = aq ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"au aw = av ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:"B = aw . aB ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"txt",b:"ax ( aw . O , aw . ao , U , bI ) ;".split(" ")}]}}]},{a:"txt",b:"h = aw . O ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:13}],l:{a:"grp",f:[{a:"txt",b:"j = aw . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"bG = u_camera_eye - aw . O ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:"A = az ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",
b:"bH = aw . aQ ;".split(" ")}]}},{a:"elif",j:["VERTEX_COLOR"],l:{a:"grp",f:[{a:"txt",b:["bH","=","a_color",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2},"BILLBOARD",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 bL = bI * vec4 ( aw . O , 1.0 ) ; bL . xyz = ap ( N , bL . xyz ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 bL = vec4 ( ap ( N , aw . O ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
j:["NODES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2},"SHADELESS",{a:"logic_negative_expr",o:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",o:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:["i","=","bL",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bL ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SMAA_JITTER"],l:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:"l = aC ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"bM ( aw . O , aw . U ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["REFRACTIVE","NODES",{a:"logic_negative_expr",o:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"m = - bL . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES"],l:{a:"grp",f:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},
{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_PLANE"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",
c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",
b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},
{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"include",D:"math.glslv"},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"include",D:"coverage.glslf"}]}}]},
{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CAUSTICS"],l:{a:"grp",f:[{a:"include",D:"caustics.glslf"}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["RGBA_SHADOWS"],l:{a:"grp",f:[{a:"include",D:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["CAUSTICS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",
";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_STENCIL_ALPHA_MASK"],l:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_SPEC"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float",
"u_parallax_scale",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2},"SHADELESS",{a:"logic_negative_expr",o:1},"CAUSTICS",{a:"logical_and_expr",o:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:5}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bG",";"]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",
j:["TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","bH",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},
{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},"REFRACTIVE",{a:"logical_or_expr",o:3}],
l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"shadow.glslf"}]}}]},{a:"include",D:"mirror.glslf"},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"include",D:"refraction.glslf"}]}}]},{a:"include",D:"environment.glslf"},{a:"cond",f:[{a:"if",
j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"lighting_nodes.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2},"SHADELESS",{a:"logic_negative_expr",o:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",
o:3},{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"float bA = length ( i ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"float bB = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:["vec2","bN","=","A",";"]}]}}]},{a:"txt",b:"vec3 bO = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bO = bO ; else bO = - bO ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( bO , k . xyz ) * k . w ; mat3 bP = mat3 ( k . xyz , W , bO ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",
o:2},"REFRACTIVE",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NORMAL_TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:"vec2 bQ = normalize ( _ ( N , j ) ) . st ; bQ = bQ * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"PARALLAX",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( bA < PARALLAX_LOD_DIST ) { float bR = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bA ) , 0.0 , 1.0 ) ; float bS = u_parallax_scale * bR ; vec3 bT = normalize ( bG * bP ) ; float bU = 1.0 / PARALLAX_STEPS ; vec2 bV = bT . xy * bS / ( PARALLAX_STEPS * bT . z ) ; float bW = 1.0 ; float bX ;".split(" ")},
{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["vec2","bY","=","bQ",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec2","bY","=","bN",";"]}]}}]},{a:"txt",b:"bX = GLSL_TEXTURE ( u_normalmap0 , bY ) . a ; for ( float bZ = 1.0 ; bZ <= PARALLAX_STEPS ; bZ ++ ) { if ( bX < bW ) { bW -= bU ; bY -= bV ; bX = GLSL_TEXTURE ( u_normalmap0 , bY ) . a ; } } vec2 b_ = bY + bV ; float ca = GLSL_TEXTURE ( u_normalmap0 , b_ ) . a - ( bW + bU ) ; float cb = bX - bW ; float cc = cb / ( cb - ca ) ; bY = cc * b_ + ( 1.0 - cc ) * bY ;".split(" ")},
{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:"bN += bY - bQ ;".split(" ")}]}}]},{a:"txt",b:["bQ","=","bY",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NORMAL_TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:"bQ += bY - bN ;".split(" ")}]}}]},{a:"txt",b:["bN","=","bY",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:["vec4","cd",";"]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cd = GLSL_TEXTURE ( u_normalmap0 , bQ ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"cd = GLSL_TEXTURE ( u_normalmap0 , bN ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 ce = cd . rgb - 0.5 ; ce = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , ce , u_normal_factor ) ; vec3 U = bP * ce ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec3","U",
"=","bO",";"]}]}}]},{a:"txt",b:"U = normalize ( U ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["NORMAL_TEXCOORD"],l:{a:"grp",f:[{a:"txt",b:"bQ = normalize ( _ ( N , U ) ) . st ; bQ = bQ * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bG ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 cf = bH ; cg ( cf ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 ch = vec4 ( cf , 1.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec4","ch","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","ci","=","1.0",";"]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 cj = GLSL_TEXTURE ( u_colormap0 , bQ ) ;".split(" ")}]}},{a:"elif",j:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 cj = GLSL_TEXTURE ( u_colormap0 , bN ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cg ( cj . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_STENCIL_ALPHA_MASK"],l:{a:"grp",f:[{a:"txt",b:["vec4","ck",";"]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"ck = GLSL_TEXTURE ( u_colormap1 , bQ ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"ck = GLSL_TEXTURE ( u_colormap1 , bN ) ;".split(" ")}]}}]},
{a:"txt",b:"cg ( ck . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 cl = GLSL_TEXTURE ( u_stencil0 , bQ ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 cl = GLSL_TEXTURE ( u_stencil0 , bN ) ;".split(" ")}]}}]},{a:"txt",b:"cj = mix ( cj , ck , cl . r ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:"ch . rgb = mix ( ch . rgb , cj . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * cj . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; ch . a = mix ( L , 1.0 , u_diffuse_color . a ) ; ci = cj . a ;".split(" ")}]}},{a:"elif",j:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"ch . rgb *= mix ( vec3 ( 1.0 ) , cj . rgb , u_diffuse_color_factor ) ; ch . a = cj . a ; ci = cj . a ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SHADELESS"],l:{a:"grp",
f:[{a:"txt",b:"vec3 aQ = ch . rgb ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 cm = u_diffuse_intensity * ch . rgb ; vec3 co = u_environment_energy * cn ( U ) ; vec3 cp = u_ambient * co ; vec4 bC = cq ( cm ) ; vec3 cr = u_emit * ch . rgb ; vec3 cs = u_specular_color ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_SPEC"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["ALPHA_AS_SPEC"],l:{a:"grp",f:[{a:"txt",b:"vec3 ct = vec3 ( ci ) ;".split(" ")}]}},{a:"elif",j:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ct = GLSL_TEXTURE ( u_specmap0 , bQ ) . rgb ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ct = GLSL_TEXTURE ( u_specmap0 , bN ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"cg ( ct . rgb ) ; cs = mix ( cs , ct , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cu = u_specular_params [ 0 ] ; vec2 cv = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cw = cu * cs ; vec3 aQ ; vec3 cx ; cy ( cr , cp , cm , cw , h , U , C , cv , u_diffuse_params , bC , 0.0 , vec4 ( 0.0 ) , aQ , cx ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cz ( aQ , C , U , u_reflect_factor , N ) ;".split(" ")}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cz ( aQ , C , U , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cz ( aQ , C , U , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["aQ","+=","cx",";"]}]}}]},{a:"txt",b:"float J = ch . a ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1},"WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WETTABLE"],l:{a:"grp",f:[{a:"txt",b:"aQ = max ( aQ - sqrt ( 0.01 * - min ( bB , 0.0 ) ) , 0.5 * aQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CAUSTICS"],l:{a:"grp",f:[{a:"txt",b:"bD ( aQ , bB , u_time , bC , U , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bA ) ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["ALPHA_CLIP"],l:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"float t = max ( max ( cx . r , cx . g ) , cx . b ) * u_specular_alpha ; J = ch . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],
l:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:"vec2 cA = - ( _ ( N , U ) ) . xy ; aQ = mix ( cB ( l , cA * u_refr_bump ) , aQ , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"bE ( aQ , bA , C , bB ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",
b:"bE ( aQ , bA , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float bF = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aQ = vec3 ( bF ) ;".split(" ")}]}}]},{a:"txt",b:["aW","(","aQ",")",";"]},{a:"cond",f:[{a:"if",j:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"txt",
b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};a["node_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"cond",f:[{a:"if",j:["USE_NODE_VALUE"],l:{a:"grp",
f:[{a:"txt",b:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_RGB"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_VIEW_TSR"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_VIEW_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR"],l:{a:"grp",f:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 cC ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",D:"nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",
f:[{a:"if",j:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_GEOMETRY_NO","USE_NODE_GEOMETRY_GL","USE_NODE_GEOMETRY_IN","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB","USE_NODE_TEX_COORD_NO","USE_NODE_B4W_REFLECT_WORLD",{a:"logical_or_expr",o:9}],l:{a:"grp",f:[{a:"txt",b:"vec3 C = - normalize ( cC ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec3","C",";"]}]}}]},{a:"txt",b:"vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; D = max ( vec3 ( 0.0 ) , D ) ; aW ( D ) ; GLSL_OUT_FRAG_COLOR = vec4 ( D , _1_0 ) ; }".split(" ")}]};
a["particle_system.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",
b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",
b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"USE_TEXTURE_LOD_EXT",b:["0"]},{a:"cond",f:[{a:"if",j:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"cond",f:[{a:"if",j:["GLSL1","USE_TEXTURE_LOD_EXT",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"extension",b:["GL_EXT_shader_texture_lod",
":","enable"]}]}}]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",
f:[{a:"if",j:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",o:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_LAMP"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_VALUE"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_RGB"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_VIEW_TSR",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_VIEW_TSR_INVERSE"],
l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_OBJECT_INFO"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:7}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"NODES",{a:"logical_or_expr",
o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"fog.glslf"}]}}]},{a:"include",D:"math.glslv"},{a:"include",D:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aQ = D ; float J = H ;".split(" ")},
{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["ALPHA_CLIP"],l:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"bE ( aQ , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES"],l:{a:"grp",
f:[{a:"txt",b:"float cD = - i . z / u_view_max_depth ; vec4 cE = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cG = cF ( cE ) ; float cH = cG - cD ; float cI = u_view_max_depth / SOFT_STRENGTH * cH ; J = J * min ( cI , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aW","(","aQ",")",";"]},{a:"cond",f:[{a:"if",j:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",
b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",D:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},
{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["HALO_PARTICLES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","cJ",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bH",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR",
"HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:8}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",f:[{a:"if",j:["PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1},"DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bG",";"]}]}}]},{a:"cond",f:[{a:"if",
j:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"NODES",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","bf",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","j",";"]},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",0,{a:"g_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",j:["WORLD_SPACE",{a:"logic_negative_expr",o:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_COLOR_RAMP"],
l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"include",D:"particles.glslv"},{a:"cond",f:[{a:"if",j:["NODES"],l:{a:"grp",f:[{a:"include",D:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cM ( vec2 cK , vec2 cL ) { return ( atan ( cL . y , cL . x ) - atan ( cK . y , cK . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["mat4","bI","=","u_view_refl_matrix",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"mat4 bI = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 N = u_view_tsr ; cN pp ; pp = cO ( ) ; float cP ; mat3 bk = cQ ( ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 cR = ( bI * vec4 ( pp . O , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 cR = pp . O ;".split(" ")}]}}]},{a:"txt",b:"vec3 U = vec3 ( 0.0 , - 1.0 , 0.0 ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cP = pp . bx ; bk = bj ( cR , N ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cP = cM ( vec2 ( EPSILON , 1.0 ) , vec2 ( U . x , - U . y ) ) + pp . bx ; bk [ 0 ] = cR ; vec4 cS = X ( RIGHT_VECTOR , - M_PI / 2.0 ) ; bk = cT ( cS , bk ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cP = pp . bx ; bk [ 0 ] = cR ; vec4 cU = X ( UP_VECTOR , M_PI / 2.0 ) ; bk = cT ( cU , bk ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cP = pp . bx ; bk [ 0 ] = cR ; } vec3 bn = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cV * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cV * u_p_size ) ; float cW = a_p_data [ 2 ] ; float cX = u_p_tilt * u_p_tilt_rand * ( 2.0 * cW - 1.0 ) ; float cY = ( cX + u_p_tilt ) * M_PI ; vec4 cZ = X ( TOWARD_VECTOR , cY + cP ) ; vec3 bo = ap ( bk , T ( cZ , bn ) ) ; vec4 bL = vec4 ( ap ( N , bo ) , 1.0 ) ; vec4 f = u_proj_matrix * bL ;".split(" ")},
{a:"cond",f:[{a:"if",j:["HALO_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:["bf","=","cW",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"mat3 c_ = cQ ( ) ; cZ = X ( TOWARD_VECTOR , cP ) ; c_ = cT ( cZ , c_ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",o:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",
o:2},{a:"logical_and_expr",o:2},"USE_TBN_SHADING",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 W = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"au aw = av ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , V , vec3 ( 0.0 ) , W , U , aY ( bk , c_ ) ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",o:2},"CALC_TBN_SPACE",
"USE_TBN_SHADING",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{a:"txt",b:"I ( pp . O , pp . da , pp . db , pp . dc , pp . cV , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"au aw = av ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , U , aY ( bk , c_ ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"cJ = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bH = pp . aQ ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1},"PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",o:11}],l:{a:"grp",f:[{a:"txt",b:"j = aw . U ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"l = aC ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",
o:1},"NODES",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["i","=","bL",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bo ;".split(" ")},{a:"cond",f:[{a:"if",j:["PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1},"DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"bG = u_camera_eye - bo ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",
c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},
{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"pack.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",
f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",f:[{a:"if",j:["SKY_STARS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",
o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:8}],l:{a:"grp",f:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",j:["NODES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["HALO_PARTICLES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","cJ",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bH",";"]}]}}]},{a:"cond",f:[{a:"if",j:["PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1},"DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec3","bG",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",o:1},"NODES",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","bf",";"]},{a:"cond",f:[{a:"if",j:["SKY_STARS"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","be",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",D:"lighting_nodes.glslf"},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"fog.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES"],l:{a:"grp",f:[{a:"include",D:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",
j:["PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1},"DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( bG ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["HALO_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:"vec4 bi = bh ( ) ; vec3 aQ = bi . rgb * bH ; float dd = 0.9 * length ( A ) ; float de = smoothstep ( u_p_alpha_start , u_p_alpha_end , dd ) ; float J = bi . a * ( 1.0 - de ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec4",
"ch","=","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:"vec4 cj = GLSL_TEXTURE ( u_sampler , A ) ; cg ( cj . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"ch . rgb = mix ( ch . rgb , cj . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",j:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"ch . rgb *= mix ( vec3 ( 1.0 ) , cj . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"ch . a = cj . a ;".split(" ")}]}}]},{a:"txt",b:"ch . rgb *= bH ;".split(" ")},{a:"cond",f:[{a:"if",j:["PARTICLES_SHADELESS",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"vec3 cm = u_diffuse_intensity * ch . rgb ; vec3 cr = u_emit * ch . rgb ; vec3 U = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",o:1},"SKY_COLOR",{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"vec3 co = u_environment_energy * cn ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 co = u_environment_energy * cn ( U ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cp = u_ambient * co ; float cu = u_specular_params [ 0 ] ; vec2 cv = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cw = cu * u_specular_color ; vec3 aQ ; vec3 cx ; cy ( cr , cp , cm , cw , h , U , C , cv , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aQ , cx ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 aQ = ch . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = ch . a * cJ ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["ALPHA_CLIP"],l:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"bE ( aQ , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES"],l:{a:"grp",f:[{a:"txt",b:"float cD = - i . z / u_view_max_depth ; vec4 cE = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cG = cF ( cE ) ; float cH = cG - cD ; float cI = u_view_max_depth / SOFT_STRENGTH * cH ; J = J * min ( cI , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aW","(","aQ",")",";"]},{a:"cond",f:[{a:"if",j:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cC ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float df = 0.99 ; const float dg = 1.8 ; const int dh = 8 ; float dm ( vec3 O , vec3 bp ) { float a = dot ( bp , bp ) ; float b = 2.0 * dot ( bp , O ) ; float di = dot ( O , O ) - 1.0 ; float dj = b * b - 4.0 * a * di ; float dk = sqrt ( dj ) ; float q = ( - b - dk ) / 2.0 ; float dl = di / q ; return dl ; } float dp ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float di = 1.0 + J * J ; float dn = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; dn = max ( dn , 0.00001 ) ; return ( a / b ) * ( di / dn ) ; } float du ( vec3 O , vec3 bp , float dq ) { float dr = dot ( bp , - O ) ; if ( dr < 0.0 ) { return 1.0 ; } vec3 ds = O + dr * bp ; if ( length ( ds ) < dq ) { return 0.0 ; } else if ( length ( ds ) >= dq ) { vec3 cL = normalize ( ds ) * dq - O ; float dt = acos ( dot ( normalize ( cL ) , bp ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dt * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dv ( float aM , vec3 aQ , float aL ) { return aQ - aQ * pow ( u_sky_color , vec3 ( aL / aM ) ) ; } void main ( ) { vec3 dw = normalize ( cC ) ; vec3 dx = u_sun_direction ; float J = dot ( dw , dx ) ; float dy = dp ( J , - 0.01 ) * u_rayleigh_brightness * dx . z ; float dz = dp ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dx . z ) ; float dA = smoothstep ( 0.0 , 100.0 , dp ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dB = vec3 ( 0.0 , 0.0 , df ) ; float dC = dm ( dB , dw ) ; float dD = dC / float ( dh ) ; float dE = du ( dB , dw , df - 0.3 ) ; vec3 dF = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dG = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bZ = 0 ; bZ < dh ; bZ ++ ) { float dH = dD * float ( bZ ) ; vec3 O = dB + dw * dH ; float dI = du ( O , dx , df - 0.2 ) ; float dJ = dm ( O , dx ) ; vec3 dK = dv ( dJ , vec3 ( dg ) , u_scatter_strength ) * dI ; dF += dv ( sqrt ( dH ) , u_sky_color * dK , u_rayleigh_strength ) ; dG += dv ( dH , dK , u_mie_strength ) ; } dF = dF * dE * pow ( dC , u_rayleigh_collection_power ) / float ( dh ) ; dG = ( dG * dE * pow ( dC , u_mie_collection_power ) ) / float ( dh ) ; vec3 aQ = vec3 ( dA * dG + dz * dG + dy * dF ) ; aW ( aQ ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",
b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",
b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_LOD_SMOOTHING",b:["0"]},{a:"cond",f:[{a:"if",j:["GLSL1","USE_DERIVATIVES_EXT",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",j:["RGBA_SHADOWS"],l:{a:"grp",f:[{a:"include",D:"depth_fetch.glslf"},{a:"include",D:"pack.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"include",D:"coverage.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",
f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",j:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",o:2},"CAMERA_TYPE",
"CAM_TYPE_ORTHO",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_VIEW_TSR",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_VIEW_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR"],l:{a:"grp",
f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_MODEL_TSR_INVERSE"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec2 u_fresnel_params ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_LAMP"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_VALUE"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_RGB"],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",f:[{a:"if",
j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW",
"u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",j:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",o:3}],
l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_OBJECT_INFO"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",j:["RGBA_SHADOWS","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_lod_coverage ; uniform float u_lod_cmp_logic ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"NODES","ALPHA",{a:"logical_and_expr",o:2},"SHADOW_USAGE",
"SHADOW_CASTING",{a:"equal_expr",o:2},"RGBA_SHADOWS",{a:"logical_and_expr",o:2},{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2",
"NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",
{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",j:["SHADELESS",{a:"logic_negative_expr",o:1},"NODES","ALPHA",{a:"logical_and_expr",o:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",o:2},{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"include",D:"shadow.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NODES"],l:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",j:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_LOD_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"if ( ! M ( u_lod_coverage , u_lod_cmp_logic ) ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["RGBA_SHADOWS"],l:{a:"grp",f:[{a:"txt",b:"float dM = dL ( - i . z , u_camera_range ) ; GLSL_OUT_FRAG_COLOR = dN ( dM ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"elif",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dO ( i . z ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};
a["shadow.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",
c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},
{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"include",D:"scale_texcoord.glslv"},
{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_INSTANCED_PARTCLS"],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",
o:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",j:["DETAIL_BEND"],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",j:["BEND_CENTER_ONLY"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",o:5}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2},{a:"logic_negative_expr",o:1},"TEXTURE_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",
j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"NODES","ALPHA",{a:"logical_and_expr",o:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2},"RGBA_SHADOWS",{a:"logical_and_expr",o:2},{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4",
"i",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3",
"NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_JITTER"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",
";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",j:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",
b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",
b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["BILLBOARD_JITTERED"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:["uniform","float",
"u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2},{a:"logic_negative_expr",o:1},"TEXTURE_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",j:["MAC_OS_SHADOW_HACK"],l:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION"],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",D:"dynamic_grass.glslv"},{a:"include",D:"shadow.glslv"},{a:"include",D:"skin.glslv"},{a:"include",D:"wind_bending.glslv"},
{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 N = u_view_tsr ; vec3 O = a_position ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO",
"USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:13}],l:{a:"grp",f:[{a:"txt",b:"float P , Q ; vec4 S = R ( a_tbn , P , Q ) ; vec3 bJ = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 U = bJ ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 U = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 W = Q * cross ( U , V ) ; vec4 Y = X ( W , Q * P ) ; V = T ( Y , U ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 0.0 ) ; vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["VERTEX_ANIM"],l:{a:"grp",f:[{a:"txt",b:"O = mix ( O , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",o:5}],l:{a:"grp",f:[{a:"txt",b:"float af , ah ; vec4 ai = R ( a_tbn_next , af , ah ) ; vec3 aj = T ( ai , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; U = mix ( U , aj , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:"vec3 ak = T ( ai , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 al = ah * cross ( aj , ak ) ; vec4 am = X ( al , ah * af ) ; ak = T ( am , aj ) ; V = mix ( V , ak , u_va_frame_factor ) ; W = mix ( W , al , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"txt",b:"an ( O , V , W , U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_INSTANCED_PARTCLS"],l:{a:"grp",f:[{a:"txt",b:"mat3 Z = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["STATIC_BATCH",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"Z = aY ( u_model_tsr , Z ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["mat3","Z","=","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",o:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["vec3","ao","=","au_center_pos",";"]}]}},{a:"elif",j:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",
{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ao = a_part_ts . xyz ; O = ap ( Z , O ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ao = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["CALC_TBN"],l:{a:"grp",f:[{a:"txt",b:"vec3 ac = normalize ( _ ( Z , bJ ) ) ; vec3 ad = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , ac ) ; vec3 ae = cross ( ac , ad ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec3","ae","=",
"a_shade_tangs",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ae = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"txt",b:"au aw = aZ ( O , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , U , ao , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , N , Z ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:"vec3 aq = ap ( Z , ao ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["HAIR_BILLBOARD",{a:"logic_negative_expr",o:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["mat3","dP","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["mat3","dP","=","N",";"]}]}}]},{a:"txt",b:"Z = as ( u_camera_eye , aq , dP , Z ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"Z = at ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aq , Z ) ;".split(" ")}]}}]},
{a:"txt",b:"au aw = av ( O - ao , ao , V , ae , W , U , Z ) ; aw . ao = aq ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"au aw = av ( O , ao , V , ae , W , U , Z ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["vec3","ay","=","bJ",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ay = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ax ( aw . O , aw . ao , ay , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"h = aw . O ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",o:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:12}],l:{a:"grp",f:[{a:"txt",b:"j = aw . U ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"txt",b:"float aA = ( dot ( cross ( aw . U , aw . V ) , aw . W ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( aw . V , aA ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:"B = aw . aB ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bL = vec4 ( ap ( N , aw . O ) , 1.0 ) ; vec4 f = u_proj_matrix * bL ;".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_JITTER"],l:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["NODES","ALPHA",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"USE_POSITION_CLIP",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"l = aC ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"m = - bL . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",
j:["TEXTURE_COLOR"],l:{a:"grp",f:[{a:"txt",b:"A = az ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"bM ( aw . O , aw . U ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"NODES","ALPHA",{a:"logical_and_expr",o:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2},"RGBA_SHADOWS",{a:"logical_and_expr",o:2},{a:"logical_or_expr",
o:3}],l:{a:"grp",f:[{a:"txt",b:["i","=","bL",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 dQ = ( u_proj_matrix * vec4 ( N [ 0 ] , 1.0 ) ) . xy ; float dR = SHADOW_TEX_RES / 2.0 ; dQ = floor ( dQ * dR + 0.5 ) / dR - dQ ; f . xy += dQ ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["sky.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",
c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},"REFLECTION_PASS",
"REFL_PASS_NONE",{a:"equal_expr",o:2},{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WO_SKYBLEND",
"WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"include",D:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cC",";"]},{a:"cond",f:[{a:"if",j:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",o:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dS ; vec3 dw = normalize ( cC ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WO_SKYBLEND",
"WO_SKYPAPER",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["float","dT","=","0.0",";"]},{a:"cond",f:[{a:"if",j:["WO_SKYREAL"],l:{a:"grp",f:[{a:"txt",b:"dT = abs ( A . y ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"dT = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dU = u_horizon_color ; vec3 dV = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",j:["WO_SKYTEX"],l:{a:"grp",f:[{a:"txt",b:"vec3 dW = vec3 ( A , 0.0 ) ; vec4 dX = GLSL_TEXTURE_CUBE ( u_sky , dw ) ; cg ( dX . rgb ) ; dS = dY ( dU , dV , dX , dT , dW ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"dS = mix ( dU , dV , dT ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"dS = GLSL_TEXTURE_CUBE ( u_sky , dw ) . rgb ; cg ( dS ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",o:2},{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"float dZ = WATER_LEVEL - u_camera_eye_frag . z ; vec3 d_ = vec3 ( 0.0 ) ; vec3 ea = mix ( u_underwater_fog_color_density . rgb , d_ , min ( - dw . z , 1.0 ) ) ; ea *= min ( 1.0 - min ( 0.03 * dZ , 0.8 ) , 1.0 ) ; float aL = clamp ( sign ( 0.01 * dZ - dw . z ) , 0.0 , 1.0 ) ; dS = mix ( dS , ea , aL ) ;".split(" ")}]}}]},
{a:"txt",b:"aW ( dS ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dS , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cC ;".split(" ")},{a:"cond",f:[{a:"if",j:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",o:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dw = u_sky_vp_inverse * O ; cC = dw . xyz ;".split(" ")},{a:"cond",f:[{a:"if",j:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",o:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","O",";","}"]}]};
a["skybox.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cC ;".split(" ")},{a:"cond",f:[{a:"if",j:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",o:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 O = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dw = u_cube_view_matrix * O ; cC = dw . xyz ;".split(" ")},{a:"cond",f:[{a:"if",j:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",o:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","O",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cC ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",j:["WO_SKYTEX"],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",f:[{a:"if",j:["WO_SKYTEX"],l:{a:"grp",f:[{a:"include",D:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dw = normalize ( cC ) ; vec3 dS ; float dT = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["WO_SKYPAPER"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WO_SKYTEX"],l:{a:"grp",f:[{a:"txt",b:"dS = GLSL_TEXTURE_CUBE ( u_sky_texture , dw ) . xyz ; cg ( dS ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"dS = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",
j:["WO_SKYBLEND"],l:{a:"grp",f:[{a:"txt",b:"float J = acos ( dw . z ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WO_SKYREAL"],l:{a:"grp",f:[{a:"txt",b:"dT = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"dT = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dU = u_horizon_color ; vec3 dV = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",j:["WO_SKYTEX"],l:{a:"grp",f:[{a:"txt",b:"vec4 dX = GLSL_TEXTURE_CUBE ( u_sky_texture , dw ) ; cg ( dX . rgb ) ; vec3 dW = vec3 ( cC . xy , 0.0 ) ; dS = dY ( dU , dV , dX , dT , dW ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WO_SKYBLEND"],l:{a:"grp",f:[{a:"txt",b:"dS = mix ( dU , dV , dT ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["dS","=","dU",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aW ( dS ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dS , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",
b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",
c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"pack.glslf"},{a:"include",D:"color_util.glslf"},{a:"include",D:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",
f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",j:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2},{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",
";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",
j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["FOAM"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec2 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",1,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",2,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",3,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["FOAM"],l:{a:"grp",f:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_WIREFRAME"],l:{a:"grp",f:[{a:"txt",b:"const float aE = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bG ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2},"FOAM",{a:"logical_or_expr",o:2},"GENERATED_MESH",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 eb ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2},"FOAM",{a:"logical_or_expr",o:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","ec",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","ed",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
o:1},{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_WIREFRAME"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","aD",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",D:"environment.glslf"},{a:"cond",f:[{a:"if",j:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",o:3}],l:{a:"grp",
f:[{a:"include",D:"refraction.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"include",D:"fog.glslf"}]}}]},{a:"txt",b:"vec3 el ( in vec2 ee , in vec3 U , in vec3 ef , in vec3 eg , out float eh , in float ei ) { eh = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 ej = ee . xy + U . xy * REFL_BUMP / m ; eh = u_reflect_factor ; vec3 ek ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["DISABLE_FOG",{a:"logic_negative_expr",o:1},"WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"ek = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"ek = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { ek = GLSL_TEXTURE ( u_plane_reflection , ej ) . rgb ; cg ( ek ) ; }".split(" ")}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"eh = u_mirror_factor ; vec3 ek = eg * GLSL_TEXTURE_CUBE ( u_mirrormap , ef ) . rgb ; cg ( ek ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"eh = u_reflect_factor ; vec3 ek = eg * vec3 ( 0.3 , 0.5 , 1.0 ) ; cg ( ek ) ;".split(" ")}]}}]},{a:"txt",b:"eh = min ( eh * ei , 1.0 ) ; return ek ; }".split(" ")},{a:"include",D:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"mat3 bP = mat3 ( k , eb , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 U = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DYNAMIC",
"FOAM",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",b:"float bB = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float bB = h . z ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2},"FOAM",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["GENERATED_MESH"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"vec2 bN = vec2 ( ec . x , - ec . y ) + 0.5 ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec2 bN = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec2","bN","=","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 em = vec3 ( 0.0 ) ; em += GLSL_TEXTURE ( u_normalmap0 , bN * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",1,{a:"g_expr",o:2}],l:{a:"grp",
f:[{a:"txt",b:"em += GLSL_TEXTURE ( u_normalmap0 , bN * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",2,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"em += GLSL_TEXTURE ( u_normalmap0 , bN * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",3,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"em += GLSL_TEXTURE ( u_normalmap0 , bN * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"U = mix ( U , normalize ( bP * em ) , 0.3 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"U = mix ( U , normalize ( bP * em ) , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"U = normalize ( U ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bG ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE",{a:"logical_or_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 ee = l . xy / l . z ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec2 ee = vec2 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:"vec2 en = ee + U . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cE = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cG = cF ( cE ) ; float cH = max ( cG - m , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:"float ep = eo ( cG , en , ee ) ; float eq = max ( ep - m , 0.0 ) ; float er = u_view_max_depth / ABSORB * eq ; float es = min ( J * er , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cH , 1.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float cI = u_view_max_depth / ABSORB * cH ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cI , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:["float","es","=","J",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) es = 0.0 ; vec3 et = GLSL_TEXTURE ( u_refractmap , en ) . rgb ; cg ( et ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"float eu = pow ( min ( ed . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 ch = mix ( u_shallow_water_col , u_diffuse_color . rgb , eu ) ; eu = pow ( min ( ed . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; ch = mix ( u_shore_water_col , ch , eu ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ch = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["FOAM"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING"],l:{a:"grp",f:[{a:"txt",b:"float ev = max ( 1.0 - u_view_max_depth * cH , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float ev = 1.0 - J ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"float ew = max ( bB / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],
l:{a:"grp",f:[{a:"txt",b:"vec3 ex = normalize ( vec3 ( ed . rg , 0.0 ) ) ; vec3 ey = normalize ( mix ( UP_VECTOR , ex , 0.8 ) ) ; float ez = 1.25 * max ( dot ( U , ey ) - 0.2 , 0.0 ) ; ez += max ( dot ( U , - UP_VECTOR ) , 0.0 ) ; ev += ez * ( 1.0 - ed . b ) ; ew *= ( 1.0 - 0.95 * pow ( ed . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"ev += ew ; ev = min ( u_foam_factor * ev , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 eA = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bN * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cu = u_specular_params [ 0 ] ; vec2 cv = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cw = cu * u_specular_color ; vec3 co = u_environment_energy * cn ( U ) ; vec3 cp = u_ambient * co ; vec3 eg = cp + u_sun_intensity ; float eh ; vec3 ef = reflect ( - C , U ) ; vec3 eB = normalize ( ef + C ) ; float eC = 1.0 - dot ( C , eB ) ; float eD = u_fresnel_params [ 0 ] ; float eE = u_fresnel_params [ 1 ] ; float eF = eE + ( 1.0 - eE ) * pow ( eC , eD ) ; vec3 ek = el ( ee , U , ef , eg , eh , eF ) ; vec3 cm = u_diffuse_intensity * ch ; vec3 aQ ; vec3 cx ; cy ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cm , cw , h , U , C , cv , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aQ , cx ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"float eG = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; eG = clamp ( SSS_STRENGTH * eG , 0.0 , 1.0 ) ; aQ = mix ( aQ , u_shallow_water_col , eG ) ; aQ = mix ( aQ , u_shore_water_col , eG ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"txt",b:"aQ = mix ( et , aQ , es ) ;".split(" ")}]}}]},{a:"txt",
b:"aQ = mix ( aQ , ek , eh ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["FOAM"],l:{a:"grp",f:[{a:"txt",b:"float eH = mix ( eA . g , eA . r , max ( 4.0 * ( ev - 0.75 ) , 0.0 ) ) ; eH = mix ( eA . b , eH , max ( 2.0 * ev - 1.0 , 0.0 ) ) ; eH = mix ( 0.0 , eH , ev ) ; aQ = mix ( aQ , eg , eH ) ;".split(" ")}]}}]},{a:"txt",b:["aQ","+=","cx",";"]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float eI = m * u_view_max_depth ; float eJ = 1.0 ; if ( u_cam_water_depth > 1.0 ) eJ = 2.0 ; bE ( aQ , eI , C , eJ ) ;".split(" ")}]}}]},
{a:"txt",b:["aW","(","aQ",")",";"]},{a:"cond",f:[{a:"if",j:["REFRACTIVE",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"J = max ( J , cx . r ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["FOAM"],l:{a:"grp",f:[{a:"txt",b:["J","+=","eH",";"]}]}}]}]}},{a:"elif",j:["SHORE_SMOOTHING",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["ALPHA"],l:{a:"grp",f:[{a:"txt",b:"aX ( aQ , J ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_WIREFRAME",
1,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["GLSL1"],l:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aN = fwidth ( aD ) ; vec3 aO = smoothstep ( vec3 ( 0.0 ) , aN * aE , aD ) ; float eK = min ( min ( aO . x , aO . y ) , aO . z ) ; eK = clamp ( eK , 0.0 , 1.0 ) ; aQ = mix ( u_wireframe_edge_color , aQ , eK ) ; J = mix ( 1.0 , J , eK ) ;".split(" ")}]}},{a:"elif",j:["DEBUG_WIREFRAME",2,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:"vec3 aM = sign ( aD - vec3 ( 0.02 * aE ) ) ; float eK = 1.0 ; if ( aM . x < 0.0 || aM . y < 0.0 || aM . z < 0.0 ) eK = 0.0 ; aQ = mix ( u_wireframe_edge_color , aQ , eK ) ; J = mix ( 1.0 , J , eK ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},
{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",
b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",
c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"include",D:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",j:["GENERATED_MESH",{a:"logic_negative_expr",o:1},"DYNAMIC",{a:"logic_negative_expr",o:1},"NUM_NORMALMAPS",0,{a:"g_expr",o:2},{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec4","a_tbn",";"]}]}}]},{a:"cond",f:[{a:"if",j:["GENERATED_MESH",{a:"logic_negative_expr",o:1},"NUM_NORMALMAPS",0,{a:"g_expr",o:2},"FOAM",{a:"logical_or_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_WIREFRAME"],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bG ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",
o:2},"FOAM",{a:"logical_or_expr",o:2},"GENERATED_MESH",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 eb ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2},"FOAM",{a:"logical_or_expr",o:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3",
"ec",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","ed",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",
b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DEBUG_WIREFRAME"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","aD",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_TBN_SHADING"],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",j:["STATIC_BATCH"],l:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},
{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"vec3 eR ( in vec2 eL ) { vec2 eM = 0.5 + vec2 ( ( eL . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eL . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eN = GLSL_TEXTURE ( u_shore_dist_map , eM ) ; const vec2 eO = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eP = dot ( eN . ba , eO ) ; vec2 eQ = normalize ( eN . rg * 2.0 - 1.0 ) ; return vec3 ( eQ , eP ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",
f:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void ff ( inout vec3 eL , in float eS , in vec3 eN ) { float eU = eT ( DST_NOISE_SCALE_0 * ( eL . xy + DST_NOISE_FREQ_0 * eS ) ) * eT ( DST_NOISE_SCALE_1 * ( eL . yx - DST_NOISE_FREQ_1 * eS ) ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"float eV = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eP = eN . b ; float eW = sqrt ( eP ) ; float eX = max ( eP , DIR_MIN_SHR_FAC ) * sin ( eW / eV + DIR_FREQ * eS ) ; float eY = max ( eT ( DIR_NOISE_SCALE * ( eL . xy + DIR_NOISE_FREQ * eS ) ) , DIR_MIN_NOISE_FAC ) ; eX *= eY ; float eZ = WAVES_HEIGHT * mix ( eX , eU , max ( eW , DST_MIN_FAC ) ) ; vec2 eQ = eN . rg ; float e_ = WAVES_HOR_FAC * eX * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eP ) , 0.0 ) ; vec2 fa = e_ * eQ ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"float eZ = WAVES_HEIGHT * eU ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["GENERATED_MESH"],l:{a:"grp",f:[{a:"txt",b:"vec2 fb = 1.0 * ( eL . xy - 0.3 * eS ) ; vec2 fc = 0.7 * ( eL . yx + 0.07 * eS ) ; float fe = fd ( fb ) . x + fd ( fc ) . x - 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"eL . xy += fa ; fe *= eP ;".split(" ")}]}}]},{a:"txt",b:"eZ += SMALL_WAVES_FAC * fe ;".split(" ")}]}}]},{a:"txt",b:"eL . z += eZ ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["DEBUG_WIREFRAME"],l:{a:"grp",f:[{a:"txt",b:"if ( a_polyindex == 0.0 ) aD = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) aD = vec3 ( 0.0 , 0.0 , 1.0 ) ; else aD = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["GENERATED_MESH"],l:{a:"grp",f:[{a:"txt",b:"vec3 O = a_position ; float fg = abs ( O . z ) ; vec2 fh = u_camera_eye . xy - mod ( u_camera_eye . xy , fg ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],
l:{a:"grp",f:[{a:"txt",b:"O . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"O . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"O . xy += fh ; vec3 bK = O ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2},"FOAM",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"au aw = av ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bK = aw . O ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"ed = eR ( bK . xy ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DYNAMIC"],l:{a:"grp",f:[{a:"txt",b:"float fi = length ( u_wind ) ; if ( fi == 0.0 ) fi = 1.0 ; float fj = u_time ; fj *= fi ;".split(" ")},{a:"cond",f:[{a:"if",j:["GENERATED_MESH"],l:{a:"grp",f:[{a:"txt",b:"float fk = fg ; vec3 fl = bK + vec3 ( fk , 0.0 , 0.0 ) ; vec3 fm = bK + vec3 ( 0.0 , fk , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",
o:2},"FOAM",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["ec","=","bK",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 fl = bK + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fm = bK + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SHORE_PARAMS"],l:{a:"grp",f:[{a:"txt",b:"vec3 fn = eR ( fl . xy ) ; vec3 fo = eR ( fm . xy ) ; ff ( fl , fj , fn ) ; ff ( fm , fj , fo ) ; ff ( bK , fj , ed ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"ff ( fl , fj , vec3 ( 0.0 ) ) ; ff ( fm , fj , vec3 ( 0.0 ) ) ; ff ( bK , fj , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bK . z = WATER_LEVEL - 1.0 ; fl . z = bK . z ; fm . z = bK . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fp = normalize ( fl - bK ) ; vec3 V = normalize ( fm - bK ) ; j = normalize ( cross ( fp , V ) ) ; float fq = dot ( j , UP_VECTOR ) ; float aL = clamp ( 0.8 - fq , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aL ) ;".split(" ")}]}},{a:"elif",j:["GENERATED_MESH",{a:"logic_negative_expr",
o:1}],l:{a:"grp",f:[{a:"txt",b:"vec4 S = R ( a_tbn ) ; j = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_NORMALMAPS",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DYNAMIC",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["GENERATED_MESH",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"vec3 V = T ( S , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",j:["DYNAMIC",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"vec3 V = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = V ; eb = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bK ; bG = u_camera_eye - bK ; vec4 bL = vec4 ( ap ( u_view_tsr , bK ) , 1.0 ) ; vec4 f = u_proj_matrix * bL ;".split(" ")},{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"float fr = f . x ; float fs = f . y ; float ft = f . w ; l . x = ( fr + ft ) / 2.0 ; l . y = ( fs + ft ) / 2.0 ; l . z = ft ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:"m = - bL . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",D:"precision_statement.glslf"},
{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",j:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fv ( float x , float y ) { vec2 fu = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fu ) ; } vec4 fO ( ) { vec4 fw = fv ( - 1.0 , - 1.0 ) ; vec4 fx = fv ( 1.0 , - 1.0 ) ; vec4 fy = fv ( - 1.0 , 1.0 ) ; vec4 fz = fv ( 1.0 , 1.0 ) ; vec4 fA = fv ( 0.0 , 0.0 ) ; float fC = fB ( fA ) ; float fD = fB ( fw ) ; float fE = fB ( fx ) ; float fF = fB ( fy ) ; float fG = fB ( fz ) ; float fH = min ( fC , min ( min ( fD , fE ) , min ( fF , fG ) ) ) ; float fI = max ( fC , max ( max ( fD , fE ) , max ( fF , fG ) ) ) ; vec2 bp ; bp . x = - ( ( fD + fE ) - ( fF + fG ) ) ; bp . y = ( ( fD + fF ) - ( fE + fG ) ) ; float fJ = max ( ( fD + fE + fF + fG ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fK = 1.0 / ( min ( abs ( bp . x ) , abs ( bp . y ) ) + fJ ) ; bp = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , bp * fK ) ) * u_texel_size ; vec4 fL = 0.5 * ( GLSL_TEXTURE ( u_color , A + bp * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + bp * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fM = fL * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + bp * - 0.5 ) + GLSL_TEXTURE ( u_color , A + bp * 0.5 ) ) ; float fN = fB ( fM ) ; if ( ( fN < fH ) || ( fN > fI ) ) return fL ; else return fM ; }".split(" ")}]}},
{a:"elif",j:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",D:"fxaa.glslf"},{a:"cond",f:[{a:"if",j:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",j:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",j:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fO ( ) ;".split(" ")}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 fP = u_texel_size ; GLSL_OUT_FRAG_COLOR = fQ ( A , u_color , fP , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_combine.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"var",c:"BLUR_PASS_NUM",b:["BLUR_PASS_5"]},{a:"txt",b:["uniform","sampler2D","u_main",";"]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_1",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_2",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:["uniform","sampler2D","u_bloom_level_1",";"]}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_3",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_2",";"]}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_4",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_3",";"]}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_5",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_bloom_level_4",";"]}]}}]},
{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_main , A ) ; vec4 fS = vec4 ( 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_1",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"fS += GLSL_TEXTURE ( u_bloom_level_0 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_2",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"fS += GLSL_TEXTURE ( u_bloom_level_1 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
j:["BLUR_PASS_NUM","BLUR_PASS_3",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"fS += GLSL_TEXTURE ( u_bloom_level_2 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_4",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"fS += GLSL_TEXTURE ( u_bloom_level_3 , A ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["BLUR_PASS_NUM","BLUR_PASS_5",{a:"ge_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"fS += GLSL_TEXTURE ( u_bloom_level_4 , A ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fR + fS ; }".split(" ")}]};
a["postprocessing/coc.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",f:[{a:"if",j:["COC_TYPE","COC_COMBINE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D",
"u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aQ = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float dM = fT ( u_depth , A , u_camera_range ) ; dM *= u_view_max_depth ; float fU = 0.0 ;".split(" ")},{a:"cond",
f:[{a:"if",j:["COC_TYPE","COC_COMBINE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 fV = GLSL_TEXTURE ( u_coc_fg , A ) ; float fW = fV . a ;".split(" ")}]}}]},{a:"txt",b:"if ( dM < u_dof_dist ) fU = ( u_dof_dist - dM - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"else fU = ( dM - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fU = clamp ( fU , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["COC_TYPE","COC_COMBINE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"fU = max ( fU , fW ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fU ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aQ . xyz * fU , fU ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aQ . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fX = GLSL_TEXTURE ( u_color , A ) ; vec3 aQ = fX . rgb ; if ( u_brightness < 0.0 ) aQ = aQ * ( 1.0 + u_brightness ) ; else aQ = aQ + ( ( 1.0 - aQ ) * u_brightness ) ; aQ = ( aQ - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aQ *= u_exposure ; float dg = fB ( vec4 ( aQ , 0.0 ) ) ; aQ = mix ( vec3 ( dg ) , aQ , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , fX . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"pack.glslf"},{a:"include",D:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = dN ( clamp ( fT ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"include",D:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fY = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",
j:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float fU ; vec4 fZ = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 f_ = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 gc = min ( fZ . rgba , f_ . rgba ) ; fU = gc . a ; if ( fU > 0.0 ) { gc = vec4 ( gc . rgb / fU , fY . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fY , gc , min ( fU * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fY ;".split(" ")}]}},{a:"elif",j:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float dM = fT ( u_depth , A , u_camera_range ) ; dM *= u_view_max_depth ; float gd ; if ( dM < u_dof_dist ) gd = ( u_dof_dist - dM ) / u_dof_front_end ; else gd = ( dM - u_dof_dist ) / u_dof_rear_end ; gd = clamp ( gd , 0.0 , 1.0 ) ; vec4 ge = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fY , ge , gd ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fY",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fY ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gf = GLSL_TEXTURE ( u_src_color , A ) ; vec4 gh = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gi = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = gf ; if ( gi . a != 0.0 ) { float gj = u_glow_mask_large_coeff * gi . a ; gj = clamp ( gj , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gi . rgb / gi . a , gj ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gj ) ; } if ( gh . a != 0.0 ) { float gk = u_glow_mask_small_coeff * gh . a ; gk = clamp ( gk , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gh . rgb / gh . a , gk ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gk ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"depth_fetch.glslf"},{a:"include",D:"procedural.glslf"},{a:"include",D:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",f:[{a:"if",j:["DEPTH_RGBA"],l:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN float gl ; GLSL_IN vec2 gm ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gn ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cH = ( gn . xy - A ) ; float aM = length ( cH ) ; vec2 go = u_radial_blur_step * cH / aM ; float gp = aM / u_radial_blur_step ; go *= min ( gp , STEPS_PER_PASS ) / STEPS_PER_PASS ; gp = max ( gp , STEPS_PER_PASS ) ; vec2 gq = A ; float gs = 0.0 ; const int gt = int ( STEPS_PER_PASS ) ; int gu = int ( gp + 0.5 ) ; for ( int bZ = 0 ; bZ < gt ; bZ += 1 ) { if ( bZ <= gu ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["DEPTH_RGBA"],l:{a:"grp",f:[{a:"txt",b:"float dM = fT ( u_input , gq , u_camera_range ) ; gs += max ( ( 1.0 - pow ( aM , 0.3 ) ) * step ( 0.9 , dM ) , 0.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 gv = GLSL_TEXTURE ( u_input , gq ) ; gs += cF ( gv ) ;".split(" ")}]}}]},{a:"txt",b:"} gq += go ; }".split(" ")},{a:"cond",f:[{a:"if",j:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 bN = A + gm ; float gw = fd ( vec2 ( 2.5 * ( bN . x ) , 2.5 * ( bN . y ) + 1.0 * u_time ) ) . x + 0.75 * fd ( vec2 ( 5.0 * ( bN . x ) - 0.66 * u_time , 5.0 * ( bN . y ) + 0.66 * u_time ) ) . x + 0.5 * eT ( vec2 ( 7.5 * ( bN . x ) + 0.33 * u_time , 7.5 * ( bN . y ) - 0.33 * u_time ) ) ; gw *= clamp ( 1.2 - sqrt ( 0.2 * aM ) , 0.0 , 1.0 ) * gl ; gs = max ( gw , gs ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dN ( gs / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",j:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",f:[{a:"if",j:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT float gl ; GLSL_OUT vec2 gm ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gn ; void main ( ) { A = a_bb_vertex ; vec3 bp = normalize ( u_sun_direction ) ; gn = u_view_proj_matrix * vec4 ( bp , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gl = 1.0 ; vec3 gx = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gy = T ( u_camera_quat , gx ) ; gy = normalize ( gy ) ; float gz = dot ( gy , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gA = atan ( gy . x , gy . z ) ; gm = vec2 ( - gA , acos ( gz ) ) ; } else { gl = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gn . xy = 0.5 * ( gn . xy / gn . w + 1.0 ) ; gn += 99999.0 * step ( gn . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"include",D:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gB = GLSL_TEXTURE ( u_main , A ) ; vec3 gC = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; cg ( gB . rgb ) ; float gD = cF ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gE = gB . rgb + u_god_rays_intensity * vec3 ( gD ) * gC ; aW ( gE ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SAFARI_CANVAS_ALPHA_HACK"],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gE , max ( 0.01 , gB . a ) ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gE , gB . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_input , A ) ; float gF = dot ( fR . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gF ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; uniform float u_mipmap_1x1 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gG = max ( GLSL_TEXTURE ( u_input , A , u_mipmap_1x1 ) . r , 0.01 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gG ) , 1.0 ) ; }".split(" ")}]};a["postprocessing/luminance_truncated.glslf"]={a:"grp",f:[{a:"version",
b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"var",c:"ADAPTIVE_BLOOM",b:["0"]},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; uniform float u_bloom_key ;".split(" ")},{a:"cond",f:[{a:"if",j:["ADAPTIVE_BLOOM",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_average_lum_val",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["ADAPTIVE_BLOOM"],l:{a:"grp",f:[{a:"txt",b:"float gG = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["float","gG","=","u_average_lum_val",";"]}]}}]},{a:"txt",b:"float gH = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aQ = GLSL_TEXTURE ( u_main , A ) ; float gI = gH / gG ; float gJ = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aQ * u_bloom_key * smoothstep ( gJ , gJ + 1.2 , gI ) ; }".split(" ")}]};a["postprocessing/motion_blur.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gK = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gL = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gM = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gL - gM ) > u_motion_blur_decay_threshold ) { vec4 gN = ( 1.0 - u_motion_blur_exp ) * gL + u_motion_blur_exp * gM ; vec4 gO = gN - gM ; vec4 gP = gL - gM ; vec4 cH = min ( max ( abs ( gO ) , vec4 ( gK ) ) , abs ( gP ) ) * sign ( gO ) ; GLSL_OUT_FRAG_COLOR = gM + cH ; } else { GLSL_OUT_FRAG_COLOR = gL ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gQ = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gQ ; if ( u_draw_outline != 0.0 ) { vec4 gR = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gS = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gT = gS . a - gR . a ; if ( gT != 0.0 ) { float gU = smoothstep ( 0.0 , 1.0 , gS . a ) ; if ( gR . a == 0.0 ) { vec3 gV = u_outline_color ; aW ( gV ) ; vec4 gW = vec4 ( clamp ( gV , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gQ , gW , gU ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aQ = vec4 ( 0.0 ) ; for ( int bZ = 0 ; bZ < 10 ; bZ ++ ) { vec2 gX = vec2 ( fract ( A * vec2 ( bZ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aQ += 0.01 * GLSL_TEXTURE ( u_color , gX ) ; } GLSL_OUT_FRAG_COLOR = aQ ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",f:[{a:"if",j:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",o:2}],
l:{a:"grp",f:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",j:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",j:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 di = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( di . r + di . g + di . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",j:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 ff = vec2 ( 0.0 , 0.0 ) ; vec2 cH = u_texel_size ; vec4 aQ ; aQ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aQ * 0.2270270270 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1945945946 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1945945946 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1216216216 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.1216216216 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0540540541 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0540540541 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0162162162 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * 0.0162162162 ;".split(" ")}]}},
{a:"elif",j:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 ff = vec2 ( 0.0 , 0.0 ) ; vec2 cH = u_texel_size ; vec4 aQ ; aQ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.152507 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.141763 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.141763 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.113861 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.113861 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.079019 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.079019 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.047383 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.047383 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.024549 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.024549 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.01099 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.01099 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00425 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00425 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00142 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; GLSL_OUT_FRAG_COLOR += aQ * ( 1.0 - step ( 0.0 , - aQ . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",j:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 ff = vec2 ( 0.0 , 0.0 ) ; vec2 cH = u_texel_size ; vec4 aQ ; vec4 gY ; vec4 gZ ; float fU ; float g_ = u_dof_bokeh_intensity ; aQ = GLSL_TEXTURE ( u_color , A ) ; gY = aQ ; gZ = aQ ; fU = aQ . a ; cH = fU * cH ; for ( int bZ = 0 ; bZ < 12 ; bZ += 2 ) { ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; gY += aQ ; gZ = max ( gZ , aQ ) ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; gY += aQ ; gZ = max ( gZ , aQ ) ; } gY /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( gY , gZ , g_ ) ;".split(" ")}]}},
{a:"elif",j:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 ff = vec2 ( 0.0 , 0.0 ) ; vec2 cH = u_texel_size ; vec4 aQ ; vec4 gY ; vec4 gZ ; aQ = GLSL_TEXTURE ( u_color , A ) ; gZ = max ( gZ , aQ ) ; gY = aQ ; gY . a = aQ . a * 0.2270270270 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.1945945946 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.1945945946 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.1216216216 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.1216216216 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.0540540541 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.0540540541 ; ff += cH ; aQ = GLSL_TEXTURE ( u_color , A + ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.0162162162 ; aQ = GLSL_TEXTURE ( u_color , A - ff ) ; gZ . a = max ( gZ . a , aQ . a ) ; gY . a += aQ . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( gY , gZ , 0.5 ) ;".split(" ")}]}},
{a:"elif",j:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 cH = u_texel_size ; vec4 aQ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aQ ; if ( aQ . a == 0.0 ) { aQ = GLSL_TEXTURE ( u_color , A + cH ) ; if ( aQ . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aQ . a ) ; else { aQ = GLSL_TEXTURE ( u_color , A - cH ) ; if ( aQ . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aQ . a ) ; } }".split(" ")}]}},{a:"elif",j:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float ha = u_delta [ 0 ] ; float hb = u_delta [ 1 ] ; float hc = 1.0 / 3.0 ; float hd = 0.5 ; vec2 he = vec2 ( hc , hd ) ; if ( u_tex_number == 0 ) { vec2 bN = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * he + vec2 ( 2.0 * hc , hd ) ; bN [ 0 ] = max ( bN [ 0 ] , 2.0 * hc + ha ) ; bN [ 1 ] = max ( bN [ 1 ] , hb ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bN [ 0 ] , hd - bN [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bN = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * he + vec2 ( 0.0 , hd ) ; bN [ 0 ] = max ( bN [ 0 ] , ha ) ; bN [ 1 ] = min ( bN [ 1 ] , hd - hb ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hc - bN [ 0 ] , bN [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bN = A * he + vec2 ( 2.0 * hc , hd ) ; bN [ 0 ] = max ( bN [ 0 ] , 2.0 * hc + ha ) ; bN [ 1 ] = min ( bN [ 1 ] , 1.0 - hb ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bN [ 0 ] , 1.5 - bN [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bN = A * he + vec2 ( hc , 0.0 ) ; bN [ 0 ] = max ( bN [ 0 ] , hc + ha ) ; bN [ 0 ] = min ( bN [ 0 ] , 2.0 * hc - ha ) ; bN [ 1 ] = min ( bN [ 1 ] , hd - hb ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bN [ 0 ] , bN [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bN = A * he + vec2 ( hc , hd ) ; bN [ 0 ] = max ( bN [ 0 ] , hc + ha ) ; bN [ 0 ] = min ( bN [ 0 ] , 2.0 * hc - ha ) ; bN [ 1 ] = min ( bN [ 1 ] , 1.0 - hb ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bN [ 0 ] , 3.0 * hd - bN [ 1 ] ) ) ; } else { vec2 bN = A * he + vec2 ( 0.0 , hd ) ; bN [ 0 ] = max ( bN [ 0 ] , ha ) ; bN [ 1 ] = min ( bN [ 1 ] , 1.0 - hb ) ; bN [ 1 ] = max ( bN [ 1 ] , hd + hb ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hc - bN [ 0 ] , bN [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"SMAA_DISABLE_CORNER_DETECTION",b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_ULTRA"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",
f:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2},"SMAA_PREDICATION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","hf",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 hg ; GLSL_IN vec4 hh ; GLSL_IN vec4 hi ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","hj",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",j:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_THRESHOLD",l:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",l:{a:"grp",f:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",l:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",l:{a:"grp",
f:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",l:{a:"grp",f:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION",l:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",l:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",l:{a:"grp",
f:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",l:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION",l:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",l:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",l:{a:"grp",f:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 hn ( vec2 bN , sampler2D hk ) { float p = GLSL_TEXTURE ( hk , bN ) . r ; float hl = GLSL_TEXTURE ( hk , hg . xy ) . r ; float hm = GLSL_TEXTURE ( hk , hg . zw ) . r ; return vec3 ( p , hl , hm ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 hr ( vec2 bN , sampler2D ho ) { vec3 hp = hn ( bN , ho ) ; vec2 cH = abs ( hp . xx - hp . yz ) ; vec2 hq = step ( SMAA_PREDICATION_THRESHOLD , cH ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hq ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hv ( bvec2 hs , inout vec2 ht , vec2 hu ) { if ( hs . x ) ht . x = hu . x ; if ( hs . y ) ht . y = hu . y ; } void hv ( bvec4 hs , inout vec4 ht , vec4 hu ) { hv ( hs . xy , ht . xy , hu . xy ) ; hv ( hs . zw , ht . zw , hu . zw ) ; } vec2 hw ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hw ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",
b:"vec2 hJ ( vec2 bN , sampler2D hx".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PREDICATION"],l:{a:"grp",f:[{a:"txt",b:[",","sampler2D","ho"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",j:["SMAA_PREDICATION"],l:{a:"grp",f:[{a:"txt",b:"vec2 hy = hr ( bN , ho ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec2 hy = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hz = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hA = dot ( GLSL_TEXTURE ( hx , bN ) . rgb , hz ) ; float hB = dot ( GLSL_TEXTURE ( hx , hg . xy ) . rgb , hz ) ; float hC = dot ( GLSL_TEXTURE ( hx , hg . zw ) . rgb , hz ) ; vec4 cH ; cH . xy = abs ( hA - vec2 ( hB , hC ) ) ; vec2 hq = step ( hy , cH . xy ) ; if ( dot ( hq , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hD = dot ( GLSL_TEXTURE ( hx , hh . xy ) . rgb , hz ) ; float hE = dot ( GLSL_TEXTURE ( hx , hh . zw ) . rgb , hz ) ; cH . zw = abs ( hA - vec2 ( hD , hE ) ) ; vec2 hF = max ( cH . xy , cH . zw ) ; float hG = dot ( GLSL_TEXTURE ( hx , hi . xy ) . rgb , hz ) ; float hH = dot ( GLSL_TEXTURE ( hx , hi . zw ) . rgb , hz ) ; cH . zw = abs ( vec2 ( hB , hC ) - vec2 ( hG , hH ) ) ; hF = max ( hF . xy , cH . zw ) ; float hI = max ( hF . x , hF . y ) ; hq . xy *= step ( hI , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cH . xy ) ; return hq ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"vec2 hL ( vec2 hK ) { hK . r = hK . r * abs ( 5.0 * hK . r - 5.0 * 0.75 ) ; return hw ( hK ) ; } vec4 hL ( vec4 hK ) { hK . rb = hK . rb * abs ( 5.0 * hK . rb - 5.0 * 0.75 ) ; return hw ( hK ) ; } vec2 hN ( sampler2D hM , vec2 bN , vec2 bp , out vec2 hK ) { vec4 fu = vec4 ( bN , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bZ = 0 ; bZ < SMAA_MAX_SEARCH_STEPS_DIAG ; bZ ++ ) { if ( fu . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fu . w > 0.9 ) { fu . xyz += t * vec3 ( bp , 1.0 ) ; hK = GLSL_TEXTURE ( hM , fu . xy , 0.0 ) . rg ; fu . w = dot ( hK , vec2 ( 0.5 , 0.5 ) ) ; } } return fu . zw ; } vec2 hO ( sampler2D hM , vec2 bN , vec2 bp , out vec2 hK ) { vec4 fu = vec4 ( bN , - 1.0 , 1.0 ) ; fu . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bZ = 0 ; bZ < SMAA_MAX_SEARCH_STEPS_DIAG ; bZ ++ ) { if ( fu . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fu . w > 0.9 ) { fu . xyz = t * vec3 ( bp , 1.0 ) + fu . xyz ; hK = GLSL_TEXTURE ( hM , fu . xy , 0.0 ) . rg ; hK = hL ( hK ) ; fu . w = dot ( hK , vec2 ( 0.5 , 0.5 ) ) ; } } return fu . zw ; } vec2 hQ ( sampler2D hP , vec2 aM , vec2 hK , float ff ) { vec2 bN = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hK + aM ; bN = SMAA_AREATEX_PIXEL_SIZE * bN + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bN . x += 0.5 ; bN . y += SMAA_AREATEX_SUBTEX_SIZE * ff ; return GLSL_TEXTURE ( hP , bN , 0.0 ) . rg ; } vec2 hV ( sampler2D hM , sampler2D hP , vec2 bN , vec2 hK , vec4 hR ) { vec2 hz = vec2 ( 0.0 , 0.0 ) ; vec4 dn ; vec2 hS ; if ( hK . r > 0.0 ) { dn . xz = hN ( hM , bN , vec2 ( - 1.0 , 1.0 ) , hS ) ; dn . x += float ( hS . y > 0.9 ) ; } else dn . xz = vec2 ( 0.0 , 0.0 ) ; dn . yw = hN ( hM , bN , vec2 ( 1.0 , - 1.0 ) , hS ) ; if ( dn . x + dn . y > 2.0 ) { vec4 hT = vec4 ( - dn . x + 0.25 , dn . x , dn . y , - dn . y - 0.25 ) * u_texel_size . xyxy + bN . xyxy ; vec4 di ; di . xy = GLSL_TEXTURE ( hM , hT . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; di . zw = GLSL_TEXTURE ( hM , hT . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; di . yxwz = hL ( di . xyzw ) ; vec2 hU = vec2 ( 2.0 , 2.0 ) * di . xz + di . yw ; hv ( bvec2 ( step ( 0.9 , dn . zw ) ) , hU , vec2 ( 0.0 , 0.0 ) ) ; hz += hQ ( hP , dn . xy , hU , hR . z ) ; } dn . xz = hO ( hM , bN , vec2 ( - 1 , - 1 ) , hS ) ; if ( GLSL_TEXTURE ( hM , bN + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { dn . yw = hO ( hM , bN , vec2 ( 1 , 1 ) , hS ) ; dn . y += float ( hS . y > 0.9 ) ; } else dn . yw = vec2 ( 0.0 , 0.0 ) ; if ( dn . x + dn . y > 2.0 ) { vec4 hT = vec4 ( - dn . x , - dn . x , dn . y , dn . y ) * u_texel_size . xyxy + bN . xyxy ; vec4 di ; di . x = GLSL_TEXTURE ( hM , hT . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; di . y = GLSL_TEXTURE ( hM , hT . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; di . zw = GLSL_TEXTURE ( hM , hT . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 hU = vec2 ( 2.0 , 2.0 ) * di . xz + di . yw ; hv ( bvec2 ( step ( 0.9 , dn . zw ) ) , hU , vec2 ( 0 , 0 ) ) ; hz += hQ ( hP , dn . xy , hU , hR . w ) . gr ; } return hz ; }".split(" ")}]}}]},
{a:"txt",b:"float hY ( sampler2D hW , vec2 hK , float ff ) { vec2 he = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 hX = SMAA_SEARCHTEX_SIZE * vec2 ( ff , 1.0 ) ; he += vec2 ( - 1.0 , 1.0 ) ; hX += vec2 ( 0.5 , - 0.5 ) ; he *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; hX *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( hW , he * hK + hX , 0.0 ) . r ; } float hZ ( sampler2D hM , sampler2D hW , vec2 bN , float hS ) { vec2 hK = vec2 ( 0.0 , 1.0 ) ; for ( int bZ = 0 ; bZ < SMAA_MAX_SEARCH_STEPS ; bZ ++ ) { if ( bN . x > hS && hK . g > 0.8281 && hK . r == 0.0 ) { hK = GLSL_TEXTURE ( hM , bN , 0.0 ) . rg ; bN = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bN ; } } float ff = - ( 255.0 / 127.0 ) * hY ( hW , hK , 0.0 ) + 3.25 ; return u_texel_size . x * ff + bN . x ; } float h_ ( sampler2D hM , sampler2D hW , vec2 bN , float hS ) { vec2 hK = vec2 ( 0.0 , 1.0 ) ; for ( int bZ = 0 ; bZ < SMAA_MAX_SEARCH_STEPS ; bZ ++ ) { if ( bN . x < hS && hK . g > 0.8281 && hK . r == 0.0 ) { hK = GLSL_TEXTURE ( hM , bN , 0.0 ) . rg ; bN = vec2 ( 2.0 , 0.0 ) * u_texel_size + bN ; } } float ff = - ( 255.0 / 127.0 ) * hY ( hW , hK , 0.5 ) + 3.25 ; return - u_texel_size . x * ff + bN . x ; } float ia ( sampler2D hM , sampler2D hW , vec2 bN , float hS ) { vec2 hK = vec2 ( 1.0 , 0.0 ) ; for ( int bZ = 0 ; bZ < SMAA_MAX_SEARCH_STEPS ; bZ ++ ) { if ( bN . y > hS && hK . r > 0.8281 && hK . g == 0.0 ) { hK = GLSL_TEXTURE ( hM , bN , 0.0 ) . rg ; bN = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bN ; } } float ff = - ( 255.0 / 127.0 ) * hY ( hW , hK . gr , 0.0 ) + 3.25 ; return u_texel_size . y * ff + bN . y ; } float ib ( sampler2D hM , sampler2D hW , vec2 bN , float hS ) { vec2 hK = vec2 ( 1.0 , 0.0 ) ; for ( int bZ = 0 ; bZ < SMAA_MAX_SEARCH_STEPS ; bZ ++ ) { if ( bN . y < hS && hK . r > 0.8281 && hK . g == 0.0 ) { hK = GLSL_TEXTURE ( hM , bN , 0.0 ) . rg ; bN = vec2 ( 0.0 , 2.0 ) * u_texel_size + bN ; } } float ff = - ( 255.0 / 127.0 ) * hY ( hW , hK . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * ff + bN . y ; } vec2 ie ( sampler2D hP , vec2 aM , float ic , float id , float ff ) { vec2 bN = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hw ( 4.0 * vec2 ( ic , id ) ) + aM ; bN = SMAA_AREATEX_PIXEL_SIZE * bN + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bN . y = SMAA_AREATEX_SUBTEX_SIZE * ff + bN . y ; return GLSL_TEXTURE ( hP , bN , 0.0 ) . rg ; } void ii ( sampler2D hM , inout vec2 hz , vec4 bN , vec2 dn ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"vec2 ig = step ( dn . xy , dn . yx ) ; vec2 ih = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ig ; ih /= ig . x + ig . y ; vec2 aL = vec2 ( 1.0 , 1.0 ) ; aL . x -= ih . x * GLSL_TEXTURE ( hM , bN . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aL . x -= ih . y * GLSL_TEXTURE ( hM , bN . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aL . y -= ih . x * GLSL_TEXTURE ( hM , bN . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aL . y -= ih . y * GLSL_TEXTURE ( hM , bN . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hz *= clamp ( aL , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void ij ( sampler2D hM , inout vec2 hz , vec4 bN , vec2 dn ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"vec2 ig = step ( dn . xy , dn . yx ) ; vec2 ih = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ig ; ih /= ig . x + ig . y ; vec2 aL = vec2 ( 1.0 , 1.0 ) ; aL . x -= ih . x * GLSL_TEXTURE ( hM , bN . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aL . x -= ih . y * GLSL_TEXTURE ( hM , bN . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aL . y -= ih . x * GLSL_TEXTURE ( hM , bN . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aL . y -= ih . y * GLSL_TEXTURE ( hM , bN . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hz *= clamp ( aL , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 im ( vec2 bN , vec2 ik , sampler2D hM , sampler2D hP , sampler2D hW , vec4 hR ) { vec4 hz = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hK = GLSL_TEXTURE ( hM , bN ) . rg ; if ( hK . g > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"hz . rg = hV ( hM , hP , bN , hK , hR ) ; if ( hz . r == - hz . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 dn ; vec3 hT ; hT . x = hZ ( hM , hW , hg . xy , hi . x ) ; hT . y = hh . y ; dn . x = hT . x ; float ic = GLSL_TEXTURE ( hM , hT . xy , 0.0 ) . r ; hT . z = h_ ( hM , hW , hg . zw , hi . y ) ; dn . y = hT . z ; dn = abs ( hw ( dn / u_texel_size . xx - ik . xx ) ) ; vec2 il = sqrt ( dn ) ; float id = GLSL_TEXTURE ( hM , hT . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hz . rg = ie ( hP , il , ic , id , hR . y ) ; hT . y = bN . y ; ii ( hM , hz . rg , hT . xyzy , dn ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"} else hK . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hK . r > 0.0 ) { vec2 dn ; vec3 hT ; hT . y = ia ( hM , hW , hh . xy , hi . z ) ; hT . x = hg . x ; dn . x = hT . y ; float ic = GLSL_TEXTURE ( hM , hT . xy , 0.0 ) . g ; hT . z = ib ( hM , hW , hh . zw , hi . w ) ; dn . y = hT . z ; dn = abs ( hw ( dn / u_texel_size . yy - ik . yy ) ) ; vec2 il = sqrt ( dn ) ; float id = GLSL_TEXTURE ( hM , hT . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hz . ba = ie ( hP , il , ic , id , hR . x ) ; hT . x = bN . x ; ij ( hM , hz . ba , hT . xyxz , dn ) ; } return hz ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 iw ( vec2 bN , sampler2D hx , sampler2D io".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:[",","sampler2D","ip"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( io , hf . xy ) . a ; a . y = GLSL_TEXTURE ( io , hf . zw ) . g ; a . wz = GLSL_TEXTURE ( io , bN ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aQ = GLSL_TEXTURE ( hx , bN , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:"vec4 iq = GLSL_TEXTURE ( ip , A ) ; vec2 da = 2.0 * ir ( iq ) - 1.0 ; aQ . a = sqrt ( 2.0 * length ( da ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aQ ; } else { bool bX = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 is = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 it = a . yw ; hv ( bvec4 ( bX , bX , bX , bX ) , is , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hv ( bvec2 ( bX , bX ) , it , a . xz ) ; it /= dot ( it , vec2 ( 1.0 , 1.0 ) ) ; vec4 iu = is * vec4 ( u_texel_size , - u_texel_size ) + bN . xyxy ; vec4 aQ = it . x * GLSL_TEXTURE ( hx , iu . xy , 0.0 ) ; aQ += it . y * GLSL_TEXTURE ( hx , iu . zw , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:"vec4 iq = GLSL_TEXTURE ( ip , iu . xy ) ; vec2 iv = 2.0 * ir ( iq ) - 1.0 ; vec2 da = it . x * iv ; iq = GLSL_TEXTURE ( ip , iu . zw ) ; iv = 2.0 * ir ( iq ) - 1.0 ; da += it . y * iv ; aQ . a = sqrt ( 2.0 * length ( da ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aQ",";","}","}"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 iB ( vec2 bN , sampler2D ix , sampler2D iy".split(" ")},
{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:[",","sampler2D","ip"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:"vec4 iq = GLSL_TEXTURE ( ip , A ) ; vec2 da ; da = 2.0 * ir ( iq ) - 1.0 ; vec4 iz = GLSL_TEXTURE ( ix , bN ) ; vec4 iA = GLSL_TEXTURE ( iy , bN - da ) ; float cH = abs ( iz . a * iz . a - iA . a * iA . a ) / 2.0 ; float cc = 0.5 * clamp ( 1.0 - sqrt ( cH ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aQ = mix ( iz , iA , cc ) ; aQ . a = 1.0 ; return aQ ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 iz = GLSL_TEXTURE ( ix , bN ) ; vec4 iA = GLSL_TEXTURE ( iy , bN ) ; return mix ( iz , iA , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 aQ = vec4 ( hJ ( A , u_color".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PREDICATION"],l:{a:"grp",f:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 aQ = im ( A , hj , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",j:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 aQ = iw ( A , u_color , u_blend".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",j:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 aQ = vec4 ( iB ( A , u_color , u_color_prev".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_REPROJECTION"],l:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 aQ = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",
b:["highp"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",D:"std.glsl"},{a:"txt",b:"uniform PRECISION vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","hf",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec4 hg ; GLSL_OUT vec4 hh ; GLSL_OUT vec4 hi ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","hj",";"]}]}}]},{a:"cond",f:[{a:"if",j:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",o:2}],l:{a:"grp",
f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",j:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",l:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"void iC ( vec2 bN ) { hg = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bN . xyxy ; hh = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bN . xyxy ; hi = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bN . xyxy ; }".split(" ")}]}},
{a:"elif",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"void iD ( vec2 bN , out vec2 ik ) { ik = bN / u_texel_size ; hg = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bN . xyxy ; hh = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bN . xyxy ; hi = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hg . xz , hh . yw ) ; }".split(" ")}]}},{a:"elif",j:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"void iE ( vec2 bN ) { hf = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bN . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",f:[{a:"if",j:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["iC","(","A",")",";"]}]}},{a:"elif",j:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"iD ( A , hj ) ;".split(" ")}]}},
{a:"elif",j:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["iE","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iF ( in vec2 fu ) { return fT ( u_depth , fu , u_camera_range ) ; } void main ( ) { vec3 fX = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SSAO_WHITE"],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fX , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iG = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float dM = iF ( A ) ; float iH = dM * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"const float iI = 8.0 ; const int iJ = 1 ;".split(" ")}]}},
{a:"elif",j:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"const float iI = 16.0 ; const int iJ = 2 ;".split(" ")}]}},{a:"elif",j:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"const float iI = 24.0 ; const int iJ = 3 ;".split(" ")}]}},{a:"elif",j:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"const float iI = 32.0 ; const int iJ = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iK = u_ssao_radius_increase * 0.001 ; const float iL = 1.0 + 2.4 / iI ; float iM = 0.0 ; for ( int bZ = 0 ; bZ < iJ ; bZ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iN = reflect ( normalize ( vec3 ( x , y , z ) ) , iG ) * ( iK *= iL ) ; vec3 iO = vec3 ( A , iH ) ; iO += vec3 ( iN . xy , iN . z * iH * 2.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SSAO_HEMISPHERE"],l:{a:"grp",f:[{a:"txt",b:"iO . z -= 1.4 * ( iO . z - iH ) * step ( iH , iO . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iP = iF ( iO . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iQ = clamp ( ( iH - iP ) / iP , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SSAO_HEMISPHERE"],l:{a:"grp",f:[{a:"txt",b:"iM += mix ( 1.0 , iQ , step ( iP , iO . z ) ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"iM += mix ( step ( iO . z , iP ) , 0.5 , iQ ) ;".split(" ")}]}}]},
{a:"txt",b:"} iM = iM / iI ;".split(" ")},{a:"cond",f:[{a:"if",j:["SSAO_HEMISPHERE"],l:{a:"grp",f:[{a:"txt",b:"iM = clamp ( iM * iM + 0.6 * iM , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"iM = clamp ( iM * iM + iM , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iR = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * dM ) ; iM = mix ( 1.0 , iM , iR ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fX , iM ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["SSAO_BLUR_DEPTH"],l:{a:"grp",f:[{a:"include",D:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",j:["SSAO_BLUR_DEPTH"],l:{a:"grp",f:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iF ( in vec2 fu ) { return fT ( u_depth , fu , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iS = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["SSAO_BLUR_DEPTH"],l:{a:"grp",f:[{a:"txt",b:"float iT = iF ( A ) ; float cc = 0.0 ; float iU = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 iV = vec2 ( - 2.0 ) ; for ( int bZ = 0 ; bZ < 4 ; ++ bZ ) { for ( int iW = 0 ; iW < 4 ; ++ iW ) { vec2 ff = ( iV + vec2 ( float ( bZ ) , float ( iW ) ) ) * u_texel_size ; float iX = GLSL_TEXTURE ( u_ssao_mask , A + ff ) . a ;".split(" ")},
{a:"cond",f:[{a:"if",j:["SSAO_BLUR_DEPTH"],l:{a:"grp",f:[{a:"txt",b:"float iY = iF ( A + ff ) ; float iZ = 1.0 - clamp ( abs ( iY - iT ) * iU , 0.0 , 1.0 ) ; iS += iX * iZ ; cc += iZ ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["iS","+=","iX",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",f:[{a:"if",j:["SSAO_BLUR_DEPTH"],l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iS / cc ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iS / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"DISTOR_SCALE",b:["0.8"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",
j:["ANAGLYPH",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void ji ( vec2 bN , vec2 ao , float cV , sampler2D i_ ) { vec2 ja = ( bN - ao ) * 4.0 * u_texel_size [ 0 ] / u_texel_size [ 1 ] / cV ; float jb = ja . x * ja . x + ja . y * ja . y ; vec2 jc = ja * ( 1.0 + u_distortion_params [ 0 ] * jb + u_distortion_params [ 1 ] * jb * jb ) ; vec2 jd = jc * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 je = jd * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jb * u_chromatic_aberration_coefs [ 1 ] ) + 0.5 ; vec2 jf = jd + 0.5 ; vec2 jg = jd * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jb * u_chromatic_aberration_coefs [ 3 ] ) + 0.5 ; if ( clamp ( jg , 0.0 , 1.0 ) != jg ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jh = GLSL_TEXTURE ( i_ , jf ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( i_ , je ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jh . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( i_ , jg ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jh . w ; } } else { jd += 0.5 ; if ( clamp ( jd , 0.0 , 1.0 ) != jd ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( i_ , jd ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",j:["ANAGLYPH"],l:{a:"grp",f:[{a:"txt",b:"vec4 jj = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jk = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jl = vec3 ( jj [ 0 ] , jj [ 1 ] , jj [ 2 ] ) ; cg ( jl ) ; vec3 jm = vec3 ( jk [ 0 ] , jk [ 1 ] , jk [ 2 ] ) ; cg ( jm ) ; mat3 jn = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jo = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aQ = clamp ( jn * jl , 0.0 , 1.0 ) + clamp ( jo * jm , 0.0 , 1.0 ) ; aW ( aQ ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aQ , jj [ 3 ] + jk [ 3 ] ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( abs ( u_distortion_params [ 0 ] ) > EPSILON || abs ( u_distortion_params [ 1 ] ) > EPSILON ) if ( A [ 0 ] < 0.5 ) { vec2 bN = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ao = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cV = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; ji ( bN , ao , cV , u_sampler_left ) ; } else { vec2 bN = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ao = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cV = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; ji ( bN , ao , cV , u_sampler_right ) ; } else if ( A [ 0 ] < 0.5 ) { vec2 bN = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , bN ) ; } else { vec2 bN = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_right , bN ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",D:"precision_statement.glslf"},{a:"include",D:"std.glsl"},{a:"include",D:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float dM = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 jp = vec4 ( A * 2.0 - 1.0 , 2.0 * dM - 1.0 , 1.0 ) ; vec4 cm = u_view_proj_inverse * jp ; vec4 jq = cm / cm . w ; vec4 jr = u_view_proj_prev * jq ; jr /= jr . w ; vec2 da = ( jp . xy - jr . xy ) / 4.0 + 0.5 ; da = clamp ( da , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = dN ( da ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"BLENDING_GLSLF",l:{a:"grp",f:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jt ( vec3 rgb ) { vec4 js = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , js . wz ) , vec4 ( rgb . gb , js . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dn = q . x - min ( q . w , q . y ) ; float hK = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dn + hK ) ) , dn / ( q . x + hK ) , q . x ) ; } vec3 jv ( vec3 ju ) { vec4 js = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( ju . r , ju . r , ju . r ) + js . xyz ) * 6.0 - js . www ) ; return ju . b * mix ( js . xxx , clamp ( p - js . xxx , _0_0 , _1_0 ) , ju . g ) ; } vec3 jz ( vec3 jw , vec3 jx , float jy ) { return mix ( jw , jx , jy ) ; } vec3 jA ( vec3 jw , vec3 jx , float jy ) { return jy * jw + jx ; } vec3 jB ( vec3 jw , vec3 jx , float jy ) { return jx - jy * jw ; } vec3 jD ( vec3 jw , vec3 jx , float jy ) { float jC = _1_0 - jy ; return ( vec3 ( jC ) + jy * jw ) * jx ; } vec3 jE ( vec3 jw , vec3 jx , float jy ) { vec3 jC = vec3 ( _1_0 - jy ) ; return vec3 ( _1_0 ) - ( jC + jy * ( vec3 ( _1_0 ) - jw ) ) * ( vec3 ( _1_0 ) - jx ) ; } vec3 jF ( vec3 jw , vec3 jx , float jy ) { vec3 jC = vec3 ( _1_0 - jy ) ; return mix ( jx * ( jC + 2.0 * jy * jw ) , vec3 ( _1_0 ) - ( jC + 2.0 * jy * ( vec3 ( _1_0 ) - jw ) ) * ( vec3 ( _1_0 ) - jx ) , step ( 0.5 , jx ) ) ; } vec3 jG ( vec3 jw , vec3 jx , float jy ) { return mix ( jx , abs ( jw - jx ) , jy ) ; } vec3 jH ( vec3 jw , vec3 jx , float jy ) { return mix ( jx , jx / ( jw + step ( jw , vec3 ( _0_0 ) ) ) , jy ) ; } vec3 jI ( vec3 jw , vec3 jx , float jy ) { return mix ( jx , min ( jw , jx ) , jy ) ; } vec3 jJ ( vec3 jw , vec3 jx , float jy ) { return max ( jy * jw , jx ) ; } vec3 jN ( vec3 jw , vec3 jx , float jy ) { vec3 jK = jt ( jx ) ; if ( jK . y != _0_0 ) { vec3 jL = jt ( jw ) ; vec3 jM = jv ( vec3 ( jK . x , jL . yz ) ) ; return mix ( jw , jM , jy ) ; } return jw ; } vec3 jO ( vec3 jw , vec3 jx , float jy ) { vec3 jK = jt ( jw ) ; if ( jK . y != _0_0 ) { vec3 jL = jt ( jx ) ; return jv ( vec3 ( jK . x , mix ( jK . y , jL . y , jy ) , jK . z ) ) ; } return jw ; } vec3 jP ( vec3 jw , vec3 jx , float jy ) { vec3 jK = jt ( jw ) ; vec3 jL = jt ( jx ) ; return jv ( vec3 ( jK . xy , mix ( jK . z , jL . z , jy ) ) ) ; } vec3 jQ ( vec3 jw , vec3 jx , float jy ) { vec3 jK = jt ( jx ) ; if ( jK . y != _0_0 ) { vec3 jL = jt ( jw ) ; vec3 jM = jv ( vec3 ( jK . xy , jL . z ) ) ; return mix ( jw , jM , jy ) ; } return jw ; } vec3 jS ( vec3 jw , vec3 jx , float jy ) { vec3 jR = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jx ) * ( vec3 ( _1_0 ) - jw ) ; return mix ( jw , ( ( vec3 ( _1_0 ) - jw ) * jx * jw ) + jw * jR , jy ) ; } vec3 jT ( vec3 jw , vec3 jx , float jy ) { return jw + jy * ( 2.0 * jx - _1_0 ) ; } float jX ( float jU , float jV , float jy , float jW ) { float jC = _1_0 - jW ; return ( jC + jy * jU ) * jV ; } float jY ( float jU , float jV , float jy , float jW ) { float jC = _1_0 - jW ; return _1_0 - ( jC + jy * ( _1_0 - jU ) ) * ( _1_0 - jV ) ; } float jZ ( float jU , float jV , float jy , float jW ) { float jC = _1_0 - jW ; return mix ( jV * ( jC + 2.0 * jy * jU ) , _1_0 - ( jC + 2.0 * jy * ( _1_0 - jU ) ) * ( _1_0 - jV ) , step ( 0.5 , jV ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"CAUSTICS_GLSLF",l:{a:"grp",f:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",D:"procedural.glslf"},{a:"include",D:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bD ( inout vec3 aQ , float j_ , float eS , vec4 bC , vec3 U , vec3 ka , vec3 kb , vec4 kc , vec3 bo , float bA ) { if ( bA > CAUSTICS_VIEW_DISTANCE ) return ; vec3 kd = bo + U ; kd . xz = 10.0 * sin ( 0.1 * kd . xz ) ; vec3 kf = T ( ke ( kc ) , kd ) ; vec2 bN = kf . xz ; vec3 kg = ka ; float kh = max ( dot ( U , kg ) , 0.0 ) ; float ki = 0.025 ; vec2 kj = CAUST_SPEED * eS ; bN . s += 0.25 * sin ( dot ( bo + eS , vec3 ( 1.0 ) ) ) ; bN . t += 0.35 * ( - sin ( dot ( bo - eS , vec3 ( - 0.7 ) ) ) ) ; bN . st += 0.15 * cos ( 4.0 * j_ - kj . x ) + 1.5 * sin ( j_ - 0.3 * kj . y ) ; float he = CAUST_SCALE * ( 1.0 + max ( 0.1 * j_ , 0.0 ) ) ; vec3 kl = kk ( ( bN / he ) , ki ) ; kl *= CAUST_BRIGHT ; kl *= kl ; float km = min ( 0.25 * j_ , - j_ ) + 1.0 ; km = max ( km , 0.0 ) ; float kn = bC [ SUN_NUM ] * kh ; float ko = max ( sign ( j_ ) , 0.0 ) ; kn = kn + max ( 0.5 * sign ( - U . y ) * ko , 0.0 ) ; kn = min ( kn , 1.0 ) ; aQ += kb * kl * km * kn ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",l:{a:"grp",f:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",D:"std.glsl"},{a:"txt",b:"void cg ( inout float aQ ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SRGB","SRGB_SIMPLE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aQ = pow ( aQ , 2.2 ) ;".split(" ")}]}},{a:"elif",j:["SRGB","SRGB_PROPER",{a:"equal_expr",o:2}],l:{a:"grp",
f:[{a:"txt",b:"if ( aQ < 0.04045 ) aQ = aQ / 12.92 ; else aQ = pow ( aQ * ( 1.0 / 1.055 ) + 0.0521327 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aW ( inout float aQ ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SRGB","SRGB_SIMPLE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aQ = pow ( aQ , 1.0 / 2.2 ) ;".split(" ")}]}},{a:"elif",j:["SRGB","SRGB_PROPER",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( aQ < 0.0031308 ) aQ = aQ * 12.92 ; else aQ = 1.055 * pow ( aQ , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},
{a:"txt",b:"} void cg ( inout vec3 aQ ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SRGB","SRGB_SIMPLE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aQ = pow ( aQ , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",j:["SRGB","SRGB_PROPER",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cg ( aQ . r ) ; cg ( aQ . g ) ; cg ( aQ . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aW ( inout vec3 aQ ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SRGB","SRGB_SIMPLE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aQ = pow ( aQ , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",j:["SRGB","SRGB_PROPER",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"aW ( aQ . r ) ; aW ( aQ . g ) ; aW ( aQ . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aX ( inout vec3 aQ , in float J ) {".split(" ")},{a:"cond",f:[{a:"if",j:["PREMULTIPLY_ALPHA"],l:{a:"grp",f:[{a:"txt",b:"aQ = aQ * J ;".split(" ")}]}}]},{a:"txt",b:"} float fB ( vec4 aQ ) { vec3 kp = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kq = dot ( aQ . rgb , kp ) ; return kq ; }".split(" ")}]}}]}]};a["include/coverage.glslf"]={a:"grp",
f:[{a:"cond",f:[{a:"ifndef",c:"COVERAGE_GLSLF",l:{a:"grp",f:[{a:"define",c:"COVERAGE_GLSLF",b:[""]},{a:"include",D:"procedural.glslf"},{a:"txt",b:"const float kr = 1000.0 ; bool M ( float J , float ks ) { if ( ks < 0.0 ) J = 1.0 - J ; float kt = floor ( J * kr ) ; float kv = floor ( ku ( gl_FragCoord . xy ) * kr ) ; if ( ks > 0.0 ) return kv < kt ; else return kv >= kt ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",l:{a:"grp",f:[{a:"define",
c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"include",D:"std.glsl"},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float dL ( in float kw , in vec2 kx ) { float ds = kx . x ; float ky = kx . y ;".split(" ")},{a:"cond",f:[{a:"if",j:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return ky * ( 1.0 - ds / kw ) / ( ky - ds ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"return ( kw - ds ) / ( ky - ds ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float fT ( in sampler2D kz , in vec2 fu , in vec2 kx ) { float dM = GLSL_TEXTURE ( kz , fu ) . r ; float ds = kx . x ; float ky = kx . y ; float kw = 2.0 * ds / ( ds + ky - ( 2.0 * dM - 1.0 ) * ( ky - ds ) ) ; return kw ; }".split(" ")}]}}]}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",l:{a:"grp",f:[{a:"define",
c:"DYNAMIC_GRASS_GLSLV",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",f:[{a:"if",j:["DYNAMIC_GRASS"],l:{a:"grp",f:[{a:"include",D:"math.glslv"},{a:"include",D:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 O , float kA , vec2 kB ) { vec2 kC = vec2 ( ( O . x - kB . x ) / kA , ( O . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gq , float kA , vec2 kB ) { return vec2 ( gq . x * kA , gq . y * kA ) + kB ; } au kF ( ) { return au ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",f:[{a:"if",j:["GLSL3"],l:{a:"grp",f:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"au aZ ( vec3 O , vec3 V , vec3 kQ , vec3 W , vec3 U , vec3 ao , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 N , mat3 Z ) { vec3 kX = T ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ao , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float he = lg . r ; if ( he < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",f:[{a:"if",j:["GLSL3"],l:{a:"grp",f:[{a:"txt",b:"float bW = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float bW = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = O . xy - ao . xy ; ao . xy = kE ( k_ , kU , kB ) ; ao . z = bW ; O . xy = ao . xy + li ; O . z *= he ; O . z += bW ; vec3 aQ = lg . gba ;".split(" ")},{a:"cond",f:[{a:"if",j:["BILLBOARD"],l:{a:"grp",f:[{a:"txt",b:"O -= ao ; mat3 lj = as ( kV , ao , N , Z ) ; au aw = av ( O , ao , V , kQ , W , U , lj ) ; aw . ao = ao ; aw . aQ = aQ ; return lk ( aw ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"return lk ( au ( O , ao , V , kQ , W , U , aQ ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",l:{a:"grp",f:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 cn ( vec3 U ) {".split(" ")},{a:"cond",f:[{a:"if",j:["USE_ENVIRONMENT_LIGHT"],l:{a:"grp",f:[{a:"cond",
f:[{a:"if",j:["SKY_TEXTURE"],l:{a:"grp",f:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , U ) . rgb ;".split(" ")}]}},{a:"elif",j:["SKY_COLOR"],l:{a:"grp",f:[{a:"txt",b:"float ll = 0.5 * U . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",f:[{a:"cond",
f:[{a:"ifndef",c:"FOG_GLSLF",l:{a:"grp",f:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",D:"std.glsl"},{a:"include",D:"color_util.glslf"},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"txt",b:"void lq ( inout vec3 aQ , in float lm , in float bW , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FOG_TYPE","QUADRATIC",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",j:["FOG_TYPE","LINEAR",{a:"equal_expr",o:2}],l:{a:"grp",f:[]}},{a:"elif",j:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bW > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bW , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aQ = mix ( aQ , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , ( C . x + 1.0 ) / 2.0 ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , ( C . y + 1.0 ) / 2.0 ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aQ = mix ( ls , lt , abs ( C . y ) ) ; aQ = mix ( aQ , lu , abs ( C . z ) ) ; cg ( aQ ) ; return aQ ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",
b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aQ , in float lm , in vec3 C , in float dZ , in vec4 ly , in float eJ ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dZ / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 d_ = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eJ , 0.0 , 1.0 ) ; vec3 ea = mix ( lC , d_ , min ( lz , 1.0 ) ) ; dZ = clamp ( - dZ * 0.03 , 0.0 , 0.8 ) ; ea *= 1.0 - dZ ; aQ = mix ( aQ , ea , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bE ( inout vec3 aQ , float lm , vec3 C , float bB ) {".split(" ")},{a:"cond",f:[{a:"if",j:["USE_FOG"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["PROCEDURAL_FOG"],l:{a:"grp",f:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 ea = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec4","ea","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aQ , lm , h . z , ea ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WATER_EFFECTS"],l:{a:"grp",f:[{a:"txt",
b:"lD ( aQ , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bB ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSLF",l:{a:"grp",f:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PS3",l:{a:"grp",f:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_360",l:{a:"grp",f:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",f:[{a:"ifndef",c:"FXAA_360_OPT",l:{a:"grp",f:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC",l:{a:"grp",f:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC_CONSOLE",l:{a:"grp",f:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_120",l:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_130",l:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_HLSL_3",l:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_4",l:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_5",l:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",l:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_EARLY_EXIT",l:{a:"grp",f:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_DISCARD",l:{a:"grp",f:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",l:{a:"grp",f:[{a:"cond",f:[{a:"ifdef",c:"GL_EXT_gpu_shader4",l:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",l:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",l:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",l:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["FXAA_HLSL_5",1,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",l:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",l:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",l:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:[1],l:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:[0],l:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",f:[{a:"if",j:[0],l:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:[1],l:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",l:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
f:[{a:"if",j:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",D:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",f:[{a:"if",j:["FXAA_BLEND4WEB",1,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fQ ( vec2 eL , sampler2D hk , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eL . x ; lM . y = eL . y ;".split(" ")},{a:"cond",f:[{a:"if",j:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",o:2}],l:{a:"grp",f:[]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 lN = lF ( hk , lM ) ; float fC = fB ( lN ) ; float lO = fB ( lH ( hk , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = fB ( lH ( hk , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = fB ( lH ( hk , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = fB ( lH ( hk , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fC ) ; float lT = min ( lO , fC ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",f:[{a:"if",j:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float fD = fB ( lH ( hk , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fG = fB ( lH ( hk , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fE = fB ( lH ( hk , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fF = fB ( lH ( hk , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fC ) + md ; float mi = ( - 2.0 * fC ) + me ; float mj = fE + fG ; float mk = fD + fE ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fD + fF ; float mo = fF + fG ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fC ; float mA = lQ - fC ; float mB = lO - fC ; float mC = lQ + fC ; float mD = lO + fC ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = fB ( lF ( hk , mJ ) ) ; float mN = mG * mG ; float mO = fB ( lF ( hk , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fC - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",3,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",4,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",5,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",6,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",7,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",8,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",9,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",10,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",11,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_QUALITY_PS",12,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = fB ( lF ( hk , mJ . xy ) ) ; if ( ! mU ) mO = fB ( lF ( hk , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",f:[{a:"if",j:["FXAA_DISCARD",1,{a:"equal_expr",o:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return lF ( hk , lM ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"return vec4 ( lF ( hk , lM ) . xyz , fC ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"HALO_COLOR_GLSLF",l:{a:"grp",f:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",f:[{a:"if",j:["NUM_RINGS","NUM_LINES",{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",f:[{a:"if",j:["NUM_RINGS"],l:{a:"grp",f:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_LINES"],l:{a:"grp",f:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aM ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aM ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aM , in vec2 bN ) { float nx , bx ; bx = atan ( bN . y , bN . x ) ; bx *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bx ) ; float nz = sin ( bx ) ; bx = ( ny * bN . x + nz * bN . y ) * ( ny * bN . y - nz * bN . x ) ; nx = abs ( bx ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aM *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 bh ( ) { float aM = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aM ) ; aM = max ( 1.0 - aM , 0.0 ) ; aM = pow ( aM , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",f:[{a:"if",j:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float nm [ nj ] ; for ( int bZ = 0 ; bZ < nj ; bZ ++ ) { nm [ bZ ] = fract ( bf / float ( bZ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_RINGS"],l:{a:"grp",f:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_LINES"],l:{a:"grp",f:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aM ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_STARS"],
l:{a:"grp",f:[{a:"txt",b:"nA ( aM , A ) ;".split(" ")}]}}]},{a:"txt",b:"aM *= J ; vec3 aQ = u_diffuse_color . rgb ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_RINGS"],l:{a:"grp",f:[{a:"txt",b:"nl *= aM ; aQ += u_halo_rings_color * nl ; aM += nl ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_LINES"],l:{a:"grp",f:[{a:"txt",b:"ns *= J ; aQ += u_halo_lines_color * ns ; aM += ns ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["SKY_STARS"],l:{a:"grp",f:[{a:"txt",b:"aM *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float km = u_halo_stars_blend * ( be . y - u_halo_stars_height ) ; aM *= clamp ( km , 0.0 , 1.0 ) ; aM *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aQ , aM ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",l:{a:"grp",
f:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",D:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",B:[],A:[{a:"node_out",c:"nP",i:["vec3"],g:!1},{a:"node_out",c:"nQ",i:["vec3"],g:!1},{a:"node_out",c:"nR",i:["vec3"],g:!1},{a:"node_out",c:"nS",i:["vec3"],g:!0},{a:"node_out",c:"nT",i:["vec3"],g:!0},{a:"node_out",c:"nU",i:["vec2"],g:!0},{a:"node_out",c:"nV",i:["vec2"],g:!0},{a:"node_out",c:"nW",i:["vec4"],g:!0},{a:"node_out",c:"nX",i:["float"],g:!0},{a:"node_out",c:"nY",i:["vec4"],g:!0}],u:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_nS"],u:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_nT"],u:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_nV"],u:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_nU"],u:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_nW"],u:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",f:[{a:"node_if",
j:["USE_OUT_nX"],u:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_nY"],u:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",B:[],A:[{a:"node_in",c:"nZ",i:["vec3"],g:!1},{a:"node_in",c:"n_",i:["vec3"],g:!1},{a:"node_in",c:"oa",i:["vec3"],g:!1},{a:"node_out",c:"ob",i:["vec4"],g:!1},{a:"node_out",c:"oc",i:["vec3"],g:!1}],u:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",B:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],A:[{a:"node_in",c:"od",i:["vec4"],g:!1},{a:"node_out",c:"oe",i:["vec3"],g:!1},{a:"node_out",c:"of",i:["vec2"],g:!1},{a:"node_out",c:"og",i:["vec3"],g:!1},{a:"node_out",c:"oh",i:["float"],g:!1}],u:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","HEMI",{a:"equal_expr",o:2}],u:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",u:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",o:1},{a:"non_equal_expr",o:2}],u:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aM = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aM * aM ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["LAMP_USE_SPHERE"],u:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aM , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",u:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"om",i:["vec3"],g:!1},{a:"node_in",c:"on",i:["vec2"],g:!1},{a:"node_in",c:"oo",i:["vec3"],g:!1},{a:"node_in",c:"op",i:["float"],g:!1},
{a:"node_in",c:"oq",i:["vec2"],g:!1},{a:"node_out",c:"or",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"ou",i:["vec3"],g:!1},{a:"node_in",c:"ov",i:["vec2"],g:!1},{a:"node_in",c:"ow",i:["vec3"],g:!1},{a:"node_in",c:"ox",i:["float"],g:!1},{a:"node_out",c:"oy",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oz",i:["vec3"],g:!1},{a:"node_in",c:"oA",i:["vec2"],g:!1},{a:"node_in",c:"oB",i:["vec3"],g:!1},{a:"node_in",c:"oC",i:["float"],g:!1},{a:"node_in",c:"oD",i:["vec2"],g:!1},{a:"node_out",c:"oE",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cp = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cp ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cp + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oO",i:["vec3"],g:!1},{a:"node_in",c:"oP",i:["vec2"],g:!1},{a:"node_in",c:"oQ",i:["vec3"],g:!1},{a:"node_in",c:"oR",i:["float"],g:!1},{a:"node_in",c:"oS",i:["vec2"],g:!1},{a:"node_out",c:"oT",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oU",i:["vec3"],g:!1},{a:"node_in",c:"oV",i:["vec2"],g:!1},{a:"node_in",c:"oW",i:["vec3"],g:!1},
{a:"node_in",c:"oX",i:["float"],g:!1},{a:"node_in",c:"oY",i:["vec2"],g:!1},{a:"node_out",c:"oZ",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pa",i:["vec3"],g:!1},{a:"node_in",c:"pb",i:["vec2"],g:!1},{a:"node_in",c:"pc",i:["vec3"],g:!1},{a:"node_in",c:"pd",i:["float"],g:!1},{a:"node_in",c:"pe",i:["vec2"],g:!1},{a:"node_out",c:"pf",i:["float"],g:!1}],u:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"ph",i:["vec3"],g:!1},{a:"node_in",c:"pi",i:["vec2"],g:!1},{a:"node_in",c:"pj",i:["vec3"],g:!1},{a:"node_in",c:"pk",i:["float"],g:!1},{a:"node_in",c:"pl",i:["vec2"],g:!1},{a:"node_out",c:"pm",i:["float"],g:!1}],u:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pn",i:["vec3"],g:!1},{a:"node_in",c:"po",i:["vec2"],g:!1},{a:"node_in",c:"pr",i:["vec3"],g:!1},{a:"node_in",c:"pu",i:["float"],g:!1},{a:"node_in",c:"pv",i:["vec2"],g:!1},{a:"node_out",c:"pw",i:["float"],g:!1}],u:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bx = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bx * bx ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pz",i:["vec3"],g:!1},{a:"node_in",c:"pA",i:["vec2"],g:!1},{a:"node_in",c:"pB",i:["vec3"],g:!1},{a:"node_in",c:"pC",i:["float"],g:!1},{a:"node_in",c:"pD",i:["vec2"],g:!1},{a:"node_out",c:"pE",i:["float"],
g:!1}],u:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bX = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float pF = dot ( bX , B . xyz ) ; float bx = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bx = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float bx = acos ( dot ( bX , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bx < pD [ 0 ] ) pE = _1_0 ; else if ( bx >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bx - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pG",i:["vec3"],g:!1},{a:"node_in",c:"pH",i:["vec2"],g:!1},{a:"node_in",c:"pI",i:["vec3"],g:!1},{a:"node_in",c:"pJ",i:["float"],g:!1},{a:"node_in",c:"pK",i:["vec2"],g:!1},{a:"node_out",c:"pL",i:["float"],g:!1}],u:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float di = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , di ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",B:[],A:[{a:"node_in",c:"pQ",i:["vec4"],g:!1},{a:"node_in",c:"pR",i:["vec3"],g:!1},{a:"node_in",c:"pS",i:["float"],g:!1},{a:"node_in",c:"pT",i:["float"],g:!1},{a:"node_in",c:"pU",i:["vec3"],g:!1},{a:"node_in",c:"pV",i:["vec3"],g:!1},{a:"node_in",c:"pW",i:["vec4"],g:!1},{a:"node_in",c:"pX",i:["vec3"],g:!1},{a:"node_in",c:"pY",i:["vec3"],g:!1},{a:"node_in",c:"pZ",i:["vec3"],g:!1},{a:"node_in",c:"p_",i:["float"],g:!1},{a:"node_out",c:"qa",i:["vec4"],g:!1},{a:"node_out",c:"qb",
i:["vec3"],g:!1}],u:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",B:[],A:[{a:"node_in",c:"qc",i:["vec4"],g:!1},{a:"node_in",c:"qd",i:["vec3"],g:!1}],u:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cy ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MATH_GLSLV",l:{a:"grp",f:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",D:"std.glsl"},{a:"txt",b:"struct au { vec3 O ; vec3 ao ; vec3 V ; vec3 aB ; vec3 W ; vec3 U ; vec3 aQ ; } ; bool qe ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 T ( in vec4 q , in vec3 kd ) { return kd + 2.0 * cross ( q . xyz , cross ( q . xyz , kd ) + q . w * kd ) ; } vec4 ke ( in vec4 qf ) { return vec4 ( - qf . xyz , qf . w ) ; } vec4 qh ( in vec4 a , in vec4 b ) { vec4 qg ; qg . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; qg . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; qg . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; qg . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return qg ; } vec4 X ( in vec3 qi , in float qj ) { vec4 qg ; qj = qj * 0.5 ; float s = sin ( qj ) ; qg . x = s * qi [ 0 ] ; qg . y = s * qi [ 1 ] ; qg . z = s * qi [ 2 ] ; qg . w = cos ( qj ) ; return qg ; } vec4 qm ( in vec3 bp , in vec3 qk ) { vec4 qg ; float dn = dot ( qk , bp ) ; vec3 ql = cross ( qk , bp ) ; qg . xyz = ql . xyz ; qg . w = 1.0 + dn ; return normalize ( qg ) ; } vec3 qr ( vec4 qn , vec4 qf , vec3 qo ) { vec3 qg = qo * qn . w ; qg = T ( qf , qg ) ; qg += qn . xyz ; return qg ; } vec3 ap ( mat3 qu , vec3 qo ) { vec3 qg = qo * qu [ 1 ] [ 0 ] ; vec4 qf = vec4 ( qu [ 1 ] [ 1 ] , qu [ 1 ] [ 2 ] , qu [ 2 ] [ 0 ] , qu [ 2 ] [ 1 ] ) ; qg = T ( qf , qg ) ; qg += qu [ 0 ] ; return qg ; } vec3 qv ( vec4 qn , vec4 qf , vec3 bp ) { vec3 qg = bp * qn . w ; qg = T ( qf , qg ) ; return qg ; } vec3 _ ( mat3 qu , vec3 bp ) { vec3 qg = bp * qu [ 1 ] [ 0 ] ; vec4 qf = vec4 ( qu [ 1 ] [ 1 ] , qu [ 1 ] [ 2 ] , qu [ 2 ] [ 0 ] , qu [ 2 ] [ 1 ] ) ; qg = T ( qf , qg ) ; return qg ; } vec3 qw ( vec4 qn , vec4 qf , vec3 qo ) { vec3 qg = qo - qn . xyz ; qg = T ( ke ( qf ) , qg ) ; qg /= qn . w ; return qg ; } vec3 qx ( vec4 qn , vec4 qf , vec3 bp ) { return T ( ke ( qf ) , bp ) / qn . w ; } mat4 qy ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qz ( float bx ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bx ) , sin ( bx ) , _0_0 , _0_0 , - sin ( bx ) , cos ( bx ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qA ( float bx ) { return mat4 ( cos ( bx ) , _0_0 , - sin ( bx ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bx ) , _0_0 , cos ( bx ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qB ( float bx ) { return mat4 ( cos ( bx ) , sin ( bx ) , _0_0 , _0_0 , - sin ( bx ) , cos ( bx ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } au lk ( in au kd ) { return au ( kd . O , kd . ao , normalize ( kd . V ) , normalize ( kd . aB ) , normalize ( kd . W ) , normalize ( kd . U ) , kd . aQ ) ; }".split(" ")},
{a:"cond",f:[{a:"if",j:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",o:5}],l:{a:"grp",f:[{a:"txt",b:"vec3 aC ( vec4 f ) { float fr = f . x ; float fs = f . y ; float ft = f . w ; vec3 qC ; qC . x = ( fr + ft ) / 2.0 ; qC . y = ( fs + ft ) / 2.0 ; qC . z = ft ; return qC ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cQ ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 bc ( mat3 t ) { mat4 qD ; qD [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qD [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qD [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qD [ 0 ] [ 3 ] = _0_0 ; qD [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qD [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qD [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qD [ 1 ] [ 3 ] = _0_0 ; qD [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qD [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qD [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qD [ 2 ] [ 3 ] = _0_0 ; qD [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qD [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qD [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qD [ 3 ] [ 3 ] = 1.0 ; return qD ; } mat3 aY ( in mat3 qu , in mat3 qE ) { mat3 qg ; vec3 qo = qE [ 0 ] ; vec4 qn = vec4 ( qu [ 0 ] , qu [ 1 ] [ 0 ] ) ; vec4 qf = vec4 ( qu [ 1 ] [ 1 ] , qu [ 1 ] [ 2 ] , qu [ 2 ] [ 0 ] , qu [ 2 ] [ 1 ] ) ; qg [ 0 ] = qr ( qn , qf , qo ) ; qg [ 1 ] [ 0 ] = qu [ 1 ] [ 0 ] * qE [ 1 ] [ 0 ] ; qg [ 1 ] [ 1 ] = qu [ 1 ] [ 1 ] * qE [ 2 ] [ 1 ] + qu [ 2 ] [ 1 ] * qE [ 1 ] [ 1 ] + qu [ 1 ] [ 2 ] * qE [ 2 ] [ 0 ] - qu [ 2 ] [ 0 ] * qE [ 1 ] [ 2 ] ; qg [ 1 ] [ 2 ] = qu [ 1 ] [ 2 ] * qE [ 2 ] [ 1 ] + qu [ 2 ] [ 1 ] * qE [ 1 ] [ 2 ] + qu [ 2 ] [ 0 ] * qE [ 1 ] [ 1 ] - qu [ 1 ] [ 1 ] * qE [ 2 ] [ 0 ] ; qg [ 2 ] [ 0 ] = qu [ 2 ] [ 0 ] * qE [ 2 ] [ 1 ] + qu [ 2 ] [ 1 ] * qE [ 2 ] [ 0 ] + qu [ 1 ] [ 1 ] * qE [ 1 ] [ 2 ] - qu [ 1 ] [ 2 ] * qE [ 1 ] [ 1 ] ; qg [ 2 ] [ 1 ] = qu [ 2 ] [ 1 ] * qE [ 2 ] [ 1 ] - qu [ 1 ] [ 1 ] * qE [ 1 ] [ 1 ] - qu [ 1 ] [ 2 ] * qE [ 1 ] [ 2 ] - qu [ 2 ] [ 0 ] * qE [ 2 ] [ 0 ] ; return qg ; } mat3 cT ( in vec4 qf , in mat3 qu ) { mat3 qg ; qg [ 0 ] = qu [ 0 ] ; qg [ 1 ] [ 0 ] = qu [ 1 ] [ 0 ] ; qg [ 1 ] [ 1 ] = qf [ 0 ] ; qg [ 1 ] [ 2 ] = qf [ 1 ] ; qg [ 2 ] [ 0 ] = qf [ 2 ] ; qg [ 2 ] [ 1 ] = qf [ 3 ] ; return qg ; } vec4 R ( in vec4 qF ) { return normalize ( qF ) ; } vec4 R ( in vec4 qF , out float P , out float Q ) { vec4 qf = R ( qF ) ; P = length ( qF ) * M_PI ; Q = sign ( qF [ 3 ] ) ; return R ( qF ) ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MIRROR_GLSLF",l:{a:"grp",f:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_BSDF_SKY_DIM",b:[""]},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2},{a:"logical_or_expr",o:3}],
l:{a:"grp",f:[{a:"include",D:"color_util.glslf"},{a:"include",D:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qG ( in vec3 C , vec3 ef , float eD , float eE ) { vec3 eB = normalize ( ef + C ) ; float eC = 1.0 - dot ( C , eB ) ; float r = eE + ( 1.0 - eE ) * pow ( eC , eD ) ; return r ; } void cz ( inout vec3 qH , vec3 C , vec3 U , float qI , mat3 N ) { vec3 ef = reflect ( - C , U ) ; float eD = u_fresnel_params [ 0 ] ; float eE = u_fresnel_params [ 1 ] ; float r = 1.0 ; if ( eD != 0.0 ) r = qG ( C , ef , eD , eE ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ek = GLSL_TEXTURE_CUBE ( u_cube_reflection , ef ) . xyz ;".split(" ")}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 qJ = u_refl_plane . xyz * dot ( U , u_refl_plane . xyz ) ; vec3 qK = U - qJ ; vec2 qL = _ ( N , qK ) . xy ; vec2 qM = l . xy / l . z ; qM += qL * REFL_BUMP ; vec3 ek = GLSL_TEXTURE ( u_plane_reflection , qM ) . rgb ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ek = vec3 ( 1.0 ) ; qI = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",j:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 ek = GLSL_TEXTURE_CUBE ( u_mirrormap , ef ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"cg ( ek . rgb ) ; qH = mix ( qH , ek , qI * r ) ; } vec3 qW ( vec3 qH , vec3 qN , vec3 C , vec3 U , float qO , float qP , mat3 N ) {".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2},"USE_BSDF_SKY_DIM",
{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float qQ = max ( dot ( U , C ) , _0_0 ) ; float qR = qO + ( max ( _1_0 - qP , qO ) - qO ) * pow ( _1_0 - qQ , 5.0 ) ; vec3 ef = reflect ( - C , U ) ; float qS = 2.0 / ( qP * qP ) - 2.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["GLSL1"],l:{a:"grp",f:[{a:"txt",b:["float","qT","=","u_bsdf_cube_sky_dim",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"float qT = float ( textureSize ( u_cube_reflection , 0 ) . x ) ;".split(" ")}]}}]},{a:"txt",b:"float qU = log2 ( qT * sqrt ( 3.0 ) ) - _0_5 * log2 ( qS + _1_0 ) ; vec3 ek = GLSL_TEXTURE_CUBE_LOD ( u_cube_reflection , ef , qU ) . xyz ; cg ( ek ) ; ek *= qN ; vec3 qV = GLSL_TEXTURE_CUBE_LOD ( u_cube_reflection , U , 100.0 ) . xyz ; cg ( qV ) ; qV *= qH ; return qV + qR * ek ;".split(" ")}]}},
{a:"elif",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 qJ = u_refl_plane . xyz * dot ( U , u_refl_plane . xyz ) ; vec3 qK = U - qJ ; vec2 qL = _ ( N , qK ) . xy ; vec2 qM = l . xy / l . z ; qM += qL * REFL_BUMP ; vec3 ek = GLSL_TEXTURE ( u_plane_reflection , qM ) . rgb ; cg ( ek ) ; ek *= qN ; return mix ( qH , ek , qO ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ek = qN ; return mix ( qH , ek , qO ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLF",l:{a:"grp",f:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",
b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"IS_WORLD",b:["0"]},{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"mirror.glslf"},{a:"include",D:"shadow.glslf"},{a:"include",D:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"refraction.glslf"}]}}]},{a:"include",D:"color_util.glslf"},{a:"include",D:"math.glslv"},
{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","qX",";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_B4W_REFRACTION"],l:{a:"grp",f:[{a:"txt",b:"vec3 q_ ( in vec3 qY , in float qZ ) { vec3 et = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_REFRACTION"],l:{a:"grp",f:[{a:"txt",b:"et = cB ( l , qY . xy * qZ ) ;".split(" ")}]}},{a:"elif",j:["HAS_REFRACT_TEXTURE"],l:{a:"grp",f:[{a:"txt",b:"et = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; cg ( et ) ;".split(" ")}]}}]},
{a:"txt",b:["return","et",";","}"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:"vec3 jt ( vec3 rgb ) { vec4 js = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , js . wz ) , vec4 ( rgb . gb , js . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dn = q . x - min ( q . w , q . y ) ; float hK = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dn + hK ) ) , dn / ( q . x + hK ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:"vec3 jv ( vec3 ju ) { vec4 js = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( ju . r , ju . r , ju . r ) + js . xyz ) * 6.0 - js . www ) ; return ju . b * mix ( js . xxx , clamp ( p - js . xxx , _0_0 , _1_0 ) , ju . g ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",j:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",o:5}],l:{a:"grp",f:[{a:"txt",b:"vec3 rc ( vec2 gq ) { return vec3 ( gq * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"vec2 rd ( vec3 qo ) { return vec2 ( qo . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float rj ( vec3 re , vec3 rf , float rh ) { float di = abs ( dot ( re , rf ) ) ; float g = rh * rh - _1_0 + di * di ; float ri ; if ( g > _0_0 ) { g = sqrt ( g ) ; float cp = ( g - di ) / ( g + di ) ; float oN = ( di * ( g + di ) - _1_0 ) / ( di * ( g - di ) + _1_0 ) ; ri = _0_5 * cp * cp * ( _1_0 + oN * oN ) ; } else { ri = _1_0 ; } return ri ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
B:[],A:[{a:"node_out",c:"rJ",i:["vec3"],g:!0},{a:"node_out",c:"rK",i:["float"],g:!0},{a:"node_out",c:"rL",i:["float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_rJ"],u:[{a:"txt",b:"rJ = normalize ( rG . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_rK"],u:[{a:"txt",b:"rK = abs ( rG . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_rL"],u:[{a:"txt",b:"rL = length ( rG . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",B:[],A:[{a:"node_in",c:"rM",i:["float"],
g:!1},{a:"node_in",c:"rN",i:["float"],g:!1},{a:"node_in",c:"rO",i:["float"],g:!1},{a:"node_out",c:"rP",i:["vec3"],g:!1}],u:[{a:"txt",b:"rP = vec3 ( rM , rN , rO ) ;".split(" ")}]},{a:"node",c:"COMBHSV",B:[],A:[{a:"node_in",c:"rQ",i:["float"],g:!1},{a:"node_in",c:"rR",i:["float"],g:!1},{a:"node_in",c:"rS",i:["float"],g:!1},{a:"node_out",c:"rT",i:["vec3"],g:!1}],u:[{a:"txt",b:"rT = jv ( vec3 ( rQ , rR , rS ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",B:[],A:[{a:"node_out",c:"rU",i:["vec3"],g:!1}],u:[{a:"txt",
b:"rU = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",B:[],A:[{a:"node_out",c:"rV",i:["vec3"],g:!1}],u:[{a:"txt",b:"rV = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",B:[],A:[{a:"node_out",c:"rW",i:["vec3"],g:!1},{a:"node_param",c:"rk",i:["GLSL_IN","vec2"],g:!1}],u:[{a:"txt",b:"rW = rc ( rk ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",B:[],A:[{a:"node_out",c:"rX",i:["vec3"],g:!1}],u:[{a:"txt",b:"rX = 2.0 * qX - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
B:[],A:[{a:"node_out",c:"rY",i:["vec3"],g:!1},{a:"node_param",c:"rl",i:["GLSL_IN","vec3"],g:!1}],u:[{a:"txt",b:"rY = max ( vec3 ( _0_0 ) , rl ) ; cg ( rY ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",B:[],A:[{a:"node_out",c:"rZ",i:["float"],g:!1},{a:"node_param",c:"rm",i:["GLSL_IN","float"],g:!1}],u:[{a:"txt",b:"rZ = max ( _0_0 , rm ) ; cg ( rZ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",B:[],A:[{a:"node_out",c:"r_",i:["float"],g:!1},{a:"node_out",c:"sa",i:["float"],g:!1},{a:"node_param",c:"rn",
i:["GLSL_IN","vec2"],g:!1}],u:[{a:"txt",b:"r_ = max ( _0_0 , rn [ 0 ] ) ; sa = max ( _0_0 , rn [ 1 ] ) ; cg ( r_ ) ; cg ( sa ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",B:[],A:[{a:"node_out",c:"sb",i:["float"],g:!1},{a:"node_out",c:"sc",i:["float"],g:!1},{a:"node_out",c:"sd",i:["float"],g:!1},{a:"node_param",c:"ro",i:["GLSL_IN","vec3"],g:!1}],u:[{a:"txt",b:"sb = max ( _0_0 , ro [ 0 ] ) ; sc = max ( _0_0 , ro [ 1 ] ) ; sd = max ( _0_0 , ro [ 2 ] ) ; cg ( sb ) ; cg ( sc ) ; cg ( sd ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"se",i:["vec3"],g:!1},{a:"node_out",c:"sf",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["sf","=","se",";"]}]},{a:"node_else",u:[{a:"txt",b:"sf = rz . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",B:[],A:[{a:"node_out",c:"sg",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"sg = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"sg = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",B:[],A:[{a:"node_out",c:"sh",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"sh = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"sh = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",B:[],A:[{a:"node_out",c:"si",i:["vec3"],g:!1}],u:[{a:"txt",
b:"si = - _ ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",B:[],A:[{a:"node_out",c:"sj",i:["vec3"],g:!1}],u:[{a:"txt",b:"sj = rG . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",B:[],A:[{a:"node_out",c:"sk",i:["vec3"],g:!1}],u:[{a:"txt",b:["sk","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",B:[],A:[{a:"node_out",c:"sl",i:["vec3"],g:!1}],u:[{a:"txt",b:["sl","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",B:[],A:[{a:"node_out",c:"sm",i:["vec3"],g:!1},{a:"node_out",c:"sn",i:["vec3"],g:!1},
{a:"node_out",c:"so",i:["vec3"],g:!1},{a:"node_out",c:"sr",i:["vec3"],g:!1},{a:"node_out",c:"su",i:["vec3"],g:!1},{a:"node_out",c:"sv",i:["vec3"],g:!1},{a:"node_out",c:"sw",i:["float"],g:!1},{a:"node_out",c:"sx",i:["float"],g:!1}],u:[{a:"txt",b:"sm = vec3 ( _0_0 ) ; sn = vec3 ( _0_0 ) ; so = vec3 ( _0_0 ) ; sr = vec3 ( _0_0 ) ; su = vec3 ( _0_0 ) ; sv = vec3 ( _0_0 ) ; sw = _0_0 ; sx = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",B:[],A:[{a:"node_in",c:"sy",i:["float"],g:!1},{a:"node_in",c:"sz",i:["float"],
g:!1},{a:"node_in",c:"sA",i:["float"],g:!1},{a:"node_in",c:"sB",i:["float"],g:!1},{a:"node_in",c:"sC",i:["vec3"],g:!1},{a:"node_out",c:"sD",i:["vec3"],g:!1}],u:[{a:"txt",b:"vec3 ju = jt ( sC ) ; ju [ 0 ] += ( sy - _0_5 ) ; if ( ju [ 0 ] > _1_0 ) ju [ 0 ] -= _1_0 ; else if ( ju [ 0 ] < _0_0 ) ju [ 0 ] += _1_0 ; ju *= vec3 ( _1_0 , sz , sA ) ; ju = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , ju , step ( vec3 ( _0_0 ) , ju ) ) , step ( ju , vec3 ( _1_0 ) ) ) ; sD = mix ( sC , jv ( ju ) , sB ) ;".split(" ")}]},
{a:"node",c:"INVERT",B:[],A:[{a:"node_in",c:"sE",i:["float"],g:!1},{a:"node_in",c:"sF",i:["vec3"],g:!1},{a:"node_out",c:"sG",i:["vec3"],g:!1}],u:[{a:"txt",b:"sG = mix ( sF , vec3 ( _1_0 ) - sF , sE ) ;".split(" ")}]},{a:"node",c:"LAMP",B:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],A:[{a:"node_out",
c:"sH",i:["vec3"],g:!0},{a:"node_out",c:"sI",i:["vec3"],g:!1},{a:"node_out",c:"sJ",i:["float"],g:!1},{a:"node_out",c:"sK",i:["float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["LAMP_INDEX",1,{a:"negative_expr",o:1},{a:"non_equal_expr",o:2}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sH"],u:[{a:"txt",b:"sH = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sL = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sM = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2},"LAMP_TYPE","POINT",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"sI = h - sM ; sJ = length ( sI ) ; sI = normalize ( sI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sK"],u:[{a:"txt",b:"sK = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sJ * sJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"float ol = dot ( - sI , sL ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sK *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["LAMP_USE_SPHERE"],u:[{a:"txt",b:"sK *= max ( LAMP_LIGHT_DIST - sJ , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sI"],u:[{a:"txt",b:["sI","=","sL",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sJ"],u:[{a:"txt",b:"sJ = length ( sM - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sK"],u:[{a:"txt",b:["sK","=","_1_0",";"]}]}]}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",
j:["USE_OUT_sH"],u:[{a:"txt",b:"sH = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"sI = vec3 ( _0_0 ) ; sJ = 0.0 ;".split(" ")}]}]}]},{a:"node",c:"NORMAL",B:[],A:[{a:"node_in",c:"sN",i:["vec3"],g:!1},{a:"node_out",c:"sO",i:["vec3"],g:!0},{a:"node_out",c:"sP",i:["float"],g:!0},{a:"node_param",c:"rp",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sO"],u:[{a:"txt",b:["sO","=","rp",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sP"],u:[{a:"txt",b:"sP = - dot ( sN , rp ) ;".split(" ")}]}]}]},
{a:"node",c:"B4W_VECTOR_VIEW",B:[],A:[{a:"node_in",c:"sQ",i:["vec3"],g:!1},{a:"node_out",c:"sR",i:["vec3"],g:!1}],u:[{a:"txt",b:"sR = - _ ( u_view_tsr_frag , sQ ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",B:[],A:[{a:"node_in",c:"sS",i:["vec3"],g:!1},{a:"node_in",c:"sT",i:["vec3"],g:!1},{a:"node_in",c:"sU",i:["float"],g:!1},{a:"node_in",c:"sV",i:["vec3"],g:!1},{a:"node_in",c:"sW",i:["float"],g:!1},{a:"node_in",c:"sX",i:["float"],g:!1},{a:"node_in",c:"sY",i:["vec3"],g:!1},{a:"node_in",c:"sZ",i:["vec3"],
g:!1},{a:"node_in",c:"s_",i:["float"],g:!1},{a:"node_in",c:"ta",i:["vec3"],g:!1},{a:"node_in",c:"tb",i:["float"],g:!1},{a:"node_out",c:"tc",i:["vec3"],g:!1},{a:"node_out",c:"td",i:["vec3"],g:!1},{a:"node_out",c:"te",i:["vec3"],g:!1},{a:"node_out",c:"tf",i:["vec3"],g:!1},{a:"node_out",c:"tg",i:["vec3"],g:!1},{a:"node_out",c:"th",i:["vec4"],g:!1},{a:"node_out",c:"ti",i:["vec4"],g:!1},{a:"node_out",c:"tj",i:["vec3"],g:!1},{a:"node_out",c:"tk",i:["vec3"],g:!1},{a:"node_out",c:"tl",i:["vec3"],g:!1},{a:"node_out",
c:"tm",i:["float"],g:!1},{a:"node_out",c:"tn",i:["vec3"],g:!1},{a:"node_out",c:"to",i:["float"],g:!1}],u:[{a:"txt",b:"te = sT ; tf = sV ; tg = sY ; tj = sT ; tk = sV ; tl = sZ ; tm = s_ ; tn = ta ; to = tb ; tc = rH * te ; td = rI * u_environment_energy * cn ( tg ) ; ti = cq ( te ) ; G = ti ; th [ 0 ] = sU ; th [ 1 ] = sW ; th [ 2 ] = sX ;".split(" ")}]},{a:"node",c:"BSDF_END",B:[],A:[{a:"node_in",c:"tr",i:["vec4"],g:!1},{a:"node_in",c:"tu",i:["vec3"],g:!1},{a:"node_in",c:"tv",i:["vec3"],g:!1},{a:"node_in",
c:"tw",i:["vec4"],g:!1},{a:"node_in",c:"tx",i:["vec3"],g:!1},{a:"node_in",c:"ty",i:["vec3"],g:!1},{a:"node_in",c:"tz",i:["vec3"],g:!1},{a:"node_in",c:"tA",i:["float"],g:!1},{a:"node_in",c:"tB",i:["vec3"],g:!1},{a:"node_in",c:"tC",i:["float"],g:!1},{a:"node_out",c:"tD",i:["vec3"],g:!1}],u:[{a:"txt",b:"float tE = clamp ( tw [ 1 ] , _0_0 , _1_0 ) ; float qO = tw [ 2 ] ; tD = tr . rgb ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"tD += qW ( tx , ty , nI , tv , qO , tE , mat3 ( _0_0 ) ) ;".split(" ")}]},
{a:"node_elif",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"tD += qW ( tx , ty , nI , tv , qO , u_view_tsr_frag ) ;".split(" ")}]}]},{a:"txt",b:"tD += tu ; tD = mix ( tD , tz , tA ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_NODE_BSDF_TRANSPARENT"],u:[{a:"txt",b:"vec3 tF = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; cg ( tF ) ; tB = tB * tF ; tD += tB ;".split(" ")}]}]},{a:"txt",b:["tv",";"]}]},{a:"node",c:"BSDF_COMPUTE",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",
b:["0"]}],A:[{a:"node_in",c:"tG",i:["vec3"],g:!1},{a:"node_in",c:"tH",i:["vec2"],g:!1},{a:"node_in",c:"tI",i:["vec3"],g:!1},{a:"node_in",c:"tJ",i:["float"],g:!1},{a:"node_in",c:"tK",i:["vec4"],g:!1},{a:"node_out",c:"tL",i:["float"],g:!1},{a:"node_out",c:"tM",i:["float"],g:!1}],u:[{a:"txt",b:"vec3 rf = tI ; float tN = clamp ( tK [ 0 ] , _0_0 , _1_0 ) ; float tE = clamp ( tK [ 1 ] , _0_0 , _1_0 ) ; float qO = tK [ 2 ] ; vec3 pg = normalize ( nI + tG ) ; float ot = ( _1_0 - tJ ) * dot ( rf , tG ) + tJ ; float tO = ( _1_0 - tJ ) * max ( dot ( tG , pg ) , _0_0 ) + tJ ; float tP = ( _1_0 - tJ ) * max ( dot ( tI , pg ) , _0_0 ) + tJ ; tL = _0_0 ; if ( tH . r != _0_0 ) { if ( tN > _0_0 ) { float oF = max ( dot ( rf , nI ) , _0_0 ) ; float oG = tN * tN ; float cp = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = tG - ot * rf ; vec3 oI = nI - oF * rf ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) tL = ot * cp ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; tL = ot * ( cp + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else tL = ot ; tL = max ( tL , _0_0 ) / M_PI ; } float J = tE ; float tQ = J * J ; float tR = ( tP * tQ - tP ) * tP + _1_0 ; float cm = tQ / ( M_PI * tR * tR ) ; float tS ; float tT ; float tU = pow ( _1_0 - tO , 5.0 ) ; tS = _1_0 ; tT = tU ; float js = J / 2.0 ; float tV = js * js ; float tW = _1_0 - tV ; float tX = _1_0 / ( tO * tO * tW + tV ) ; tS *= tX ; tT *= tX ; float tY = mix ( 0.04 , _1_0 , qO ) ; float tZ = mix ( tT , tS , tY ) ; tM = max ( ot * cm * tZ , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",B:[],A:[{a:"node_in",c:"t_",i:["vec3"],g:!1},{a:"node_in",c:"ua",i:["float"],g:!1},{a:"node_in",c:"ub",i:["float"],g:!1},{a:"node_in",c:"uc",i:["float"],g:!1},{a:"node_in",c:"ud",i:["vec3"],g:!1},{a:"node_in",c:"ue",i:["vec3"],g:!1},{a:"node_out",c:"uf",i:["vec3"],g:!1}],u:[{a:"txt",b:"uf = t_ ; ua ; ub ; uc ; ud ; ue ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"ug",i:["vec3"],g:!1},{a:"node_in",c:"uh",i:["float"],
g:!1},{a:"node_in",c:"ui",i:["vec3"],g:!1},{a:"node_out",c:"uj",i:["vec3"],g:!1},{a:"node_out",c:"uk",i:["vec3"],g:!1},{a:"node_out",c:"ul",i:["float"],g:!1},{a:"node_out",c:"um",i:["vec3"],g:!1},{a:"node_out",c:"un",i:["float"],g:!1},{a:"node_out",c:"uo",i:["float"],g:!1},{a:"node_out",c:"up",i:["vec3"],g:!1},{a:"node_out",c:"uq",i:["vec3"],g:!1},{a:"node_out",c:"ur",i:["float"],g:!1},{a:"node_out",c:"us",i:["vec3"],g:!1},{a:"node_out",c:"ut",i:["float"],g:!1}],u:[{a:"txt",b:"uk = ug ; ul = uh ; uo = _0_0 ; ur = _0_0 ; ut = _1_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["up","=","ui",";"]}]},{a:"node_else",u:[{a:"txt",b:["up","=","nH",";"]}]}]},{a:"txt",b:"uj ; um = vec3 ( _0_0 ) ; un = _0_0 ; uq = vec3 ( _0_0 ) ; us = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",B:[],A:[{a:"node_in",c:"uu",i:["vec3"],g:!1},{a:"node_in",c:"uv",i:["float"],g:!1},{a:"node_in",c:"uw",i:["float"],g:!1},{a:"node_in",c:"ux",i:["vec3"],g:!1},{a:"node_out",c:"uy",i:["vec3"],g:!1}],u:[{a:"txt",b:"uy = uu ; uv ; uw ; ux ;".split(" ")}]},
{a:"node",c:"BSDF_GLOSSY",B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"uz",i:["vec3"],g:!1},{a:"node_in",c:"uA",i:["float"],g:!1},{a:"node_in",c:"uB",i:["vec3"],g:!1},{a:"node_out",c:"uC",i:["vec3"],g:!1},{a:"node_out",c:"uD",i:["vec3"],g:!1},{a:"node_out",c:"uE",i:["float"],g:!1},{a:"node_out",c:"uF",i:["vec3"],g:!1},{a:"node_out",c:"uG",i:["float"],g:!1},{a:"node_out",c:"uH",i:["float"],g:!1},{a:"node_out",c:"uI",i:["vec3"],g:!1},{a:"node_out",c:"uJ",i:["vec3"],g:!1},{a:"node_out",
c:"uK",i:["float"],g:!1},{a:"node_out",c:"uL",i:["vec3"],g:!1},{a:"node_out",c:"uM",i:["float"],g:!1}],u:[{a:"txt",b:"uF = uz ; uG = uA ; uH = _1_0 ; uK = _0_0 ; uM = _1_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["uI","=","uB",";"]}]},{a:"node_else",u:[{a:"txt",b:["uI","=","nH",";"]}]}]},{a:"txt",b:"uC ; uD = vec3 ( _0_0 ) ; uE = _0_0 ; uJ = vec3 ( _0_0 ) ; uL = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",B:[],A:[{a:"node_in",c:"uN",i:["vec3"],g:!1},
{a:"node_in",c:"uO",i:["float"],g:!1},{a:"node_in",c:"uP",i:["float"],g:!1},{a:"node_in",c:"uQ",i:["float"],g:!1},{a:"node_out",c:"uR",i:["vec3"],g:!1}],u:[{a:"txt",b:"uR = uN ; uO ; uP ; uQ ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",B:[],A:[{a:"node_in",c:"uS",i:["vec3"],g:!1},{a:"node_out",c:"uT",i:["vec3"],g:!1},{a:"node_out",c:"uU",i:["vec3"],g:!1},{a:"node_out",c:"uV",i:["float"],g:!1},{a:"node_out",c:"uW",i:["vec3"],g:!1},{a:"node_out",c:"uX",i:["float"],g:!1},{a:"node_out",c:"uY",i:["float"],
g:!1},{a:"node_out",c:"uZ",i:["vec3"],g:!1},{a:"node_out",c:"u_",i:["vec3"],g:!1},{a:"node_out",c:"va",i:["float"],g:!1},{a:"node_out",c:"vb",i:["vec3"],g:!1},{a:"node_out",c:"vc",i:["float"],g:!1}],u:[{a:"txt",b:"vb = uS ; uY = _0_0 ; va = _0_0 ; vc = _0_0 ; uZ = nH ; uT ; uU = vec3 ( _0_0 ) ; uV = _0_0 ; uW = vec3 ( _0_0 ) ; uX = _0_0 ; u_ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",B:[],A:[{a:"node_in",c:"vd",i:["vec3"],g:!1},{a:"node_in",c:"ve",i:["vec3"],g:!1},{a:"node_out",
c:"vf",i:["vec3"],g:!1}],u:[{a:"txt",b:"vf = vd ; ve ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",B:[],A:[{a:"node_in",c:"vg",i:["vec3"],g:!1},{a:"node_in",c:"vh",i:["float"],g:!1},{a:"node_in",c:"vi",i:["float"],g:!1},{a:"node_in",c:"vj",i:["vec3"],g:!1},{a:"node_out",c:"vk",i:["vec3"],g:!1}],u:[{a:"txt",b:"vk [ 0 ] = vk [ 1 ] = vk [ 2 ] = _0_0 ; vg ; vh ; vi ; vj ;".split(" ")}]},{a:"node",c:"BSDF_TOON",B:[],A:[{a:"node_in",c:"vl",i:["vec3"],g:!1},{a:"node_in",c:"vm",i:["float"],g:!1},{a:"node_in",
c:"vn",i:["float"],g:!1},{a:"node_in",c:"vo",i:["vec3"],g:!1},{a:"node_out",c:"vp",i:["vec3"],g:!1}],u:[{a:"txt",b:"vp = vl ; vm ; vn ; vo ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",B:[],A:[{a:"node_in",c:"vq",i:["vec3"],g:!1},{a:"node_in",c:"vr",i:["float"],g:!1},{a:"node_in",c:"vs",i:["vec3"],g:!1},{a:"node_out",c:"vt",i:["vec3"],g:!1}],u:[{a:"txt",b:"vt = vq ; vr ; vs ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",B:[],A:[{a:"node_in",c:"vu",i:["vec3"],g:!1},{a:"node_in",c:"vv",i:["float"],
g:!1},{a:"node_in",c:"vw",i:["vec3"],g:!1},{a:"node_in",c:"vx",i:["float"],g:!1},{a:"node_in",c:"vy",i:["float"],g:!1},{a:"node_in",c:"vz",i:["vec3"],g:!1},{a:"node_out",c:"vA",i:["vec3"],g:!1}],u:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vu ; vw ; vx ; vy ; vz ; vv ;".split(" ")}]},{a:"node",c:"EMISSION",B:[],A:[{a:"node_in",c:"vB",i:["vec3"],g:!1},{a:"node_in",c:"vC",i:["float"],g:!1},{a:"node_out",c:"vD",i:["vec3"],g:!1},{a:"node_out",c:"vE",i:["vec3"],g:!1},{a:"node_out",c:"vF",i:["float"],
g:!1},{a:"node_out",c:"vG",i:["vec3"],g:!1},{a:"node_out",c:"vH",i:["float"],g:!1},{a:"node_out",c:"vI",i:["float"],g:!1},{a:"node_out",c:"vJ",i:["vec3"],g:!1},{a:"node_out",c:"vK",i:["vec3"],g:!1},{a:"node_out",c:"vL",i:["float"],g:!1},{a:"node_out",c:"vM",i:["vec3"],g:!1},{a:"node_out",c:"vN",i:["float"],g:!1}],u:[{a:"txt",b:"vK = vC * vB ; vI = _0_0 ; vL = _1_0 ; vN = _1_0 ; vJ = nH ; vD ; vE = vec3 ( _0_0 ) ; vF = _0_0 ; vG = vec3 ( _0_0 ) ; vH = _0_0 ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",
B:[],A:[{a:"node_in",c:"vO",i:["vec3"],g:!1},{a:"node_out",c:"vP",i:["vec3"],g:!1}],u:[{a:"txt",b:"vP [ 0 ] = vP [ 1 ] = vP [ 2 ] = _0_0 ; vO ;".split(" ")}]},{a:"node",c:"HOLDOUT",B:[],A:[{a:"node_out",c:"vQ",i:["vec3"],g:!1}],u:[{a:"txt",b:"vQ [ 0 ] = vQ [ 1 ] = vQ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",B:[],A:[{a:"node_in",c:"vR",i:["vec3"],g:!1},{a:"node_in",c:"vS",i:["float"],g:!1},{a:"node_out",c:"vT",i:["vec3"],g:!1}],u:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vR ; vS ;".split(" ")}]},
{a:"node",c:"VOLUME_SCATTER",B:[],A:[{a:"node_in",c:"vU",i:["vec3"],g:!1},{a:"node_in",c:"vV",i:["float"],g:!1},{a:"node_in",c:"vW",i:["float"],g:!1},{a:"node_out",c:"vX",i:["vec3"],g:!1}],u:[{a:"txt",b:"vX [ 0 ] = vX [ 1 ] = vX [ 2 ] = _0_0 ; vU ; vV ; vW ;".split(" ")}]},{a:"node",c:"BUMP",B:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"vY",i:["float"],g:!1},{a:"node_in",c:"vZ",i:["float"],g:!1},{a:"node_in",c:"v_",i:["float"],g:!1},{a:"node_in",
c:"wa",i:["vec3"],g:!1},{a:"node_out",c:"wb",i:["vec3"],g:!1}],u:[{a:"txt",b:"float aM = vZ ; float gd = vY ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["INVERT"],u:[{a:"txt",b:["aM","=","-","_1_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["vec3","U","=","wa",";"]}]},{a:"node_else",u:[{a:"txt",b:["vec3","U","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_DERIVATIVES_EXT"],u:[{a:"txt",b:"vec3 wc = dFdx ( nG ) ; vec3 wd = dFdy ( nG ) ; vec3 we = cross ( wd , U ) ; vec3 wf = cross ( U , wc ) ; float dj = dot ( wc , we ) ; float wg = abs ( dj ) ; vec3 wh = dFdx ( v_ ) * we + dFdy ( v_ ) * wf ; gd = max ( gd , _0_0 ) ; wb = normalize ( wg * U - aM * sign ( dj ) * wh ) ; wb = normalize ( gd * wb + ( _1_0 - gd ) * U ) ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:["wb","=","U",";"]}]}]}]},{a:"node",c:"DISPLACEMENT_BUMP",B:[],A:[{a:"node_in",c:"wi",i:["float"],g:!1},{a:"node_out",c:"wj",i:["vec3"],g:!1}],u:[{a:"txt",b:"float aM = 0.1 ; vec3 U = nH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_DERIVATIVES_EXT"],u:[{a:"txt",b:"vec3 wc = dFdx ( nG ) ; vec3 wd = dFdy ( nG ) ; vec3 we = cross ( wd , U ) ; vec3 wf = cross ( U , wc ) ; float dj = dot ( wc , we ) ; float wg = abs ( dj ) ; vec3 wh = dFdx ( wi ) * we + dFdy ( wi ) * wf ; wj = normalize ( wg * U - aM * sign ( dj ) * wh ) ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:["wj","=","U",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",B:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"wk",i:["float"],g:!1},{a:"node_in",c:"wl",i:["vec4"],g:!1},{a:"node_in",c:"wm",i:["vec3"],g:!1},{a:"node_out",c:"wn",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["vec3","wo","=","wm",";"]}]},{a:"node_else",u:[{a:"txt",b:["vec3","wo","=","rB",";"]}]}]},{a:"node_cond",f:[{a:"node_if",
j:["SPACE","NM_TANGENT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wn = 2.0 * wl . xyz - _1_0 ; wn = rF * wn ;".split(" ")}]},{a:"node_elif",j:["SPACE","NM_OBJECT",{a:"equal_expr",o:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"wn = 2.0 * wl . xyz - _1_0 ; wn . yz *= - _1_0 ; wn = _ ( u_model_tsr , wn ) ;".split(" ")}]},{a:"node_elif",j:["SPACE","NM_WORLD",{a:"equal_expr",o:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",
b:"wn = 2.0 * wl . xyz - _1_0 ; wn . yz *= - _1_0 ;".split(" ")}]}]},{a:"txt",b:"float lo = max ( wk , _0_0 ) ; wn = normalize ( mix ( wo , wn , lo ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",B:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],A:[{a:"node_in",c:"wp",i:["vec3"],g:!1},{a:"node_out",c:"wq",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",o:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",
{a:"equal_expr",o:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",o:2},{a:"logical_or_expr",o:3}],u:[{a:"txt",b:["wq","=","wp",";"]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",o:2}],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_view_tsr_frag , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_model_tsr_inverse , wp ) ;".split(" ")}]},
{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_model_tsr , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_model_tsr , wp ) ; wq = ap ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_view_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",
{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_view_tsr_inverse , wp ) ; wq = ap ( u_model_tsr_inverse , wq ) ;".split(" ")}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_view_tsr_frag , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_model_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",
{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_model_tsr , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_model_tsr , wp ) ; wq = _ ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_view_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_view_tsr_inverse , wp ) ; wq = _ ( u_model_tsr_inverse , wq ) ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",j:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = normalize ( wq ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",B:[],A:[{a:"node_in",c:"wr",i:["float"],g:!1},{a:"node_out",c:"ws",i:["vec3"],g:!1}],u:[{a:"txt",b:"ws [ 0 ] = ws [ 1 ] = ws [ 2 ] = _0_0 ; wr ;".split(" ")}]},{a:"node",c:"WAVELENGTH",B:[],A:[{a:"node_in",c:"wt",i:["float"],g:!1},{a:"node_out",c:"wu",i:["vec3"],g:!1}],u:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wt ;".split(" ")}]},
{a:"node",c:"SEPXYZ",B:[],A:[{a:"node_in",c:"wv",i:["vec3"],g:!1},{a:"node_out",c:"wA",i:["float"],g:!1},{a:"node_out",c:"wB",i:["float"],g:!1},{a:"node_out",c:"wC",i:["float"],g:!1}],u:[{a:"txt",b:"wA = wv [ 0 ] ; wB = wv [ 1 ] ; wC = wv [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",B:[],A:[{a:"node_in",c:"wD",i:["float"],g:!1},{a:"node_in",c:"wE",i:["float"],g:!1},{a:"node_in",c:"wF",i:["float"],g:!1},{a:"node_out",c:"wG",i:["vec3"],g:!1}],u:[{a:"txt",b:"wG [ 0 ] = wD ; wG [ 1 ] = wE ; wG [ 2 ] = wF ;".split(" ")}]},
{a:"node",c:"BRIGHTCONTRAST",B:[],A:[{a:"node_in",c:"wH",i:["vec3"],g:!1},{a:"node_in",c:"wI",i:["float"],g:!1},{a:"node_in",c:"wJ",i:["float"],g:!1},{a:"node_out",c:"wK",i:["vec3"],g:!1}],u:[{a:"txt",b:"float b = wI - wJ * _0_5 ; wK = max ( ( _1_0 + wJ ) * wH + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",B:[],A:[{a:"node_in",c:"wL",i:["float"],g:!1},{a:"node_in",c:"wM",i:["float"],g:!1},{a:"node_out",c:"wN",i:["float"],g:!1},{a:"node_out",c:"wO",i:["float"],g:!1},{a:"node_out",
c:"wP",i:["float"],g:!1}],u:[{a:"txt",b:"wN = wO = wP = _0_0 ; wL ; wM ;".split(" ")}]},{a:"node",c:"TEX_SKY",B:[],A:[{a:"node_in",c:"wQ",i:["vec3"],g:!1},{a:"node_out",c:"wR",i:["vec3"],g:!1}],u:[{a:"txt",b:"wR [ 0 ] = wR [ 1 ] = wR [ 2 ] = _0_0 ; wQ ;".split(" ")}]},{a:"node",c:"TEX_NOISE",B:[],A:[{a:"node_in",c:"wS",i:["vec3"],g:!1},{a:"node_in",c:"wT",i:["float"],g:!1},{a:"node_in",c:"wU",i:["float"],g:!1},{a:"node_in",c:"wV",i:["float"],g:!1},{a:"node_out",c:"wW",i:["vec3"],g:!1},{a:"node_out",
c:"wX",i:["float"],g:!1}],u:[{a:"txt",b:"wW [ 0 ] = wW [ 1 ] = wW [ 2 ] = _0_0 ; wX = _1_0 ; wS ; wT ; wU ; wV ;".split(" ")}]},{a:"node",c:"TEX_WAVE",B:[],A:[{a:"node_in",c:"wY",i:["vec3"],g:!1},{a:"node_in",c:"wZ",i:["float"],g:!1},{a:"node_in",c:"w_",i:["float"],g:!1},{a:"node_in",c:"xa",i:["float"],g:!1},{a:"node_in",c:"xb",i:["float"],g:!1},{a:"node_out",c:"xc",i:["vec3"],g:!1},{a:"node_out",c:"xd",i:["float"],g:!1}],u:[{a:"txt",b:"xc [ 0 ] = xc [ 1 ] = xc [ 2 ] = _0_0 ; xd = _1_0 ; wY ; wZ ; w_ ; xa ; xb ;".split(" ")}]},
{a:"node",c:"TEX_VORONOI",B:[],A:[{a:"node_in",c:"xe",i:["vec3"],g:!1},{a:"node_in",c:"xf",i:["float"],g:!1},{a:"node_out",c:"xg",i:["vec3"],g:!1},{a:"node_out",c:"xh",i:["float"],g:!1}],u:[{a:"txt",b:"xg [ 0 ] = xg [ 1 ] = xg [ 2 ] = _0_0 ; xh = _1_0 ; xe ; xf ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",B:[],A:[{a:"node_in",c:"xi",i:["vec3"],g:!1},{a:"node_in",c:"xj",i:["float"],g:!1},{a:"node_in",c:"xk",i:["float"],g:!1},{a:"node_in",c:"xl",i:["float"],g:!1},{a:"node_in",c:"xm",i:["float"],g:!1},
{a:"node_in",c:"xn",i:["float"],g:!1},{a:"node_in",c:"xo",i:["float"],g:!1},{a:"node_out",c:"xp",i:["vec3"],g:!1},{a:"node_out",c:"xq",i:["float"],g:!1}],u:[{a:"txt",b:"xp [ 0 ] = xp [ 1 ] = xp [ 2 ] = _0_0 ; xq = _1_0 ; xi ; xj ; xk ; xl ; xm ; xn ; xo ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",B:[],A:[{a:"node_in",c:"xr",i:["vec3"],g:!1},{a:"node_out",c:"xs",i:["vec3"],g:!1},{a:"node_out",c:"xt",i:["float"],g:!1}],u:[{a:"txt",b:"xs [ 0 ] = xs [ 1 ] = xs [ 2 ] = _0_0 ; xt = _1_0 ; xr ;".split(" ")}]},
{a:"node",c:"TEX_MAGIC",B:[],A:[{a:"node_in",c:"xu",i:["vec3"],g:!1},{a:"node_in",c:"xv",i:["float"],g:!1},{a:"node_in",c:"xA",i:["float"],g:!1},{a:"node_out",c:"xB",i:["vec3"],g:!1},{a:"node_out",c:"xC",i:["float"],g:!1}],u:[{a:"txt",b:"xB [ 0 ] = xB [ 1 ] = xB [ 2 ] = _0_0 ; xC = _1_0 ; xu ; xv ; xA ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",B:[],A:[{a:"node_in",c:"xD",i:["vec3"],g:!1},{a:"node_in",c:"xE",i:["vec3"],g:!1},{a:"node_in",c:"xF",i:["vec3"],g:!1},{a:"node_in",c:"xG",i:["float"],g:!1},
{a:"node_out",c:"xH",i:["vec3"],g:!1},{a:"node_out",c:"xI",i:["float"],g:!1}],u:[{a:"txt",b:"xH [ 0 ] = xH [ 1 ] = xH [ 2 ] = _0_0 ; xI = _1_0 ; xD ; xE ; xF ; xG ;".split(" ")}]},{a:"node",c:"TEX_BRICK",B:[],A:[{a:"node_in",c:"xJ",i:["vec3"],g:!1},{a:"node_in",c:"xK",i:["vec3"],g:!1},{a:"node_in",c:"xL",i:["vec3"],g:!1},{a:"node_in",c:"xM",i:["vec3"],g:!1},{a:"node_in",c:"xN",i:["float"],g:!1},{a:"node_in",c:"xO",i:["float"],g:!1},{a:"node_in",c:"xP",i:["float"],g:!1},{a:"node_in",c:"xQ",i:["float"],
g:!1},{a:"node_in",c:"xR",i:["float"],g:!1},{a:"node_out",c:"xS",i:["vec3"],g:!1},{a:"node_out",c:"xT",i:["float"],g:!1}],u:[{a:"txt",b:"xS [ 0 ] = xS [ 1 ] = xS [ 2 ] = _0_0 ; xT = _1_0 ; xJ ; xK ; xL ; xM ; xN ; xO ; xP ; xQ ; xR ;".split(" ")}]},{a:"node",c:"ADD_SHADER",B:[],A:[{a:"node_in",c:"xU",i:["vec3"],g:!1},{a:"node_in",c:"xV",i:["vec3"],g:!1},{a:"node_out",c:"xW",i:["vec3"],g:!1}],u:[{a:"txt",b:"xW = clamp ( xU + xV , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",
B:[],A:[{a:"node_in",c:"xX",i:["float"],g:!1},{a:"node_in",c:"xY",i:["vec3"],g:!1},{a:"node_in",c:"xZ",i:["vec3"],g:!1},{a:"node_in",c:"x_",i:["vec3"],g:!1},{a:"node_in",c:"ya",i:["float"],g:!1},{a:"node_in",c:"yb",i:["vec3"],g:!1},{a:"node_in",c:"yc",i:["float"],g:!1},{a:"node_in",c:"yd",i:["float"],g:!1},{a:"node_in",c:"ye",i:["vec3"],g:!1},{a:"node_in",c:"yf",i:["vec3"],g:!1},{a:"node_in",c:"yg",i:["float"],g:!1},{a:"node_in",c:"yh",i:["vec3"],g:!1},{a:"node_in",c:"yi",i:["float"],g:!1},{a:"node_in",
c:"yj",i:["vec3"],g:!1},{a:"node_in",c:"yk",i:["float"],g:!1},{a:"node_in",c:"yl",i:["vec3"],g:!1},{a:"node_in",c:"ym",i:["float"],g:!1},{a:"node_in",c:"yn",i:["float"],g:!1},{a:"node_in",c:"yo",i:["vec3"],g:!1},{a:"node_in",c:"yp",i:["vec3"],g:!1},{a:"node_in",c:"yq",i:["float"],g:!1},{a:"node_in",c:"yr",i:["vec3"],g:!1},{a:"node_in",c:"ys",i:["float"],g:!1},{a:"node_out",c:"yt",i:["vec3"],g:!1},{a:"node_out",c:"yu",i:["vec3"],g:!1},{a:"node_out",c:"yv",i:["float"],g:!1},{a:"node_out",c:"yA",i:["vec3"],
g:!1},{a:"node_out",c:"yB",i:["float"],g:!1},{a:"node_out",c:"yC",i:["float"],g:!1},{a:"node_out",c:"yD",i:["vec3"],g:!1},{a:"node_out",c:"yE",i:["vec3"],g:!1},{a:"node_out",c:"yF",i:["float"],g:!1},{a:"node_out",c:"yG",i:["vec3"],g:!1},{a:"node_out",c:"yH",i:["float"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( xX , _0_0 , _1_0 ) ; yu = mix ( x_ , yj , yI ) ; yv = mix ( ya , yk , yI ) ; if ( yd > _0_0 ) { if ( yn > _0_0 ) { yA = mix ( yb , yl , yI ) ; yB = mix ( yc , ym , yI ) ; } else { yA = yb ; yB = yc ; } } else { yA = yl ; yB = ym ; } if ( yg > _0_0 ) { if ( yq > _0_0 ) { yE = mix ( yf , yp , yI ) ; } else { yE = yf ; } } else { yE = yp ; } yC = mix ( yd , yn , yI ) ; yD = mix ( ye , yo , yI ) ; yF = mix ( yg , yq , yI ) ; yG = mix ( yh , yr , yI ) ; yH = mix ( yi , ys , yI ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",B:[],A:[{a:"node_out",c:"yJ",i:["vec3"],g:!1},{a:"node_out",c:"yK",i:["vec3"],g:!1},{a:"node_param",c:"rq",i:["GLSL_IN","vec2"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yJ"],u:[{a:"txt",b:"yJ = rc ( rq ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yK"],u:[{a:"txt",b:"yK = vec3 ( rq , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",B:[],A:[{a:"node_out",c:"yL",i:["vec3"],g:!1},{a:"node_param",c:"rs",i:["GLSL_IN","vec2"],g:!1}],u:[{a:"txt",
b:"yL = vec3 ( rs , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",B:[],A:[{a:"node_out",c:"yM",i:["vec3"],g:!1}],u:[{a:"txt",b:["yM","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",B:[],A:[{a:"node_out",c:"yN",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["IS_WORLD",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["yN","=","qX",";"]}]},{a:"node_else",u:[{a:"txt",b:["yN","=","ry",";"]}]}]}]},{a:"node",c:"TEX_COORD_OB",B:[],A:[{a:"node_out",c:"yO",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",
j:["IS_WORLD",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:"yO = ap ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:["yO","=","ry",";"]}]}]}]},{a:"node",c:"TEX_COORD_CA",B:[],A:[{a:"node_out",c:"yP",i:["vec3"],g:!1}],u:[{a:"txt",b:"yP . xy = rG . xy ; yP . z = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",B:[],A:[{a:"node_out",c:"yQ",i:["vec3"],g:!1}],u:[{a:"txt",b:"yQ . xy = l . xy / l . z ; yQ . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",B:[],A:[{a:"node_out",
c:"yR",i:["vec3"],g:!1}],u:[{a:"txt",b:"yR = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",B:[],A:[{a:"node_out",c:"yS",i:["vec3"],g:!1},{a:"node_param",c:"rt",i:["GLSL_IN","vec2"],g:!1}],u:[{a:"txt",b:"yS = vec3 ( rt , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",B:[],A:[{a:"node_out",c:"yT",i:["float"],g:!1},{a:"node_out",c:"yU",i:["float"],g:!1},{a:"node_out",c:"yV",i:["float"],g:!1},{a:"node_out",c:"yW",i:["vec3"],g:!1},{a:"node_out",c:"yX",i:["float"],g:!1},{a:"node_out",
c:"yY",i:["vec3"],g:!1},{a:"node_out",c:"yZ",i:["vec3"],g:!1}],u:[{a:"txt",b:"yT = _0_0 ; yU = _0_0 ; yV = _0_0 ; yW = vec3 ( _0_0 ) ; yX = _0_0 ; yY = yW ; yZ = yW ;".split(" ")}]},{a:"node",c:"HAIR_INFO",B:[],A:[{a:"node_out",c:"y_",i:["float"],g:!1},{a:"node_out",c:"za",i:["float"],g:!1},{a:"node_out",c:"zb",i:["float"],g:!1},{a:"node_out",c:"zc",i:["vec3"],g:!1}],u:[{a:"txt",b:"y_ = _0_0 ; za = _0_0 ; zb = _0_0 ; zc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",B:[{a:"node_var",c:"USE_LOCATION_OUT",
b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],A:[{a:"node_out",c:"zd",i:["vec3"],g:!1},{a:"node_out",c:"ze",i:["float"],g:!1},{a:"node_out",c:"zf",i:["float"],g:!1},{a:"node_out",c:"zg",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_LOCATION_OUT"],u:[{a:"txt",b:"zd = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OBJ_IND_OUT"],u:[{a:"txt",b:"ze = u_obj_info . r ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_MAT_IND_OUT"],u:[{a:"txt",b:"zf = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_RANDOM_OUT"],u:[{a:"txt",b:"zg = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",B:[],A:[{a:"node_in",c:"zh",i:["float"],g:!1},{a:"node_out",c:"zi",i:["float"],g:!1}],u:[{a:"txt",b:["zi","=","zh",";"]}]},{a:"node",c:"TANGENT",B:[],A:[{a:"node_out",c:"zj",i:["vec3"],g:!1}],u:[{a:"txt",b:"zj = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",
B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"zk",i:["float"],g:!1},{a:"node_in",c:"zl",i:["vec3"],g:!1},{a:"node_out",c:"zm",i:["float"],g:!1},{a:"node_out",c:"zn",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:"vec3 ce = normalize ( zl ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:["vec3","ce","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",o:2}],u:[{a:"txt",b:"vec3 zo = normalize ( nI ) ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:["vec3","zo","=","u_camera_direction",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_zm"],u:[{a:"txt",b:"float rh = max ( _1_0 - zk , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",o:2}],u:[{a:"txt",b:"rh = gl_FrontFacing == false ? rh : _1_0 / rh ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"rh = gl_FrontFacing ? rh : _1_0 / rh ;".split(" ")}]}]},{a:"txt",b:"zm = rj ( zo , ce , rh ) ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:["zm","=","_0_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_zn"],u:[{a:"txt",b:"zn = abs ( dot ( zo , ce ) ) ; float dT = zk ; if ( dT != _0_5 ) { dT = clamp ( dT , _0_0 , 0.99999 ) ; dT = ( dT < _0_5 ) ? 2.0 * dT : _0_5 / ( _1_0 - dT ) ; zn = pow ( zn , dT ) ; } zn = _1_0 - zn ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:["zn","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",B:[],A:[{a:"node_out",c:"zp",i:["float"],g:!1},{a:"node_out",c:"zq",i:["float"],g:!1},
{a:"node_out",c:"zr",i:["float"],g:!1},{a:"node_out",c:"zs",i:["float"],g:!1},{a:"node_out",c:"zt",i:["float"],g:!1},{a:"node_out",c:"zu",i:["float"],g:!1},{a:"node_out",c:"zv",i:["float"],g:!1},{a:"node_out",c:"zA",i:["float"],g:!1},{a:"node_out",c:"zB",i:["float"],g:!1},{a:"node_out",c:"zC",i:["float"],g:!1},{a:"node_out",c:"zD",i:["float"],g:!1}],u:[{a:"txt",b:"zp = zq = zr = _0_0 ; zs = zt = zu = _0_0 ; zv = zD = zB = zC = _0_0 ; zA = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",B:[],A:[{a:"node_out",
c:"zE",i:["vec3"],g:!1},{a:"node_out",c:"zF",i:["vec3"],g:!1},{a:"node_out",c:"zG",i:["float"],g:!1}],u:[{a:"txt",b:"zE = zF = vec3 ( _0_0 ) ; zG = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",B:[],A:[],u:[]},{a:"node",c:"CURVE_VEC",B:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],A:[{a:"node_in",c:"zH",i:["float"],g:!1},{a:"node_in",c:"zI",i:["vec3"],g:!1},{a:"node_out",c:"zJ",i:["vec3"],g:!1}],u:[{a:"txt",
b:["zJ","=","zI",";"]},{a:"node_cond",f:[{a:"node_if",j:["READ_R"],u:[{a:"txt",b:"zJ . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zI . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_G"],u:[{a:"txt",b:"zJ . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zI . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_B"],u:[{a:"txt",b:"zJ . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zI . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},
{a:"txt",b:"zJ = mix ( zI , zJ , zH ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",B:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],A:[{a:"node_in",c:"zK",i:["float"],g:!1},{a:"node_in",c:"zL",i:["vec3"],g:!1},{a:"node_out",c:"zM",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["READ_A"],u:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zL . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zL . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zL . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"float r = zL . r ; float g = zL . g ; float b = zL . b ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_R"],u:[{a:"txt",b:"zM . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zM . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_G"],u:[{a:"txt",b:"zM . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zM . g = g ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["READ_B"],u:[{a:"txt",b:"zM . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zM . b = b ;".split(" ")}]}]},{a:"txt",b:"zM = mix ( zL , zM , zK ) ;".split(" ")}]},{a:"node",c:"VALTORGB",B:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],A:[{a:"node_in",c:"zN",i:["float"],g:!1},{a:"node_out",c:"zO",i:["vec3"],g:!1},{a:"node_out",c:"zP",i:["float"],g:!1}],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zN , NODE_TEX_ROW ) ) ; zO = zQ . rgb ; zP = zQ . a ;".split(" ")}]},
{a:"node",c:"MAPPING",B:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],A:[{a:"node_in",c:"zR",i:["vec3"],g:!1},{a:"node_out",c:"zS",i:["vec3"],g:!1}],u:[{a:"txt",b:["zS","=","zR",";"]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_SCALE_DEF"],u:[{a:"txt",b:"zS = zS * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_TRANS_DEF"],u:[{a:"txt",b:"zS = zS + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_TRS_MATRIX_DEF"],
u:[{a:"txt",b:"zS = ( MAPPING_TRS_MATRIX * vec4 ( zS , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_MIN_CLIP_DEF"],u:[{a:"txt",b:"zS = max ( zS , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_MAX_CLIP_DEF"],u:[{a:"txt",b:"zS = min ( zS , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_IS_NORMAL"],u:[{a:"txt",b:"zS = normalize ( zS ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",B:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],A:[{a:"node_in",c:"zT",i:["float"],g:!1},{a:"node_in",c:"zU",i:["float"],g:!1},{a:"node_out",c:"zV",i:["float"],g:!1}],u:[{a:"txt",b:"zV = zT + zU ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"zV = clamp ( zV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"zW",i:["float"],g:!1},{a:"node_in",c:"zX",i:["float"],g:!1},{a:"node_out",c:"zY",i:["float"],g:!1}],u:[{a:"txt",b:"zY = zW - zX ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"zY = clamp ( zY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"zZ",i:["float"],g:!1},{a:"node_in",c:"z_",i:["float"],g:!1},{a:"node_out",c:"Aa",i:["float"],g:!1}],u:[{a:"txt",b:"Aa = zZ * z_ ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Aa = clamp ( Aa , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ab",i:["float"],g:!1},{a:"node_in",c:"Ac",i:["float"],g:!1},{a:"node_out",c:"Ad",i:["float"],g:!1}],u:[{a:"txt",b:"Ad = ( Ac != _0_0 ) ? Ab / Ac : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ae",i:["float"],g:!1},{a:"node_in",c:"Af",i:["float"],g:!1},
{a:"node_out",c:"Ag",i:["float"],g:!1}],u:[{a:"txt",b:"Ag = sin ( Ae ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ag = clamp ( Ag , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Af",";"]}]},{a:"node",c:"MATH_COSINE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ah",i:["float"],g:!1},{a:"node_in",c:"Ai",i:["float"],g:!1},{a:"node_out",c:"Aj",i:["float"],g:!1}],u:[{a:"txt",b:"Aj = cos ( Ah ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],
u:[{a:"txt",b:"Aj = clamp ( Aj , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ai",";"]}]},{a:"node",c:"MATH_TANGENT",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ak",i:["float"],g:!1},{a:"node_in",c:"Al",i:["float"],g:!1},{a:"node_out",c:"Am",i:["float"],g:!1}],u:[{a:"txt",b:"Am = tan ( Ak ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Am = clamp ( Am , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Al",";"]}]},{a:"node",c:"MATH_ARCSINE",B:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"An",i:["float"],g:!1},{a:"node_in",c:"Ao",i:["float"],g:!1},{a:"node_out",c:"Ap",i:["float"],g:!1}],u:[{a:"txt",b:"Ap = ( An <= _1_0 && An >= - _1_0 ) ? asin ( An ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ao",";"]}]},{a:"node",c:"MATH_ARCCOSINE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Aq",i:["float"],g:!1},{a:"node_in",
c:"Ar",i:["float"],g:!1},{a:"node_out",c:"As",i:["float"],g:!1}],u:[{a:"txt",b:"As = ( Aq <= _1_0 && Aq >= - _1_0 ) ? acos ( Aq ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"As = clamp ( As , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ar",";"]}]},{a:"node",c:"MATH_ARCTANGENT",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"At",i:["float"],g:!1},{a:"node_in",c:"Au",i:["float"],g:!1},{a:"node_out",c:"Av",i:["float"],g:!1}],u:[{a:"txt",
b:"Av = atan ( At ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Av = clamp ( Av , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Au",";"]}]},{a:"node",c:"MATH_POWER",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Aw",i:["float"],g:!1},{a:"node_in",c:"Ax",i:["float"],g:!1},{a:"node_out",c:"Ay",i:["float"],g:!1}],u:[{a:"txt",b:"if ( Aw < _0_0 && Ax != floor ( Ax ) ) Ay = _0_0 ; else if ( Ax == _0_0 ) Ay = _1_0 ; else if ( Aw < _0_0 ) Ay = mix ( _1_0 , - _1_0 , sign ( mod ( - Ax , 2.0 ) ) ) * pow ( - Aw , Ax ) ; else if ( Aw == _0_0 ) Ay = _0_0 ; else Ay = pow ( Aw , Ax ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Az",i:["float"],g:!1},{a:"node_in",c:"AA",i:["float"],g:!1},{a:"node_out",c:"AB",i:["float"],g:!1}],u:[{a:"txt",b:"AB = ( Az > _0_0 && AA > _0_0 ) ? log2 ( Az ) / log2 ( AA ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AB = clamp ( AB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AC",i:["float"],g:!1},{a:"node_in",c:"AD",i:["float"],g:!1},{a:"node_out",c:"AE",i:["float"],g:!1}],u:[{a:"txt",b:"AE = min ( AC , AD ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AE = clamp ( AE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AF",i:["float"],g:!1},{a:"node_in",c:"AG",i:["float"],
g:!1},{a:"node_out",c:"AH",i:["float"],g:!1}],u:[{a:"txt",b:"AH = max ( AF , AG ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AH = clamp ( AH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AI",i:["float"],g:!1},{a:"node_in",c:"AJ",i:["float"],g:!1},{a:"node_out",c:"AK",i:["float"],g:!1}],u:[{a:"txt",b:"AK = floor ( AI + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],
u:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AL",i:["float"],g:!1},{a:"node_in",c:"AM",i:["float"],g:!1},{a:"node_out",c:"AN",i:["float"],g:!1}],u:[{a:"txt",b:"AN = ( AL < AM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AN = clamp ( AN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",B:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AO",i:["float"],g:!1},{a:"node_in",c:"AP",i:["float"],g:!1},{a:"node_out",c:"AQ",i:["float"],g:!1}],u:[{a:"txt",b:"AQ = ( AO > AP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AQ = clamp ( AQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AR",i:["float"],g:!1},{a:"node_in",c:"AS",i:["float"],g:!1},{a:"node_out",c:"AT",
i:["float"],g:!1}],u:[{a:"txt",b:"AT = abs ( AS ) > 0.000001 ? mod ( AR , AS ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AT = clamp ( AT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AU",i:["float"],g:!1},{a:"node_in",c:"AV",i:["float"],g:!1},{a:"node_out",c:"AW",i:["float"],g:!1}],u:[{a:"txt",b:"AW = abs ( AU ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],
u:[{a:"txt",b:"AW = clamp ( AW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AV",";"]}]},{a:"node",c:"MIX_RGB_MIX",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AX",i:["float"],g:!1},{a:"node_in",c:"AY",i:["vec3"],g:!1},{a:"node_in",c:"AZ",i:["vec3"],g:!1},{a:"node_out",c:"A_",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( AX , _0_0 , _1_0 ) ; A_ = mix ( AY , AZ , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"A_ = clamp ( A_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ba",i:["float"],g:!1},{a:"node_in",c:"Bb",i:["vec3"],g:!1},{a:"node_in",c:"Bc",i:["vec3"],g:!1},{a:"node_out",c:"Bd",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ba , _0_0 , _1_0 ) ; Bd = mix ( Bb , Bb + Bc , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",B:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Be",i:["float"],g:!1},{a:"node_in",c:"Bf",i:["vec3"],g:!1},{a:"node_in",c:"Bg",i:["vec3"],g:!1},{a:"node_out",c:"Bh",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Be , _0_0 , _1_0 ) ; Bh = mix ( Bf , Bf * Bg , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",
c:"Bi",i:["float"],g:!1},{a:"node_in",c:"Bj",i:["vec3"],g:!1},{a:"node_in",c:"Bk",i:["vec3"],g:!1},{a:"node_out",c:"Bl",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bi , _0_0 , _1_0 ) ; Bl = mix ( Bj , Bj - Bk , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Bm",i:["float"],g:!1},{a:"node_in",c:"Bn",
i:["vec3"],g:!1},{a:"node_in",c:"Bo",i:["vec3"],g:!1},{a:"node_out",c:"Bp",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bm , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; Bp = vec3 ( _1_0 ) - ( vec3 ( Bq ) + yI * ( vec3 ( _1_0 ) - Bo ) ) * ( vec3 ( _1_0 ) - Bn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Br",
i:["float"],g:!1},{a:"node_in",c:"Bs",i:["vec3"],g:!1},{a:"node_in",c:"Bt",i:["vec3"],g:!1},{a:"node_out",c:"Bu",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Br , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; Bt += step ( Bt , vec3 ( _0_0 ) ) ; Bu = Bq * Bs + yI * Bs / Bt ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",
c:"Bv",i:["float"],g:!1},{a:"node_in",c:"Bw",i:["vec3"],g:!1},{a:"node_in",c:"Bx",i:["vec3"],g:!1},{a:"node_out",c:"By",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bv , _0_0 , _1_0 ) ; By = mix ( Bw , abs ( Bw - Bx ) , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"By = clamp ( By , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Bz",i:["float"],g:!1},{a:"node_in",
c:"BA",i:["vec3"],g:!1},{a:"node_in",c:"BB",i:["vec3"],g:!1},{a:"node_out",c:"BC",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bz , _0_0 , _1_0 ) ; BC = min ( BA . rgb , BB . rgb * yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BC = clamp ( BC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BD",i:["float"],g:!1},{a:"node_in",c:"BE",i:["vec3"],g:!1},{a:"node_in",
c:"BF",i:["vec3"],g:!1},{a:"node_out",c:"BG",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BD , _0_0 , _1_0 ) ; BG = max ( BE . rgb , BF . rgb * yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BG = clamp ( BG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BH",i:["float"],g:!1},{a:"node_in",c:"BI",i:["vec3"],g:!1},{a:"node_in",c:"BJ",i:["vec3"],g:!1},{a:"node_out",
c:"BK",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BH , _0_0 , _1_0 ) ; vec3 BL = vec3 ( _1_0 - yI ) ; BK = mix ( BI * ( BL + 2.0 * yI * BJ ) , vec3 ( _1_0 ) - ( BL + 2.0 * yI * ( vec3 ( _1_0 ) - BJ ) ) * ( vec3 ( _1_0 ) - BI ) , step ( _0_5 , BI ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BK = clamp ( BK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BM",i:["float"],
g:!1},{a:"node_in",c:"BN",i:["vec3"],g:!1},{a:"node_in",c:"BO",i:["vec3"],g:!1},{a:"node_out",c:"BP",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BM , _0_0 , _1_0 ) ; vec3 BQ = vec3 ( _1_0 ) - yI * BO ; vec3 BR = clamp ( BN / BQ , _0_0 , _1_0 ) ; BP = mix ( mix ( BR , vec3 ( _1_0 ) , step ( BQ , vec3 ( _0_0 ) ) ) , BN , step ( BN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BP = clamp ( BP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BS",i:["float"],g:!1},{a:"node_in",c:"BT",i:["vec3"],g:!1},{a:"node_in",c:"BU",i:["vec3"],g:!1},{a:"node_out",c:"BV",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BS , _0_0 , _1_0 ) ; vec3 jC = vec3 ( _1_0 - yI ) ; vec3 BQ = jC + yI * BU ; vec3 BR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BT ) / BQ , _0_0 , _1_0 ) ; BV = mix ( BR , vec3 ( _0_0 ) , step ( BQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BV = clamp ( BV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BW",i:["float"],g:!1},{a:"node_in",c:"BX",i:["vec3"],g:!1},{a:"node_in",c:"BY",i:["vec3"],g:!1},{a:"node_out",c:"BZ",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BW , _0_0 , _1_0 ) ; vec3 ju , B_ , BQ ; BZ = BX ; B_ = jt ( BY ) ; if ( B_ . y != _0_0 ) { ju = jt ( BZ ) ; ju . x = B_ . x ; BQ = jv ( ju ) ; BZ = mix ( BZ , BQ , yI ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BZ = clamp ( BZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ca",i:["float"],g:!1},{a:"node_in",c:"Cb",i:["vec3"],g:!1},{a:"node_in",c:"Cc",i:["vec3"],g:!1},{a:"node_out",c:"Cd",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ca , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; Cd = Cb ; vec3 ju , B_ ; ju = jt ( Cd ) ; if ( ju . y != _0_0 ) { B_ = jt ( Cc ) ; ju . y = Bq * ju . y + yI * B_ . y ; Cd = jv ( ju ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cd = clamp ( Cd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ce",i:["float"],g:!1},{a:"node_in",c:"Cf",i:["vec3"],g:!1},{a:"node_in",c:"Cg",i:["vec3"],g:!1},{a:"node_out",c:"Ch",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ce , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; vec3 ju , B_ ; ju = jt ( Cf ) ; B_ = jt ( Cg ) ; ju . z = Bq * ju . z + yI * B_ . z ; Ch = jv ( ju ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Ch = clamp ( Ch , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ci",i:["float"],g:!1},{a:"node_in",c:"Cj",i:["vec3"],g:!1},{a:"node_in",c:"Ck",i:["vec3"],g:!1},{a:"node_out",c:"Cl",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ci , _0_0 , _1_0 ) ; vec3 ju , B_ , BQ ; Cl = Cj ; B_ = jt ( Ck ) ; if ( B_ . y != _0_0 ) { ju = jt ( Cl ) ; ju . x = B_ . x ; ju . y = B_ . y ; BQ = jv ( ju ) ; Cl = mix ( Cl , BQ , yI ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cl = clamp ( Cl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Cm",i:["float"],g:!1},{a:"node_in",c:"Cn",i:["vec3"],g:!1},{a:"node_in",c:"Co",i:["vec3"],g:!1},{a:"node_out",c:"Cp",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Cm , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; vec3 Cq = Co + Cn - Co * Cn ; Cp = Cn * ( vec3 ( Bq ) + vec3 ( yI ) * ( ( vec3 ( _1_0 ) - Cn ) * Co + Cq ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cp = clamp ( Cp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Cr",i:["float"],g:!1},{a:"node_in",c:"Cs",i:["vec3"],g:!1},{a:"node_in",c:"Ct",i:["vec3"],g:!1},{a:"node_out",c:"Cu",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Cr , _0_0 , _1_0 ) ; Cu = Cs + yI * ( 2.0 * Ct - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cu = clamp ( Cu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_WORLD_RGB",B:[],A:[{a:"node_in",c:"Cv",i:["float"],g:!1},{a:"node_in",c:"Cw",i:["vec3"],g:!1},{a:"node_in",c:"Cx",i:["vec3"],g:!1},{a:"node_out",c:"Cy",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Cv , _0_0 , _1_0 ) ; Cy = mix ( Cw , Cx , yI ) ;".split(" ")}]},{a:"node",c:"ADD_WORLD_RGB",B:[],A:[{a:"node_in",c:"Cz",i:["float"],g:!1},{a:"node_in",c:"CA",i:["vec3"],g:!1},{a:"node_in",
c:"CB",i:["vec3"],g:!1},{a:"node_out",c:"CC",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Cz , _0_0 , _1_0 ) ; CC = mix ( CA , CA + CB , yI ) ;".split(" ")}]},{a:"node",c:"OUTPUT",B:[],A:[{a:"node_in",c:"CD",i:["vec3"],g:!1},{a:"node_in",c:"CE",i:["float"],g:!1}],u:[{a:"txt",b:"D = CD ; H = CE ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",B:[],A:[{a:"node_in",c:"CF",i:["vec3"],g:!1}],u:[{a:"txt",b:"D = CF ; H = _1_0 ;".split(" ")}]},{a:"node",c:"OUTPUT_WORLD_SURFACE",B:[],A:[{a:"node_in",c:"CG",
i:["vec3"],g:!1}],u:[{a:"txt",b:"D = CG ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",B:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],A:[{a:"node_in",c:"CH",i:["vec3"],g:!1},{a:"node_in",c:"CI",i:["vec3"],g:!1},{a:"node_in",c:"CJ",i:["float"],g:!1},{a:"node_in",c:"CK",i:["vec3"],g:!0},{a:"node_in",c:"CL",i:["float"],g:!0},{a:"node_out",c:"CM",i:["vec3"],g:!1},
{a:"node_out",c:"CN",i:["vec3"],g:!1},{a:"node_out",c:"CO",i:["vec3"],g:!1},{a:"node_out",c:"CP",i:["vec3"],g:!1},{a:"node_out",c:"CQ",i:["vec3"],g:!1},{a:"node_out",c:"CR",i:["vec2"],g:!1},{a:"node_out",c:"CS",i:["vec2"],g:!1},{a:"node_out",c:"CT",i:["vec4"],g:!1},{a:"node_param",c:"ru",i:["const","vec2"],g:!1},{a:"node_param",c:"rv",i:["const","vec3"],g:!1}],u:[{a:"txt",b:"CO = clamp ( CH , _0_0 , _1_0 ) ; CP = rv [ 0 ] * clamp ( CI , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
j:["USE_MATERIAL_NORMAL"],u:[{a:"txt",b:"CQ = normalize ( CK ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:["CQ","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["SHADELESS_MAT",{a:"logic_negative_expr",o:1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MATERIAL_EXT"],u:[{a:"txt",b:"CM = CL * CO ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"CM = rH * CO ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_DIFFUSE"],u:[{a:"txt",b:["CO","*=","CJ",";"]}]}]},{a:"txt",b:"CN = rI * u_environment_energy * cn ( CQ ) ; CT = cq ( CO ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],u:[{a:"txt",b:"CR = vec2 ( ru [ 0 ] , ru [ 1 ] ) ; CS = vec2 ( rv [ 1 ] , rv [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["G","=","CT",";"]}]},{a:"node_else",u:[{a:"txt",b:"CM = vec3 ( _0_0 ) ; CN = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",B:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],A:[{a:"node_in",c:"CU",i:["vec4"],g:!1},
{a:"node_in",c:"CV",i:["vec3"],g:!1},{a:"node_in",c:"CW",i:["vec3"],g:!1},{a:"node_in",c:"CX",i:["float"],g:!0},{a:"node_in",c:"CY",i:["float"],g:!0},{a:"node_in",c:"CZ",i:["float"],g:!0},{a:"node_out",c:"C_",i:["vec3"],g:!0},{a:"node_out",c:"Da",i:["float"],g:!0},{a:"node_out",c:"Db",i:["vec3"],g:!0},{a:"node_out",c:"Dc",i:["vec3"],g:!0},{a:"node_out",c:"Dd",i:["vec3"],g:!0},{a:"node_param",c:"rw",i:["float"],g:!1},{a:"node_param",c:"rx",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_C_"],
u:[{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_DIFFUSE"],u:[{a:"txt",b:"C_ = CU . rgb ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"C_ = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",o:2},{a:"logical_and_expr",o:2}],u:[{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"cz ( C_ , nI , CW , CX , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"cz ( C_ , nI , CW , CX , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:["C_","+=","CV",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Db"],u:[{a:"txt",b:["Db","=","CW",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["MATERIAL_EXT"],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dc"],u:[{a:"txt",b:"Dc = CU . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dd"],u:[{a:"txt",b:["Dd","=","CV",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Da"],u:[{a:"txt",b:"Da = clamp ( CZ , _0_0 , _1_0 ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:"float t = max ( max ( CV . r , CV . g ) , CV . b ) * CY ; Da = clamp ( CZ * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Da"],u:[{a:"txt",b:"Da = clamp ( rw , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:"float t = max ( max ( CV . r , CV . g ) , CV . b ) * rx ; Da = rw * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:["E","=","CV",";"]}]},{a:"node_else",u:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","CW",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",B:[],A:[{a:"node_in",c:"nZ",i:["vec3"],g:!1},{a:"node_in",c:"n_",i:["vec3"],g:!1},{a:"node_in",c:"oa",i:["vec3"],g:!1},{a:"node_out",c:"ob",i:["vec4"],g:!1},{a:"node_out",c:"oc",i:["vec3"],g:!1}],u:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},
{a:"node",c:"LIGHTING_LAMP",B:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],A:[{a:"node_in",c:"od",i:["vec4"],g:!1},{a:"node_out",c:"oe",i:["vec3"],g:!1},{a:"node_out",c:"of",i:["vec2"],g:!1},{a:"node_out",c:"og",i:["vec3"],g:!1},{a:"node_out",
c:"oh",i:["float"],g:!1}],u:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","HEMI",{a:"equal_expr",o:2}],u:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",u:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",o:1},{a:"non_equal_expr",o:2}],
u:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2},"LAMP_TYPE","POINT",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aM = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aM * aM ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["LAMP_USE_SPHERE"],u:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aM , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",u:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"om",i:["vec3"],g:!1},{a:"node_in",c:"on",i:["vec2"],g:!1},{a:"node_in",c:"oo",i:["vec3"],g:!1},{a:"node_in",c:"op",i:["float"],g:!1},{a:"node_in",c:"oq",i:["vec2"],
g:!1},{a:"node_out",c:"or",i:["float"],g:!1}],u:[{a:"txt",b:["vec3","rf","=","oo",";"]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; rf = cross ( os , B . xyz ) ; rf = - normalize ( rf ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( rf , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"ou",i:["vec3"],g:!1},{a:"node_in",c:"ov",i:["vec2"],g:!1},{a:"node_in",c:"ow",i:["vec3"],g:!1},{a:"node_in",c:"ox",i:["float"],g:!1},{a:"node_out",c:"oy",i:["float"],g:!1}],u:[{a:"txt",b:["vec3","rf","=","ow",";"]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; rf = cross ( os , B . xyz ) ; rf = - normalize ( rf ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( rf , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oz",i:["vec3"],g:!1},{a:"node_in",c:"oA",i:["vec2"],g:!1},{a:"node_in",c:"oB",i:["vec3"],g:!1},{a:"node_in",c:"oC",i:["float"],g:!1},{a:"node_in",c:"oD",i:["vec2"],g:!1},{a:"node_out",c:"oE",i:["float"],g:!1}],u:[{a:"txt",b:["vec3","rf","=","oB",";"]},{a:"node_cond",
f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; rf = cross ( os , B . xyz ) ; rf = - normalize ( rf ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( rf , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( rf , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cp = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * rf ; vec3 oI = nI - oF * rf ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cp ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cp + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oO",i:["vec3"],g:!1},{a:"node_in",c:"oP",i:["vec2"],g:!1},{a:"node_in",c:"oQ",i:["vec3"],g:!1},{a:"node_in",c:"oR",i:["float"],g:!1},{a:"node_in",c:"oS",i:["vec2"],g:!1},{a:"node_out",c:"oT",i:["float"],g:!1}],u:[{a:"txt",b:["vec3","rf","=","oQ",";"]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; rf = cross ( os , B . xyz ) ; rf = - normalize ( rf ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( rf , oO ) + oR ; float oF = max ( dot ( rf , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oU",i:["vec3"],g:!1},{a:"node_in",c:"oV",i:["vec2"],g:!1},{a:"node_in",c:"oW",i:["vec3"],
g:!1},{a:"node_in",c:"oX",i:["float"],g:!1},{a:"node_in",c:"oY",i:["vec2"],g:!1},{a:"node_out",c:"oZ",i:["float"],g:!1}],u:[{a:"txt",b:["vec3","rf","=","oW",";"]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; rf = cross ( os , B . xyz ) ; rf = - normalize ( rf ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( rf , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pa",i:["vec3"],g:!1},{a:"node_in",c:"pb",i:["vec2"],g:!1},{a:"node_in",c:"pc",i:["vec3"],g:!1},{a:"node_in",c:"pd",i:["float"],g:!1},{a:"node_in",c:"pe",i:["vec2"],g:!1},{a:"node_out",c:"pf",i:["float"],g:!1}],u:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"ph",i:["vec3"],g:!1},{a:"node_in",c:"pi",i:["vec2"],g:!1},{a:"node_in",c:"pj",i:["vec3"],g:!1},{a:"node_in",c:"pk",i:["float"],g:!1},{a:"node_in",c:"pl",i:["vec2"],g:!1},{a:"node_out",c:"pm",i:["float"],g:!1}],u:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pn",i:["vec3"],g:!1},{a:"node_in",c:"po",i:["vec2"],g:!1},{a:"node_in",c:"pr",i:["vec3"],g:!1},{a:"node_in",c:"pu",i:["float"],g:!1},{a:"node_in",c:"pv",i:["vec2"],g:!1},{a:"node_out",c:"pw",i:["float"],g:!1}],u:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bx = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bx * bx ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pz",i:["vec3"],g:!1},{a:"node_in",c:"pA",i:["vec2"],g:!1},{a:"node_in",c:"pB",i:["vec3"],g:!1},{a:"node_in",c:"pC",i:["float"],g:!1},{a:"node_in",c:"pD",i:["vec2"],g:!1},{a:"node_out",c:"pE",i:["float"],
g:!1}],u:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bX = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float pF = dot ( bX , B . xyz ) ; float bx = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bx = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float bx = acos ( dot ( bX , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bx < pD [ 0 ] ) pE = _1_0 ; else if ( bx >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bx - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pG",i:["vec3"],g:!1},{a:"node_in",c:"pH",i:["vec2"],g:!1},{a:"node_in",c:"pI",i:["vec3"],g:!1},{a:"node_in",c:"pJ",i:["float"],g:!1},{a:"node_in",c:"pK",i:["vec2"],g:!1},{a:"node_out",c:"pL",i:["float"],g:!1}],u:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < _1_0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( _1_0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float px = _0_0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float di = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , di ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",B:[],A:[{a:"node_in",c:"pQ",i:["vec4"],g:!1},{a:"node_in",c:"pR",i:["vec3"],g:!1},{a:"node_in",c:"pS",i:["float"],g:!1},{a:"node_in",c:"pT",i:["float"],g:!1},{a:"node_in",c:"pU",i:["vec3"],g:!1},{a:"node_in",c:"pV",i:["vec3"],g:!1},{a:"node_in",c:"pW",i:["vec4"],g:!1},{a:"node_in",c:"pX",i:["vec3"],g:!1},{a:"node_in",c:"pY",i:["vec3"],g:!1},{a:"node_in",c:"pZ",i:["vec3"],g:!1},{a:"node_in",c:"p_",i:["float"],g:!1},{a:"node_out",c:"qa",i:["vec4"],g:!1},{a:"node_out",c:"qb",
i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NODE_B4W_TRANSLUCENCY"],u:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float De = pW . x ; float Df = pW . y ; float Dg = pW . z ; float Dh = pW . w ; float Di = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Dj = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Dk = pow ( Dj , Df ) ; qa = pQ + p_ * vec4 ( pZ * Di * pow ( pX , vec3 ( De ) ) , _1_0 ) ; qa += Dg * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Dh ) * p_ * vec4 ( pZ * Di * vec3 ( Dk ) , _1_0 ) ; } else { qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]},{a:"txt",b:"qb = pR + pZ * pY * pT ;".split(" ")}]},{a:"node",c:"RGB",B:[{a:"node_var",c:"RGB_IND",b:["0"]}],A:[{a:"node_out",c:"Dl",i:["vec3"],g:!1}],u:[{a:"txt",b:"Dl = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",B:[],A:[{a:"node_in",c:"Dm",i:["vec3"],g:!1},{a:"node_out",c:"Dn",i:["float"],g:!1}],u:[{a:"txt",b:"Dn = dot ( Dm , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",
B:[],A:[{a:"node_in",c:"Do",i:["vec3"],g:!1},{a:"node_out",c:"Dp",i:["float"],g:!0},{a:"node_out",c:"Dq",i:["float"],g:!0},{a:"node_out",c:"Dr",i:["float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dp"],u:[{a:"txt",b:"Dp = Do . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dq"],u:[{a:"txt",b:"Dq = Do . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dr"],u:[{a:"txt",b:"Dr = Do . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",B:[],A:[{a:"node_in",c:"Ds",i:["vec3"],
g:!1},{a:"node_out",c:"Dt",i:["float"],g:!0},{a:"node_out",c:"Du",i:["float"],g:!0},{a:"node_out",c:"Dv",i:["float"],g:!0}],u:[{a:"txt",b:"vec3 Dw = jt ( Ds ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dt"],u:[{a:"txt",b:"Dt = Dw . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Du"],u:[{a:"txt",b:"Du = Dw . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dv"],u:[{a:"txt",b:"Dv = Dw . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",B:[],A:[{a:"node_in",
c:"Dx",i:["float"],g:!1},{a:"node_in",c:"Dy",i:["float"],g:!1},{a:"node_in",c:"Dz",i:["float"],g:!1},{a:"node_out",c:"DA",i:["float"],g:!1}],u:[{a:"txt",b:"DA = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Dx - Dz ) * Dy ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",B:[],A:[{a:"node_in",c:"DB",i:["vec3"],g:!1},{a:"node_in",c:"DC",i:["float"],g:!1},{a:"node_out",c:"DD",i:["vec3"],g:!1}],u:[{a:"txt",b:"DD = DB ; if ( DD . x > _0_0 ) DD . x = pow ( DB . x , DC ) ; if ( DD . y > _0_0 ) DD . y = pow ( DB . y , DC ) ; if ( DD . z > _0_0 ) DD . z = pow ( DB . z , DC ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",B:[],A:[{a:"node_in",c:"DE",i:["vec3"],g:!1},{a:"node_out",c:"DF",i:["vec3"],g:!1}],u:[{a:"txt",b:"DF = max ( vec3 ( _0_0 ) , DE ) ; DF = pow ( DF , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",B:[],A:[{a:"node_in",c:"DG",i:["vec3"],g:!1},{a:"node_out",c:"DH",i:["vec3"],g:!1}],u:[{a:"txt",b:"DH = max ( vec3 ( _0_0 ) , DG ) ; DH = pow ( DH , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",B:[],A:[{a:"node_out",c:"DI",i:["vec3"],
g:!1},{a:"node_out",c:"DJ",i:["vec3"],g:!1},{a:"node_out",c:"DK",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DI"],u:[{a:"txt",b:"DI [ 2 ] = DI [ 1 ] = DI [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DJ"],u:[{a:"txt",b:"DJ [ 2 ] = DJ [ 1 ] = DJ [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DK"],u:[{a:"txt",b:["DK","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT_CUBE",B:[],A:[{a:"node_in",c:"DL",i:["vec3"],g:!1},
{a:"node_out",c:"DM",i:["vec3"],g:!0},{a:"node_out",c:"DN",i:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_CUBE_var_texture",i:["uniform","samplerCube"],g:!1}],u:[{a:"txt",b:"vec3 DO = vec3 ( DL . x , DL . y , DL . z ) ; vec4 zQ = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_CUBE_var_texture , DO ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DM"],u:[{a:"txt",b:"DM = zQ . xyz ; cg ( DM ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DN"],u:[{a:"txt",b:"DN = zQ . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR",B:[{a:"node_var",c:"USE_VECTOR_IN",b:["0"]}],A:[{a:"node_in",c:"DP",i:["vec3"],g:!1},{a:"node_out",c:"DQ",i:["vec3"],g:!1},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_VECTOR_IN"],u:[{a:"txt",b:"vec3 DR = normalize ( DP ) ;".split(" ")}]},{a:"node_elif",j:["IS_WORLD"],u:[{a:"txt",b:["vec3","DR","=","ry",";"]}]},{a:"node_else",u:[{a:"txt",b:["vec3",
"DR","=","nH",";"]}]}]},{a:"txt",b:"float dr = - atan ( DR . y , DR . x ) / ( 2.0 * M_PI ) + _0_5 ; float kd = atan ( DR . z , sqrt ( DR . x * DR . x + DR . y * DR . y ) ) / M_PI + _0_5 ; vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture , vec2 ( dr , kd ) ) ; DQ = zQ . xyz ; cg ( DQ ) ;".split(" ")}]},{a:"node",c:"TEXTURE_ENVIRONMENT_MIRROR_BALL",B:[{a:"node_var",c:"USE_VECTOR_IN",b:["0"]}],A:[{a:"node_in",c:"DS",i:["vec3"],g:!1},{a:"node_out",c:"DT",i:["vec3"],g:!1},
{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_VECTOR_IN"],u:[{a:"txt",b:"vec3 DR = normalize ( DS ) ;".split(" ")}]},{a:"node_elif",j:["IS_WORLD"],u:[{a:"txt",b:["vec3","DR","=","ry",";"]}]},{a:"node_else",u:[{a:"txt",b:["vec3","DR","=","nH",";"]}]}]},{a:"txt",b:"DR . y -= _1_0 ; float DU = 2.0 * sqrt ( max ( - _0_5 * DR . y , _0_0 ) ) ; if ( DU > _0_0 ) DR /= DU ; float dr = _0_5 * ( DR . x + _1_0 ) ; float kd = _0_5 * ( DR . z + _1_0 ) ; vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture , vec2 ( dr , kd ) ) ; DT = zQ . xyz ; cg ( DT ) ;".split(" ")}]},
{a:"node",c:"TEXTURE_COLOR",B:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],A:[{a:"node_in",c:"DV",i:["vec3"],g:!0},{a:"node_in",c:"DW",i:["vec3"],g:!0},{a:"node_in",c:"DX",i:["vec3"],g:!0},{a:"node_in",c:"DY",i:["vec3"],g:!0},{a:"node_out",c:"DZ",i:["vec3"],g:!0},{a:"node_out",c:"D_",i:["float"],g:!0},{a:"node_out",c:"Ea",i:["vec3"],g:!0},{a:"node_out",c:"Eb",i:["float"],
g:!0},{a:"node_out",c:"Ec",i:["vec3"],g:!0},{a:"node_out",c:"Ed",i:["float"],g:!0},{a:"node_out",c:"Ee",i:["vec3"],g:!0},{a:"node_out",c:"Ef",i:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_UV"],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DV ) ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DV . xy ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DZ"],u:[{a:"txt",b:"DZ = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","DZ",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_D_"],u:[{a:"txt",b:"D_ = zQ . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv2"],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_UV"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DW ) ) ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DW . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ea"],u:[{a:"txt",b:"Ea = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","Ea",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Eb"],u:[{a:"txt",b:"Eb = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv3"],u:[{a:"node_cond",f:[{a:"node_if",
j:["CONVERT_UV"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DX ) ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DX . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ec"],u:[{a:"txt",b:"Ec = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","Ec",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ed"],u:[{a:"txt",
b:"Ed = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv4"],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_UV"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DY ) ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , DY . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ee"],u:[{a:"txt",b:"Ee = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",
o:1}],u:[{a:"txt",b:["cg","(","Ee",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ef"],u:[{a:"txt",b:"Ef = zQ . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",B:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],A:[{a:"node_in",c:"Eg",i:["vec3"],g:!0},{a:"node_in",c:"Eh",i:["vec3"],g:!0},{a:"node_in",c:"Ei",i:["vec3"],g:!0},{a:"node_in",c:"Ej",i:["vec3"],g:!0},{a:"node_out",c:"Ek",i:["vec3"],g:!0},{a:"node_out",c:"El",
i:["float"],g:!0},{a:"node_out",c:"Em",i:["vec3"],g:!0},{a:"node_out",c:"En",i:["float"],g:!0},{a:"node_out",c:"Eo",i:["vec3"],g:!0},{a:"node_out",c:"Ep",i:["float"],g:!0},{a:"node_out",c:"Eq",i:["vec3"],g:!0},{a:"node_out",c:"Er",i:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Eg ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ek"],u:[{a:"txt",b:"Ek = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_El"],u:[{a:"txt",b:"El = zQ . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv2"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Eh ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Em"],u:[{a:"txt",b:"Em = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_En"],u:[{a:"txt",b:"En = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv3"],
u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Ei ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Eo"],u:[{a:"txt",b:"Eo = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ep"],u:[{a:"txt",b:"Ep = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv4"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Ej ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Eq"],
u:[{a:"txt",b:"Eq = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Er"],u:[{a:"txt",b:"Er = zQ . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",B:[{a:"node_var",c:"VALUE_ROW_IND",b:["0"]},{a:"node_var",c:"VALUE_COL_IND",b:["0"]}],A:[{a:"node_out",c:"Es",i:["float"],g:!1}],u:[{a:"txt",b:"Es = u_node_values [ VALUE_ROW_IND ] [ VALUE_COL_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",B:[],A:[{a:"node_in",c:"Et",i:["vec3"],g:!1},{a:"node_in",c:"Eu",
i:["vec3"],g:!1},{a:"node_out",c:"Ev",i:["vec3"],g:!1},{a:"node_out",c:"Ew",i:["float"],g:!0}],u:[{a:"txt",b:"Ev = Et + Eu ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ew"],u:[{a:"txt",b:"Ew = ( abs ( Ev [ 0 ] ) + abs ( Ev [ 1 ] ) + abs ( Ev [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",B:[],A:[{a:"node_in",c:"Ex",i:["vec3"],g:!1},{a:"node_in",c:"Ey",i:["vec3"],g:!1},{a:"node_out",c:"Ez",i:["vec3"],g:!1},{a:"node_out",c:"EA",i:["float"],g:!0}],u:[{a:"txt",b:"Ez = Ex - Ey ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EA"],u:[{a:"txt",b:"EA = ( abs ( Ez [ 0 ] ) + abs ( Ez [ 1 ] ) + abs ( Ez [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",B:[],A:[{a:"node_in",c:"EB",i:["vec3"],g:!1},{a:"node_in",c:"EC",i:["vec3"],g:!1},{a:"node_out",c:"ED",i:["vec3"],g:!1},{a:"node_out",c:"EE",i:["float"],g:!0}],u:[{a:"txt",b:"ED = EB + EC ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EE"],u:[{a:"txt",b:"EE = length ( ED ) ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",j:["USE_OUT_ED"],u:[{a:"txt",b:"ED = normalize ( ED ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",B:[],A:[{a:"node_in",c:"EF",i:["vec3"],g:!1},{a:"node_in",c:"EG",i:["vec3"],g:!1},{a:"node_out",c:"EH",i:["vec3"],g:!1},{a:"node_out",c:"EI",i:["float"],g:!0}],u:[{a:"txt",b:"EH = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EI"],u:[{a:"txt",b:"EI = dot ( EF , EG ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",B:[],A:[{a:"node_in",c:"EJ",
i:["vec3"],g:!1},{a:"node_in",c:"EK",i:["vec3"],g:!1},{a:"node_out",c:"EL",i:["vec3"],g:!1},{a:"node_out",c:"EM",i:["float"],g:!0}],u:[{a:"txt",b:"EL = cross ( EJ , EK ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EM"],u:[{a:"txt",b:"EM = length ( EL ) ; EL /= EM ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"EL = normalize ( EL ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",B:[],A:[{a:"node_in",c:"EN",i:["vec3"],g:!1},{a:"node_in",c:"EO",i:["vec3"],g:!1},{a:"node_out",c:"EP",
i:["vec3"],g:!1},{a:"node_out",c:"EQ",i:["float"],g:!0}],u:[{a:"txt",b:"EP = normalize ( EN ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EQ"],u:[{a:"txt",b:"EQ = length ( EN ) ;".split(" ")}]}]},{a:"txt",b:["EO",";"]}]},{a:"node",c:"FRESNEL",B:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],A:[{a:"node_in",c:"ER",i:["float"],g:!1},{a:"node_in",c:"ES",i:["vec3"],g:!1},{a:"node_out",c:"ET",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_FRESNEL_NORMAL"],u:[{a:"txt",b:"vec3 ce = normalize ( ES ) ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:["vec3","ce","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",o:2}],u:[{a:"txt",b:"vec3 zo = normalize ( nI ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:["vec3","zo","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float rh = max ( ER , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"rh = gl_FrontFacing == false ? rh : _1_0 / rh ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"rh = gl_FrontFacing ? rh : _1_0 / rh ;".split(" ")}]}]},{a:"txt",b:"ET = rj ( zo , ce , rh ) ;".split(" ")}]},{a:"node",c:"BACKGROUND",B:[],A:[{a:"node_in",c:"EU",i:["vec3"],g:!1},{a:"node_in",c:"EV",i:["float"],g:!1},{a:"node_out",c:"EW",i:["vec3"],g:!1}],u:[{a:"txt",b:"EW = EU * EV ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",B:[],A:[{a:"node_in",c:"EX",i:["vec3"],g:!1},{a:"node_in",c:"EY",i:["vec3"],g:!1},{a:"node_out",c:"EZ",i:["vec3"],g:!1}],u:[{a:"txt",b:"EZ = reflect ( _ ( u_view_tsr_inverse , EX ) , EY ) ;".split(" ")}]},
{a:"node",c:"B4W_REFLECT_WORLD",B:[],A:[{a:"node_in",c:"E_",i:["vec3"],g:!1},{a:"node_out",c:"Fa",i:["vec3"],g:!1}],u:[{a:"txt",b:"Fa = reflect ( - nI . xyz , E_ ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",B:[],A:[{a:"node_in",c:"Fb",i:["vec3"],g:!1},{a:"node_in",c:"Fc",i:["float"],g:!1},{a:"node_in",c:"Fd",i:["const","float"],g:!1},{a:"node_in",c:"Fe",i:["const","float"],g:!1},{a:"node_out",c:"Ff",i:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",i:["uniform","sampler2D"],g:!1}],
u:[{a:"txt",b:"float bA = length ( rG ) ; if ( bA < Fe ) { vec2 bN = rd ( Fb ) ; float bR = clamp ( _0_5 * ( Fe - bA ) , _0_0 , _1_0 ) ; float he = Fc * bR ; vec3 bT = normalize ( nI * rD ) ; float bU = _1_0 / Fd ; vec2 bV = bT . xy * he / ( Fd * bT . z ) ; float bW = _1_0 ; float bX = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bN ) . a ; for ( float bZ = 1.0 ; bZ <= Fd ; bZ ++ ) { if ( bX < bW ) { bW -= bU ; bN -= bV ; bX = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bN ) . a ; } } vec2 b_ = bN + bV ; float ca = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , b_ ) . a - ( bW + bU ) ; float cb = bX - bW ; float cc = cb / ( cb - ca ) ; bN = cc * b_ + ( _1_0 - cc ) * bN ; Ff = rc ( bN ) ; } else Ff = Fb ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",B:[],A:[{a:"node_in",c:"Fg",i:["vec3"],g:!1},{a:"node_out",c:"Fh",i:["vec3"],g:!1}],u:[{a:"txt",b:"Fh = clamp ( Fg , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",B:[],A:[{a:"node_in",c:"Fi",i:["vec3"],g:!1},{a:"node_in",c:"Fj",i:["float"],g:!1},{a:"node_out",c:"Fk",i:["vec3"],g:!1}],u:[{a:"txt",b:"Fk = q_ ( Fi , Fj ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",B:[],A:[{a:"node_in",c:"Fl",i:["float"],g:!1},{a:"node_in",c:"Fm",i:["float"],g:!1},{a:"node_in",
c:"Fn",i:["float"],g:!1},{a:"node_in",c:"Fo",i:["float"],g:!1},{a:"node_in",c:"Fp",i:["float"],g:!1},{a:"node_out",c:"Fq",i:["float"],g:!0},{a:"node_out",c:"Fr",i:["vec4"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Fq"],u:[{a:"txt",b:["Fq","=","Fl",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Fr"],u:[{a:"txt",b:"Fr = vec4 ( Fm , Fn , Fo , Fp ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",B:[],A:[{a:"node_out",c:"Fs",i:["float"],g:!1}],u:[{a:"txt",b:["Fs","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",B:[],A:[{a:"node_in",c:"Ft",i:["float"],g:!1},{a:"node_in",c:"Fu",i:["float"],g:!1},{a:"node_in",c:"Fv",i:["float"],g:!1},{a:"node_out",c:"Fw",i:["float"],g:!1}],u:[{a:"txt",b:"Fw = smoothstep ( Fu , Fv , Ft ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",B:[],A:[{a:"node_in",c:"Fx",i:["vec3"],g:!1},{a:"node_in",c:"Fy",i:["float"],g:!1}],u:[{a:"txt",b:"D = Fx ; H = Fy ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",B:[],A:[{a:"node_in",c:"Fz",i:["vec3"],g:!1},{a:"node_out",c:"FA",
i:["float"],g:!1}],u:[{a:"txt",b:"FA = ( Fz . r + Fz . g + Fz . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",B:[],A:[{a:"node_in",c:"FB",i:["float"],g:!1},{a:"node_out",c:"FC",i:["vec3"],g:!1}],u:[{a:"txt",b:"FC [ 0 ] = FB ; FC [ 1 ] = FB ; FC [ 2 ] = FB ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["IS_WORLD"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB",{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:"vec3 ry = - nI ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_GL"],l:{a:"grp",f:[{a:"txt",b:"vec3 nG = - nI ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_TEX_COORD_NO"],l:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","nI",
";"]}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_NO"],l:{a:"grp",f:[{a:"txt",b:["vec3","rz","=","nI",";"]}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:11}],l:{a:"grp",f:[{a:"txt",b:["vec3","rA","=","j",";"]},{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING",
"USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"rA = rA ; else rA = - rA ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_NORMAL_MAP"],l:{a:"grp",f:[{a:"txt",b:["vec3","rB","=","rA",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING",
"USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:"vec3 rC = normalize ( rA ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING"],l:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","rC",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 nH = normalize ( j ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_NO"],l:{a:"grp",f:[{a:"txt",b:["vec3","rz","=","rC",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],
l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( rC , k . xyz ) * k . w ; mat3 rD = mat3 ( k . xyz , W , rC ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_NORMAL_MAP"],l:{a:"grp",f:[{a:"txt",b:"vec3 rE = cross ( rA , k . xyz ) * k . w ; mat3 rF = mat3 ( k . xyz , rE , rA ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rG = i ; float rH = u_emit ; float rI = u_ambient ;".split(" ")}]}}]},
{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLV",l:{a:"grp",f:[{a:"define",c:"NODES_GLSLV",b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:2},"PARTICLE_BATCH",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qX ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",
B:[],A:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",i:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rs",i:["GLSL_OUT","vec2"],g:!1}],u:[{a:"txt",b:["rs","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{a:"node",c:"UV_MERGED",B:[],A:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",i:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rq",i:["GLSL_OUT","vec2"],g:!1}],u:[{a:"txt",b:["rq","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",B:[],A:[{a:"node_param",c:"node_UVMAP_var_a_uv",i:["GLSL_IN","vec2"],g:!1},
{a:"node_param",c:"rt",i:["GLSL_OUT","vec2"],g:!1}],u:[{a:"txt",b:["rt","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",B:[],A:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",i:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rk",i:["GLSL_OUT","vec2"],g:!1}],u:[{a:"txt",b:["rk","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",B:[],A:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",i:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"FD",i:["GLSL_OUT","vec3"],g:!1}],u:[{a:"txt",
b:["FD","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",B:[],A:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",i:["GLSL_IN","float"],g:!1},{a:"node_param",c:"FE",i:["GLSL_OUT","float"],g:!1}],u:[{a:"txt",b:["FE","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",B:[],A:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",i:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"FF",i:["GLSL_OUT","vec2"],g:!1}],u:[{a:"txt",b:["FF","=","node_GEOMETRY_VC2_var_a_vertex_color",
";"]}]},{a:"node",c:"GEOMETRY_VC3",B:[],A:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",i:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"FG",i:["GLSL_OUT","vec3"],g:!1}],u:[{a:"txt",b:["FG","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["qX","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};
a["include/pack.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PACK_GLSLF",l:{a:"grp",f:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 dN ( const in float hu ) { vec4 eO = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 FH = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iM = fract ( hu * eO ) ; iM -= iM . xxyz * FH ; return iM ; } float cF ( const in vec4 FI ) { float dM ; vec4 eO = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; dM = dot ( FI , eO ) ; return dM ; } vec4 dN ( const in vec2 qo ) { vec2 eO = vec2 ( _255_0 , _1_0 ) ; vec2 FH = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iM = fract ( qo . xxyy * eO . xyxy ) ; iM -= iM . xxzz * FH . xyxy ; if ( qo . r == _1_0 ) iM . rg = vec2 ( _0_0 , _1_0 ) ; if ( qo . g == _1_0 ) iM . ba = vec2 ( _0_0 , _1_0 ) ; return iM ; } vec2 ir ( const in vec4 FJ ) { vec2 qo ; vec2 eO = vec2 ( _1_0 / _255_0 , _1_0 ) ; qo . r = dot ( FJ . rg , eO ) ; qo . g = dot ( FJ . ba , eO ) ; return qo ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_GLSLV",l:{a:"grp",f:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",D:"math.glslv"},{a:"txt",b:"struct cN { float cV ; vec3 O ; float J ; vec3 aQ ; float bx ; vec3 da ; vec3 db ; float dc ; } ;".split(" ")},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",0,{a:"g_expr",o:2}],
l:{a:"grp",f:[{a:"txt",b:"void FN ( inout vec3 aQ , float FK , vec4 jn , vec4 jo ) { float FL = jo . x - jn . x ; float FM = ( FK - jn . x ) / FL ; aQ = mix ( aQ , jo . yzw , clamp ( FM , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 FQ ( float t , float FO , vec4 FP [ COLOR_RAMP_LENGTH ] ) { float FK = t / FO ; vec3 aQ = FP [ 0 ] . yzw ;".split(" ")},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",1,{a:"g_expr",o:2}],
l:{a:"grp",f:[{a:"txt",b:"FN ( aQ , FK , FP [ 0 ] , FP [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",2,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"FN ( aQ , FK , FP [ 1 ] , FP [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",3,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"FN ( aQ , FK , FP [ 2 ] , FP [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aQ",";","}"]}]}}]},{a:"txt",b:"float FW ( float t , float FO , float FR , float FS ) { float FT = max ( 0.01 , min ( FO , FR ) ) ; float FU = max ( 0.01 , min ( FO , FS ) ) ; float FV = FO - FU ; float J = clamp ( t / FT , 0.0 , 1.0 ) - step ( FV , t ) * ( t - FV ) / FU ; return J ; } cN cO ( ) { cN sp ; float t ; float FO = a_p_data [ 0 ] ; float FX = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - FX ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - FX ; } if ( t < 0.0 || t >= FO ) { sp . cV = 0.0001 ; sp . O = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= FO ) ) { vec4 S = R ( a_tbn ) ; vec3 bJ = T ( S , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["WORLD_SPACE"],l:{a:"grp",f:[{a:"txt",b:"vec3 eL = a_position ; vec3 rf = bJ ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 eL = ap ( u_model_tsr , a_position ) ; vec3 rf = _ ( u_model_tsr , bJ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 FY = u_p_nfactor * rf ; FY += a_p_vels . xyz ; FY . z -= u_p_gravity * t / 2.0 ; float FZ = max ( u_p_mass , EPSILON ) ; FY += ( u_p_wind_fac * u_wind / FZ ) * t / 2.0 ; sp . dc = t ; sp . da = FY ; sp . db = bJ * a_p_vels . w ; sp . O = eL + FY * t ; sp . bx = a_p_vels . w * t ;".split(" ")},
{a:"cond",f:[{a:"if",j:["USE_COLOR_RAMP"],l:{a:"grp",f:[{a:"txt",b:"sp . cV = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"sp . cV = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["COLOR_RAMP_LENGTH",0,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"sp . aQ = FQ ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"sp . aQ = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = FW ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",l:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",f:[{a:"if",j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",o:2}],l:{a:"grp",
f:[{a:"include",D:"environment.glslf"}]}}]},{a:"include",D:"color_util.glslf"},{a:"include",D:"math.glslv"},{a:"cond",f:[{a:"if",j:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:"vec3 jt ( vec3 rgb ) { vec4 js = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , js . wz ) , vec4 ( rgb . gb , js . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dn = q . x - min ( q . w , q . y ) ; float hK = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dn + hK ) ) , dn / ( q . x + hK ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",o:6}],l:{a:"grp",f:[{a:"txt",b:"vec3 jv ( vec3 ju ) { vec4 js = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( ju . r , ju . r , ju . r ) + js . xyz ) * 6.0 - js . www ) ; return ju . b * mix ( js . xxx , clamp ( p - js . xxx , _0_0 , _1_0 ) , ju . g ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",j:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"vec3 rc ( vec2 gq ) { return vec3 ( gq * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"txt",b:"vec2 rd ( vec3 qo ) { return vec2 ( qo . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
B:[],A:[{a:"node_out",c:"rJ",i:["vec3"],g:!0},{a:"node_out",c:"rK",i:["float"],g:!0},{a:"node_out",c:"rL",i:["float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_rJ"],u:[{a:"txt",b:"rJ = normalize ( rG . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_rK"],u:[{a:"txt",b:"rK = abs ( rG . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_rL"],u:[{a:"txt",b:"rL = length ( rG . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",B:[],A:[{a:"node_in",c:"rM",i:["float"],
g:!1},{a:"node_in",c:"rN",i:["float"],g:!1},{a:"node_in",c:"rO",i:["float"],g:!1},{a:"node_out",c:"rP",i:["vec3"],g:!1}],u:[{a:"txt",b:"rP = vec3 ( rM , rN , rO ) ;".split(" ")}]},{a:"node",c:"COMBHSV",B:[],A:[{a:"node_in",c:"rQ",i:["float"],g:!1},{a:"node_in",c:"rR",i:["float"],g:!1},{a:"node_in",c:"rS",i:["float"],g:!1},{a:"node_out",c:"rT",i:["vec3"],g:!1}],u:[{a:"txt",b:"rT = jv ( vec3 ( rQ , rR , rS ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",B:[],A:[{a:"node_out",c:"rU",i:["vec3"],g:!1}],u:[{a:"txt",
b:"rU = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",B:[],A:[{a:"node_out",c:"rV",i:["vec3"],g:!1}],u:[{a:"txt",b:"rV = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",B:[],A:[{a:"node_out",c:"rW",i:["vec3"],g:!1}],u:[{a:"txt",b:"rW = rc ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",B:[],A:[{a:"node_out",c:"rX",i:["vec3"],g:!1}],u:[{a:"txt",b:"rX = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",B:[],A:[{a:"node_out",c:"rY",
i:["vec3"],g:!1}],u:[{a:"txt",b:"rY = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",B:[],A:[{a:"node_out",c:"rZ",i:["float"],g:!1}],u:[{a:"txt",b:["rZ","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",B:[],A:[{a:"node_out",c:"r_",i:["float"],g:!1},{a:"node_out",c:"sa",i:["float"],g:!1}],u:[{a:"txt",b:"r_ = _1_0 ; sa = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",B:[],A:[{a:"node_out",c:"sb",i:["float"],g:!1},{a:"node_out",c:"sc",i:["float"],g:!1},{a:"node_out",c:"sd",i:["float"],g:!1}],
u:[{a:"txt",b:"sb = _1_0 ; sc = _1_0 ; sd = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"se",i:["vec3"],g:!1},{a:"node_out",c:"sf",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["sf","=","se",";"]}]},{a:"node_else",u:[{a:"txt",b:"sf = rz . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",B:[],A:[{a:"node_out",c:"sg",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",o:2}],u:[{a:"txt",b:"sg = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"sg = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",B:[],A:[{a:"node_out",c:"si",i:["vec3"],g:!1}],u:[{a:"txt",b:"si = - _ ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",B:[],A:[{a:"node_out",c:"sj",i:["vec3"],g:!1}],u:[{a:"txt",b:"sj [ 0 ] = rG [ 0 ] ; sj [ 1 ] = rG [ 1 ] ; sj [ 2 ] = rG [ 2 ] ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",B:[],A:[{a:"node_out",c:"sk",i:["vec3"],g:!1}],u:[{a:"txt",b:"sk = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",B:[],A:[{a:"node_out",c:"sm",i:["vec3"],g:!1},{a:"node_out",c:"sn",i:["vec3"],g:!1},{a:"node_out",c:"so",i:["vec3"],g:!1},{a:"node_out",c:"sr",i:["vec3"],g:!1},{a:"node_out",c:"su",i:["vec3"],g:!1},{a:"node_out",c:"sv",i:["vec3"],g:!1},{a:"node_out",c:"sw",i:["float"],g:!1},{a:"node_out",c:"sx",i:["float"],g:!1}],u:[{a:"txt",b:"sm = vec3 ( _0_0 ) ; sn = vec3 ( _0_0 ) ; so = vec3 ( _0_0 ) ; sr = vec3 ( _0_0 ) ; su = vec3 ( _0_0 ) ; sv = vec3 ( _0_0 ) ; sw = _0_0 ; sx = _0_0 ;".split(" ")}]},
{a:"node",c:"HUE_SAT",B:[],A:[{a:"node_in",c:"sy",i:["float"],g:!1},{a:"node_in",c:"sz",i:["float"],g:!1},{a:"node_in",c:"sA",i:["float"],g:!1},{a:"node_in",c:"sB",i:["float"],g:!1},{a:"node_in",c:"sC",i:["vec3"],g:!1},{a:"node_out",c:"sD",i:["vec3"],g:!1}],u:[{a:"txt",b:"vec3 ju = jt ( sC ) ; ju [ 0 ] += ( sy - _0_5 ) ; if ( ju [ 0 ] > _1_0 ) ju [ 0 ] -= _1_0 ; else if ( ju [ 0 ] < _0_0 ) ju [ 0 ] += _1_0 ; ju *= vec3 ( _1_0 , sz , sA ) ; ju = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , ju , step ( vec3 ( _0_0 ) , ju ) ) , step ( ju , vec3 ( _1_0 ) ) ) ; sD = mix ( sC , jv ( ju ) , sB ) ;".split(" ")}]},
{a:"node",c:"INVERT",B:[],A:[{a:"node_in",c:"sE",i:["float"],g:!1},{a:"node_in",c:"sF",i:["vec3"],g:!1},{a:"node_out",c:"sG",i:["vec3"],g:!1}],u:[{a:"txt",b:"sG = mix ( sF , vec3 ( _1_0 ) - sF , sE ) ;".split(" ")}]},{a:"node",c:"LAMP",B:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],A:[{a:"node_out",
c:"sH",i:["vec3"],g:!0},{a:"node_out",c:"sI",i:["vec3"],g:!1},{a:"node_out",c:"sJ",i:["float"],g:!1},{a:"node_out",c:"sK",i:["float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sH"],u:[{a:"txt",b:"sH = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sL = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sM = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2},"LAMP_TYPE","POINT",{a:"equal_expr",
o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"sI = - h + sM ; sJ = length ( sI ) ; sI = normalize ( sI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sK"],u:[{a:"txt",b:"sK = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sJ * sJ ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"float ol = dot ( sI , sL ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sK *= ol ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",
j:["LAMP_USE_SPHERE"],u:[{a:"txt",b:"sK *= max ( LAMP_LIGHT_DIST - sJ , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sI"],u:[{a:"txt",b:["sI","=","sL",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sJ"],u:[{a:"txt",b:"sJ = length ( sM - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sK"],u:[{a:"txt",b:["sK","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",B:[],A:[{a:"node_in",c:"sN",i:["vec3"],g:!1},{a:"node_out",
c:"sO",i:["vec3"],g:!0},{a:"node_out",c:"sP",i:["float"],g:!0},{a:"node_param",c:"rp",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sO"],u:[{a:"txt",b:["sO","=","rp",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_sP"],u:[{a:"txt",b:"sP = - dot ( sN , rp ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",B:[],A:[{a:"node_in",c:"sQ",i:["vec3"],g:!1},{a:"node_out",c:"sR",i:["vec3"],g:!1}],u:[{a:"txt",b:"sR = - _ ( u_view_tsr_frag , sQ ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
B:[],A:[{a:"node_in",c:"sS",i:["vec3"],g:!1},{a:"node_in",c:"sT",i:["vec3"],g:!1},{a:"node_in",c:"sU",i:["float"],g:!1},{a:"node_in",c:"sV",i:["vec3"],g:!1},{a:"node_in",c:"sW",i:["float"],g:!1},{a:"node_in",c:"sX",i:["float"],g:!1},{a:"node_in",c:"sY",i:["vec3"],g:!1},{a:"node_in",c:"sZ",i:["vec3"],g:!1},{a:"node_in",c:"s_",i:["float"],g:!1},{a:"node_in",c:"ta",i:["vec3"],g:!1},{a:"node_in",c:"tb",i:["float"],g:!1},{a:"node_out",c:"tc",i:["vec3"],g:!1},{a:"node_out",c:"td",i:["vec3"],g:!1},{a:"node_out",
c:"te",i:["vec3"],g:!1},{a:"node_out",c:"tf",i:["vec3"],g:!1},{a:"node_out",c:"tg",i:["vec3"],g:!1},{a:"node_out",c:"th",i:["vec4"],g:!1},{a:"node_out",c:"ti",i:["vec4"],g:!1},{a:"node_out",c:"tj",i:["vec3"],g:!1},{a:"node_out",c:"tk",i:["vec3"],g:!1},{a:"node_out",c:"tl",i:["vec3"],g:!1},{a:"node_out",c:"tm",i:["float"],g:!1},{a:"node_out",c:"tn",i:["vec3"],g:!1},{a:"node_out",c:"to",i:["float"],g:!1}],u:[{a:"txt",b:"te = sT ; tf = sV ; tg = sY ; tj = sT ; tk = sV ; metalness_out = sX ; tl = sZ ; tm = s_ ; tn = ta ; to = tb ; tc = rH * te ; td = rI * u_environment_energy * cn ( tg ) ; ti = cq ( te ) ; G = ti ; th [ 0 ] = sU ; th [ 1 ] = sW ; th [ 2 ] = sX ;".split(" ")}]},
{a:"node",c:"BSDF_END",B:[],A:[{a:"node_in",c:"tr",i:["vec4"],g:!1},{a:"node_in",c:"tu",i:["vec3"],g:!1},{a:"node_in",c:"tv",i:["vec3"],g:!1},{a:"node_in",c:"tw",i:["vec4"],g:!1},{a:"node_in",c:"tx",i:["vec3"],g:!1},{a:"node_in",c:"ty",i:["vec3"],g:!1},{a:"node_in",c:"tz",i:["vec3"],g:!1},{a:"node_in",c:"tA",i:["float"],g:!1},{a:"node_in",c:"tB",i:["vec3"],g:!1},{a:"node_in",c:"tA",i:["float"],g:!1},{a:"node_in",c:"tC",i:["float"],g:!1},{a:"node_out",c:"tD",i:["vec3"],g:!1}],u:[{a:"txt",b:"tD = tr . rgb + tu ; tD = mix ( tD , tz , tA ) ; H = _1_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_NODE_BSDF_TRANSPARENT"],u:[{a:"txt",b:"vec3 tF = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; cg ( tF ) ; tB = tB * tF ; tD += tB ;".split(" ")}]}]},{a:"txt",b:["tv",";"]}]},{a:"node",c:"BSDF_COMPUTE",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"tG",i:["vec3"],g:!1},{a:"node_in",c:"tH",i:["vec2"],g:!1},{a:"node_in",c:"tI",i:["vec3"],g:!1},{a:"node_in",c:"tJ",i:["float"],g:!1},{a:"node_in",c:"tK",i:["vec4"],g:!1},{a:"node_out",
c:"tL",i:["float"],g:!1},{a:"node_out",c:"tM",i:["float"],g:!1}],u:[{a:"txt",b:"vec3 rf = tI ; float tN = clamp ( tK [ 0 ] , _0_0 , _1_0 ) ; float tE = clamp ( tK [ 1 ] , _0_0 , _1_0 ) ; float qO = tK [ 2 ] ; vec3 pg = normalize ( nI + tG ) ; float ot = ( _1_0 - tJ ) * dot ( rf , tG ) + tJ ; float tO = ( _1_0 - tJ ) * max ( dot ( tG , pg ) , _0_0 ) + tJ ; float tP = ( _1_0 - tJ ) * max ( dot ( tI , pg ) , _0_0 ) + tJ ; tL = _0_0 ; if ( tH . r != _0_0 ) { if ( tN > _0_0 ) { float oF = max ( dot ( rf , nI ) , _0_0 ) ; float oG = tN * tN ; float cp = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = tG - ot * rf ; vec3 oI = nI - oF * rf ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) tL = ot * cp ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; tL = ot * ( cp + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else tL = ot ; tL = max ( tL , _0_0 ) ; } float J = tE ; float tQ = J * J ; float tR = ( tP * tQ - tP ) * tP + _1_0 ; float cm = tQ / ( M_PI * tR * tR ) ; float tS ; float tT ; float tU = pow ( _1_0 - tO , 5.0 ) ; tS = _1_0 ; tT = tU ; float js = J / 2.0 ; float tV = js * js ; float tW = _1_0 - tV ; float tX = _1_0 / ( tO * tO * tW + tV ) ; tS *= tX ; tT *= tX ; float tY = mix ( 0.04 , _1_0 , qO ) ; float tZ = mix ( tT , tS , tY ) ; tM = max ( ot * cm * tZ , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",B:[],A:[{a:"node_in",c:"t_",i:["vec3"],g:!1},{a:"node_in",c:"ua",i:["float"],g:!1},{a:"node_in",c:"ub",i:["float"],g:!1},{a:"node_in",c:"uc",i:["float"],g:!1},{a:"node_in",c:"ud",i:["vec3"],g:!1},{a:"node_in",c:"ue",i:["vec3"],g:!1},{a:"node_out",c:"uf",i:["vec3"],g:!1}],u:[{a:"txt",b:"uf = t_ ; ua ; ub ; uc ; ud ; ue ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"ug",i:["vec3"],g:!1},{a:"node_in",c:"uh",i:["float"],
g:!1},{a:"node_in",c:"ui",i:["vec3"],g:!1},{a:"node_out",c:"uj",i:["vec3"],g:!1},{a:"node_out",c:"uk",i:["vec3"],g:!1},{a:"node_out",c:"ul",i:["float"],g:!1},{a:"node_out",c:"um",i:["vec3"],g:!1},{a:"node_out",c:"un",i:["float"],g:!1},{a:"node_out",c:"uo",i:["float"],g:!1},{a:"node_out",c:"up",i:["vec3"],g:!1},{a:"node_out",c:"uq",i:["vec3"],g:!1},{a:"node_out",c:"ur",i:["float"],g:!1},{a:"node_out",c:"us",i:["vec3"],g:!1},{a:"node_out",c:"ut",i:["float"],g:!1}],u:[{a:"txt",b:"uk = ug ; ul = uh ; uo = _0_0 ; ur = _0_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["up","=","ui",";"]}]},{a:"node_else",u:[{a:"txt",b:["up","=","nH",";"]}]}]},{a:"txt",b:"uj ; um ; un ; uq ; us ; ut ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",B:[],A:[{a:"node_in",c:"uu",i:["vec3"],g:!1},{a:"node_in",c:"uv",i:["float"],g:!1},{a:"node_in",c:"uw",i:["float"],g:!1},{a:"node_in",c:"ux",i:["vec3"],g:!1},{a:"node_out",c:"uy",i:["vec3"],g:!1}],u:[{a:"txt",b:"uy = uu ; uv ; uw ; ux ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",
B:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"uz",i:["vec3"],g:!1},{a:"node_in",c:"uA",i:["float"],g:!1},{a:"node_in",c:"uB",i:["vec3"],g:!1},{a:"node_out",c:"uC",i:["vec3"],g:!1},{a:"node_out",c:"uD",i:["vec3"],g:!1},{a:"node_out",c:"uE",i:["float"],g:!1},{a:"node_out",c:"uF",i:["vec3"],g:!1},{a:"node_out",c:"uG",i:["float"],g:!1},{a:"node_out",c:"uH",i:["float"],g:!1},{a:"node_out",c:"uI",i:["vec3"],g:!1},{a:"node_out",c:"uJ",i:["vec3"],g:!1},{a:"node_out",c:"uK",i:["float"],g:!1},
{a:"node_out",c:"uL",i:["vec3"],g:!1},{a:"node_out",c:"uM",i:["float"],g:!1}],u:[{a:"txt",b:"uF = uz ; uG = uA ; uH = _1_0 ; uK = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["uI","=","uB",";"]}]},{a:"node_else",u:[{a:"txt",b:["uI","=","nH",";"]}]}]},{a:"txt",b:"uC ; uD ; uE ; uJ ; uL ; uM ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",B:[],A:[{a:"node_in",c:"uN",i:["vec3"],g:!1},{a:"node_in",c:"uO",i:["float"],g:!1},{a:"node_in",c:"uP",i:["float"],g:!1},{a:"node_in",
c:"uQ",i:["float"],g:!1},{a:"node_out",c:"uR",i:["vec3"],g:!1}],u:[{a:"txt",b:"uR = uN ; uO ; uP ; uQ ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",B:[],A:[{a:"node_in",c:"uS",i:["vec3"],g:!1},{a:"node_out",c:"uT",i:["vec3"],g:!1},{a:"node_out",c:"uU",i:["vec3"],g:!1},{a:"node_out",c:"uV",i:["float"],g:!1},{a:"node_out",c:"uW",i:["vec3"],g:!1},{a:"node_out",c:"uX",i:["float"],g:!1},{a:"node_out",c:"uY",i:["float"],g:!1},{a:"node_out",c:"uZ",i:["vec3"],g:!1},{a:"node_out",c:"u_",i:["vec3"],g:!1},
{a:"node_out",c:"va",i:["float"],g:!1},{a:"node_out",c:"vb",i:["vec3"],g:!1},{a:"node_out",c:"vc",i:["float"],g:!1}],u:[{a:"txt",b:"vb = uS ; uY = _0_0 ; va = _0_0 ; vc = _0_0 ; uZ = nH ; uT ; uU ; uV ; uW ; uX ; u_ ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",B:[],A:[{a:"node_in",c:"vd",i:["vec3"],g:!1},{a:"node_in",c:"ve",i:["vec3"],g:!1},{a:"node_out",c:"vf",i:["vec3"],g:!1}],u:[{a:"txt",b:"vf = vd ; ve ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",B:[],A:[{a:"node_in",c:"vg",i:["vec3"],g:!1},
{a:"node_in",c:"vh",i:["float"],g:!1},{a:"node_in",c:"vi",i:["float"],g:!1},{a:"node_in",c:"vj",i:["vec3"],g:!1},{a:"node_out",c:"vk",i:["vec3"],g:!1}],u:[{a:"txt",b:"vk [ 0 ] = vk [ 1 ] = vk [ 2 ] = _0_0 ; vg ; vh ; vi ; vj ;".split(" ")}]},{a:"node",c:"BSDF_TOON",B:[],A:[{a:"node_in",c:"vl",i:["vec3"],g:!1},{a:"node_in",c:"vm",i:["float"],g:!1},{a:"node_in",c:"vn",i:["float"],g:!1},{a:"node_in",c:"vo",i:["vec3"],g:!1},{a:"node_out",c:"vp",i:["vec3"],g:!1}],u:[{a:"txt",b:"vp = vl ; vm ; vn ; vo ;".split(" ")}]},
{a:"node",c:"BSDF_VELVET",B:[],A:[{a:"node_in",c:"vq",i:["vec3"],g:!1},{a:"node_in",c:"vr",i:["float"],g:!1},{a:"node_in",c:"vs",i:["vec3"],g:!1},{a:"node_out",c:"vt",i:["vec3"],g:!1}],u:[{a:"txt",b:"vt = vq ; vr ; vs ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",B:[],A:[{a:"node_in",c:"vu",i:["vec3"],g:!1},{a:"node_in",c:"vv",i:["float"],g:!1},{a:"node_in",c:"vw",i:["vec3"],g:!1},{a:"node_in",c:"vx",i:["float"],g:!1},{a:"node_in",c:"vy",i:["float"],g:!1},{a:"node_in",c:"vz",i:["vec3"],g:!1},
{a:"node_out",c:"vA",i:["vec3"],g:!1}],u:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vu ; vw ; vx ; vy ; vz ; vv ;".split(" ")}]},{a:"node",c:"EMISSION",B:[],A:[{a:"node_in",c:"vB",i:["vec3"],g:!1},{a:"node_in",c:"vC",i:["float"],g:!1},{a:"node_out",c:"vD",i:["vec3"],g:!1},{a:"node_out",c:"vE",i:["vec3"],g:!1},{a:"node_out",c:"vF",i:["float"],g:!1},{a:"node_out",c:"vG",i:["vec3"],g:!1},{a:"node_out",c:"vH",i:["float"],g:!1},{a:"node_out",c:"vI",i:["float"],g:!1},{a:"node_out",c:"vJ",i:["vec3"],
g:!1},{a:"node_out",c:"vK",i:["vec3"],g:!1},{a:"node_out",c:"vL",i:["float"],g:!1},{a:"node_out",c:"vM",i:["vec3"],g:!1},{a:"node_out",c:"vN",i:["float"],g:!1}],u:[{a:"txt",b:"vK = vC * vB ; vI = _0_0 ; vL = _1_0 ; vJ = nH ; vD ; vE ; vF ; vG ; vH ; vM ; vN ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",B:[],A:[{a:"node_in",c:"vO",i:["vec3"],g:!1},{a:"node_out",c:"vP",i:["vec3"],g:!1}],u:[{a:"txt",b:"vP [ 0 ] = vP [ 1 ] = vP [ 2 ] = _0_0 ; vO ;".split(" ")}]},{a:"node",c:"HOLDOUT",B:[],A:[{a:"node_out",
c:"vQ",i:["vec3"],g:!1}],u:[{a:"txt",b:"vQ [ 0 ] = vQ [ 1 ] = vQ [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",B:[],A:[{a:"node_in",c:"vR",i:["vec3"],g:!1},{a:"node_in",c:"vS",i:["float"],g:!1},{a:"node_out",c:"vT",i:["vec3"],g:!1}],u:[{a:"txt",b:"vT [ 0 ] = vT [ 1 ] = vT [ 2 ] = _0_0 ; vR ; vS ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",B:[],A:[{a:"node_in",c:"vU",i:["vec3"],g:!1},{a:"node_in",c:"vV",i:["float"],g:!1},{a:"node_in",c:"vW",i:["float"],g:!1},{a:"node_out",c:"vX",i:["vec3"],
g:!1}],u:[{a:"txt",b:"vX [ 0 ] = vX [ 1 ] = vX [ 2 ] = _0_0 ; vU ; vV ; vW ;".split(" ")}]},{a:"node",c:"BUMP",B:[],A:[{a:"node_in",c:"Gd",i:["float"],g:!1},{a:"node_in",c:"Ge",i:["float"],g:!1},{a:"node_in",c:"v_",i:["float"],g:!1},{a:"node_in",c:"Gf",i:["vec3"],g:!1},{a:"node_out",c:"wb",i:["vec3"],g:!1}],u:[{a:"txt",b:"wb = Gf ; Gd ; Ge ; v_ ;".split(" ")}]},{a:"node",c:"DISPLACEMENT_BUMP",B:[],A:[{a:"node_in",c:"wi",i:["float"],g:!1},{a:"node_out",c:"wj",i:["vec3"],g:!1}],u:[{a:"txt",b:"wj = nH ; wi ;".split(" ")}]},
{a:"node",c:"NORMAL_MAP",B:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],A:[{a:"node_in",c:"wk",i:["float"],g:!1},{a:"node_in",c:"wl",i:["vec4"],g:!1},{a:"node_in",c:"wm",i:["vec3"],g:!1},{a:"node_out",c:"wn",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NORMAL_IN"],u:[{a:"txt",b:["vec3","wo","=","wm",";"]}]},{a:"node_else",u:[{a:"txt",b:["vec3","wo","=","rB",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["SPACE","NM_TANGENT",{a:"equal_expr",o:2}],
u:[{a:"txt",b:"wn = 2.0 * wl . xyz - _1_0 ; wn = rF * wn ;".split(" ")}]},{a:"node_elif",j:["SPACE","NM_OBJECT",{a:"equal_expr",o:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"wn = 2.0 * wl . xyz - _1_0 ; wn . yz *= - _1_0 ; wn = _ ( u_model_tsr , wn ) ;".split(" ")}]},{a:"node_elif",j:["SPACE","NM_WORLD",{a:"equal_expr",o:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"wn = 2.0 * wl . xyz - _1_0 ; wn . yz *= - _1_0 ;".split(" ")}]}]},
{a:"txt",b:"float lo = max ( wk , _0_0 ) ; wn = normalize ( mix ( wo , wn , lo ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",B:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],A:[{a:"node_in",c:"wp",i:["vec3"],g:!1},{a:"node_out",c:"wq",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",o:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",o:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",
{a:"equal_expr",o:2},{a:"logical_or_expr",o:3}],u:[{a:"txt",b:["wq","=","wp",";"]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",o:2}],u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_view_tsr_frag , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_model_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",
j:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_model_tsr , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_model_tsr , wp ) ; wq = ap ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = ap ( u_view_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",
o:2}],u:[{a:"txt",b:"wq = ap ( u_view_tsr_inverse , wp ) ; wq = ap ( u_model_tsr_inverse , wq ) ;".split(" ")}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_view_tsr_frag , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_model_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",
o:2}],u:[{a:"txt",b:"wq = _ ( u_model_tsr , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_model_tsr , wp ) ; wq = _ ( u_view_tsr_frag , wq ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_view_tsr_inverse , wp ) ;".split(" ")}]},{a:"node_elif",j:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = _ ( u_view_tsr_inverse , wp ) ; wq = _ ( u_model_tsr_inverse , wq ) ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",j:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",o:2}],u:[{a:"txt",b:"wq = normalize ( wq ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",B:[],A:[{a:"node_in",c:"wr",i:["float"],g:!1},{a:"node_out",c:"ws",i:["vec3"],g:!1}],u:[{a:"txt",b:"ws [ 0 ] = ws [ 1 ] = ws [ 2 ] = _0_0 ; wr ;".split(" ")}]},{a:"node",c:"WAVELENGTH",B:[],A:[{a:"node_in",c:"wt",i:["float"],g:!1},{a:"node_out",c:"wu",i:["vec3"],g:!1}],u:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wt ;".split(" ")}]},
{a:"node",c:"SEPXYZ",B:[],A:[{a:"node_in",c:"wv",i:["vec3"],g:!1},{a:"node_out",c:"wA",i:["float"],g:!1},{a:"node_out",c:"wB",i:["float"],g:!1},{a:"node_out",c:"wC",i:["float"],g:!1}],u:[{a:"txt",b:"wA = wv [ 0 ] ; wB = wv [ 1 ] ; wC = wv [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",B:[],A:[{a:"node_in",c:"wD",i:["float"],g:!1},{a:"node_in",c:"wE",i:["float"],g:!1},{a:"node_in",c:"wF",i:["float"],g:!1},{a:"node_out",c:"wG",i:["vec3"],g:!1}],u:[{a:"txt",b:"wG [ 0 ] = wD ; wG [ 1 ] = wE ; wG [ 2 ] = wF ;".split(" ")}]},
{a:"node",c:"BRIGHTCONTRAST",B:[],A:[{a:"node_in",c:"wH",i:["vec3"],g:!1},{a:"node_in",c:"wI",i:["float"],g:!1},{a:"node_in",c:"wJ",i:["float"],g:!1},{a:"node_out",c:"wK",i:["vec3"],g:!1}],u:[{a:"txt",b:"float b = wI - wJ * _0_5 ; wK = max ( ( _1_0 + wJ ) * wH + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",B:[],A:[{a:"node_in",c:"wL",i:["float"],g:!1},{a:"node_in",c:"wM",i:["float"],g:!1},{a:"node_out",c:"wN",i:["float"],g:!1},{a:"node_out",c:"wO",i:["float"],g:!1},{a:"node_out",
c:"wP",i:["float"],g:!1}],u:[{a:"txt",b:"wN = wO = wP = _0_0 ; wL ; wM ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",B:[],A:[{a:"node_in",c:"Gg",i:["vec3"],g:!1},{a:"node_out",c:"Gh",i:["vec3"],g:!1},{a:"node_out",c:"Gi",i:["float"],g:!1}],u:[{a:"txt",b:"Gh [ 0 ] = Gh [ 1 ] = Gh [ 2 ] = _0_0 ; Gi = _1_0 ; Gg ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",B:[],A:[{a:"node_in",c:"Gj",i:["vec3"],g:!1},{a:"node_out",c:"Gk",i:["vec3"],g:!1}],u:[{a:"txt",b:"Gk [ 0 ] = Gk [ 1 ] = Gk [ 2 ] = _0_0 ; Gj ;".split(" ")}]},
{a:"node",c:"TEX_SKY",B:[],A:[{a:"node_in",c:"wQ",i:["vec3"],g:!1},{a:"node_out",c:"wR",i:["vec3"],g:!1}],u:[{a:"txt",b:"wR [ 0 ] = wR [ 1 ] = wR [ 2 ] = _0_0 ; wQ ;".split(" ")}]},{a:"node",c:"TEX_NOISE",B:[],A:[{a:"node_in",c:"wS",i:["vec3"],g:!1},{a:"node_in",c:"wT",i:["float"],g:!1},{a:"node_in",c:"wU",i:["float"],g:!1},{a:"node_in",c:"wV",i:["float"],g:!1},{a:"node_out",c:"wW",i:["vec3"],g:!1},{a:"node_out",c:"wX",i:["float"],g:!1}],u:[{a:"txt",b:"wW [ 0 ] = wW [ 1 ] = wW [ 2 ] = _0_0 ; wX = _1_0 ; wS ; wT ; wU ; wV ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",B:[],A:[{a:"node_in",c:"wY",i:["vec3"],g:!1},{a:"node_in",c:"wZ",i:["float"],g:!1},{a:"node_in",c:"w_",i:["float"],g:!1},{a:"node_in",c:"xa",i:["float"],g:!1},{a:"node_in",c:"xb",i:["float"],g:!1},{a:"node_out",c:"xc",i:["vec3"],g:!1},{a:"node_out",c:"xd",i:["float"],g:!1}],u:[{a:"txt",b:"xc [ 0 ] = xc [ 1 ] = xc [ 2 ] = _0_0 ; xd = _1_0 ; wY ; wZ ; w_ ; xa ; xb ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",B:[],A:[{a:"node_in",c:"xe",i:["vec3"],g:!1},{a:"node_in",c:"xf",i:["float"],
g:!1},{a:"node_out",c:"xg",i:["vec3"],g:!1},{a:"node_out",c:"xh",i:["float"],g:!1}],u:[{a:"txt",b:"xg [ 0 ] = xg [ 1 ] = xg [ 2 ] = _0_0 ; xh = _1_0 ; xe ; xf ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",B:[],A:[{a:"node_in",c:"xi",i:["vec3"],g:!1},{a:"node_in",c:"xj",i:["float"],g:!1},{a:"node_in",c:"xk",i:["float"],g:!1},{a:"node_in",c:"xl",i:["float"],g:!1},{a:"node_in",c:"xm",i:["float"],g:!1},{a:"node_in",c:"xn",i:["float"],g:!1},{a:"node_in",c:"xo",i:["float"],g:!1},{a:"node_out",c:"xp",i:["vec3"],
g:!1},{a:"node_out",c:"xq",i:["float"],g:!1}],u:[{a:"txt",b:"xp [ 0 ] = xp [ 1 ] = xp [ 2 ] = _0_0 ; xq = _1_0 ; xi ; xj ; xk ; xl ; xm ; xn ; xo ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",B:[],A:[{a:"node_in",c:"xr",i:["vec3"],g:!1},{a:"node_out",c:"xs",i:["vec3"],g:!1},{a:"node_out",c:"xt",i:["float"],g:!1}],u:[{a:"txt",b:"xs [ 0 ] = xs [ 1 ] = xs [ 2 ] = _0_0 ; xt = _1_0 ; xr ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",B:[],A:[{a:"node_in",c:"xu",i:["vec3"],g:!1},{a:"node_in",c:"xv",i:["float"],
g:!1},{a:"node_in",c:"xA",i:["float"],g:!1},{a:"node_out",c:"xB",i:["vec3"],g:!1},{a:"node_out",c:"xC",i:["float"],g:!1}],u:[{a:"txt",b:"xB [ 0 ] = xB [ 1 ] = xB [ 2 ] = _0_0 ; xC = _1_0 ; xu ; xv ; xA ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",B:[],A:[{a:"node_in",c:"xD",i:["vec3"],g:!1},{a:"node_in",c:"xE",i:["vec3"],g:!1},{a:"node_in",c:"xF",i:["vec3"],g:!1},{a:"node_in",c:"xG",i:["float"],g:!1},{a:"node_out",c:"xH",i:["vec3"],g:!1},{a:"node_out",c:"xI",i:["float"],g:!1}],u:[{a:"txt",b:"xH [ 0 ] = xH [ 1 ] = xH [ 2 ] = _0_0 ; xI = _1_0 ; xD ; xE ; xF ; xG ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",B:[],A:[{a:"node_in",c:"xJ",i:["vec3"],g:!1},{a:"node_in",c:"xK",i:["vec3"],g:!1},{a:"node_in",c:"xL",i:["vec3"],g:!1},{a:"node_in",c:"xM",i:["vec3"],g:!1},{a:"node_in",c:"xN",i:["float"],g:!1},{a:"node_in",c:"xO",i:["float"],g:!1},{a:"node_in",c:"xP",i:["float"],g:!1},{a:"node_in",c:"xQ",i:["float"],g:!1},{a:"node_in",c:"xR",i:["float"],g:!1},{a:"node_out",c:"xS",i:["vec3"],g:!1},{a:"node_out",c:"xT",i:["float"],g:!1}],u:[{a:"txt",b:"xS [ 0 ] = xS [ 1 ] = xS [ 2 ] = _0_0 ; xT = _1_0 ; xJ ; xK ; xL ; xM ; xN ; xO ; xP ; xQ ; xR ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",B:[],A:[{a:"node_in",c:"xU",i:["vec3"],g:!1},{a:"node_in",c:"xV",i:["vec3"],g:!1},{a:"node_out",c:"xW",i:["vec3"],g:!1}],u:[{a:"txt",b:"xW = clamp ( xU + xV , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",B:[],A:[{a:"node_in",c:"xX",i:["float"],g:!1},{a:"node_in",c:"xY",i:["vec3"],g:!1},{a:"node_in",c:"xZ",i:["vec3"],g:!1},{a:"node_in",c:"x_",i:["vec3"],g:!1},{a:"node_in",c:"ya",i:["float"],g:!1},{a:"node_in",c:"yb",i:["vec3"],g:!1},{a:"node_in",
c:"yc",i:["float"],g:!1},{a:"node_in",c:"yd",i:["float"],g:!1},{a:"node_in",c:"ye",i:["vec3"],g:!1},{a:"node_in",c:"yf",i:["vec3"],g:!1},{a:"node_in",c:"yg",i:["float"],g:!1},{a:"node_in",c:"yh",i:["vec3"],g:!1},{a:"node_in",c:"yi",i:["float"],g:!1},{a:"node_in",c:"yj",i:["vec3"],g:!1},{a:"node_in",c:"yk",i:["float"],g:!1},{a:"node_in",c:"yl",i:["vec3"],g:!1},{a:"node_in",c:"ym",i:["float"],g:!1},{a:"node_in",c:"yn",i:["float"],g:!1},{a:"node_in",c:"yo",i:["vec3"],g:!1},{a:"node_in",c:"yp",i:["vec3"],
g:!1},{a:"node_in",c:"yq",i:["float"],g:!1},{a:"node_in",c:"yr",i:["vec3"],g:!1},{a:"node_in",c:"ys",i:["float"],g:!1},{a:"node_out",c:"yt",i:["vec3"],g:!1},{a:"node_out",c:"yu",i:["vec3"],g:!1},{a:"node_out",c:"yv",i:["float"],g:!1},{a:"node_out",c:"yA",i:["vec3"],g:!1},{a:"node_out",c:"yB",i:["float"],g:!1},{a:"node_out",c:"yC",i:["float"],g:!1},{a:"node_out",c:"yD",i:["vec3"],g:!1},{a:"node_out",c:"yE",i:["vec3"],g:!1},{a:"node_out",c:"yF",i:["float"],g:!1},{a:"node_out",c:"yG",i:["vec3"],g:!1},
{a:"node_out",c:"yH",i:["float"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( xX , _0_0 , _1_0 ) ; yu = mix ( x_ , yj , yI ) ; yv = mix ( ya , yk , yI ) ; if ( yd > _0_0 ) { if ( yn > _0_0 ) { yA = mix ( yb , yl , yI ) ; yB = mix ( yc , ym , yI ) ; } else { yA = yb ; yB = yc ; } } else { yA = yl ; yB = ym ; } if ( yg > _0_0 ) { if ( yq > _0_0 ) { yE = mix ( yf , yp , yI ) ; } else { yE = yf ; } } else { yE = yp ; } yC = mix ( yd , yn , yI ) ; yD = mix ( ye , yo , yI ) ; yF = mix ( yg , yq , yI ) ; yG = mix ( yh , yr , yI ) ; yH = mix ( yi , ys , yI ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",B:[],A:[{a:"node_out",c:"yJ",i:["vec3"],g:!1},{a:"node_out",c:"yK",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yJ"],u:[{a:"txt",b:"yJ = rc ( A ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yK"],u:[{a:"txt",b:"yK = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",B:[],A:[{a:"node_out",c:"yL",i:["vec3"],g:!1}],u:[{a:"txt",b:"yL = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",B:[],A:[{a:"node_out",c:"yM",i:["vec3"],
g:!1}],u:[{a:"txt",b:["yM","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",B:[],A:[{a:"node_out",c:"yN",i:["vec3"],g:!1}],u:[{a:"txt",b:"yN = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",B:[],A:[{a:"node_out",c:"yO",i:["vec3"],g:!1}],u:[{a:"txt",b:"yO [ 0 ] = yO [ 1 ] = yO [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",B:[],A:[{a:"node_out",c:"yP",i:["vec3"],g:!1}],u:[{a:"txt",b:"yP [ 0 ] = rG [ 0 ] ; yP [ 1 ] = rG [ 1 ] ; yP [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
B:[],A:[{a:"node_out",c:"yQ",i:["vec3"],g:!1}],u:[{a:"txt",b:"yQ [ 0 ] = yQ [ 1 ] = yQ [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",B:[],A:[{a:"node_out",c:"yR",i:["vec3"],g:!1}],u:[{a:"txt",b:"yR [ 0 ] = yR [ 1 ] = yR [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",B:[],A:[{a:"node_out",c:"yS",i:["vec3"],g:!1}],u:[{a:"txt",b:"yS = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",B:[],A:[{a:"node_out",c:"yT",i:["float"],g:!1},{a:"node_out",c:"yU",i:["float"],g:!1},{a:"node_out",
c:"yV",i:["float"],g:!1},{a:"node_out",c:"yW",i:["vec3"],g:!1},{a:"node_out",c:"yX",i:["float"],g:!1},{a:"node_out",c:"yY",i:["vec3"],g:!1},{a:"node_out",c:"yZ",i:["vec3"],g:!1},{a:"node_param",c:"F_",i:["GLSL_IN","vec4"],g:!0},{a:"node_param",c:"Ga",i:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Gb",i:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Gc",i:["GLSL_IN","vec3"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["PARTICLE_BATCH"],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yT"],u:[{a:"txt",b:"yT = F_ [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yU"],u:[{a:"txt",b:"yU = F_ [ 1 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yV"],u:[{a:"txt",b:"yV = F_ [ 2 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yW"],u:[{a:"txt",b:["yW","=","Ga",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yX"],u:[{a:"txt",b:"yX = F_ [ 3 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yY"],u:[{a:"txt",b:["yY","=","Gb",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_yZ"],
u:[{a:"txt",b:["yZ","=","Gc",";"]}]}]}]},{a:"node_else",u:[{a:"txt",b:"yT = _0_0 ; yU = _0_0 ; yV = _0_0 ; yW = vec3 ( _0_0 ) ; yX = _0_0 ; yY = yW ; yZ = yW ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",B:[],A:[{a:"node_out",c:"y_",i:["float"],g:!1},{a:"node_out",c:"za",i:["float"],g:!1},{a:"node_out",c:"zb",i:["float"],g:!1},{a:"node_out",c:"zc",i:["vec3"],g:!1}],u:[{a:"txt",b:"y_ = _0_0 ; za = _0_0 ; zb = _0_0 ; zc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",B:[],A:[{a:"node_out",
c:"zd",i:["vec3"],g:!1},{a:"node_out",c:"ze",i:["float"],g:!1},{a:"node_out",c:"zf",i:["float"],g:!1},{a:"node_out",c:"zg",i:["float"],g:!1}],u:[{a:"txt",b:"ze = _0_0 ; zf = _0_0 ; zg = _0_0 ; zd = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",B:[],A:[{a:"node_in",c:"zh",i:["float"],g:!1},{a:"node_out",c:"zi",i:["float"],g:!1}],u:[{a:"txt",b:["zi","=","zh",";"]}]},{a:"node",c:"TANGENT",B:[],A:[{a:"node_out",c:"zj",i:["vec3"],g:!1}],u:[{a:"txt",b:"zj = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",B:[],A:[{a:"node_in",c:"Gl",i:["float"],g:!1},{a:"node_in",c:"Gm",i:["vec3"],g:!1},{a:"node_out",c:"zm",i:["float"],g:!1},{a:"node_out",c:"zn",i:["float"],g:!1}],u:[{a:"txt",b:"zm = zn = _0_0 ; Gm ; Gl ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",B:[],A:[{a:"node_out",c:"zp",i:["float"],g:!1},{a:"node_out",c:"zq",i:["float"],g:!1},{a:"node_out",c:"zr",i:["float"],g:!1},{a:"node_out",c:"zs",i:["float"],g:!1},{a:"node_out",c:"zt",i:["float"],g:!1},{a:"node_out",c:"zu",i:["float"],g:!1},
{a:"node_out",c:"zv",i:["float"],g:!1},{a:"node_out",c:"zA",i:["float"],g:!1},{a:"node_out",c:"zB",i:["float"],g:!1},{a:"node_out",c:"zC",i:["float"],g:!1}],u:[{a:"txt",b:"zp = zq = zr = _0_0 ; zs = zt = zu = _0_0 ; zv = zv = zB = zC = _0_0 ; zA = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",B:[],A:[{a:"node_out",c:"zE",i:["vec3"],g:!1},{a:"node_out",c:"zF",i:["vec3"],g:!1},{a:"node_out",c:"zG",i:["float"],g:!1}],u:[{a:"txt",b:"zE = zF = vec3 ( _0_0 ) ; zG = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
B:[],A:[],u:[]},{a:"node",c:"CURVE_VEC",B:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],A:[{a:"node_in",c:"zH",i:["float"],g:!1},{a:"node_in",c:"zI",i:["vec3"],g:!1},{a:"node_out",c:"zJ",i:["vec3"],g:!1}],u:[{a:"txt",b:["zJ","=","zI",";"]},{a:"node_cond",f:[{a:"node_if",j:["READ_R"],u:[{a:"txt",b:"zJ . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zI . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["READ_G"],u:[{a:"txt",b:"zJ . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zI . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_B"],u:[{a:"txt",b:"zJ . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zI . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zJ = mix ( zI , zJ , zH ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",B:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",
c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],A:[{a:"node_in",c:"zK",i:["float"],g:!1},{a:"node_in",c:"zL",i:["vec3"],g:!1},{a:"node_out",c:"zM",i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["READ_A"],u:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zL . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zL . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zL . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"float r = zL . r ; float g = zL . g ; float b = zL . b ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_R"],u:[{a:"txt",b:"zM . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zM . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["READ_G"],u:[{a:"txt",b:"zM . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zM . g = g ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["READ_B"],u:[{a:"txt",b:"zM . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"zM . b = b ;".split(" ")}]}]},{a:"txt",b:"zM = mix ( zL , zM , zK ) ;".split(" ")}]},{a:"node",c:"VALTORGB",B:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],A:[{a:"node_in",c:"zN",i:["float"],g:!1},{a:"node_out",c:"zO",i:["vec3"],g:!1},{a:"node_out",c:"zP",i:["float"],g:!1}],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zN , NODE_TEX_ROW ) ) ; zO = zQ . rgb ; zP = zQ . a ;".split(" ")}]},
{a:"node",c:"MAPPING",B:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],A:[{a:"node_in",c:"zR",i:["vec3"],g:!1},{a:"node_out",c:"zS",i:["vec3"],g:!1}],u:[{a:"txt",b:["zS","=","zR",";"]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_SCALE_DEF"],u:[{a:"txt",b:"zS = zS * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_TRANS_DEF"],u:[{a:"txt",b:"zS = zS + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_TRS_MATRIX_DEF"],
u:[{a:"txt",b:"zS = ( MAPPING_TRS_MATRIX * vec4 ( zS , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_MIN_CLIP_DEF"],u:[{a:"txt",b:"zS = max ( zS , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_MAX_CLIP_DEF"],u:[{a:"txt",b:"zS = min ( zS , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAPPING_IS_NORMAL"],u:[{a:"txt",b:"zS = normalize ( zS ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",B:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],A:[{a:"node_in",c:"zT",i:["float"],g:!1},{a:"node_in",c:"zU",i:["float"],g:!1},{a:"node_out",c:"zV",i:["float"],g:!1}],u:[{a:"txt",b:"zV = zT + zU ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"zV = clamp ( zV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"zW",i:["float"],g:!1},{a:"node_in",c:"zX",i:["float"],g:!1},{a:"node_out",c:"zY",i:["float"],g:!1}],u:[{a:"txt",b:"zY = zW - zX ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"zY = clamp ( zY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"zZ",i:["float"],g:!1},{a:"node_in",c:"z_",i:["float"],g:!1},{a:"node_out",c:"Aa",i:["float"],g:!1}],u:[{a:"txt",b:"Aa = zZ * z_ ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Aa = clamp ( Aa , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ab",i:["float"],g:!1},{a:"node_in",c:"Ac",i:["float"],g:!1},{a:"node_out",c:"Ad",i:["float"],g:!1}],u:[{a:"txt",b:"Ad = ( Ac != _0_0 ) ? Ab / Ac : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ae",i:["float"],g:!1},{a:"node_in",c:"Af",i:["float"],g:!1},
{a:"node_out",c:"Ag",i:["float"],g:!1}],u:[{a:"txt",b:"Ag = sin ( Ae ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ag = clamp ( Ag , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Af",";"]}]},{a:"node",c:"MATH_COSINE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ah",i:["float"],g:!1},{a:"node_in",c:"Ai",i:["float"],g:!1},{a:"node_out",c:"Aj",i:["float"],g:!1}],u:[{a:"txt",b:"Aj = cos ( Ah ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],
u:[{a:"txt",b:"Aj = clamp ( Aj , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ai",";"]}]},{a:"node",c:"MATH_TANGENT",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ak",i:["float"],g:!1},{a:"node_in",c:"Al",i:["float"],g:!1},{a:"node_out",c:"Am",i:["float"],g:!1}],u:[{a:"txt",b:"Am = tan ( Ak ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Am = clamp ( Am , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Al",";"]}]},{a:"node",c:"MATH_ARCSINE",B:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"An",i:["float"],g:!1},{a:"node_in",c:"Ao",i:["float"],g:!1},{a:"node_out",c:"Ap",i:["float"],g:!1}],u:[{a:"txt",b:"Ap = ( An <= _1_0 && An >= - _1_0 ) ? asin ( An ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ap = clamp ( Ap , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ao",";"]}]},{a:"node",c:"MATH_ARCCOSINE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Aq",i:["float"],g:!1},{a:"node_in",
c:"Ar",i:["float"],g:!1},{a:"node_out",c:"As",i:["float"],g:!1}],u:[{a:"txt",b:"As = ( Aq <= _1_0 && Aq >= - _1_0 ) ? acos ( Aq ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"As = clamp ( As , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ar",";"]}]},{a:"node",c:"MATH_ARCTANGENT",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"At",i:["float"],g:!1},{a:"node_in",c:"Au",i:["float"],g:!1},{a:"node_out",c:"Av",i:["float"],g:!1}],u:[{a:"txt",
b:"Av = atan ( At ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Av = clamp ( Av , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Au",";"]}]},{a:"node",c:"MATH_POWER",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Aw",i:["float"],g:!1},{a:"node_in",c:"Ax",i:["float"],g:!1},{a:"node_out",c:"Ay",i:["float"],g:!1}],u:[{a:"txt",b:"if ( Aw < _0_0 && Ax != floor ( Ax ) ) Ay = _0_0 ; else if ( Ax == _0_0 ) Ay = _1_0 ; else if ( Aw < _0_0 ) Ay = mix ( _1_0 , - _1_0 , sign ( mod ( - Ax , 2.0 ) ) ) * pow ( - Aw , Ax ) ; else if ( Aw == _0_0 ) Ay = _0_0 ; else Ay = pow ( Aw , Ax ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"Ay = clamp ( Ay , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Az",i:["float"],g:!1},{a:"node_in",c:"AA",i:["float"],g:!1},{a:"node_out",c:"AB",i:["float"],g:!1}],u:[{a:"txt",b:"AB = ( Az > _0_0 && AA > _0_0 ) ? log2 ( Az ) / log2 ( AA ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AB = clamp ( AB , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AC",i:["float"],g:!1},{a:"node_in",c:"AD",i:["float"],g:!1},{a:"node_out",c:"AE",i:["float"],g:!1}],u:[{a:"txt",b:"AE = min ( AC , AD ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AE = clamp ( AE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AF",i:["float"],g:!1},{a:"node_in",c:"AG",i:["float"],
g:!1},{a:"node_out",c:"AH",i:["float"],g:!1}],u:[{a:"txt",b:"AH = max ( AF , AG ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AH = clamp ( AH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AI",i:["float"],g:!1},{a:"node_in",c:"AJ",i:["float"],g:!1},{a:"node_out",c:"AK",i:["float"],g:!1}],u:[{a:"txt",b:"AK = floor ( AI + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],
u:[{a:"txt",b:"AK = clamp ( AK , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AJ",";"]}]},{a:"node",c:"MATH_LESS_THAN",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AL",i:["float"],g:!1},{a:"node_in",c:"AM",i:["float"],g:!1},{a:"node_out",c:"AN",i:["float"],g:!1}],u:[{a:"txt",b:"AN = ( AL < AM ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AN = clamp ( AN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",B:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AO",i:["float"],g:!1},{a:"node_in",c:"AP",i:["float"],g:!1},{a:"node_out",c:"AQ",i:["float"],g:!1}],u:[{a:"txt",b:"AQ = ( AO > AP ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AQ = clamp ( AQ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AR",i:["float"],g:!1},{a:"node_in",c:"AS",i:["float"],g:!1},{a:"node_out",c:"AT",
i:["float"],g:!1}],u:[{a:"txt",b:"AT = abs ( AS ) > 0.000001 ? mod ( AR , AS ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],u:[{a:"txt",b:"AT = clamp ( AT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",B:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AU",i:["float"],g:!1},{a:"node_in",c:"AV",i:["float"],g:!1},{a:"node_out",c:"AW",i:["float"],g:!1}],u:[{a:"txt",b:"AW = abs ( AU ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MATH_USE_CLAMP"],
u:[{a:"txt",b:"AW = clamp ( AW , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AV",";"]}]},{a:"node",c:"MIX_RGB_MIX",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"AX",i:["float"],g:!1},{a:"node_in",c:"AY",i:["vec3"],g:!1},{a:"node_in",c:"AZ",i:["vec3"],g:!1},{a:"node_out",c:"A_",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( AX , _0_0 , _1_0 ) ; A_ = mix ( AY , AZ , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"A_ = clamp ( A_ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ba",i:["float"],g:!1},{a:"node_in",c:"Bb",i:["vec3"],g:!1},{a:"node_in",c:"Bc",i:["vec3"],g:!1},{a:"node_out",c:"Bd",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ba , _0_0 , _1_0 ) ; Bd = mix ( Bb , Bb + Bc , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bd = clamp ( Bd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",B:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Be",i:["float"],g:!1},{a:"node_in",c:"Bf",i:["vec3"],g:!1},{a:"node_in",c:"Bg",i:["vec3"],g:!1},{a:"node_out",c:"Bh",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Be , _0_0 , _1_0 ) ; Bh = mix ( Bf , Bf * Bg , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bh = clamp ( Bh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",
c:"Bi",i:["float"],g:!1},{a:"node_in",c:"Bj",i:["vec3"],g:!1},{a:"node_in",c:"Bk",i:["vec3"],g:!1},{a:"node_out",c:"Bl",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bi , _0_0 , _1_0 ) ; Bl = mix ( Bj , Bj - Bk , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bl = clamp ( Bl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Bm",i:["float"],g:!1},{a:"node_in",c:"Bn",
i:["vec3"],g:!1},{a:"node_in",c:"Bo",i:["vec3"],g:!1},{a:"node_out",c:"Bp",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bm , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; Bp = vec3 ( _1_0 ) - ( vec3 ( Bq ) + yI * ( vec3 ( _1_0 ) - Bo ) ) * ( vec3 ( _1_0 ) - Bn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bp = clamp ( Bp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Br",
i:["float"],g:!1},{a:"node_in",c:"Bs",i:["vec3"],g:!1},{a:"node_in",c:"Bt",i:["vec3"],g:!1},{a:"node_out",c:"Bu",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Br , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; Bt += step ( Bt , vec3 ( _0_0 ) ) ; Bu = Bq * Bs + yI * Bs / Bt ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Bu = clamp ( Bu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",
c:"Bv",i:["float"],g:!1},{a:"node_in",c:"Bw",i:["vec3"],g:!1},{a:"node_in",c:"Bx",i:["vec3"],g:!1},{a:"node_out",c:"By",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bv , _0_0 , _1_0 ) ; By = mix ( Bw , abs ( Bw - Bx ) , yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"By = clamp ( By , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Bz",i:["float"],g:!1},{a:"node_in",
c:"BA",i:["vec3"],g:!1},{a:"node_in",c:"BB",i:["vec3"],g:!1},{a:"node_out",c:"BC",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Bz , _0_0 , _1_0 ) ; BC = min ( BA . rgb , BB . rgb * yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BC = clamp ( BC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BD",i:["float"],g:!1},{a:"node_in",c:"BE",i:["vec3"],g:!1},{a:"node_in",
c:"BF",i:["vec3"],g:!1},{a:"node_out",c:"BG",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BD , _0_0 , _1_0 ) ; BG = max ( BE . rgb , BF . rgb * yI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BG = clamp ( BG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BH",i:["float"],g:!1},{a:"node_in",c:"BI",i:["vec3"],g:!1},{a:"node_in",c:"BJ",i:["vec3"],g:!1},{a:"node_out",
c:"BK",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BH , _0_0 , _1_0 ) ; vec3 BL = vec3 ( _1_0 - yI ) ; BK = mix ( BI * ( BL + 2.0 * yI * BJ ) , vec3 ( _1_0 ) - ( BL + 2.0 * yI * ( vec3 ( _1_0 ) - BJ ) ) * ( vec3 ( _1_0 ) - BI ) , step ( _0_5 , BI ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BK = clamp ( BK , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BM",i:["float"],
g:!1},{a:"node_in",c:"BN",i:["vec3"],g:!1},{a:"node_in",c:"BO",i:["vec3"],g:!1},{a:"node_out",c:"BP",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BM , _0_0 , _1_0 ) ; vec3 BQ = vec3 ( _1_0 ) - yI * BO ; vec3 BR = clamp ( BN / BQ , _0_0 , _1_0 ) ; BP = mix ( mix ( BR , vec3 ( _1_0 ) , step ( BQ , vec3 ( _0_0 ) ) ) , BN , step ( BN , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BP = clamp ( BP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BS",i:["float"],g:!1},{a:"node_in",c:"BT",i:["vec3"],g:!1},{a:"node_in",c:"BU",i:["vec3"],g:!1},{a:"node_out",c:"BV",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BS , _0_0 , _1_0 ) ; vec3 jC = vec3 ( _1_0 - yI ) ; vec3 BQ = jC + yI * BU ; vec3 BR = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BT ) / BQ , _0_0 , _1_0 ) ; BV = mix ( BR , vec3 ( _0_0 ) , step ( BQ , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BV = clamp ( BV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"BW",i:["float"],g:!1},{a:"node_in",c:"BX",i:["vec3"],g:!1},{a:"node_in",c:"BY",i:["vec3"],g:!1},{a:"node_out",c:"BZ",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( BW , _0_0 , _1_0 ) ; vec3 ju , B_ , BQ ; BZ = BX ; B_ = jt ( BY ) ; if ( B_ . y != _0_0 ) { ju = jt ( BZ ) ; ju . x = B_ . x ; BQ = jv ( ju ) ; BZ = mix ( BZ , BQ , yI ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"BZ = clamp ( BZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ca",i:["float"],g:!1},{a:"node_in",c:"Cb",i:["vec3"],g:!1},{a:"node_in",c:"Cc",i:["vec3"],g:!1},{a:"node_out",c:"Cd",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ca , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; Cd = Cb ; vec3 ju , B_ ; ju = jt ( Cd ) ; if ( ju . y != _0_0 ) { B_ = jt ( Cc ) ; ju . y = Bq * ju . y + yI * B_ . y ; Cd = jv ( ju ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cd = clamp ( Cd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ce",i:["float"],g:!1},{a:"node_in",c:"Cf",i:["vec3"],g:!1},{a:"node_in",c:"Cg",i:["vec3"],g:!1},{a:"node_out",c:"Ch",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ce , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; vec3 ju , B_ ; ju = jt ( Cf ) ; B_ = jt ( Cg ) ; ju . z = Bq * ju . z + yI * B_ . z ; Ch = jv ( ju ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Ch = clamp ( Ch , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Ci",i:["float"],g:!1},{a:"node_in",c:"Cj",i:["vec3"],g:!1},{a:"node_in",c:"Ck",i:["vec3"],g:!1},{a:"node_out",c:"Cl",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Ci , _0_0 , _1_0 ) ; vec3 ju , B_ , BQ ; Cl = Cj ; B_ = jt ( Ck ) ; if ( B_ . y != _0_0 ) { ju = jt ( Cl ) ; ju . x = B_ . x ; ju . y = B_ . y ; BQ = jv ( ju ) ; Cl = mix ( Cl , BQ , yI ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cl = clamp ( Cl , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Cm",i:["float"],g:!1},{a:"node_in",c:"Cn",i:["vec3"],g:!1},{a:"node_in",c:"Co",i:["vec3"],g:!1},{a:"node_out",c:"Cp",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Cm , _0_0 , _1_0 ) ; float Bq = _1_0 - yI ; vec3 Cq = Co + Cn - Co * Cn ; Cp = Cn * ( vec3 ( Bq ) + vec3 ( yI ) * ( ( vec3 ( _1_0 ) - Cn ) * Co + Cq ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cp = clamp ( Cp , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",B:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],A:[{a:"node_in",c:"Cr",i:["float"],g:!1},{a:"node_in",c:"Cs",i:["vec3"],g:!1},{a:"node_in",c:"Ct",i:["vec3"],g:!1},{a:"node_out",c:"Cu",i:["vec3"],g:!1}],u:[{a:"txt",b:"float yI = clamp ( Cr , _0_0 , _1_0 ) ; Cu = Cs + yI * ( 2.0 * Ct - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
j:["MIX_RGB_USE_CLAMP"],u:[{a:"txt",b:"Cu = clamp ( Cu , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",B:[],A:[{a:"node_in",c:"CD",i:["vec3"],g:!1},{a:"node_in",c:"CE",i:["float"],g:!1}],u:[{a:"txt",b:"D = CD ; H = CE ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",B:[],A:[{a:"node_in",c:"CF",i:["vec3"],g:!1}],u:[{a:"txt",b:"D = CF ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",B:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",
c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],A:[{a:"node_in",c:"CH",i:["vec3"],g:!1},{a:"node_in",c:"CI",i:["vec3"],g:!1},{a:"node_in",c:"CJ",i:["float"],g:!1},{a:"node_in",c:"CK",i:["vec3"],g:!0},{a:"node_in",c:"CL",i:["float"],g:!0},{a:"node_out",c:"CM",i:["vec3"],g:!1},{a:"node_out",c:"CN",i:["vec3"],g:!1},{a:"node_out",c:"CO",i:["vec3"],g:!1},{a:"node_out",c:"CP",i:["vec3"],g:!1},{a:"node_out",c:"CQ",i:["vec3"],g:!1},{a:"node_out",c:"CR",i:["vec2"],g:!1},{a:"node_out",
c:"CS",i:["vec2"],g:!1},{a:"node_out",c:"CT",i:["vec4"],g:!1},{a:"node_param",c:"ru",i:["const","vec2"],g:!0},{a:"node_param",c:"rv",i:["const","vec3"],g:!1}],u:[{a:"txt",b:"CO = clamp ( CH , _0_0 , _1_0 ) ; CP = rv [ 0 ] * clamp ( CI , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_NORMAL"],u:[{a:"txt",b:"CQ = normalize ( CK ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:["CQ","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["SHADELESS_MAT",{a:"logic_negative_expr",
o:1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MATERIAL_EXT"],u:[{a:"txt",b:"CM = CL * CO ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"CM = rH * CO ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_DIFFUSE"],u:[{a:"txt",b:["CO","*=","CJ",";"]}]}]},{a:"txt",b:"CN = rI * u_environment_energy * cn ( CQ ) ; CT = vec4 ( _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NUM_LIGHTS",0,{a:"g_expr",o:2}],u:[{a:"txt",b:"CR = vec2 ( ru [ 0 ] , ru [ 1 ] ) ; CS = vec2 ( rv [ 1 ] , rv [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","CT",";"]}]},{a:"node_else",u:[{a:"txt",b:"CM = vec3 ( _0_0 ) ; CN = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",B:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],A:[{a:"node_in",c:"CU",i:["vec4"],g:!1},{a:"node_in",c:"CV",i:["vec3"],g:!1},{a:"node_in",c:"CW",i:["vec3"],g:!1},{a:"node_in",c:"CX",i:["float"],g:!0},{a:"node_in",c:"CY",i:["float"],g:!0},{a:"node_in",c:"CZ",
i:["float"],g:!0},{a:"node_out",c:"C_",i:["vec3"],g:!0},{a:"node_out",c:"Da",i:["float"],g:!0},{a:"node_out",c:"Db",i:["vec3"],g:!0},{a:"node_out",c:"Dc",i:["vec3"],g:!0},{a:"node_out",c:"Dd",i:["vec3"],g:!0},{a:"node_param",c:"rw",i:["float"],g:!1},{a:"node_param",c:"rx",i:["float"],g:!1}],u:[{a:"txt",b:["CX",";"]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_C_"],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_DIFFUSE"],u:[{a:"txt",b:"C_ = CU . rgb ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"C_ = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:["C_","+=","CV",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Db"],u:[{a:"txt",b:["Db","=","CW",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["MATERIAL_EXT"],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dc"],u:[{a:"txt",b:"Dc = CU . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dd"],u:[{a:"txt",b:["Dd","=","CV",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Da"],u:[{a:"txt",b:"Da = clamp ( CZ , _0_0 , _1_0 ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:"float t = max ( max ( CV . r , CV . g ) , CV . b ) * CY ; Da = clamp ( CZ * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Da"],u:[{a:"txt",b:"Da = clamp ( rw , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:"float t = max ( max ( CV . r , CV . g ) , CV . b ) * rx ; Da = rw * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_MATERIAL_SPECULAR"],u:[{a:"txt",b:["E","=","CV",";"]}]},{a:"node_else",u:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","CW",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",B:[],A:[{a:"node_in",c:"nZ",i:["vec3"],g:!1},{a:"node_in",c:"n_",i:["vec3"],g:!1},{a:"node_in",c:"oa",i:["vec3"],g:!1},{a:"node_out",c:"ob",i:["vec4"],g:!1},{a:"node_out",c:"oc",i:["vec3"],g:!1}],u:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},
{a:"node",c:"LIGHTING_LAMP",B:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],A:[{a:"node_in",c:"od",i:["vec4"],g:!1},{a:"node_out",c:"oe",i:["vec3"],g:!1},{a:"node_out",c:"of",i:["vec2"],g:!1},{a:"node_out",c:"og",i:["vec3"],g:!1},{a:"node_out",c:"oh",i:["float"],g:!1}],u:[{a:"txt",
b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","HEMI",{a:"equal_expr",o:2}],u:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",u:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",o:1},{a:"non_equal_expr",o:2}],u:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2},"LAMP_TYPE","POINT",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],u:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aM = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aM * aM ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["LAMP_TYPE","SPOT",{a:"equal_expr",o:2}],u:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",u:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"om",i:["vec3"],g:!1},{a:"node_in",c:"on",i:["vec2"],g:!1},{a:"node_in",c:"oo",i:["vec3"],g:!1},{a:"node_in",c:"op",i:["float"],g:!1},{a:"node_in",c:"oq",i:["vec2"],g:!1},{a:"node_out",c:"or",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"ou",i:["vec3"],g:!1},{a:"node_in",c:"ov",i:["vec2"],g:!1},{a:"node_in",c:"ow",i:["vec3"],
g:!1},{a:"node_in",c:"ox",i:["float"],g:!1},{a:"node_out",c:"oy",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",
c:"oz",i:["vec3"],g:!1},{a:"node_in",c:"oA",i:["vec2"],g:!1},{a:"node_in",c:"oB",i:["vec3"],g:!1},{a:"node_in",c:"oC",i:["float"],g:!1},{a:"node_in",c:"oD",i:["vec2"],g:!1},{a:"node_out",c:"oE",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cp = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cp ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cp + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oO",i:["vec3"],g:!1},{a:"node_in",c:"oP",i:["vec2"],g:!1},{a:"node_in",c:"oQ",i:["vec3"],g:!1},{a:"node_in",c:"oR",i:["float"],g:!1},{a:"node_in",c:"oS",i:["vec2"],g:!1},{a:"node_out",c:"oT",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"oU",i:["vec3"],g:!1},{a:"node_in",c:"oV",i:["vec2"],g:!1},{a:"node_in",c:"oW",i:["vec3"],g:!1},
{a:"node_in",c:"oX",i:["float"],g:!1},{a:"node_in",c:"oY",i:["vec2"],g:!1},{a:"node_out",c:"oZ",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pa",i:["vec3"],g:!1},{a:"node_in",c:"pb",i:["vec2"],g:!1},{a:"node_in",c:"pc",i:["vec3"],g:!1},{a:"node_in",c:"pd",i:["float"],g:!1},{a:"node_in",c:"pe",i:["vec2"],g:!1},{a:"node_out",c:"pf",i:["float"],g:!1}],u:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"ph",i:["vec3"],g:!1},{a:"node_in",c:"pi",i:["vec2"],g:!1},{a:"node_in",c:"pj",i:["vec3"],g:!1},{a:"node_in",c:"pk",i:["float"],g:!1},{a:"node_in",c:"pl",i:["vec2"],g:!1},{a:"node_out",c:"pm",i:["float"],g:!1}],u:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pn",i:["vec3"],g:!1},{a:"node_in",c:"po",i:["vec2"],g:!1},{a:"node_in",c:"pr",i:["vec3"],g:!1},{a:"node_in",c:"pu",i:["float"],g:!1},{a:"node_in",c:"pv",i:["vec2"],g:!1},{a:"node_out",c:"pw",i:["float"],g:!1}],u:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bx = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bx * bx ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pz",i:["vec3"],g:!1},{a:"node_in",c:"pA",i:["vec2"],g:!1},{a:"node_in",c:"pB",i:["vec3"],g:!1},{a:"node_in",c:"pC",i:["float"],g:!1},{a:"node_in",c:"pD",i:["vec2"],g:!1},{a:"node_out",c:"pE",i:["float"],
g:!1}],u:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bX = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float pF = dot ( bX , k . xyz ) ; float bx = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bx = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float bx = acos ( dot ( bX , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bx < pD [ 0 ] ) pE = _1_0 ; else if ( bx >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bx - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",B:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],A:[{a:"node_in",c:"pG",i:["vec3"],g:!1},{a:"node_in",c:"pH",i:["vec2"],g:!1},{a:"node_in",c:"pI",i:["vec3"],g:!1},{a:"node_in",c:"pJ",i:["float"],g:!1},{a:"node_in",c:"pK",i:["vec2"],g:!1},{a:"node_out",c:"pL",i:["float"],g:!1}],u:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < _1_0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( _1_0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["MAT_USE_TBN_SHADING"],u:[{a:"txt",b:"float px = _0_0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",u:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float di = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , di ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",B:[],A:[{a:"node_in",c:"pQ",i:["vec4"],g:!1},{a:"node_in",c:"pR",i:["vec3"],g:!1},{a:"node_in",c:"pS",i:["float"],g:!1},{a:"node_in",c:"pT",i:["float"],g:!1},{a:"node_in",c:"pU",i:["vec3"],g:!1},{a:"node_in",c:"pV",i:["vec3"],g:!1},{a:"node_in",c:"pW",i:["vec4"],g:!1},{a:"node_in",c:"pX",i:["vec3"],g:!1},{a:"node_in",c:"pY",i:["vec3"],g:!1},{a:"node_in",c:"pZ",i:["vec3"],g:!1},{a:"node_in",c:"p_",i:["float"],g:!1},{a:"node_out",c:"qa",i:["vec4"],g:!1},{a:"node_out",c:"qb",
i:["vec3"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_NODE_B4W_TRANSLUCENCY"],u:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float De = pW . x ; float Df = pW . y ; float Dg = pW . z ; float Dh = pW . w ; float Di = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float Dj = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float Dk = pow ( Dj , Df ) ; qa = pQ + p_ * vec4 ( pZ * Di * pow ( pX , vec3 ( De ) ) , _1_0 ) ; qa += Dg * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , Dh ) * p_ * vec4 ( pZ * Di * vec3 ( Dk ) , _1_0 ) ; } else { qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",u:[{a:"txt",b:"qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]},{a:"txt",b:"qb = pR + pZ * pY * pT ;".split(" ")}]},{a:"node",c:"RGB",B:[{a:"node_var",c:"RGB_IND",b:["0"]}],A:[{a:"node_out",c:"Dl",i:["vec3"],g:!1}],u:[{a:"txt",b:"Dl = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",B:[],A:[{a:"node_in",c:"Dm",i:["vec3"],g:!1},{a:"node_out",c:"Dn",i:["float"],g:!1}],u:[{a:"txt",b:"Dn = dot ( Dm , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",
B:[],A:[{a:"node_in",c:"Do",i:["vec3"],g:!1},{a:"node_out",c:"Dp",i:["float"],g:!0},{a:"node_out",c:"Dq",i:["float"],g:!0},{a:"node_out",c:"Dr",i:["float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dp"],u:[{a:"txt",b:"Dp = Do . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dq"],u:[{a:"txt",b:"Dq = Do . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dr"],u:[{a:"txt",b:"Dr = Do . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",B:[],A:[{a:"node_in",c:"Ds",i:["vec3"],
g:!1},{a:"node_out",c:"Dt",i:["float"],g:!0},{a:"node_out",c:"Du",i:["float"],g:!0},{a:"node_out",c:"Dv",i:["float"],g:!0}],u:[{a:"txt",b:"vec3 Dw = jt ( Ds ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dt"],u:[{a:"txt",b:"Dt = Dw . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Du"],u:[{a:"txt",b:"Du = Dw . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Dv"],u:[{a:"txt",b:"Dv = Dw . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",B:[],A:[{a:"node_in",
c:"Dx",i:["float"],g:!1},{a:"node_in",c:"Dy",i:["float"],g:!1},{a:"node_in",c:"Dz",i:["float"],g:!1},{a:"node_out",c:"DA",i:["float"],g:!1}],u:[{a:"txt",b:"DA = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( Dx - Dz ) * Dy ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",B:[],A:[{a:"node_in",c:"DB",i:["vec3"],g:!1},{a:"node_in",c:"DC",i:["float"],g:!1},{a:"node_out",c:"DD",i:["vec3"],g:!1}],u:[{a:"txt",b:"DD = DB ; if ( DD . x > _0_0 ) DD . x = pow ( DB . x , DC ) ; if ( DD . y > _0_0 ) DD . y = pow ( DB . y , DC ) ; if ( DD . z > _0_0 ) DD . z = pow ( DB . z , DC ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",B:[],A:[{a:"node_in",c:"DE",i:["vec3"],g:!1},{a:"node_out",c:"DF",i:["vec3"],g:!1}],u:[{a:"txt",b:"DF = max ( vec3 ( _0_0 ) , DE ) ; DF = pow ( DF , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",B:[],A:[{a:"node_in",c:"DG",i:["vec3"],g:!1},{a:"node_out",c:"DH",i:["vec3"],g:!1}],u:[{a:"txt",b:"DH = max ( vec3 ( _0_0 ) , DG ) ; DH = pow ( DH , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",B:[],A:[{a:"node_out",c:"DI",i:["vec3"],
g:!1},{a:"node_out",c:"DJ",i:["vec3"],g:!1},{a:"node_out",c:"DK",i:["float"],g:!1}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DI"],u:[{a:"txt",b:"DI [ 2 ] = DI [ 1 ] = DI [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DJ"],u:[{a:"txt",b:"DJ [ 2 ] = DJ [ 1 ] = DJ [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DK"],u:[{a:"txt",b:["DK","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",B:[],A:[{a:"node_in",c:"Gn",i:["vec3"],g:!1},{a:"node_out",
c:"Go",i:["vec3"],g:!0},{a:"node_out",c:"Gp",i:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",i:["uniform","samplerCube"],g:!1}],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Gn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Go"],u:[{a:"txt",b:"Go = zQ . xyz ; cg ( Go ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Gp"],u:[{a:"txt",b:"Gp = zQ . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",B:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],A:[{a:"node_in",c:"DV",i:["vec3"],g:!0},{a:"node_in",c:"DW",i:["vec3"],g:!0},{a:"node_in",c:"DX",i:["vec3"],g:!0},{a:"node_in",c:"DY",i:["vec3"],g:!0},{a:"node_out",c:"DZ",i:["vec3"],g:!0},{a:"node_out",c:"D_",i:["float"],g:!0},{a:"node_out",c:"Ea",i:["vec3"],g:!0},{a:"node_out",c:"Eb",i:["float"],g:!0},{a:"node_out",c:"Ec",i:["vec3"],g:!0},{a:"node_out",c:"Ed",i:["float"],
g:!0},{a:"node_out",c:"Ee",i:["vec3"],g:!0},{a:"node_out",c:"Ef",i:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DV ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_DZ"],u:[{a:"txt",b:"DZ = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","DZ",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",
j:["USE_OUT_D_"],u:[{a:"txt",b:"D_ = zQ . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv2"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DW ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ea"],u:[{a:"txt",b:"Ea = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","Ea",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Eb"],u:[{a:"txt",b:"Eb = zQ . w ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",j:["USE_uv3"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DX ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ec"],u:[{a:"txt",b:"Ec = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","Ec",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ed"],u:[{a:"txt",b:"Ed = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv4"],u:[{a:"txt",
b:"zQ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , rd ( DY ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ee"],u:[{a:"txt",b:"Ee = zQ . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["NON_COLOR",{a:"logic_negative_expr",o:1}],u:[{a:"txt",b:["cg","(","Ee",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ef"],u:[{a:"txt",b:"Ef = zQ . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",B:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],A:[{a:"node_in",c:"Eg",i:["vec3"],g:!0},{a:"node_in",c:"Eh",i:["vec3"],g:!0},{a:"node_in",c:"Ei",i:["vec3"],g:!0},{a:"node_in",c:"Ej",i:["vec3"],g:!0},{a:"node_out",c:"Ek",i:["vec3"],g:!0},{a:"node_out",c:"El",i:["float"],g:!0},{a:"node_out",c:"Em",i:["vec3"],g:!0},{a:"node_out",c:"En",i:["float"],g:!0},{a:"node_out",c:"Eo",i:["vec3"],g:!0},{a:"node_out",c:"Ep",i:["float"],g:!0},{a:"node_out",c:"Eq",i:["vec3"],g:!0},{a:"node_out",c:"Er",i:["float"],g:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"txt",b:"vec4 zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Eg ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ek"],u:[{a:"txt",b:"Ek = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_El"],u:[{a:"txt",b:"El = zQ . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv2"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Eh ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Em"],u:[{a:"txt",b:"Em = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_En"],u:[{a:"txt",b:"En = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv3"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Ei ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Eo"],u:[{a:"txt",b:"Eo = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",j:["USE_OUT_Ep"],u:[{a:"txt",b:"Ep = zQ . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_uv4"],u:[{a:"txt",b:"zQ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , rd ( Ej ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Eq"],u:[{a:"txt",b:"Eq = normalize ( rD * ( zQ . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Er"],u:[{a:"txt",b:"Er = zQ . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",B:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],A:[{a:"node_out",c:"Es",i:["float"],g:!1}],u:[{a:"txt",b:"Es = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",B:[],A:[{a:"node_in",c:"Et",i:["vec3"],g:!1},{a:"node_in",c:"Eu",i:["vec3"],g:!1},{a:"node_out",c:"Ev",i:["vec3"],g:!1},{a:"node_out",c:"Ew",i:["float"],g:!0}],u:[{a:"txt",b:"Ev = Et + Eu ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Ew"],u:[{a:"txt",b:"Ew = ( abs ( Ev [ 0 ] ) + abs ( Ev [ 1 ] ) + abs ( Ev [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",B:[],A:[{a:"node_in",c:"Ex",i:["vec3"],g:!1},{a:"node_in",c:"Ey",i:["vec3"],g:!1},{a:"node_out",c:"Ez",i:["vec3"],g:!1},{a:"node_out",c:"EA",i:["float"],g:!0}],u:[{a:"txt",b:"Ez = Ex - Ey ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EA"],u:[{a:"txt",b:"EA = ( abs ( Ez [ 0 ] ) + abs ( Ez [ 1 ] ) + abs ( Ez [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",B:[],A:[{a:"node_in",c:"EB",i:["vec3"],g:!1},{a:"node_in",c:"EC",i:["vec3"],g:!1},
{a:"node_out",c:"ED",i:["vec3"],g:!1},{a:"node_out",c:"EE",i:["float"],g:!0}],u:[{a:"txt",b:"ED = EB + EC ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EE"],u:[{a:"txt",b:"EE = length ( ED ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_ED"],u:[{a:"txt",b:"ED = normalize ( ED ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",B:[],A:[{a:"node_in",c:"EF",i:["vec3"],g:!1},{a:"node_in",c:"EG",i:["vec3"],g:!1},{a:"node_out",c:"EH",i:["vec3"],g:!1},{a:"node_out",c:"EI",
i:["float"],g:!0}],u:[{a:"txt",b:"EH = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EI"],u:[{a:"txt",b:"EI = dot ( EF , EG ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",B:[],A:[{a:"node_in",c:"EJ",i:["vec3"],g:!1},{a:"node_in",c:"EK",i:["vec3"],g:!1},{a:"node_out",c:"EL",i:["vec3"],g:!1},{a:"node_out",c:"EM",i:["float"],g:!0}],u:[{a:"txt",b:"EL = cross ( EJ , EK ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EM"],u:[{a:"txt",b:"EM = length ( EL ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",B:[],A:[{a:"node_in",c:"EN",i:["vec3"],g:!1},{a:"node_in",c:"EO",i:["vec3"],g:!1},{a:"node_out",c:"EP",i:["vec3"],g:!1},{a:"node_out",c:"EQ",i:["float"],g:!0}],u:[{a:"txt",b:"EP = normalize ( EN ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_EQ"],u:[{a:"txt",b:"EQ = length ( EN ) ;".split(" ")}]}]},{a:"txt",b:["EO",";"]}]},{a:"node",c:"B4W_REFLECT",B:[],A:[{a:"node_in",c:"EX",i:["vec3"],g:!1},{a:"node_in",c:"EY",i:["vec3"],g:!1},{a:"node_out",c:"EZ",
i:["vec3"],g:!1}],u:[{a:"txt",b:"EZ = reflect ( _ ( u_view_tsr_inverse , EX ) , EY ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",B:[],A:[{a:"node_in",c:"E_",i:["vec3"],g:!1},{a:"node_out",c:"Fa",i:["vec3"],g:!1}],u:[{a:"txt",b:"vec3 Gq = - nI . xyz ; Fa = reflect ( Gq , E_ ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",B:[],A:[{a:"node_in",c:"Fb",i:["vec3"],g:!1},{a:"node_in",c:"Fc",i:["float"],g:!1},{a:"node_in",c:"Fd",i:["const","float"],g:!1},{a:"node_in",c:"Fe",i:["const","float"],g:!1},{a:"node_out",
c:"Ff",i:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",i:["uniform","sampler2D"],g:!1}],u:[{a:"txt",b:"float bA = length ( rG ) ; if ( bA < Fe ) { vec2 bN = rd ( Fb ) ; float bR = clamp ( _0_5 * ( Fe - bA ) , _0_0 , _1_0 ) ; float he = Fc * bR ; vec3 bT = normalize ( nI * rD ) ; float bU = _1_0 / Fd ; vec2 bV = bT . xy * he / ( Fd * bT . z ) ; float bW = _1_0 ; float bX = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bN ) . a ; for ( float bZ = 1.0 ; bZ <= Fd ; bZ ++ ) { if ( bX < bW ) { bW -= bU ; bN -= bV ; bX = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bN ) . a ; } } vec2 b_ = bN + bV ; float ca = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , b_ ) . a - ( bW + bU ) ; float cb = bX - bW ; float cc = cb / ( cb - ca ) ; bN = cc * b_ + ( _1_0 - cc ) * bN ; Ff = rc ( bN ) ; } else Ff = Fb ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",B:[],A:[{a:"node_in",c:"Fg",i:["vec3"],g:!1},{a:"node_out",c:"Fh",i:["vec3"],g:!1}],u:[{a:"txt",b:"Fh = clamp ( Fg , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",B:[],A:[{a:"node_in",c:"Fi",i:["vec3"],g:!1},{a:"node_in",c:"Fj",i:["float"],g:!1},{a:"node_out",c:"Fk",i:["vec3"],g:!1}],u:[{a:"txt",b:["Fk","=","Fi",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",B:[],A:[{a:"node_in",c:"Fl",i:["float"],g:!1},{a:"node_in",c:"Fm",i:["float"],g:!1},{a:"node_in",c:"Fn",i:["float"],
g:!1},{a:"node_in",c:"Fo",i:["float"],g:!1},{a:"node_in",c:"Fp",i:["float"],g:!1},{a:"node_out",c:"Fq",i:["float"],g:!0},{a:"node_out",c:"Fr",i:["vec4"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Fq"],u:[{a:"txt",b:["Fq","=","Fl",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["USE_OUT_Fr"],u:[{a:"txt",b:"Fr = vec4 ( Fm , Fn , Fo , Fp ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",B:[],A:[{a:"node_out",c:"Fs",i:["float"],g:!1}],u:[{a:"txt",b:["Fs","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
B:[],A:[{a:"node_in",c:"Ft",i:["float"],g:!1},{a:"node_in",c:"Fu",i:["float"],g:!1},{a:"node_in",c:"Fv",i:["float"],g:!1},{a:"node_out",c:"Fw",i:["float"],g:!1}],u:[{a:"txt",b:"Fw = smoothstep ( Fu , Fv , Ft ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",B:[],A:[{a:"node_in",c:"Fx",i:["vec3"],g:!1},{a:"node_in",c:"Fy",i:["float"],g:!1}],u:[{a:"txt",b:"D = Fx ; H = Fy ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",B:[],A:[{a:"node_in",c:"Fz",i:["vec3"],g:!1},{a:"node_out",c:"FA",i:["float"],g:!1}],
u:[{a:"txt",b:"FA = ( Fz . r + Fz . g + Fz . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",B:[],A:[{a:"node_in",c:"FB",i:["float"],g:!1},{a:"node_out",c:"FC",i:["vec3"],g:!1}],u:[{a:"txt",b:"FC [ 0 ] = FB ; FC [ 1 ] = FB ; FC [ 2 ] = FB ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",f:[{a:"if",
j:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",o:11}],l:{a:"grp",f:[{a:"txt",b:["vec3","rA","=","j",";"]},{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2}],
l:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"rA = rA ; else rA = - rA ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_NORMAL_MAP"],l:{a:"grp",f:[{a:"txt",b:["vec3","rB","=","rA",";"]}]}}]},{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",o:4}],l:{a:"grp",f:[{a:"txt",b:"vec3 rC = normalize ( rA ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["DOUBLE_SIDED_LIGHTING"],l:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","rC",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 nH = normalize ( j ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_NO"],l:{a:"grp",f:[{a:"txt",b:["vec3","rz","=","rC",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["CALC_TBN_SPACE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( rC , k . xyz ) * k . w ; mat3 rD = mat3 ( k . xyz , W , rC ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["USE_NODE_NORMAL_MAP"],l:{a:"grp",f:[{a:"txt",b:"vec3 W = cross ( rA , k . xyz ) * k . w ; mat3 rF = mat3 ( k . xyz , W , rA ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rG = i ; float rH = u_emit ; float rI = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",l:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLV",b:[""]},{a:"node",c:"TEX_COORD_UV",B:[],
A:[],u:[{a:"txt",b:["A","=","Gw",";"]}]},{a:"node",c:"UV_MERGED",B:[],A:[],u:[{a:"txt",b:["A","=","Gw",";"]}]},{a:"node",c:"UVMAP",B:[],A:[],u:[{a:"txt",b:["A","=","Gw",";"]}]},{a:"node",c:"GEOMETRY_UV",B:[],A:[],u:[{a:"txt",b:["A","=","Gw",";"]}]},{a:"node",c:"PARTICLE_INFO",B:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",b:["0"]},{a:"node_var",c:"PART_INFO_VEL",
b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],A:[{a:"node_param",c:"F_",i:["GLSL_OUT","vec4"],g:!0},{a:"node_param",c:"Ga",i:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Gb",i:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Gc",i:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",i:["GLSL_IN","float"],g:!0}],u:[{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_SIZE"],u:[{a:"txt",b:"F_ [ 3 ] = Gv ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_AGE"],u:[{a:"txt",
b:"F_ [ 1 ] = Gu ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_LT"],u:[{a:"txt",b:"F_ [ 2 ] = Gx ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_LOC"],u:[{a:"txt",b:["Ga","=","Gr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_IND"],u:[{a:"txt",b:"F_ [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_VEL"],u:[{a:"txt",b:["Gb","=","Gs",";"]}]}]},{a:"node_cond",f:[{a:"node_if",j:["PART_INFO_A_VEL"],u:[{a:"txt",
b:["Gc","=","Gt",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 Gr , in vec3 Gs , in vec3 Gt , in float Gu , in float Gv , in vec2 Gw , in float Gx ) {".split(" ")},{a:"cond",f:[{a:"if",j:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["A","=","Gw",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",l:{a:"grp",f:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PROCEDURAL_GLSLF",l:{a:"grp",f:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Gy ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Gy ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Gy ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Gz ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 GA ( vec4 x ) { return Gy ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 fd ( vec2 GB ) { vec2 GC = Gy ( floor ( GB ) ) ; vec2 GD = fract ( GB ) ; vec4 GE = GD . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 GF = GD . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = GA ( GC . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = GA ( p + GC . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 GG = Gz ( p ) * K + K2 ; vec4 GH = Gz ( floor ( p * K ) ) * K + K2 ; vec4 GI = GE + JITTER * GG ; vec4 GJ = GF + JITTER * GH ; vec4 dn = GI * GI + GJ * GJ ;".split(" ")},
{a:"cond",f:[{a:"if",j:[1],l:{a:"grp",f:[{a:"txt",b:"dn . xy = min ( dn . xy , dn . zw ) ; dn . x = min ( dn . x , dn . y ) ; return dn . xx ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"dn . xy = ( dn . x < dn . y ) ? dn . xy : dn . yx ; dn . xz = ( dn . x < dn . z ) ? dn . xz : dn . zx ; dn . xw = ( dn . x < dn . w ) ? dn . xw : dn . wx ; dn . y = min ( dn . y , dn . z ) ; dn . y = min ( dn . y , dn . w ) ; return sqrt ( dn . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kk ( vec2 GB , float GK ) { vec2 GC = Gy ( floor ( GB ) ) ; vec2 GD = fract ( GB ) ; vec4 GE = GD . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 GF = GD . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = GA ( GC . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = GA ( p + GC . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 GG = Gz ( p ) * K + K2 ; vec4 GH = Gz ( floor ( p * K ) ) * K + K2 ; vec4 GI = GE + JITTER * GG ; vec4 GJ = GF + JITTER * GH ; vec4 GL = GI * GI + GJ * GJ ; GI += GK ; GJ += GK ; vec4 GM = GI * GI + GJ * GJ ; GI += GK ; GJ += GK ; vec4 GN = GI * GI + GJ * GJ ; GL . xy = min ( GL . xy , GL . zw ) ; GL . x = min ( GL . x , GL . y ) ; GM . xy = min ( GM . xy , GM . zw ) ; GM . x = min ( GM . x , GM . y ) ; GN . xy = min ( GN . xy , GN . zw ) ; GN . x = min ( GN . x , GN . y ) ; return vec3 ( GL . x , GM . x , GN . x ) ; } vec3 GO ( vec3 x ) { return Gy ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eT ( vec2 kd ) { const vec4 GP = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bZ = floor ( kd + dot ( kd , GP . yy ) ) ; vec2 GQ = kd - bZ + dot ( bZ , GP . xx ) ; vec2 GR ; GR = ( GQ . x > GQ . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 GS = GQ . xyxy + GP . xxzz ; GS . xy -= GR ; bZ = Gy ( bZ ) ; vec3 p = GO ( GO ( bZ . y + vec3 ( _0_0 , GR . y , _1_0 ) ) + bZ . x + vec3 ( _0_0 , GR . x , _1_0 ) ) ; vec3 aA = max ( 0.5 - vec3 ( dot ( GQ , GQ ) , dot ( GS . xy , GS . xy ) , dot ( GS . zw , GS . zw ) ) , _0_0 ) ; aA = aA * aA ; aA = aA * aA ; vec3 x = 2.0 * fract ( p * GP . www ) - _1_0 ; vec3 bX = abs ( x ) - 0.5 ; vec3 GG = floor ( x + 0.5 ) ; vec3 GT = x - GG ; aA *= 1.79284291400159 - 0.85373472095314 * ( GT * GT + bX * bX ) ; vec3 g ; g . x = GT . x * GQ . x + bX . x * GQ . y ; g . yz = GT . yz * GS . xz + bX . yz * GS . yw ; return 130.0 * dot ( aA , g ) ; } vec2 GW ( vec2 fu ) { float GL = dot ( fu , vec2 ( 12.9898 , 78.233 ) ) ; float GM = dot ( fu , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float GU = fract ( sin ( GL ) * 43758.5453 ) * 2.0 - _1_0 ; float GV = fract ( sin ( GM ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( GU , GV ) ; } float ku ( vec2 GX ) { return fract ( sin ( dot ( GX , vec2 ( 12.9898 , 78.233 ) ) ) * 43758.5453 ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"REFRACTION_GLSLF",l:{a:"grp",f:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",f:[{a:"if",j:["REFRACTIVE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["USE_REFRACTION_CORRECTION"],l:{a:"grp",f:[{a:"include",D:"pack.glslf"}]}}]},{a:"include",D:"color_util.glslf"},{a:"cond",f:[{a:"if",j:["USE_REFRACTION_CORRECTION"],l:{a:"grp",f:[{a:"txt",b:"float eo ( in float cG , inout vec2 en , in vec2 ee ) { vec4 GY = GLSL_TEXTURE ( u_scene_depth , en ) ; float ep = cF ( GY ) ; if ( ep < m ) { en = ee ; return cG ; } else { return ep ; } return cG ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cB ( in vec3 qC , in vec2 GZ ) { vec2 ee = qC . xy / qC . z ; vec2 en = ee + GZ ;".split(" ")},{a:"cond",f:[{a:"if",j:["USE_REFRACTION_CORRECTION"],l:{a:"grp",f:[{a:"txt",b:"vec4 cE = GLSL_TEXTURE_PROJ ( u_scene_depth , qC ) ; float cG = cF ( cE ) ; eo ( cG , en , ee ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 et = GLSL_TEXTURE ( u_refractmap , en ) . rgb ; cg ( et ) ; return et ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
l:{a:"grp",f:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 az ( vec2 bN , vec3 G_ ) { return ( bN + 0.5 ) * G_ . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLF",l:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"RGBA_SHADOWS",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"procedural.glslf"}]}}]},
{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"const float Ha = 0.1 ; const float Hb = 0.1 ; const float Hc = - 0.01 ; const float Hd = 0.05 ;".split(" ")},{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 He = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Hf = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Hg = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Hh = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Hi = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Hj = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Hk = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Hl = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",j:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 He = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Hf = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Hg = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Hh = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Hi = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Hj = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Hk = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Hl = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",j:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 He = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Hf = vec2 ( 0.5741194 , 0.0 ) ; vec2 Hg = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Hh = vec2 ( 0.82934988 , 0.0 ) ; vec2 Hi = vec2 ( 0.70009436 , 0.0 ) ; vec2 Hj = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Hk = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Hl = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool Hn ( vec2 hT , float Hm ) { return all ( lessThanEqual ( hT , vec2 ( 1.0 + Hm ) ) ) && all ( greaterThanEqual ( hT , vec2 ( 0.0 - Hm ) ) ) ; } float Hu ( float Ho , float Hp , mat2 Hq , vec3 Hr , float Hs , PRECISION GLSL_SMPLR2D_SHDW Ht ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec2 hT , ff ; ff . x = Ho ; ff . y = Hp ; ff = Hq * ff ; hT = Hr . xy + ff * Hs / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec2 hT = Hr . xy ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"if ( ! Hn ( hT , Hc ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["RGBA_SHADOWS"],l:{a:"grp",
f:[{a:"txt",b:"float dM = cF ( GLSL_TEXTURE ( Ht , hT ) ) ; return step ( Hr . z , dM ) ;".split(" ")}]}},{a:"elif",j:["COMPARED_MODE"],l:{a:"grp",f:[{a:"txt",b:"return GLSL_TEXTURE ( Ht , vec3 ( hT , Hr . z ) ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"return step ( Hr . z , GLSL_TEXTURE ( Ht , hT ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Hz ( vec3 Hr , PRECISION GLSL_SMPLR2D_SHDW Ht , float Hs ) { float Hv = 0.0 ; Hr . z = clamp ( Hr . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",
f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float Hw = GW ( Hr . xy ) . x * M_PI ; float Hx = cos ( Hw ) ; float Hy = sin ( Hw ) ; mat2 Hq = mat2 ( Hx , Hy , - Hy , Hx ) ; for ( int bZ = 0 ; bZ < POISSON_DISK_NUM ; bZ ++ ) { Hv += Hu ( He [ bZ ] , Hi [ bZ ] , Hq , Hr , Hs , Ht ) ; Hv += Hu ( Hf [ bZ ] , Hj [ bZ ] , Hq , Hr , Hs , Ht ) ; Hv += Hu ( Hg [ bZ ] , Hk [ bZ ] , Hq , Hr , Hs , Ht ) ; Hv += Hu ( Hh [ bZ ] , Hl [ bZ ] , Hq , Hr , Hs , Ht ) ; } return clamp ( Hv / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"return Hu ( 0.0 , 0.0 , mat2 ( 0.0 ) , Hr , Hs , Ht ) ;".split(" ")}]}}]},{a:"txt",b:"} float HI ( vec3 HA , PRECISION GLSL_SMPLR2D_SHDW HB , vec3 HC , PRECISION GLSL_SMPLR2D_SHDW HD , float HE , float HF , float aL ) { float HG , HH ; HA . z = clamp ( HA . z , 0.0 , 1.0 ) ; HC . z = clamp ( HC . z , 0.0 , 1.0 ) ; HG = 0.0 ; HH = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float Hw = GW ( HA . xy ) . x * M_PI ; float Hx = cos ( Hw ) ; float Hy = sin ( Hw ) ; mat2 Hq = mat2 ( Hx , Hy , - Hy , Hx ) ; for ( int bZ = 0 ; bZ < POISSON_DISK_NUM ; bZ ++ ) { HG += Hu ( He [ bZ ] , Hi [ bZ ] , Hq , HA , HE , HB ) ; HG += Hu ( Hf [ bZ ] , Hj [ bZ ] , Hq , HA , HE , HB ) ; HG += Hu ( Hg [ bZ ] , Hk [ bZ ] , Hq , HA , HE , HB ) ; HG += Hu ( Hh [ bZ ] , Hl [ bZ ] , Hq , HA , HE , HB ) ; } for ( int bZ = 0 ; bZ < POISSON_DISK_NUM ; bZ ++ ) { HH += Hu ( He [ bZ ] , Hi [ bZ ] , Hq , HC , HF , HD ) ; HH += Hu ( Hf [ bZ ] , Hj [ bZ ] , Hq , HC , HF , HD ) ; HH += Hu ( Hg [ bZ ] , Hk [ bZ ] , Hq , HC , HF , HD ) ; HH += Hu ( Hh [ bZ ] , Hl [ bZ ] , Hq , HC , HF , HD ) ; } HG = mix ( HG , HH , aL ) ; HG /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"HG += Hu ( 0.0 , 0.0 , mat2 ( 0.0 ) , HA , HE , HB ) ; HH += Hu ( 0.0 , 0.0 , mat2 ( 0.0 ) , HC , HF , HD ) ; HG = mix ( HG , HH , aL ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( HG , 0.0 , 1.0 ) ; } float HJ ( vec2 hT ) { float a = min ( hT . x , hT . y ) ; float b = min ( 1.0 - hT . x , 1.0 - hT . y ) ; return min ( a , b ) ; } float HL ( float tX , float HK ) { if ( HK >= 0.0 && HK <= Hb ) tX = ( tX - 1.0 ) / Hb * HK + 1.0 ; return tX ; } float HQ ( vec3 HM , vec3 HN , PRECISION GLSL_SMPLR2D_SHDW HB , PRECISION GLSL_SMPLR2D_SHDW HD , float HE , float HF , float HO , float dM ) { float tX ;".split(" ")},
{a:"cond",f:[{a:"if",j:["CSM_BLEND_BETWEEN_CASCADES"],l:{a:"grp",f:[{a:"txt",b:"float HK = HJ ( HM . xy ) ; if ( - dM > HO && HK >= 0.0 && HK <= Ha && Hn ( HN . xy , 0.0 ) ) { float HP = 1.0 - HK / Ha ; tX = HI ( HM , HB , HN , HD , HE , HF , HP ) ; } else".split(" ")}]}}]},{a:"txt",b:"tX = Hz ( HM , HB , HE ) ; return tX ; } float HS ( vec3 HR , PRECISION GLSL_SMPLR2D_SHDW Ht , float Hs , float HO , float dM ) { float tX = Hz ( HR , Ht , Hs ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["CSM_FADE_LAST_CASCADE"],
l:{a:"grp",f:[{a:"txt",b:"if ( - dM > HO ) { float HK = HJ ( HR . xy ) ; tX = HL ( tX , HK ) ; }".split(" ")}]}}]},{a:"txt",b:"return tX ; } vec4 dO ( float dM ) { float tX = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",j:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["vec4","HT","=","u_pcf_blur_radii",";"]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 HT = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 HA = n . xyz / n . w ; if ( n . w < 0.0 ) HA . z = 0.0 ;".split(" ")},
{a:"cond",f:[{a:"if",j:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 HC = o . xyz / o . w ; if ( o . w < 0.0 ) HC . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 HU = u . xyz / u . w ; if ( u . w < 0.0 ) HU . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",o:2},{a:"logical_or_expr",
o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 HV = v . xyz / v . w ; if ( v . w < 0.0 ) HV . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1"],l:{a:"grp",f:[{a:"txt",b:"if ( Hn ( HA . xy , 0.0 ) ) { tX = HQ ( HA , HC , u_shadow_map0 , u_shadow_map1 , HT [ 0 ] , HT [ 1 ] , u_csm_center_dists [ 0 ] , dM ) ; }".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"if ( Hn ( HA . xy , Hd ) ) { tX = HS ( HA , u_shadow_map0 , HT [ 0 ] , u_csm_center_dists [ 0 ] , dM ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",j:["CSM_SECTION1"],l:{a:"grp",f:[{a:"txt",b:"else { if ( Hn ( HC . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",j:["CSM_SECTION2"],l:{a:"grp",f:[{a:"txt",b:"tX = HQ ( HC , HU , u_shadow_map1 , u_shadow_map2 , HT [ 1 ] , HT [ 2 ] , u_csm_center_dists [ 1 ] , dM ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"tX = HS ( HC , u_shadow_map1 , HT [ 1 ] , u_csm_center_dists [ 1 ] , dM ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2"],l:{a:"grp",f:[{a:"txt",
b:"else { if ( Hn ( HU . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",j:["CSM_SECTION3"],l:{a:"grp",f:[{a:"txt",b:"tX = HQ ( HU , HV , u_shadow_map2 , u_shadow_map3 , HT [ 2 ] , HT [ 3 ] , u_csm_center_dists [ 2 ] , dM ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"tX = HS ( HU , u_shadow_map2 , HT [ 2 ] , u_csm_center_dists [ 2 ] , dM ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3"],l:{a:"grp",f:[{a:"txt",b:"else { if ( Hn ( HV . xy , 0.0 ) ) tX = HS ( HV , u_shadow_map3 , HT [ 3 ] , u_csm_center_dists [ 3 ] , dM ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_CAST_LAMPS",1,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float HW = Hz ( HC , u_shadow_map1 , HT [ 0 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["float","HW","=","0.0",";"]}]}}]},{a:"cond",f:[{a:"if",j:["NUM_CAST_LAMPS",2,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float HX = Hz ( HU , u_shadow_map2 , HT [ 0 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["float","HX","=","0.0",";"]}]}}]},{a:"cond",
f:[{a:"if",j:["NUM_CAST_LAMPS",3,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"float HY = Hz ( HV , u_shadow_map3 , HT [ 0 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:["float","HY","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tX , HW , HX , HY ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 cq ( inout vec3 cm ) {".split(" ")},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 Hv = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["NUM_CAST_LAMPS",3,{a:"l_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"cm *= Hv . a ;".split(" ")}]}}]},{a:"txt",b:["return","Hv",";"]}]}},{a:"elif",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 Hv = dO ( i . z ) ; return Hv ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLV",l:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",o:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"include",D:"math.glslv"},{a:"txt",b:"vec4 Ib ( mat4 HZ , vec4 H_ , mat4 Ia ) { vec2 dQ = ( HZ * Ia [ 3 ] ) . xy ; float dR = SHADOW_TEX_RES / 2.0 ; dQ = floor ( dQ * dR + 0.5 ) / dR - dQ ; vec4 Hr = HZ * H_ ; Hr . xy += dQ ; Hr . xyz = 0.5 * ( Hr . xyz + Hr . w ) ; return Hr ; } void bM ( vec3 eL , vec3 Ic ) {".split(" ")},{a:"cond",f:[{a:"if",j:["MAC_OS_SHADOW_HACK"],l:{a:"grp",f:[{a:"txt",b:"mat4 Ia = bc ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"mat4 Ia = bc ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 Id = Ia * vec4 ( eL + u_normal_offset * Ic , 1.0 ) ; n = Ib ( u_p_light_matrix0 , Id , Ia ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["NUM_CAST_LAMPS",1,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAC_OS_SHADOW_HACK"],l:{a:"grp",f:[{a:"txt",b:"Ia = bc ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"Ia = bc ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"Id = Ia * vec4 ( eL + u_normal_offset * Ic , 1.0 ) ; o = Ib ( u_p_light_matrix1 , Id , Ia ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["NUM_CAST_LAMPS",2,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAC_OS_SHADOW_HACK"],l:{a:"grp",f:[{a:"txt",b:"Ia = bc ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"Ia = bc ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Id = Ia * vec4 ( eL + u_normal_offset * Ic , 1.0 ) ; u = Ib ( u_p_light_matrix2 , Id , Ia ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["NUM_CAST_LAMPS",3,{a:"g_expr",o:2}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MAC_OS_SHADOW_HACK"],l:{a:"grp",f:[{a:"txt",b:"Ia = bc ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"Ia = bc ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Id = Ia * vec4 ( eL + u_normal_offset * Ic , 1.0 ) ; v = Ib ( u_p_light_matrix3 , Id , Ia ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION1"],l:{a:"grp",f:[{a:"txt",
b:"o = Ib ( u_p_light_matrix1 , Id , Ia ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION2"],l:{a:"grp",f:[{a:"txt",b:"u = Ib ( u_p_light_matrix2 , Id , Ia ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["CSM_SECTION3"],l:{a:"grp",f:[{a:"txt",b:"v = Ib ( u_p_light_matrix3 , Id , Ia ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKIN_GLSLV",l:{a:"grp",f:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",f:[{a:"if",j:["SKINNED"],l:{a:"grp",f:[{a:"include",D:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",f:[{a:"if",j:["SKIN_SLERP"],l:{a:"grp",f:[{a:"txt",b:"vec4 Il ( in vec4 qf , in vec4 Ie , in float If ) { float Ig = qf [ 0 ] * Ie [ 0 ] + qf [ 1 ] * Ie [ 1 ] + qf [ 2 ] * Ie [ 2 ] + qf [ 3 ] * Ie [ 3 ] ; if ( Ig < 0.0 ) { Ie *= - 1.0 ; Ig = - Ig ; } if ( abs ( Ig ) >= 1.0 ) return qf ; float Ih = acos ( Ig ) ; float Ii = sqrt ( 1.0 - Ig * Ig ) ; if ( abs ( Ii ) < 0.001 ) return vec4 ( qf * 0.5 + Ie * 0.5 ) ; float Ij = sin ( ( 1.0 - If ) * Ih ) / Ii ; float Ik = sin ( If * Ih ) / Ii ; return qf * Ij + Ie * Ik ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:"vec3 Iz ( in vec3 O , in vec4 Im , in vec4 In , in vec4 Io , in vec4 Ip , in float Iq ) { vec3 Ir = qr ( u_arm_rel_trans , u_arm_rel_quat , O ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SKIN_SLERP"],l:{a:"grp",f:[{a:"txt",b:"vec4 qf = Il ( Im , In , Iq ) ; vec4 Is = mix ( Io , Ip , Iq ) ; vec3 It = T ( qf , Ir ) ; vec3 Iu = It * Is . w + Is . xyz ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 Iv = T ( Im , Ir ) ; vec3 Iw = T ( In , Ir ) ; vec3 Ix = Iv * Io . w + Io . xyz ; vec3 Iy = Iw * Ip . w + Ip . xyz ; vec3 Iu = mix ( Ix , Iy , Iq ) ;".split(" ")}]}}]},
{a:"txt",b:"return qw ( u_arm_rel_trans , u_arm_rel_quat , Iu ) ; } vec3 IF ( in vec3 IA , in vec4 Im , in vec4 In , in float Iq ) { vec3 IB = qv ( u_arm_rel_trans , u_arm_rel_quat , IA ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["SKIN_SLERP"],l:{a:"grp",f:[{a:"txt",b:"vec4 qf = Il ( Im , In , Iq ) ; vec3 IC = T ( qf , IB ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 ID = T ( Im , IB ) ; vec3 IE = T ( In , IB ) ; vec3 IC = mix ( ID , IE , Iq ) ;".split(" ")}]}}]},{a:"txt",b:"return qx ( u_arm_rel_trans , u_arm_rel_quat , IC ) ; }".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 Iz ( in vec3 O , in vec4 Im , in vec4 Io ) { vec3 Ir = qr ( u_arm_rel_trans , u_arm_rel_quat , O ) ; vec3 It = T ( Im , Ir ) ; vec3 Iu = It * Io . w + Io . xyz ; return qw ( u_arm_rel_trans , u_arm_rel_quat , Iu ) ; } vec3 IF ( in vec3 IA , in vec4 Im ) { vec3 IB = qv ( u_arm_rel_trans , u_arm_rel_quat , IA ) ; vec3 IC = T ( Im , IB ) ; return qx ( u_arm_rel_trans , u_arm_rel_quat , IC ) ; }".split(" ")}]}}]},{a:"txt",b:"void an ( inout vec3 O , inout vec3 V , inout vec3 W , inout vec3 U ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:["float","IG","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iO = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 IH = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 II = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 IJ = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 IK = a_influence ; for ( int bZ = 0 ; bZ < 4 ; bZ ++ ) { int IL = int ( IK [ bZ ] ) ; float IM = fract ( IK [ bZ ] ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",
b:"IH += IM * IF ( V , u_quatsb [ IL ] , u_quatsa [ IL ] , IG ) ; II += IM * IF ( W , u_quatsb [ IL ] , u_quatsa [ IL ] , IG ) ; IJ += IM * IF ( U , u_quatsb [ IL ] , u_quatsa [ IL ] , IG ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"iO += IM * Iz ( O , u_quatsb [ IL ] , u_transb [ IL ] ) ; IJ += IM * IF ( U , u_quatsb [ IL ] ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"IH += IM * IF ( V , u_quatsb [ IL ] ) ; II += IM * IF ( W , u_quatsb [ IL ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:"int IL = int ( IK [ 0 ] ) ; float IM = fract ( IK [ 0 ] ) ; iO += IM * Iz ( O , u_quatsb [ IL ] , u_quatsa [ IL ] , u_transb [ IL ] , u_transa [ IL ] , IG ) ; IL = int ( IK [ 1 ] ) ; IM = fract ( IK [ 1 ] ) ; iO += IM * Iz ( O , u_quatsb [ IL ] , u_quatsa [ IL ] , u_transb [ IL ] , u_transa [ IL ] , IG ) ; IL = int ( IK [ 2 ] ) ; IM = fract ( IK [ 2 ] ) ; iO += IM * Iz ( O , u_quatsb [ IL ] , u_quatsa [ IL ] , u_transb [ IL ] , u_transa [ IL ] , IG ) ; IL = int ( IK [ 3 ] ) ; IM = fract ( IK [ 3 ] ) ; iO += IM * Iz ( O , u_quatsb [ IL ] , u_quatsa [ IL ] , u_transb [ IL ] , u_transa [ IL ] , IG ) ;".split(" ")}]}}]},
{a:"txt",b:"O = iO ; U = IJ ;".split(" ")},{a:"cond",f:[{a:"if",j:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"V = IH ; W = II ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int IN = int ( a_influence [ 0 ] - 1.0 ) ; if ( IN > - 1 ) {".split(" ")},{a:"cond",f:[{a:"if",j:["FRAMES_BLENDING"],l:{a:"grp",f:[{a:"txt",b:"O = Iz ( O , u_quatsb [ IN ] , u_quatsa [ IN ] , u_transb [ IN ] , u_transa [ IN ] , IG ) ; V = IF ( V , u_quatsb [ IN ] , u_quatsa [ IN ] , IG ) ; W = IF ( W , u_quatsb [ IN ] , u_quatsa [ IN ] , IG ) ; U = IF ( U , u_quatsb [ IN ] , u_quatsa [ IN ] , IG ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"O = Iz ( O , u_quatsb [ IN ] , u_transb [ IN ] ) ; U = IF ( U , u_quatsb [ IN ] ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"V = IF ( V , u_quatsb [ IN ] ) ; W = IF ( W , u_quatsb [ IN ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",l:{a:"grp",f:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",D:"std.glsl"},{a:"include",D:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 IO ( vec3 jw , vec3 jx , float aL , float jW ) { float jy = aL * jW ;".split(" ")},{a:"cond",f:[{a:"if",j:["BLENDTYPE",
"MIX",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jz ( jx , jw , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","ADD",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jA ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","SUBTRACT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jB ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","MULTIPLY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jD ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE",
"SCREEN",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jE ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","OVERLAY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jF ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jG ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","DIVIDE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jH ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE",
"DARKEN",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jI ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","LIGHTEN",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jJ ( jw , jx , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","HUE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jN ( jx , jw , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","SATURATION",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jO ( jx , jw , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE",
"VALUE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jP ( jx , jw , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","COLOR",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jQ ( jx , jw , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jS ( jx , jw , jy ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jT ( jx , jw , jy ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float IP ( float jU , float jV , float aL , float jW ) { vec3 jw = vec3 ( jU ) , jx = vec3 ( jV ) ; float jy = aL * jW ;".split(" ")},{a:"cond",f:[{a:"if",j:["BLENDTYPE","MIX",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jz ( jx , jw , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","ADD",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jA ( jw , jx , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","SUBTRACT",{a:"equal_expr",o:2}],l:{a:"grp",
f:[{a:"txt",b:"return jB ( jw , jx , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","MULTIPLY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jX ( jU , jV , jy , jW ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","SCREEN",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jY ( jU , jV , jy , jW ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","OVERLAY",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jZ ( jU , jV , jy , jW ) ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jG ( jw , jx , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","DIVIDE",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jH ( jw , jx , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","DARKEN",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jI ( jw , jx , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","LIGHTEN",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jJ ( jw , jx , jy ) . x ;".split(" ")}]}},{a:"elif",
j:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jS ( jx , jw , jy ) . x ;".split(" ")}]}},{a:"elif",j:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"return jT ( jx , jw , jy ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dY ( vec3 dU , vec3 dV , vec4 dX , float dT , vec3 dW ) { float IQ = 1.0 ; IQ = dX . a ;".split(" ")},{a:"cond",f:[{a:"if",j:["MTEX_RGBTOINT"],l:{a:"grp",f:[{a:"txt",b:"IQ = fB ( dX ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",j:["MTEX_NEGATIVE"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MTEX_RGBTOINT",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"dX = vec4 ( vec3 ( 1.0 ) - dX . rgb , dX . a ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"IQ = 1.0 - IQ ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",o:3}],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MTEX_RGBTOINT"],l:{a:"grp",f:[{a:"txt",b:"dX = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"IQ = dX . a ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WOMAP_HORIZ"],l:{a:"grp",f:[{a:"txt",b:"dU = IO ( dX . rgb , dU , IQ , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:["float","IR","=","0.0",";"]},{a:"cond",f:[{a:"if",j:["WO_SKYREAL"],l:{a:"grp",f:[{a:"txt",b:"if ( dot ( dW , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",j:["WOMAP_ZENUP"],
l:{a:"grp",f:[{a:"txt",b:"IR = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",j:["WOMAP_ZENDOWN"],l:{a:"grp",f:[{a:"txt",b:"else IR = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["WOMAP_ZENUP"],l:{a:"grp",f:[{a:"txt",b:"IR = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",j:["WOMAP_ZENDOWN"],l:{a:"grp",f:[{a:"txt",b:"IR = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( IR != 0.0 ) dV = IO ( dX . rgb , dV , IQ , IR ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",j:["WOMAP_BLEND"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["MTEX_RGBTOINT",{a:"logic_negative_expr",o:1}],l:{a:"grp",f:[{a:"txt",b:"IQ = dot ( dX . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dT = IP ( u_sky_tex_dvar , dT , IQ , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["WO_SKYBLEND"],l:{a:"grp",f:[{a:"txt",b:"vec3 dS = mix ( dU , dV , dT ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:["vec3","dS","=","dU",";"]}]}}]},{a:"txt",b:["return","dS",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"STD_ENUMS_GLSL",l:{a:"grp",f:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"BLUR_PASS_1",b:["1"]},{a:"define",c:"BLUR_PASS_2",b:["2"]},{a:"define",c:"BLUR_PASS_3",b:["3"]},{a:"define",c:"BLUR_PASS_4",b:["4"]},{a:"define",c:"BLUR_PASS_5",b:["5"]},
{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",
c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["25"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["24"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["23"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["26"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",
c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},
{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},{a:"cond",f:[{a:"if",j:["CONSTANTS_HACK"],l:{a:"grp",f:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",
c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"TO_WORLD_GLSLV",l:{a:"grp",f:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",D:"math.glslv"},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},
{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",f:[{a:"if",j:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",o:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"mat3 bj ( vec3 IS , mat3 N ) { vec4 IT = vec4 ( N [ 1 ] [ 1 ] , N [ 1 ] [ 2 ] , N [ 2 ] [ 0 ] , N [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec4 IU = X ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec4 IU = X ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},{a:"txt",b:"IT = qh ( IU , IT ) ; IT = ke ( IT ) ; mat3 bk = cQ ( ) ; bk [ 0 ] = IS ; bk = cT ( IT , bk ) ; return bk ; }".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"mat3 IW ( vec3 kV , vec3 IS ) { vec3 IV = kV - IS ; IV . z = 0.0 ; IV = normalize ( IV ) ; vec4 IT = qm ( IV , TOWARD_VECTOR ) ; mat3 bk = cQ ( ) ; bk [ 0 ] = IS ; bk = cT ( IT , bk ) ; return bk ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",j:["BILLBOARD_JITTERED"],l:{a:"grp",f:[{a:"txt",b:"mat3 at ( in vec3 IX , float IY , float IZ , float I_ , vec3 a_ , mat3 Z ) { float GX = fract ( length ( a_ ) / 0.17 ) ; float Ja = I_ + GX / 10.0 ; float Jb = GX ; if ( I_ != 0.0 ) Jb /= I_ ; IX *= 1.0 + 0.5 * sin ( IY ) ; float Jc = length ( IX ) * IZ * sin ( 2.0 * 3.14 * IY * Ja + Jb ) ; vec4 Jd = X ( TOWARD_VECTOR , Jc ) ; vec4 Je = vec4 ( Z [ 1 ] [ 1 ] , Z [ 1 ] [ 2 ] , Z [ 2 ] [ 0 ] , Z [ 2 ] [ 1 ] ) ; Je = qh ( Je , Jd ) ; Z = cT ( Je , Z ) ; return Z ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 as ( in vec3 kV , in vec3 aq , in mat3 N , in mat3 Z ) {".split(" ")},{a:"cond",f:[{a:"if",j:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",o:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",o:2},{a:"logical_and_expr",o:2},{a:"logical_or_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"mat3 lj = bj ( aq , N ) ;".split(" ")}]}},{a:"elif",j:["BILLBOARD_RANDOM"],l:{a:"grp",f:[{a:"txt",b:"float GX = fract ( ( aq . x * 1.43 - aq . z * 0.123 + aq . y * 6.1 ) ) ; float Jf = 2.0 * M_PI * GX ; vec4 Jg = vec4 ( N [ 1 ] [ 1 ] , N [ 1 ] [ 2 ] , N [ 2 ] [ 0 ] , N [ 2 ] [ 1 ] ) ; float Jh = asin ( 2.0 * ( Jg . x * Jg . y - Jg . z * Jg . w ) ) ; float gT = Jh - Jf ; if ( gT < 0.0 ) gT = 2.0 * M_PI + gT ; float Ji = Jf ; if ( gT <= MAX_BILLBOARD_ANGLE ) Ji += gT ; else if ( gT <= M_PI - MAX_BILLBOARD_ANGLE ) Ji += MAX_BILLBOARD_ANGLE * ( 2.0 * gT - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gT <= M_PI + MAX_BILLBOARD_ANGLE ) Ji += gT - M_PI ; else if ( gT <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) Ji += MAX_BILLBOARD_ANGLE * ( 2.0 * gT - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else Ji += gT - 2.0 * M_PI ; vec4 Jj = X ( UP_VECTOR , Ji ) ; mat3 lj = cQ ( ) ; lj [ 0 ] = aq ; lj = cT ( Jj , lj ) ;".split(" ")}]}},
{a:"else",l:{a:"grp",f:[{a:"txt",b:"mat3 lj = IW ( kV , aq ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",o:1},{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"Z [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aY ( lj , Z ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"lj [ 1 ] [ 0 ] *= Z [ 1 ] [ 0 ] ;".split(" ")}]}}]},{a:"txt",b:"return lj ; } au av ( in vec3 eL , in vec3 Jk , in vec3 Jl , in vec3 Jm , in vec3 Jn , in vec3 Jo , in mat3 Z ) { eL = ap ( Z , eL ) ; Jk = ap ( Z , Jk ) ; Jl = _ ( Z , Jl ) ; Jm = _ ( Z , Jm ) ; Jn = _ ( Z , Jn ) ; Jo = _ ( Z , Jo ) ; return lk ( au ( eL , Jk , Jl , Jm , Jn , Jo , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};
a["include/wind_bending.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"WIND_BENDING_GLSLV",l:{a:"grp",f:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",D:"std.glsl"},{a:"cond",f:[{a:"if",j:["WIND_BEND"],l:{a:"grp",f:[{a:"txt",b:"void JB ( inout vec3 bo , in vec3 Jp , in float Jq , in float Jr , in float eS , in vec3 IX , in float Js , in mat4 bI ) {".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2},"BILLBOARD",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 Jt = ( bI * vec4 ( bo , 1.0 ) ) . xyz ; vec3 Ju = ( bI * vec4 ( Jp , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 Jt = bo ; vec3 Ju = Jp ;".split(" ")}]}}]},{a:"txt",b:"float dp = length ( Ju ) ; float Jv = Jr * ( 1.0 + 0.1 * fract ( dp ) ) ; float Jw = Jq * Js * ( 1.0 + sin ( 2.0 * 3.14 * eS * Jv + dp ) ) ; float Jx = ( Jt . z - Ju . z ) * abs ( Jw ) ; Jx += 1.0 ; Jx *= Jx ; Jx = Jx * Jx - Jx ; vec3 Jy = Jt ; Jy . xy += IX . xy * Jx * sign ( Jw ) ; vec3 Jz = Jy - Ju ; if ( all ( equal ( Jz , vec3 ( 0.0 ) ) ) ) bo = Jp ; else {".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2},"BILLBOARD",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"Jz = ( bI * vec4 ( Jz , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float JA = length ( Jt - Ju ) ; bo = Jp + normalize ( Jz ) * JA ; } }".split(" ")},{a:"cond",f:[{a:"if",j:["DETAIL_BEND"],l:{a:"grp",f:[{a:"txt",b:"vec4 JC ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 JD ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 JE ( vec4 x ) { return JC ( JD ( x ) ) ; } void JQ ( inout vec3 bo , in float eS , in vec3 U , in vec3 IX , in vec3 Jp , in float JF , in float JG , in float JH , in vec3 JI , in mat4 bI ) { float JJ ; float JK ; float JL ; vec2 JM ; vec4 JN ; vec2 JO ; vec3 JP ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2},"BILLBOARD",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"vec3 Jt = ( bI * vec4 ( bo , 1.0 ) ) . xyz ; vec3 Ju = ( bI * vec4 ( Jp , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 Jt = bo ; vec3 Ju = Jp ;".split(" ")}]}}]},{a:"txt",b:"JJ = dot ( Ju , vec3 ( 1.0 ) ) ; JK = JJ + JI . g ; JL = dot ( Jt , vec3 ( JI . g ) ) ; JM = ( eS + vec2 ( JL , JK ) ) ; JN = ( ( fract ( ( JM . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( IX ) * JF ; JN = JE ( JN ) ; JO = JN . xz + JN . yw ; JO . y = 0.5 - JO . y ; JP = JO . xxy * JI . rrb * vec3 ( JG * U . x , JG * U . y , JH ) ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2},"BILLBOARD",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"JP = ( bI * vec4 ( JP , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bo","+=","JP",";","}"]}]}}]},{a:"txt",b:"void ax ( inout vec3 O , inout vec3 ao , in vec3 U , in mat4 bI ) { vec3 JR = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",f:[{a:"if",j:["BEND_CENTER_ONLY"],l:{a:"grp",f:[{a:"txt",b:"vec3 JS = ao ; vec3 JT = a_emitter_center ;".split(" ")},
{a:"cond",f:[{a:"if",j:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",o:2},"BILLBOARD",{a:"logical_and_expr",o:2}],l:{a:"grp",f:[{a:"txt",b:"JT = ( bI * vec4 ( JT , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"vec3 JS = O ; vec3 JT = ao ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["MAIN_BEND_COL"],l:{a:"grp",f:[{a:"cond",f:[{a:"if",j:["DETAIL_BEND"],l:{a:"grp",f:[{a:"txt",b:"JQ ( JS , u_time , U , JR , JT , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , bI ) ;".split(" ")}]}}]},
{a:"txt",b:"JB ( JS , JT , au_wind_bending_amp , au_wind_bending_freq , u_time , JR , a_bending_col_main , bI ) ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"JB ( JS , JT , au_wind_bending_amp , au_wind_bending_freq , u_time , JR , 1.0 , bI ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",j:["BEND_CENTER_ONLY"],l:{a:"grp",f:[{a:"txt",b:"O += JS - ao ; ao = JS ;".split(" ")}]}},{a:"else",l:{a:"grp",f:[{a:"txt",b:"O = JS ; ao = JT ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.animation=function(a,t){var e=t("__animation"),c=t("__obj_util"),b=t("__print");a.SLOT_0=e.SLOT_0;a.SLOT_1=e.SLOT_1;a.SLOT_2=e.SLOT_2;a.SLOT_3=e.SLOT_3;a.SLOT_4=e.SLOT_4;a.SLOT_5=e.SLOT_5;a.SLOT_6=e.SLOT_6;a.SLOT_7=e.SLOT_7;a.SLOT_ALL=e.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=e.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=e.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=e.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=e.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=e.OBJ_ANIM_TYPE_SOUND;a.OBJ_ANIM_TYPE_PARTICLES=
e.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=e.OBJ_ANIM_TYPE_MATERIAL;a.OBJ_ANIM_TYPE_STATIC=e.OBJ_ANIM_TYPE_STATIC;a.AB_CYCLIC=e.AB_CYCLIC;a.AB_FINISH_RESET=e.AB_FINISH_RESET;a.AB_FINISH_STOP=e.AB_FINISH_STOP;a.is_animated=function(a){return e.is_animated(a)};a.get_anim_names=function(a){return e.nH(a)?e.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.xQ(a,b)};a.apply=function(a,c,q){if(q>e.SLOT_7)b.error("Can't apply animation to slot "+
q+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{q=q||e.SLOT_0;if(e.is_animated(a)){var f=e.get_slot_num_by_anim(a,c);if(-1!=f&&f!=q){b.error('Animation "'+c+'" is already applied to object "'+a.name+'" (slot "'+f+'").');return}}e.FJ(a,c)?e.apply(a,null,c,q):b.error('No fcurves in action "'+c+'"')}};a.apply_ext=function(a,c,q){if(q>e.SLOT_7)b.error("Can't apply animation to slot "+q+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{q=q||
e.SLOT_0;var f=c[0];e.FJ(a,f)?e.apply(a,c.slice(1),f,q):b.error('No fcurves in action "'+f+'"')}};a.remove=function(a){e.remove(a)};a.remove_slot_animation=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.remove_slot_animation(a,b))};a.apply_def=function(a){e.apply_def(a)};a.play=function(a,c,q){e.is_animated(a)?(q=q||e.SLOT_0,e.play(a,c,q),e.UV(a,0,q,!0)):b.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.stop(a,b))};a.is_play=function(a,
b){if(!e.is_animated(a))return!1;b=b||e.SLOT_0;return e.is_play(a,b)};a.set_frame=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_frame(a,b,c))};a.set_first_frame=function(a,b){e.is_animated(a)&&e.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(e.is_animated(a)){b=b||e.SLOT_0;var c=e.get_anim_start_frame(a,b),f=e.get_anim_length(a,b);e.set_frame(a,c+f-e.sK,b)}};a.get_frame=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return e.Vz(a,b)};a.set_speed=function(a,b,c){e.is_animated(a)&&
(c=c||e.SLOT_0,e.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return a.na[b]?e.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.na[b])?e.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.na[b])?e.get_anim_length(a,b):-1};a.set_behavior=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!e.is_animated(a))return null;
b=b||e.SLOT_0;return e.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,h){h=h||e.SLOT_0;e.is_animated(a)&&e.apply_smoothing(a,b,c,h)};a.frame_to_sec=function(a){return e.frame_to_sec(a)};a.get_slot_num_by_anim=function(a,b){return e.is_animated(a)&&b?e.get_slot_num_by_anim(a,b):-1};a.get_anim_type=function(a,b){return e.is_animated(a)?e.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return e.apply_to_first_empty_slot(a,b)};a.get_skel_mix_factor=function(a){return a.v.lf};a.set_skel_mix_factor=
function(a,k,q,h){c.is_armature(a)?(k=Math.min(Math.max(k,0),1),a.v.lf!=k&&e.set_skel_mix_factor(a,k,q||0,h||null)):b.error("Can't blend animation. Object \""+a.name+'" is not armature')};a.set_skeletal_slots=function(a,b,c,e){b=void 0==b?-1:b;c=void 0==b?-1:c;var f=a.v.fi;0<=b&&(f[0]=b);0<=c&&(f[1]=c);a.v.lf=e||0};a.get_first_skeletal_slot=function(a){return a.v.fi[0]};a.get_second_skeletal_slot=function(a){return a.v.fi[1]};a.mix_from_cur_pos=function(a,b,c,h){e.mix_from_cur_pos(a,b,c||0,h||null)}};b4w.module.anchors=function(a,t){var e=t("__anchors");a.attach_move_cb=e.attach_move_cb;a.detach_move_cb=e.detach_move_cb;a.is_anchor=e.is_anchor;a.get_element_id=e.get_element_id;a.update=function(){e.update(!0)}};b4w.module.armature=function(a,t){var e=t("__armature"),c=t("__obj_util"),b=t("__transform"),f=t("__print");a.get_bone_tsr=function(a,b,h){if(!c.is_armature(a))return null;if(!e.Tt(a,b))return f.error('There is no bone: "',b,'" in "',a.name,'".'),null;h||(h=new Float32Array(8));e.get_bone_tsr(a,b,!1,!1,h);return h};a.get_bone_tsr_rel=function(a,b,h){if(!c.is_armature(a))return null;if(!e.Tt(a,b))return f.error('There is no bone: "',b,'" in "',a.name,'".'),null;h||(h=new Float32Array(8));e.get_bone_tsr(a,
b,!1,!0,h);return h};a.set_bone_tsr=function(a,q,h){c.is_armature(a)&&(e.Tt(a,q)?(e.set_bone_tsr(a,q,h,!1),b.T(a)):f.error('There is no bone: "',q,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,q,h){c.is_armature(a)&&(e.Tt(a,q)?(e.set_bone_tsr(a,q,h,!0),b.T(a)):f.error('There is no bone: "',q,'" in "',a.name,'".'))}};b4w.module.assets=function(a,t){var e=t("__assets");a.AT_ARRAYBUFFER=e.AT_ARRAYBUFFER;a.AT_ARRAYBUFFER_ZIP=e.AT_ARRAYBUFFER_ZIP;a.AT_JSON=e.AT_JSON;a.AT_JSON_ZIP=e.AT_JSON_ZIP;a.AT_TEXT=e.AT_TEXT;a.AT_AUDIOBUFFER=e.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=e.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=e.AT_AUDIO_ELEMENT;a.AT_VIDEO_ELEMENT=e.AT_VIDEO_ELEMENT;a.AT_SEQ_VIDEO_ELEMENT=e.AT_SEQ_VIDEO_ELEMENT;a.enqueue=function(a,b,f,k){a.length&&e.enqueue(a,b,f,k)}};b4w.module.camera=function(a,t){function e(a,b){if(!q.is_camera(a))return u.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=d.get_quat_view(a.v.C);r.quat_to_dir(c,r.AXIS_MZ,b);return b}var c=t("__camera"),b=t("__container"),f=t("__mat4"),k=t("__math"),q=t("__obj_util"),h=t("__physics"),u=t("__print"),y=t("__scenes"),g=t("__transform"),d=t("__tsr"),r=t("__util"),p=t("__vec3"),M=t("__vec4"),E=t("__quat"),z=new Float32Array(2),l=new Float32Array(3),B=new Float32Array(3),
w=new Float32Array(4),G=E.create(),v={},D={};a.MS_STATIC=c.MS_STATIC;a.MS_TARGET_CONTROLS=c.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=c.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=c.MS_HOVER_CONTROLS;a.static_setup=function(a,b){if(q.is_camera(a)){c.Ys(a);a.v.nb=c.MS_STATIC;if(b){var e=b.pos||d.get_trans_view(a.v.C);b.look_at?c.iI(a,e,b.look_at):g.set_translation(a,e)}g.T(a);h.sync_transform(a);c.wo(a)}else u.error("static_setup(): Wrong camera object")};a.static_set_look_at=function(a,b,e){c.is_static_camera(a)?
(b=b||d.get_trans_view(a.v.C),e?c.iI(a,b,e):g.set_translation(a,b),g.T(a),h.sync_transform(a)):u.error("static_set_look_at(): Wrong camera object or camera move style")};a.static_set_rotation=function(a,b){c.is_static_camera(a)?(g.set_rotation(a,b),g.T(a),h.sync_transform(a)):u.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,b){if(!c.is_static_camera(a))return u.error("static_get_rotation(): Wrong camera object or camera move style"),null;
b=b||new Float32Array(4);return g.get_rotation(a,b)};a.eye_setup=function(a,b){if(q.is_camera(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right))u.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))u.error("eye_setup(): Wrong vertical limits object.");else{c.Ys(a);a.v.nb=c.MS_EYE_CONTROLS;if(b){var e=b.pos||d.get_trans_view(a.v.C);c.oI(a,e,
b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}g.T(a);h.sync_transform(a);c.wo(a)}else u.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,b,e){c.is_eye_camera(a)?(b=b||d.get_trans_view(a.v.C),e?c.vU(a,b,e):g.set_translation(a,b),c.correct_up(a,a.v.oe,!0),g.T(a),h.sync_transform(a)):u.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(b,d,e,f){u.Bd("eye_rotate","rotate_camera");c.is_eye_camera(b)?a.rotate_camera(b,d,e,f||!1):u.error("eye_rotate(): Wrong camera object or camera move style")};
a.eye_set_vertical_limits=function(a,b){c.is_eye_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.Yw(a,b),g.T(a),h.sync_transform(a)):u.error("eye_set_vertical_limits(): Incorrect limits object."):u.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,b,d){if(!c.is_eye_camera(a))return u.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.v;return a.Pa?(b=b||{},d?(b.down=a.Pa.$n,b.up=a.Pa.zp):
(b.down=a.Pa.down,b.up=a.Pa.up),b.camera_space=d||!1,b):null};a.eye_set_horizontal_limits=function(a,b){c.is_eye_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.Xw(a,b),g.T(a),h.sync_transform(a)):u.error("eye_set_horizontal_limits(): Incorrect limits object."):u.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,b,d){if(!c.is_eye_camera(a))return u.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.v;return a.Ib?(b=b||{},d?(b.left=a.Ib.Co,b.right=a.Ib.$o):(b.left=a.Ib.left,b.right=a.Ib.right),b.camera_space=d||!1,b):null};a.target_setup=function(a,b){if(q.is_camera(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){u.error("target_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.Ur&&("number"!=typeof b.Ur.min_y||"number"!=typeof b.Ur.max_y||b.Ur.min_y>b.Ur.max_y))u.error("target_setup(): Wrong pivot limits object");else{c.Ys(a);a.v.nb=c.MS_TARGET_CONTROLS;var f=b.pos||d.get_trans_view(a.v.C),k=b.pivot;k||(k=e(a,l),k=p.add(f,k,k));c.qI(a,f,k,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Ur,b.use_panning||!1);g.T(a);h.sync_transform(a);c.wo(a)}}else u.error("target_setup(): Wrong vertical limits object");
else u.error("target_setup(): Wrong horizontal limits object");else u.error("target_setup(): Wrong camera object")};a.target_rotate=function(b,d,e,f){u.Bd("target_rotate","rotate_camera");c.is_target_camera(b)?a.rotate_camera(b,d,e,f||!1):u.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,b,e){c.is_target_camera(a)?(b=b||d.get_trans_view(a.v.C),e=e||a.v.pivot,c.MB(a,b,e),g.T(a),h.sync_transform(a)):u.error("target_set_trans_pivot(): Wrong camera object or camera move style")};
a.target_set_pivot_translation=function(a,b){c.is_target_camera(a)?(c.EU(a,b),g.T(a),h.sync_transform(a)):u.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,b){if(c.is_target_camera(a)){var d=g.Nr(a,a.v.pivot);g.move_local(a,0,0,Math.max(0,b)-d);g.T(a);h.sync_transform(a)}else u.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return c.is_target_camera(a)?g.Nr(a,a.v.pivot):
(u.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.target_zoom_object=function(a,b){if(c.is_target_camera(a)){var e=g.get_object_center(b,!1,l),f=g.get_object_size(b),k=y.get_active(),k=q.Da(a,k).ha[0],k=c.wQ(k)/2,f=f/Math.sin(k),k=g.Nr(a,e);c.MB(a,d.get_trans_view(a.v.C),e);g.T(a);g.move_local(a,0,0,f-k);g.T(a);h.sync_transform(a)}else u.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,b){if(!c.is_target_camera(a))return u.error("target_get_pivot(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(3);p.copy(a.v.pivot,b);return b};a.target_set_distance_limits=function(a,b){if(c.is_target_camera(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){u.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}c.ZH(a,b);g.T(a);h.sync_transform(a)}else u.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,b){if(!c.is_target_camera(a))return u.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.v;return d.Cb?(b=b||{},b.min=d.Cb.min,b.max=d.Cb.max,b):null};a.target_set_vertical_limits=function(a,b){c.is_target_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.Yw(a,b),g.T(a),h.sync_transform(a)):u.error("target_set_vertical_limits(): Wrong limits object"):u.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,b,d){if(!c.is_target_camera(a))return u.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.v;return a.Pa?(b=b||{},d?(b.down=a.Pa.$n,b.up=a.Pa.zp):(b.down=a.Pa.down,b.up=a.Pa.up),b.camera_space=d||!1,b):null};a.target_set_horizontal_limits=function(a,b){c.is_target_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.Xw(a,b),g.T(a),h.sync_transform(a)):u.error("target_set_horizontal_limits(): Wrong limits object"):u.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,b,d){if(!c.is_target_camera(a))return u.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.v;return a.Ib?(b=b||{},d?(b.left=a.Ib.Co,b.right=a.Ib.$o):(b.left=a.Ib.left,b.right=a.Ib.right),b.camera_space=d||!1,b):null};a.target_set_pivot_limits=function(a,b){c.is_target_camera(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?u.error("target_set_pivot_limits(): Wrong limits object"):(c.kI(a,b),g.T(a),h.sync_transform(a)):u.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,b){if(!c.is_target_camera(a))return u.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var d=a.v;return d.Fd?(b=b||{},b.min_z=d.Fd.min_z,b.max_z=d.Fd.max_z,b):null};a.target_pan_pivot=function(a,b,e){if(c.is_target_camera(a)){var f=a.v;f.use_panning&&(l[0]=b,l[1]=-e,l[2]=0,d.transform_dir_vec3(l,f.C,l),p.add(f.pivot,l,f.pivot),b=d.get_trans_view(f.C),p.add(b,l,b),g.T(a),h.sync_transform(a))}else u.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,b){if(!c.is_target_camera(a))return u.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.v.use_panning=b};a.hover_setup_rel=function(b,d){a.hover_setup(b,{pos:d.pos,pivot:d.pivot});var e="undefined"==typeof d.dist_interval?0:Math.max(d.dist_interval,0),f="undefined"==typeof d.angle_interval?0:Math.max(d.angle_interval,0),k="undefined"==typeof d.t?.5:r.clamp(d.t,0,1),l=a.hover_get_distance_limits(b,v);l.min=Math.max(l.min-k*e,0);l.max+=(1-k)*e;e=a.hover_get_vertical_limits(b,D);e.down=r.clamp(e.down+k*f,-Math.PI/2,0);e.up=r.clamp(e.up-(1-k)*f,-Math.PI/2,0);c.hover_set_distance_limits(b,
l);c.hover_set_vertical_limits(b,e);g.T(b);h.sync_transform(b);c.wo(b)};a.hover_setup=function(a,b){if(q.is_camera(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){u.error("hover_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<
b.hover_angle_lim.up))u.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))u.error("hover_setup(): Wrong horizontal translation limits object");else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))u.error("hover_setup(): Wrong vertical translation limits object");
else{c.Ys(a);a.v.nb=c.MS_HOVER_CONTROLS;var e=b.pos||d.get_trans_view(a.v.C);c.pI(a,e,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);g.T(a);h.sync_transform(a);c.wo(a)}}else u.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(b,d,e,f){u.Bd("hover_rotate","rotate_camera");c.is_hover_camera(b)?a.rotate_camera(b,d,e,f||!1):u.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,b){c.is_hover_camera(a)?
(c.hI(a,b),g.T(a),h.sync_transform(a)):u.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,b){if(!c.is_hover_camera(a))return u.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);p.copy(a.v.vc,b);return b};a.hover_get_distance=function(a){return c.is_hover_camera(a)?g.Nr(a,a.v.vc):(u.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.hover_set_vertical_limits=function(a,
b){c.is_hover_camera(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?u.error("hover_set_vertical_limits(): Wrong limits object"):(c.hover_set_vertical_limits(a,b),g.T(a),h.sync_transform(a)):u.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,b){if(!c.is_hover_camera(a))return u.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var d=a.v;b=b||{};b.down=d.Pa.down;b.up=d.Pa.up;return b};
a.hover_set_distance_limits=function(a,b){c.is_hover_camera(a)?"number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max?u.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),c.hover_set_distance_limits(a,b),g.T(a),h.sync_transform(a)):u.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,b){if(!c.is_hover_camera(a))return u.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.v;b=b||{};b.min=d.Cb.min;b.max=d.Cb.max;return b};a.hover_set_vert_trans_limits=function(a,b){c.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?u.error("hover_set_vert_trans_limits(): Wrong limits object"):(c.mI(a,b),g.T(a),h.sync_transform(a)):u.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,b){if(!c.is_hover_camera(a))return u.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.v;return d.Wc?(b=b||{},b.min=d.Wc.min,b.max=d.Wc.max,b):null};a.hover_set_horiz_trans_limits=function(a,b){c.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?u.error("hover_set_horiz_trans_limits(): Wrong limits object"):(c.gI(a,b),g.T(a),h.sync_transform(a)):u.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,b){if(!c.is_hover_camera(a))return u.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.v;return d.Vc?(b=b||{},b.min=d.Vc.min,b.max=d.Vc.max,b):null};a.hover_switch_horiz_rotation=function(a,b){if(!c.is_hover_camera(a))return u.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.v.Og=b};a.is_static_camera=c.is_static_camera;a.is_target_camera=c.is_target_camera;a.is_eye_camera=c.is_eye_camera;a.is_hover_camera=c.is_hover_camera;a.get_move_style=function(a){return q.is_camera(a)?c.get_move_style(a):(u.error("get_move_style(): Wrong camera object"),
null)};a.set_translation=function(a,b){if(q.is_camera(a)){var e=a.v;if(c.is_target_camera(a)){var f=d.get_trans_view(e.C),f=p.subtract(b,f,l);p.add(f,e.pivot,e.pivot)}else c.is_hover_camera(a)&&(f=d.get_trans_view(e.C),f=p.subtract(b,f,l),p.add(f,e.vc,e.vc));g.set_translation(a,b);g.T(a);h.sync_transform(a)}else u.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!q.is_camera(a))return u.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);
return g.get_translation(a,b)};a.rotate_camera=function(a,b,d,e){q.is_camera(a)?(e?c.BU(a,b,d):c.RT(a,b,d),g.T(a),h.sync_transform(a)):u.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(q.is_camera(a)){var c=a.v;"number"==typeof b.trans&&(c.Jp=r.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.Ip=r.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Kp=r.clamp(b.zoom,0,.99))}else u.error("set_velocities(): Wrong camera object")};a.get_velocities=function(a,b){if(!q.is_camera(a))return u.error("get_velocities(): Wrong camera object"),
null;var c=a.v;b=b||{};b.trans=c.Jp;b.rot=c.Ip;b.zoom=c.Kp;return b};a.is_look_up=function(a){if(!q.is_camera(a))return u.error("is_look_up(): Wrong camera object"),!1;a=d.get_quat_view(a.v.C);return 0<=r.quat_to_dir(a,r.AXIS_MZ,l)[1]};a.get_camera_angles=function(a,b){if(!q.is_camera(a))return u.error("get_camera_angles(): Wrong camera object"),null;b=b||new Float32Array(2);c.get_camera_angles(a,b);return b};a.get_camera_angles_char=function(a,b){if(!q.is_camera(a))return u.error("get_camera_angles_char(): Wrong camera object"),
null;b=b||new Float32Array(2);c.get_camera_angles_char(a,b);return b};a.get_camera_angles_dir=function(a,b){b=b||new Float32Array(2);var d=p.normalize(a,l),d=r.RH(r.AXIS_MZ,d,G);r.correct_cam_quat_up(d,!0);c.Uz(d,b);return b};a.set_stereo_distance=function(a,b){if(q.is_camera(a))for(var d=y.get_active(),d=q.Da(a,d).ha,e=0;e<d.length;e++){var f=d[e];f.type!=c.Cc&&f.type!=c.Jc&&f.type!=c.hf&&f.type!=c.Oe||c.DU(f,b,f.Kf)}else u.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=
function(a){if(!q.is_camera(a))return u.error("get_stereo_distance(): Wrong camera object"),0;var b=y.get_active();a=q.Da(a,b).ha;for(b=0;b<a.length;b++){var d=a[b];if(d.type==c.Cc||d.type==c.Jc)return d.rl}return 0};a.set_eye_distance=function(a,b){if(q.is_camera(a)){var d=y.get_active(),d=q.Da(a,d).ha;c.set_eye_distance(d,b)}else u.error("set_eye_distance(): Wrong camera object")};a.get_eye_distance=function(a){if(!q.is_camera(a))return u.error("get_eye_distance(): Wrong camera object"),0;var b=
y.get_active();a=q.Da(a,b).ha;for(b=0;b<a.length;b++){var d=a[b];if(d.type==c.Cc||d.type==c.Jc||d.type==c.hf||d.type==c.Oe)return d.Kf}return 0};a.set_vertical_axis=function(a,b){q.is_camera(a)?(p.copy(b,a.v.oe),g.T(a),h.sync_transform(a)):u.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(q.is_camera(a))return b||(b=p.create()),p.copy(a.v.oe,b),b;u.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,b,d,e){if(q.is_camera(a)){var g=
y.get_active();a=q.Da(a,g).ha;for(g=0;g<a.length;g++){var h=a[g];h.wc||c.set_projection(h,!1);var k=l;k[0]=-b;k[1]=-d;k[2]=0;f.translate(h.wb,k,h.wb);f.rotateZ(h.wb,e,h.wb);c.gE(h);c.cz(h)}}else u.error("translate_view(): Wrong camera object")};a.get_view_vector=e;a.get_fov=function(a){if(!q.is_camera(a))return u.error("get_fov(): Wrong camera object"),0;var b=y.get_active();a=q.Da(a,b).ha;return c.get_fov(a[0])};a.set_fov=function(a,b){if(q.is_camera(a))for(var d=y.get_active(),d=q.Da(a,d).ha,e=
0;e<d.length;e++){var f=d[e];c.set_fov(f,b);f.wc||c.set_projection(f,!1);c.gE(f);c.cz(f)}else u.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(){u.ia("set_hmd_fov() deprecated")};a.correct_up=function(a,b,d){q.is_camera(a)?(b=b||a.v.oe,c.correct_up(a,b,d||!1),g.T(a),h.sync_transform(a)):u.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,b){if(q.is_camera(a)&&c.is_ortho_camera(a)){var e=a.v;if(c.is_target_camera(a)){var f=d.get_trans_view(e.C),f=p.dist(f,e.pivot);
e.Ok=b/2*e.Nk/f}else c.is_hover_camera(a)?(f=d.get_trans_view(e.C),f=p.distance(f,e.vc),e.Ok=b/2*e.Nk/f):(e=y.get_active(),q.Da(a,e).ha[0].top=b/2);c.XV(a)}else u.error("set_ortho_scale(): Wrong camera object")};a.get_ortho_scale=function(a){if(!q.is_camera(a)||!c.is_ortho_camera(a))return u.error("get_ortho_scale(): Wrong camera object"),0;var b=y.get_active();return 2*q.Da(a,b).ha[0].top};a.is_ortho_camera=function(a){return q.is_camera(a)?c.is_ortho_camera(a):(u.error("is_ortho_camera(): Wrong camera object"),
!1)};a.calc_ray=function(a,e,f,h){if(!q.is_camera(a))return u.error("calc_ray(): Wrong camera object"),null;var n=y.get_active(),v=q.Da(a,n).ha[0];h&&3==h.length?u.ia('dest parameter in the function "calc_ray" should be type of parametric line.'):h=h||new Float32Array(6);switch(v.type){case c.Pc:case c.jf:case c.Cc:case c.Jc:var t=Math.tan(c.hR(v)/2),E=t*v.qb,n=l;e=b.wq(e,f,z,v);n[0]=(2*e[0]/v.width-1)*E;n[1]=(1-2*e[1]/v.height)*t;n[2]=-1;d.transform_dir_vec3(n,a.v.C,n);p.normalize(n,n);3==h.length?
p.copy(n,h):(a=g.get_translation(a,B),k.set_pline_initial_point(h,a),k.set_pline_directional_vec(h,n));return h;case c.se:return n=l,e=b.wq(e,f,z,v),n[0]=(2*e[0]/v.width-1)*v.top*v.qb,n[1]=(1-2*e[1]/v.height)*v.top,n[2]=0,d.transform_vec3(n,a.v.C,n),p.copy(n,h),a=d.get_quat_view(a.v.C,w),p.transformQuat(r.AXIS_MZ,a,n),k.set_pline_directional_vec(h,n),h;default:return u.error("calc_ray(): Non-compatible camera"),h}};a.project_point=function(a,b,d){if(!q.is_camera(a))return u.error("project_point(): Wrong camera object"),
null;d=d||new Float32Array(2);return c.project_point(a,b,d)};a.has_distance_limits=function(a){return(c.is_target_camera(a)||c.is_hover_camera(a))&&null!==a.v.Cb};a.has_vertical_rot_limits=function(a){return(c.is_eye_camera(a)||c.is_target_camera(a)||c.is_hover_camera(a))&&null!==a.v.Pa};a.has_horizontal_rot_limits=function(a){return(c.is_target_camera(a)||c.is_eye_camera(a))&&null!==a.v.Ib};a.has_vertical_trans_limits=function(a){return c.is_hover_camera(a)&&null!==a.v.Wc};a.has_horizontal_trans_limits=
function(a){return c.is_hover_camera(a)&&null!==a.v.Vc};a.get_frustum_planes=function(a,b){if(!q.is_camera(a))return u.error("get_frustum_planes(): Wrong camera object"),null;var c=y.get_active(),c=q.Da(a,c).ha[0].Eh;M.copy(c.left,b.left);M.copy(c.right,b.right);M.copy(c.top,b.top);M.copy(c.bottom,b.bottom);M.copy(c.near,b.near);M.copy(c.far,b.far);return b};a.set_projection=function(a,b){q.is_camera(a)?c.yU(a,b):u.error("set_projection(): Wrong camera object")}};b4w.module.config=function(a,t){var e=t("__config"),c=t("__compat"),b=t("__debug"),f=t("__data"),k=t("__print");a.P_LOW=e.P_LOW;a.P_HIGH=e.P_HIGH;a.P_ULTRA=e.P_ULTRA;a.P_CUSTOM=e.P_CUSTOM;a.P_AUTO=e.P_AUTO;a.set=e.set;a.get=e.get;a.reset=e.reset;a.reset_limits=e.reset_limits;a.get_std_assets_path=e.get_assets_path;a.get_assets_path=e.get_assets_path;a.apply_quality=function(a){f.is_primary_loaded()?k.error("Cannot change quality profile after a scene is loaded."):(e.set("quality",a),b.bv()&&(e.apply_quality(),
c.fI(b.bv(),!1)))}};b4w.module.controls=function(a,t){var e=t("__controls"),c=t("__physics"),b=t("__print");a.CT_POSITIVE=e.CT_POSITIVE;a.CT_CONTINUOUS=e.CT_CONTINUOUS;a.CT_TRIGGER=e.CT_TRIGGER;a.CT_SHOT=e.CT_SHOT;a.CT_LEVEL=e.CT_LEVEL;a.CT_CHANGE=e.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=
54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_MULT=106;a.KEY_ADD=107;a.KEY_SUB=
109;a.KEY_DEC_POINT=110;a.KEY_DIV=111;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=e.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=e.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=e.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=e.PL_MULTITOUCH_MOVE_ROTATE;a.default_AND_logic_fun=e.default_AND_logic_fun;
a.default_OR_logic_fun=e.default_OR_logic_fun;a.create_gamepad_btn_sensor=e.create_gamepad_btn_sensor;a.create_gamepad_axis_sensor=e.create_gamepad_axis_sensor;a.create_gamepad_position_sensor=e.create_gamepad_position_sensor;a.create_gamepad_orientation_sensor=e.create_gamepad_orientation_sensor;a.create_custom_sensor=e.create_custom_sensor;a.create_keyboard_sensor=e.create_keyboard_sensor;a.create_collision_sensor=function(a,b,c){return e.create_collision_sensor(a,b||"ANY",c||!1)};a.create_collision_impulse_sensor=
e.create_collision_impulse_sensor;a.create_ray_sensor=function(a,k,q,h,u,t,g){if(a&&!c.va(a))b.ia("No physics for object "+a.name);else return e.create_ray_sensor(a,k,q,h||"ANY",u||!1,t||!1,g||!1)};a.create_mouse_click_sensor=e.create_mouse_click_sensor;a.create_mouse_wheel_sensor=e.create_mouse_wheel_sensor;a.create_mouse_move_sensor=e.create_mouse_move_sensor;a.create_plock_mouse_sensor=e.create_plock_mouse_sensor;a.create_plock_sensor=e.create_plock_sensor;a.create_touch_move_sensor=e.create_touch_move_sensor;
a.create_touch_zoom_sensor=e.create_touch_zoom_sensor;a.create_touch_rotate_sensor=e.create_touch_rotate_sensor;a.create_touch_click_sensor=e.create_touch_click_sensor;a.create_motion_sensor=e.create_motion_sensor;a.create_vertical_velocity_sensor=e.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=e.create_gyro_angles_sensor;a.create_gyro_quat_sensor=e.create_gyro_quat_sensor;a.create_gyro_delta_sensor=e.create_gyro_delta_sensor;a.create_hmd_quat_sensor=e.create_hmd_quat_sensor;a.create_hmd_position_sensor=
e.create_hmd_position_sensor;a.create_timer_sensor=function(a,b){return e.create_timer_sensor(a,b||!1)};a.reset_timer_sensor=e.reset_timer_sensor;a.create_elapsed_sensor=e.create_elapsed_sensor;a.create_timeline_sensor=e.create_timeline_sensor;a.create_selection_sensor=function(a,b){return e.create_selection_sensor(a,b||!1)};a.create_callback_sensor=function(a,b){return e.create_callback_sensor(a,b||0)};a.set_custom_sensor=function(a,b){e.aU(a,b)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=
e.get_sensor_value;a.get_sensor_payload=e.get_sensor_payload;a.create_sensor_manifold=function(a,b,c,h,u,t,g){u=u||e.default_AND_logic_fun;e.create_sensor_manifold(a,b,c,h,u,t,void 0===g?null:g)};a.create_kb_sensor_manifold=function(a,b,c,h,u,t){h=e.create_keyboard_sensor(h);e.create_sensor_manifold(a,b,c,[h],e.default_AND_logic_fun,u,void 0===t?null:t)};a.check_sensor_manifolds=function(a){return e.check_sensor_manifold(a,null)};a.check_sensor_manifold=e.check_sensor_manifold;a.remove_sensor_manifold=
e.remove_sensor_manifold;a.reset=e.reset;a.set_plock_smooth_factor=e.set_plock_smooth_factor};b4w.module.constraints=function(a,t){var e=t("__camera"),c=t("__constraints"),b=t("__obj_util"),f=t("__physics"),k=t("__print"),q=t("__transform"),h=t("__util"),u=t("__vec3");a.append_stiff=function(a,e,d,h,p){b.is_dynamic(a)?c.wh(a,e)?c.vh(a,e)?(d=d||new Float32Array(3),p=p||1,h=h?h:[0,0,0,1],e instanceof Array&&2==e.length?c.zM(a,e[0],e[1],d,h,p):c.ED(a,e,d,h,p),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):k.error("Can not apply constraint. Object and target must be different."):
k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_semi_stiff=function(a,e,d,r,p,u,t,z){b.is_dynamic(a)?c.wh(a,e)?c.vh(a,e)?(p=h.ge(p)?p:Math.PI/2,u=h.ge(u)?u:-Math.PI/2,t=h.ge(t)?t:Math.PI/2,z=h.ge(z)?z:-Math.PI/2,d=d||new Float32Array(3),r=r?new Float32Array(r):null,c.xM(a,e,d,r,p,u,t,z),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):k.error("Can not apply constraint. Object and target must be different."):k.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.append_semi_stiff_cam=function(b,c,d,f,h,q,u,t){k.Bd("append_semi_stiff_cam","append_semi_stiff");e.is_eye_camera(b)?a.append_semi_stiff(b,c,d,f,h,q,u,t):k.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(b,c,d,f){k.Bd("append_semi_soft_cam","append_semi_soft");e.is_eye_camera(b)?a.append_semi_soft(b,c,d,f):k.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft=
function(a,e,d,r){if(b.is_dynamic(a))if(c.wh(a,e))if(c.vh(a,e)){if(!h.ge(r)||0>r)r=.25;d=d||new Float32Array(3);c.wM(a,e,d,r);q.T(a);f.sync_transform(a)}else k.error("Constraint recursion is forbidden.");else k.error("Can not apply constraint. Object and target must be different.");else k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_stiff_trans=function(a,e,d){b.is_dynamic(a)?c.wh(a,e)?c.vh(a,e)?(d=d||new Float32Array(3),c.AM(a,e,d),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):
k.error("Can not apply constraint. Object and target must be different."):k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_copy_loc=function(a,e,d,h,p){if(b.is_dynamic(a))if(c.wh(a,e))if(c.vh(a,e)){h=h||!1;d=d||"XYZ";p=p||1;var g=q.get_translation(a,new Float32Array(3)),r=new Float32Array(3);r[0]=-1!=d.indexOf("-X")?-1:-1!=d.indexOf("X")?1:0;r[1]=-1!=d.indexOf("-Y")?-1:-1!=d.indexOf("Y")?1:0;r[2]=-1!=d.indexOf("-Z")?-1:-1!=d.indexOf("Z")?1:0;c.oM(a,e,g,r,h,p);q.T(a);f.sync_transform(a)}else k.error("Constraint recursion is forbidden.");
else k.error("Can not apply constraint. Object and target must be different.");else k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_copy_trans=function(a,e,d){b.is_dynamic(a)?c.wh(a,e)?c.vh(a,e)?(c.qM(a,e,d||1),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):k.error("Can not apply constraint. Object and target must be different."):k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_copy_rot=function(a,e,d,h,p){if(b.is_dynamic(a))if(c.wh(a,e))if(c.vh(a,
e)){d=d||"XYZ";var g=new Float32Array(3);g[0]=-1!=d.indexOf("-X")?-1:-1!=d.indexOf("X")?1:0;g[1]=-1!=d.indexOf("-Y")?-1:-1!=d.indexOf("Y")?1:0;g[2]=-1!=d.indexOf("-Z")?-1:-1!=d.indexOf("Z")?1:0;c.pM(a,e,g,h||!1,p||1);q.T(a);f.sync_transform(a)}else k.error("Constraint recursion is forbidden.");else k.error("Can not apply constraint. Object and target must be different.");else k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_stiff_trans_rot=function(a,e,d,h){b.is_dynamic(a)?c.wh(a,e)?
c.vh(a,e)?(d=d||new Float32Array(3),h=h?new Float32Array(h):[0,0,0,1],c.BM(a,e,d,h),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):k.error("Can not apply constraint. Object and target must be different."):k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_track=function(a,e,d,r,p,t){if(b.is_dynamic(a))if(c.wh(a,e))if(c.vh(a,e)){var g=h.AXIS_Y;"-Y"==d?g=h.AXIS_MY:"Y"==d?g=h.AXIS_Y:"-X"==d?g=h.AXIS_MX:"X"==d?g=h.AXIS_X:"-Z"==d?g=h.AXIS_MZ:"Z"==d&&(g=h.AXIS_Z);
d=h.AXIS_Z;"X"==r?d=h.AXIS_X:"Y"==r&&(d=h.AXIS_Y);1==Math.abs(u.dot(g,d))?k.error("Can not use parallel vectors for track and up axes."):(c.CM(a,e,g,d,p||!1,t||1),q.T(a),f.sync_transform(a))}else k.error("Constraint recursion is forbidden.");else k.error("Can not apply constraint. Object and target must be different.");else k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_follow=function(a,e,d,h){b.is_dynamic(a)?c.wh(a,e)?c.vh(a,e)?(c.tM(a,e,d,h),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):
k.error("Can not apply constraint. Object and target must be different."):k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.append_stiff_viewport=function(a,e,d){b.is_dynamic(a)?c.wh(a,e)?c.vh(a,e)?(d=d||{},c.append_stiff_viewport(a,e,d),q.T(a),f.sync_transform(a)):k.error("Constraint recursion is forbidden."):k.error("Can not apply constraint. Object and target must be different."):k.error('Wrong object: "'+a.name+'" is not dynamic.')};a.remove=function(a,b){b=b||!1;a.qc&&c.remove(a,b);b&&
q.T(a)}};b4w.module.container=function(a,t){var e=t("__container"),c=t("__print");a.get_canvas=e.get_canvas;a.get_canvas_hud=e.get_canvas_hud;a.get_container=e.get_container;a.insert_to_container=function(a,f){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&f&&e.insert_to_container(a,f)};a.set_canvas_offsets=function(a,f){c.ia("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");return e.set_canvas_offsets(a,f)};
a.update_canvas_offsets=function(){c.ia("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");e.update_canvas_offsets()};a.client_to_canvas_coords=function(a,c,k){k||(k=new Float32Array(2));return e.client_to_canvas_coords(a,c,k)};a.client_to_element_coords=function(a,c,k,q){q||(q=new Float32Array(2));return e.client_to_element_coords(a,c,k,q)};a.get_coords_target_space=function(a,c,k){k||(k=new Float32Array(2));return e.get_coords_target_space(a,
c,k)};a.force_offsets_updating=function(){c.ia("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");e.force_offsets_updating()};a.resize=function(a,c,k){e.resize(a,c,k)};a.resize_to_container=function(a){e.resize_to_container(a||!1)}};b4w.module.data=function(a,t){var e=t("__data"),c=t("__loader");a.load=e.load;a.unload=function(a){e.unload(a|0)};a.set_debug_resources_root=e.set_debug_resources_root;a.is_primary_loaded=e.is_primary_loaded;a.is_idle=c.Dm;a.load_and_add_new=e.load;a.cleanup=a.unload;a.activate_media=e.activate_media;a.prefetch=e.prefetch;a.unfetch=e.unfetch};b4w.module.debug=function(a,t){function e(a,b,c,d){F.group(A.Cx(a),d);for(a=0;a<c.length;a++){var e=c[a],f=e.v;if(f.type==d)for(var g=!1,h=0;h<b.length;h++){for(var k=b[h].Ia,l=0;l<k.length;l++){var m=k[l];if(m.dc&&m.qg==f){"STATIC"==d?F.ld(e.Ed,e):F.ld(e.name,e);g=!0;break}}if(g)break}}F.groupEnd()}function c(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=
b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function b(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;F.error(c.responseText);throw"Error POST XHR: "+c.status;}function f(a){a.sort(function(a,b){return b.Pz.ALL_OPS-a.Pz.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.Pz,e=c.BW,f=k(c.gP),f=
f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";F.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);F.groupCollapsed("directives");for(var g=c.Za.yh.slice().sort(),f=0;f<g.length;f++){var h=g[f];F.ld(h[0],h[1])}F.groupEnd();F.groupCollapsed("node elements");g=c.Za.Ye;for(f=0;f<g.length;f++)F.ld(g[f]);F.groupEnd();F.groupCollapsed("vert source");F.ld(c.zW);F.groupEnd();F.groupCollapsed("vert translated source");F.ld(c.AW);F.groupEnd();
f=["ALL_OPS","TEX_OPS","ATTRIBS"];F.groupCollapsed("vert ops stats");for(var l in e)-1==f.indexOf(l)&&F.ld(l,e[l]);F.groupEnd();F.groupCollapsed("vert assembly");F.ld(c.yW);F.groupEnd();F.groupCollapsed("frag source");F.ld(c.hQ);F.groupEnd();F.groupCollapsed("frag translated source");F.ld(c.iQ);F.groupEnd();F.groupCollapsed("frag ops stats");for(l in d)-1==f.indexOf(l)&&F.ld(l,d[l]);F.groupEnd();F.groupCollapsed("frag assembly");F.ld(c.$P);F.groupEnd();F.groupEnd()}}function k(a){for(var b=[],c=N.lr(),
d=0;d<c.length;d++)for(var e=c[d],f=G.Ob(e,"MESH",G.DATA_ID_ALL),g=0;g<f.length;g++){var h=v.Da(f[g],e);if(h&&h.Y.length)for(var h=h.Y,k=0;k<h.length;k++){var l=h[k];if(l.pb==a)for(var m=0;m<l.Xb.length;m++){var p=l.Xb[m];-1==b.indexOf(p)&&b.push(p)}}}return b}function q(a){function b(){ea.push(b);return a.apply(a,arguments)}return b}function h(a,b,c,d,e){if(typeof b!=typeof a)throw"debug.eqv: wrong expected data type";if(a.length!=b.length)throw"debug.eqv: wrong expected vector length";c=c?c:1E-6;
for(var f=0;f<a.length;f++){if("number"!=typeof b[f]||isNaN(b[f]))throw"debug.eqv: wrong expected data type";if("number"!=typeof a[f]||isNaN(a[f]))throw"debug.eqv: wrong result data type";if(b[f]>a[f]+c||b[f]<a[f]-c)throw"debug.eqv: wrong result";}u(d,e,"eqv")}function u(a,b,c){a=a||"";b=b||"";if(X){if(""==a)throw"debug."+c+': no error is expected, but got "'+Z+'"';if(Z!=a)throw"debug."+c+': error "'+a+'" is expected, but got "'+Z+'"';}else if(""!=a)throw"debug."+c+': error "'+a+'" is expected, but got nothing';
if(aa){if(""==b)throw"debug."+c+': no warning is expected, but got "'+qa+'"';if(qa!=b)throw"debug."+c+': warning "'+b+'" is expected, but got "'+qa+'"';}else if(""!=b)throw"debug."+c+': warning "'+b+'" is expected, but got nothing';X=aa=!1}function y(){T&&(G.Ro(T,!1,!1,!1),E.yH(T),G.Ro(T,!0,!0,!0),G.remove_object(T),T=null)}var g=t("__batch"),d=t("__config"),r=t("__compat"),p=t("__controls"),M=t("__container"),E=t("__data"),z=t("__debug"),l=t("__extensions"),B=t("__geometry"),w=t("__loader"),G=t("__objects"),
v=t("__obj_util"),D=t("__physics"),F=t("__print"),n=t("__renderer"),N=t("__scenes"),I=t("__scenegraph"),x=t("__sfx"),J=t("__shaders"),A=t("__subscene"),C=t("__textures"),R=t("__transform"),m=t("__tsr"),H=t("__util"),U=t("__vec3"),O=m.create(),V=new Float32Array(2),ia=U.create(),na=U.create(),T=null,ja=d.K,ea=[],qa="",Z="",aa=!1,X=!1,fa=!0,Ca=new Uint8Array(4);a.DV_NONE=z.DV_NONE;a.DV_OPAQUE_WIREFRAME=z.DV_OPAQUE_WIREFRAME;a.DV_TRANSPARENT_WIREFRAME=z.DV_TRANSPARENT_WIREFRAME;a.DV_FRONT_BACK_VIEW=
z.DV_FRONT_BACK_VIEW;a.DV_BOUNDINGS=z.DV_BOUNDINGS;a.DV_CLUSTERS_VIEW=z.DV_CLUSTERS_VIEW;a.DV_BATCHES_VIEW=z.DV_BATCHES_VIEW;a.DV_RENDER_TIME=z.DV_RENDER_TIME;a.physics_stats=function(){D.nP()};a.physics_id=function(a){F.log("O",D.VP(a));var b=D.uQ();if(b)for(var b=b.zc.Ia,c=0;c<b.length;c++){var d=b[c];d.L.ga==a&&F.log("B",d)}else F.error("No active physics scene.")};a.visible_objects=function(){for(var a=N.get_active(),b=G.Ob(a,"MESH",G.DATA_ID_ALL),a=N.xg(a,[A.Nb,A.bd,A.Zd]),c=0;c<a.length;c++){var d=
a[c],f=d.Xa;f.length&&(e(d,f,b,"DYNAMIC"),e(d,f,b,"STATIC"))}};a.object_info=function(a){for(var b=N.get_active(),c=G.Ob(b,"MESH",G.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];if(e.name==a){F.log("Object",e);for(var f=N.Sz(b),g=0;g<f.length;g++){for(var h=f[g],k=[],l=h.Xa,m=0;m<l.length;m++)for(var p=l[m].Ia,n=0;n<p.length;n++)p[n].qg==e.v&&k.push(p[n]);F.log("Subscene "+h.type,k)}}}};a.objects_stat=function(){var a=N.get_active();F.log("Armatures: "+G.Ob(a,"ARMATURE",G.DATA_ID_ALL).length);F.log("Cameras: "+
G.Ob(a,"CAMERA",G.DATA_ID_ALL).length);F.log("Curves: "+G.Ob(a,"CURVE",G.DATA_ID_ALL).length);F.log("Empties: "+G.Ob(a,"EMPTY",G.DATA_ID_ALL).length);F.log("Lamps: "+G.Ob(a,"LAMP",G.DATA_ID_ALL).length);F.log("Meshes: "+G.Ob(a,"MESH",G.DATA_ID_ALL).length);F.log("Speakers: "+G.Ob(a,"SPEAKER",G.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=N.get_active(),b=N.xg(b,[A.Nb,A.bd,A.Zd]),c=0;c<b.length;c++)for(var d=b[c].Xa,e=0;e<d.length;e++)for(var f=d[e].Ia,g=0;g<f.length;g++){var h=f[g].ya;
h&&(a+=h.num_vertices)}return a};a.num_triangles=function(){for(var a=0,b=N.get_active(),b=N.xg(b,[A.Nb,A.bd,A.Zd]),c=0;c<b.length;c++)for(var d=b[c].Xa,e=0;e<d.length;e++)for(var f=d[e].Ia,g=0;g<f.length;g++){var h=f[g].ya;h&&(a+=h.num_triangles)}return a};a.num_draw_calls=function(){for(var a=N.get_active(),b=N.xg(a,[A.Nb,A.bd,A.Zd,A.$d,A.Vf]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Xa,f=0;f<e.length;f++)c+=e[f].Ia.length;a=N.xg(a,[A.ud,A.gf]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Xa,f=0;f<e.length;f++)c+=
6*e[f].Ia.length;return c};a.num_shaders=function(){return H.Aj(J.JF())};a.geometry_stats=function(){for(var a=N.get_active(),b=N.Sz(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=A.$i&&d.type!=A.ph)for(var e=d.Xa,f=0;f<e.length;f++)for(var g=e[f].Ia,h=0;h<g.length;h++){var k=g[h].ya,l=g[h].qg;k&&(d.type!=A.Ne&&d.type!=A.qh||l.ww||l.vw)&&(a[k.id]=k)}}var c=b=0,m;for(m in a)d=a[m].la,d.Sn&&(c+=d.Sn/1048576),b+=d.Vn/1048576;return{vbo_memory:b,ibo_memory:c}};a.num_textures=function(){for(var a=[],
b=0,c=N.get_active(),c=N.xg(c,[A.Nb,A.bd,A.Zd]),d=0;d<c.length;d++)for(var e=c[d].Xa,f=0;f<e.length;f++)for(var g=e[f].Ia,h=0;h<g.length;h++){var k=g[h].ya;if(k)for(var k=k.ka,l=0;l<k.length;l++){var m=k[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var p=m.Gb;-1===a.indexOf(p)&&(a.push(p),m=m.width*m.height*4/1048576/m.Jq,m*=1.3333,b+=m)}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=N.get_active(),c=N.Sz(c),d=0;d<c.length;d++){var e=c[d];if(e.type!=
A.$i){var f=e.F,g=[f.hc,f.vf];g.push.apply(g,e.lh);for(e=0;e<g.length;e++){var h=g[e];C.Ao(h)&&-1==a.indexOf(h)&&(a.push(h),b+=f.width*f.height*C.gR(h))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=N.get_active();(a=N.Pb(a,A.Nb))&&N.QG(a.F,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=N.get_active(),b=N.Pb(a,A.Nb),a=N.xg(a,[A.wd]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,
0,1];break;default:e=[1,0,1]}N.QG(d.F,b,e)}};a.scenegraph_to_dot=function(){for(var a=N.lr(),b=0;b<a.length;b++)F.log("\n"+I.lP(N.cv(a[b])))};a.loading_graph_to_dot=function(a){F.log("\n"+w.lR(a|0))};a.controls_info=p.debug;a.object_distance=function(a,b){var c=m.get_trans_view(a.v.C),d=m.get_trans_view(b.v.C);return U.dist(c,d)};a.msg=z.msg;a.fbmsg=z.fbmsg;a.print_telemetry=z.print_telemetry;a.plot_telemetry=z.plot_telemetry;a.fbres=function(a,b){function c(){z.fbmsg("FBRES",a());setTimeout(c,b)}
b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array([0,0,0,1]),b=new Float32Array([1,0,0]),c=new Float32Array([0,1,0]),d=new Float32Array([0,0,1]),e=new Float32Array([-1,0,0]),f=new Float32Array([0,-1,0]),g=new Float32Array([0,0,-1]);if(!H.wk(new Float32Array(3),H.Gy))throw"Wrong VEC3_IDENT";if(!H.wk(a,H.et))throw"Wrong QUAT4_IDENT";if(!H.wk(b,H.AXIS_X))throw"Wrong AXIS_X";if(!H.wk(c,H.AXIS_Y))throw"Wrong AXIS_Y";if(!H.wk(d,H.AXIS_Z))throw"Wrong AXIS_Z";if(!H.wk(e,H.AXIS_MX))throw"Wrong AXIS_MX";
if(!H.wk(f,H.AXIS_MY))throw"Wrong AXIS_MY";if(!H.wk(g,H.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=x.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==x.$z(c)&&x.mute(c,!0)}};a.check_finite=z.check_finite;a.set_debug_params=function(a){var b=N.get_active(),b=N.xg(b,[A.ph]);if(b.length)for(var c=0;c<b.length;c++){var d=b[c];if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case z.DV_NONE:case z.DV_OPAQUE_WIREFRAME:case z.DV_TRANSPARENT_WIREFRAME:case z.DV_FRONT_BACK_VIEW:case z.DV_BOUNDINGS:case z.DV_CLUSTERS_VIEW:case z.DV_BATCHES_VIEW:case z.DV_RENDER_TIME:N.iU(d,
a.debug_view_mode);break;default:F.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&N.hU(d,a.debug_colors_seed);"number"==typeof a.IT&&N.AU(d,a.IT);"object"==typeof a.wireframe_edge_color&&N.JU(d,H.f32(a.wireframe_edge_color))}else F.error("Debugging is not available on the scene.")};a.get_error_quantity=function(){return F.LQ()};a.get_warning_quantity=function(){return F.iR()};a.clear_errors_warnings=function(){return F.clear_errors_warnings()};a.analyze_shaders=
function(a){var d=J.JF(),e=0,g;for(g in d)a&&-1===g.indexOf(a)||e++;var e="of "+e+" analyzing...",h={};for(g in d)if(!a||-1!==g.indexOf(a)){var k=d[g],m;m=k.iy;var p=k.Uu,n=l.HQ();if(n){var q=n.getTranslatedShaderSource(m),n=n.getTranslatedShaderSource(p);if(r.detect_mobile())var q=q.replace("#version","#version 300 //"),n=n.replace("#version","#version 300 //"),v=b("/analyze_shader/vert_gles",q),u=b("/analyze_shader/frag_gles",n);else q=q.replace("#version","#version 400 //"),n=n.replace("#version",
"#version 400 //"),v=b("/analyze_shader/vert",q),u=b("/analyze_shader/frag",n);var t=c(v),x=c(u);m={zW:z.bv().getShaderSource(m),AW:q,yW:v,BW:t,hQ:z.bv().getShaderSource(p),iQ:n,$P:u,Pz:x}}else F.warn("WEBGL_debug_shaders extension not found"),m=void 0;if(m){var p=k.Za,w=p.Of+" + "+p.xe;m.gP=k;m.Za=p;k=h[w]=h[w]||[];k.push(m);F.ld(e)}}for(w in h)F.group("%c"+w,"color: #800"),k=h[w],f(k),F.groupEnd()};a.fake_load=z.fake_load;a.test_performance=function(b){if(J.qE())if(l.Xz()){var c=ja.gl_debug;ja.gl_debug=
!0;var d=I.xO();N.yF(null,d);for(var e=I.jc(d,A.Wp),f=e.F,d=0;5>d;d++)n.ao(e);ja.gl_debug=c;window.setTimeout(function(){z.rT(e);var a=e.uf;b(a,f.width*f.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.test_performance(b)},100)};a.calc_vbo_garbage_byte_size=z.calc_vbo_garbage_byte_size;a.show_vbo_garbage_info=z.show_vbo_garbage_info;a.print_batches_stat=z.print_batches_stat;a.start_debug=function(a){ea=[];fa=!0;a=t(a);for(var b in a)"function"===typeof a[b]&&
(a[b]=q(a[b]))};a.check_debug_result=function(){return fa};a.test=function(a,b){var c=t("__print"),d=c.error,e=c.ia,f=c.warn;c.error=c.ia=function(){Z=c.FE(arguments,"B4W ERROR").join(" ");X=!0};c.warn=function(){qa=c.FE(arguments,"B4W WARN").join(" ");aa=!0};X=aa=!1;try{b();var g=!0}catch(W){fa=!1,console.error('Test "'+a+'" failed with exception: "'+W+'"'),X=aa=g=!1}c.error=d;c.ia=e;c.warn=f;return g};a.pix=function(a){var b=M.UF(),c=M.TF(),d=b/2,e=c/2;M.resize(b,c,!1);b=N.get_active().J.Aa;(c=
I.WP(b))||H.I("Couldn't find onscreen subscene");b=c.F;d=M.wq(d,e,V,c.F);d[1]=b.height-d[1];d=n.Nw(b.Ve,d[0],d[1],1,1,Ca);h(a,d,1)};a.eqs=function(a,b,c,d){if(JSON.stringify(a)!=JSON.stringify(b))throw"debug.eqs: wrong result";u(c,d,"eqs")};a.eqv=h;a.eqf=function(a,b,c,d,e){if("number"!=typeof b||isNaN(b))throw"debug.eqf: wrong expected data type";if("number"!=typeof a||isNaN(a))throw"debug.eqf: wrong result data type";c=c?c:1E-6;if(b>a+c||b<a-c)throw"debug.eqf: wrong result";u(d,e,"eqf")};a.eq=function(a,
b,c,d){if(a!==b)throw"debug.eq: wrong result";u(c,d,"eq")};a.ok=function(a,b,c){if(!a)throw"debug.ok: wrong result";u(b,c,"ok")};a.stat=function(a){var b=[];a=t(a);for(var c in a)-1==ea.indexOf(a[c])&&"function"===typeof a[c]&&b.push(c);if(b.length){F.groupCollapsed(b.length+" function(s) not tested.");for(c=0;c<b.length;c++)F.ld(b[c]);F.groupEnd()}else F.group("All functions were tested.")};a.show_normals=function(a,b,c,d){y();b=g.ab(a,b,"MAIN");if(!B.Cj(a)||!b)return F.error("Normals are not avaliable for the dynamic object:",
a.name),!1;var e=b.la;if(!(e&&e.Eb&&e.Eb.a_position&&e.Eb.a_tbn))return F.error("Normals are not avaliable for the object:",a.name),!1;b=B.Mz(e,"a_position");var e=B.Mz(e,"a_normal"),f=R.get_tsr(a,O);T=G.create_line("normal_line");a=new Float32Array(2*b.length);for(var h=0;h<b.length;h+=3){var k=ia;k[0]=b[h+0];k[1]=b[h+1];k[2]=b[h+2];var l=m.transform_vec3(k,f,na);a[2*h+0]=l[0];a[2*h+1]=l[1];a[2*h+2]=l[2];l=U.scale(e.subarray(h,h+3),c,na);k=U.add(k,l,na);k=m.transform_vec3(k,f,na);a[2*h+3]=k[0];a[2*
h+4]=k[1];a[2*h+5]=k[2]}c=g.$u(T);B.draw_line(c,a,!0);n.zt(c);c.ic.set([1,1,1,1]);c.Lm=d};a.hide_normals=y};b4w.module.geometry=function(a,t){var e=t("__batch"),c=t("__geometry"),b=t("__print"),f=t("__renderer"),k=t("__tbn");a.extract_vertex_array=function(a,f,k){if(!c.Cj(a))return b.error("Wrong object:",a.name),null;if(a=e.ab(a,f,"MAIN")){if((f=a.la)&&f.Eb&&("a_normal"==k&&f.Eb.a_tbn||f.Eb[k]))return c.Mz(f,k);b.error("Attribute not found:"+k);return null}b.error("Wrong material:",f);return null};a.extract_index_array=function(a,f){if(!c.Cj(a))return b.error("Wrong object:",a.name),null;var h=e.ab(a,
f,"MAIN");if(h){if((h=h.la)&&h.Eb)return h.fe;b.error("Buffer data not found");return null}b.error("Wrong material:",f);return null};a.update_vertex_array=function(a,f,k,t){if(c.Cj(a))for(var g=["MAIN","SHADOW","COLOR_ID"],d=0;d<g.length;d++){var h=e.ab(a,f,g[d]);h&&(h=h.la)&&h.Eb&&("a_normal"==k&&h.Eb.a_tbn||h.Eb[k])&&c.hJ(h,k,0,t)}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,h,u,t,g){if(c.Cj(a))if(u instanceof Uint16Array||u instanceof Uint32Array)if(t instanceof Float32Array)for(var d=
["MAIN","SHADOW","COLOR_ID"],q=0;q<d.length;q++){var p=e.ab(a,h,d[q]);if(p){var y=p.la;if(y){c.iJ(y,p.zh,u);var E={},z;for(z in y.Eb){var l=y.Eb[z],l=t.length/3*l.lc,B=c.no(z);E[B]||(E[B]=0);E[B]+=l}B=c.GR(E);y.gc=B;E={};for(z in y.Eb)switch(l=y.Eb[z],B=c.no(z),E[B]||(E[B]=0),z){case "a_position":c.Us(y.gc,"a_position",t,E[B]);l.offset=E[B];l.length=t.length;E[B]+=l.length;break;case "a_tbn":var w;g&&(w=c.dE(u,t,t));var G=c.cE(u,t,w);l.length=t.length/3*l.lc;for(var v=new Float32Array(l.length),D=
0;D<v.length;D+=4)v[D]=1,v[D+3]=1;G=k.tm(G,v);c.Us(y.gc,"a_tbn",G,E[B]);l.offset=E[B];E[B]+=l.length;break;default:l.offset=E[B],l.length=t.length/3*l.lc,G=new (c.FQ(B))(l.length),c.Us(y.gc,z,G,E[B]),E[B]+=l.length}c.yC(y);f.zt(p);(p=e.hg(a,p))&&p.la&&(p.la=y)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,e,f){c.check_shape_keys(a)?c.kA(a,e)?c.Py(a,e,parseFloat(f)):b.error("Wrong key name:",
e):b.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return c.check_shape_keys(a)};a.get_shape_keys_names=function(a){return c.check_shape_keys(a)?c.get_shape_keys_names(a):(b.error("Wrong object:",a.name),[])};a.get_shape_key_value=function(a,e){return c.check_shape_keys(a)?c.kA(a,e)?c.get_shape_key_value(a,e):(b.error("Wrong key name:",e),0):(b.error("Wrong object:",a.name),0)};a.draw_line=function(a,h,k){k=k||!1;if(h instanceof Float32Array){if(a=e.$u(a))c.draw_line(a,h,k),f.zt(a)}else b.error("Wrong positions type")}};b4w.module.hud=function(a,t){var e=t("__hud"),c=t("__print");a.draw_mixer_strip=function(a,f,k,q,h,u,t){c.Bd("draw_mixer_strip","screen.draw_mixer_strip");e.draw_mixer_strip(a,f,k,q,h,u,t)};a.plot_array=function(a,f,k,q,h,u,t){c.Bd("plot_array","screen.plot_array");e.plot_array(a,f,k,q,h,u,t)}};b4w.module.input=function(a,t){function e(a){h.Bd("enable_split_screen","screen.request_split_screen");var e=c.get_device_by_type_element(c.DEVICE_HMD);if(!e)return!1;if(r)return!0;var f=c.get_vector_param(e,c.PC,g),l=c.get_vector_param(e,c.QC,d);b.set_hmd_fov(a,f,l);if(f=c.get_value_param(e,E))l=u.get_active(),a=q.Da(a,l).ha,b.set_eye_distance(a,f);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};c.get_value_param(e,c.HMD_WEBVR_TYPE)&(c.HMD_NON_WEBVR|c.HMD_WEBVR_MOBILE|c.HMD_WEBVR_DESKTOP)&&
(a.distortion_coefs=[e.distortion_coefs[0],e.distortion_coefs[1]],a.chromatic_aberration_coefs=[e.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]],e.xn||(e.di&&e.yi&&e.ei?a.base_line_factor=(e.di-e.ei)/e.yi:e.ei||(a.base_line_factor=e.di/e.yi)),e.Gh&&e.Hl&&!e.xn&&(a.inter_lens_factor=e.Gh/e.Hl),p.enabled||(f=1+e.distortion_coefs[0]+e.distortion_coefs[1],u.mw(f,f)));u.set_hmd_params(a);k.resize_to_container(!0);c.reset_device(e);
return r=!0}var c=t("__input"),b=t("__camera"),f=t("__config"),k=t("__container"),q=t("__obj_util"),h=t("__print"),u=t("__scenes"),y=t("__vec4"),g=y.create(),d=y.create(),r=!1,p=f.im,M=f.K;a.GMPD_BUTTON_12=c.GMPD_BUTTON_12;a.GMPD_BUTTON_13=c.GMPD_BUTTON_13;a.GMPD_BUTTON_15=c.GMPD_BUTTON_15;a.GMPD_BUTTON_14=c.GMPD_BUTTON_14;a.GMPD_BUTTON_3=c.GMPD_BUTTON_3;a.GMPD_BUTTON_0=c.GMPD_BUTTON_0;a.GMPD_BUTTON_1=c.GMPD_BUTTON_1;a.GMPD_BUTTON_2=c.GMPD_BUTTON_2;a.GMPD_BUTTON_5=c.GMPD_BUTTON_5;a.GMPD_BUTTON_7=
c.GMPD_BUTTON_7;a.GMPD_BUTTON_4=c.GMPD_BUTTON_4;a.GMPD_BUTTON_6=c.GMPD_BUTTON_6;a.GMPD_BUTTON_8=c.GMPD_BUTTON_8;a.GMPD_BUTTON_9=c.GMPD_BUTTON_9;a.GMPD_BUTTON_10=c.GMPD_BUTTON_10;a.GMPD_BUTTON_11=c.GMPD_BUTTON_11;a.GMPD_BUTTON_16=c.GMPD_BUTTON_16;a.GMPD_BUTTON_17=c.GMPD_BUTTON_17;a.GMPD_BUTTON_18=c.GMPD_BUTTON_18;a.GMPD_BUTTON_19=c.GMPD_BUTTON_19;a.GMPD_BUTTON_20=c.GMPD_BUTTON_20;a.GMPD_BUTTON_21=c.GMPD_BUTTON_21;a.GMPD_BUTTON_22=c.GMPD_BUTTON_22;a.GMPD_BUTTON_23=c.GMPD_BUTTON_23;a.GMPD_BUTTON_24=
c.GMPD_BUTTON_24;a.GMPD_BUTTON_25=c.GMPD_BUTTON_25;a.GMPD_TRACKPAD_BUTTON=c.GMPD_TRACKPAD_BUTTON;a.GMPD_TRIGGER_BUTTON=c.GMPD_TRIGGER_BUTTON;a.GMPD_GRIPS_BUTTON=c.GMPD_GRIPS_BUTTON;a.GMPD_MENU_BUTTON=c.GMPD_MENU_BUTTON;a.GMPD_AXIS_0=c.GMPD_AXIS_0;a.GMPD_AXIS_1=c.GMPD_AXIS_1;a.GMPD_AXIS_2=c.GMPD_AXIS_2;a.GMPD_AXIS_3=c.GMPD_AXIS_3;a.GMPD_AXIS_4=c.GMPD_AXIS_4;a.GMPD_AXIS_5=c.GMPD_AXIS_5;a.GMPD_AXIS_6=c.GMPD_AXIS_6;a.GMPD_AXIS_7=c.GMPD_AXIS_7;a.GMPD_AXIS_8=c.GMPD_AXIS_8;a.GMPD_AXIS_9=c.GMPD_AXIS_9;a.GMPD_AXIS_10=
c.GMPD_AXIS_10;a.GMPD_AXIS_11=c.GMPD_AXIS_11;a.HMD_ORIENTATION_QUAT=c.HMD_ORIENTATION_QUAT;a.HMD_POSITION=c.HMD_POSITION;a.HMD_WEBVR_TYPE=c.HMD_WEBVR_TYPE;a.HMD_WEBVR_DESKTOP=c.HMD_WEBVR_DESKTOP;a.HMD_WEBVR_MOBILE=c.HMD_WEBVR_MOBILE;a.HMD_NON_WEBVR=c.HMD_NON_WEBVR;a.HMD_WEBVR1=c.HMD_WEBVR1;a.HMD_WEBVR1_1=c.HMD_WEBVR1_1;var E=c.HMD_EYE_DISTANCE;a.HMD_EYE_DISTANCE=E;a.HMD_DISTORTION=c.HMD_DISTORTION;a.HMD_BASELINE_DIST=c.HMD_BASELINE_DIST;a.HMD_SCREEN_LENS_DIST=c.HMD_SCREEN_LENS_DIST;a.HMD_SCREEN_WIDTH=
c.HMD_SCREEN_WIDTH;a.HMD_SCREEN_HEIGHT=c.HMD_SCREEN_HEIGHT;a.HMD_BEVEL_SIZE=c.HMD_BEVEL_SIZE;a.MOUSE_LOCATION=c.MOUSE_LOCATION;a.MOUSE_DOWN_WHICH=c.MOUSE_DOWN_WHICH;a.MOUSE_UP_WHICH=c.MOUSE_UP_WHICH;a.MOUSE_WHEEL=c.MOUSE_WHEEL;a.KEYBOARD_UP=c.KEYBOARD_UP;a.KEYBOARD_DOWN=c.KEYBOARD_DOWN;a.TOUCH_START=c.TOUCH_START;a.TOUCH_MOVE=c.TOUCH_MOVE;a.TOUCH_END=c.TOUCH_END;a.GYRO_ORIENTATION_QUAT=c.GYRO_ORIENTATION_QUAT;a.GYRO_ORIENTATION_ANGLES=c.GYRO_ORIENTATION_ANGLES;var z={};z[c.DEVICE_HMD]=[c.HMD_ORIENTATION_QUAT,
c.HMD_POSITION];z[c.DEVICE_MOUSE]=[c.MOUSE_LOCATION];var l={};l[c.DEVICE_HMD]=[c.HMD_WEBVR_TYPE];var B={};B[c.DEVICE_MOUSE]=[c.MOUSE_LOCATION,c.MOUSE_DOWN_WHICH,c.MOUSE_UP_WHICH,c.MOUSE_WHEEL];B[c.DEVICE_KEYBOARD]=[c.KEYBOARD_UP,c.KEYBOARD_DOWN];B[c.DEVICE_TOUCH]=[c.TOUCH_START,c.TOUCH_MOVE,c.TOUCH_END];B[c.DEVICE_GYRO]=[c.GYRO_ORIENTATION_QUAT,c.GYRO_ORIENTATION_ANGLES];var w={};w[c.DEVICE_HMD]=[c.HMD_DISTORTION,c.HMD_EYE_DISTANCE,c.HMD_BASELINE_DIST,c.HMD_SCREEN_LENS_DIST,c.HMD_SCREEN_WIDTH,c.HMD_SCREEN_HEIGHT,
c.HMD_BEVEL_SIZE];a.DEVICE_GYRO=c.DEVICE_GYRO;a.DEVICE_HMD=c.DEVICE_HMD;a.DEVICE_MOUSE=c.DEVICE_MOUSE;a.DEVICE_KEYBOARD=c.DEVICE_KEYBOARD;a.DEVICE_TOUCH=c.DEVICE_TOUCH;a.can_use_device=c.can_use_device;a.get_device_by_type_element=c.get_device_by_type_element;a.switch_prevent_default=function(a,b){a&&c.switch_prevent_default(a,b)};a.register_device=function(){h.ia("input.register_device() deprecated")};a.reset_device=function(a){a&&a.type==c.DEVICE_HMD?c.reset_device(a):h.error("reset_device is undefined for device.")};
a.get_vector_param=function(a,b,d){if(a&&a.type in z&&0<=z[a.type].indexOf(b))return c.get_vector_param(a,b,d);h.error("device hasn't param: ",b);return null};a.get_value_param=function(a,b){if(a&&a.type in l&&0<=l[a.type].indexOf(b))return c.get_value_param(a,b);h.error("device hasn't param: ",b);return null};a.attach_param_cb=function(a,b,d){d=d||null;if(a&&a.type in B&&0<=B[a.type].indexOf(b))return c.attach_param_cb(a,b,d);h.error("device hasn't param: ",b)};a.detach_param_cb=function(a,b,d){d=
d||null;if(a&&a.type in B&&0<=B[a.type].indexOf(b))return c.detach_param_cb(a,b,d);h.error("device hasn't param: ",b)};a.set_config=function(a,b,d){if(a&&a.type in w&&0<=w[a.type].indexOf(b))return c.set_config(a,b,d);h.error("device hasn't config: ",b)};a.request_fullscreen_hmd=function(){h.Bd("request_fullscreen_hmd","screen.request_fullscreen_hmd");if(u.La()){var a=u.Jk(u.get_active());if(a&&(e(a),a=c.get_device_by_type_element(c.DEVICE_HMD))){var b=a.td;b&&!b.isPresenting&&(b.capabilities.canPresent?
(a=k.get_canvas(),b.requestPresent([{source:a}]).then(function(){if(!M.is_mobile_device){var a=b.getEyeParameters("left"),c=b.getEyeParameters("right");k.resize(2*Math.max(a.renderWidth,c.renderWidth),Math.max(a.renderHeight,c.renderHeight),!1)}},function(){h.error("HMD fullscreen request failed.")})):h.error("HMD fullscreen request failed."))}}};a.enable_split_screen=e;a.disable_split_screen=function(){h.Bd("disable_split_screen","screen.exit_split_screen");var a=c.get_device_by_type_element(c.DEVICE_HMD);
if(!r||!a||!a.tg)return!1;u.set_hmd_params({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);u.mw(a,a);k.resize_to_container(!0);return!0};a.set_gamepad_key=function(a,b,d){switch(a){case 0:a=c.$s;break;case 1:a=c.vy;break;case 2:a=c.wy;break;case 3:a=c.xy;break;default:a=c.$s}a=c.get_device_by_type_element(a);c.set_config(a,b,d)};a.get_pressed_gmpd_btn=c.get_pressed_gmpd_btn;a.get_moved_gmpd_axis=c.get_moved_gmpd_axis;a.get_gamepad_position=c.get_gamepad_position;a.get_gamepad_orientation=
c.get_gamepad_orientation;a.check_enable_gamepad_indices=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b};a.get_vr_controller_id=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],c=0,d=0;4>c;c++){var e=b[c];if(e&&(""==e.id||"OpenVR Gamepad"==e.id||"Oculus Touch (Left)"==e.id||"Oculus Touch (Right)"==
e.id)){if(d==a)return d;d++}}return a};a.add_click_listener=function(a,b){a&&b&&c.add_click_listener(a,b)};a.remove_click_listener=function(a,b){a&&b&&c.remove_click_listener(a,b)}};b4w.module.lights=function(a,t){function e(a){for(var c=h.get_active(),e=f.Ob(c,"LAMP",f.DATA_ID_ALL),k=0;k<e.length;k++){var l=e[k];if("SUN"==l.Db.type){var p=l;break}}if(!p)q.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=g.deg_to_rad(180-a.hor_position);a=g.deg_to_rad(90-a.vert_position);k=p.v;u.set_rotation_euler(p,[a,0,e]);e=new Float32Array(3);l=y.get_quat_view(k.C);g.quat_to_dir(l,g.AXIS_Z,e);k=y.get_trans_view(k.C);k=d.length(k);
d.copy(e,r);d.scale(r,k,r);u.set_translation(p,r);u.T(p);e=p.Db;if(e.iF){k=c.world.horizon_color;l=c.world.zenith_color;a=Math.cos(Math.abs(a));var t=Math.max(a,.1)*c.world.light_settings.environment_energy;b.set_light_energy(e,Math.max(Math.min(3*a,1),0)*e.aF);h.set_environment_colors(c,t,k,l)}h.Ks(p,c)}}function c(a){if(k.is_lamp(a))return a.Db.type;q.error("get_light_type(): Wrong object");return""}var b=t("__lights"),f=t("__objects"),k=t("__obj_util"),q=t("__print"),h=t("__scenes"),u=t("__transform"),
y=t("__tsr"),g=t("__util"),d=t("__vec3"),r=new Float32Array(3),p,M,E,z=60;a.get_lamps=function(a){var b=h.get_active(),b=f.Ob(b,"LAMP",f.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.Db.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=h.get_active(),a=f.Ob(a,"LAMP",f.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.Db.type){b=d;break}}return b?(b=b.Db.direction,a=g.rad_to_deg(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=g.rad_to_deg(Math.atan2(b[2],
Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=e;a.set_day_time=function(a){for(var b=h.get_active(),b=f.Ob(b,"LAMP",f.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];if("SUN"==d.Db.type){var g=d;break}}g?(g=-Math.cos(a/12*Math.PI)*z,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=g,e(b)):q.error("There is no sun on the scene")};a.set_date=function(a){p=a.getFullYear();M=a.getMonth();E=a.getDate();p?1582==p&&9==M&&4<E&&15>E&&q.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
q.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){z=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(k.is_lamp(a))var b=a.Db;else return q.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var d={light_type:a,light_color:new Float32Array(3),light_energy:b.fg,light_spot_blend:b.xs,light_spot_size:b.en,light_distance:b.distance};d.light_color.set(b.color);break;case "POINT":d={light_type:a,light_color:new Float32Array(3),light_energy:b.fg,
light_distance:b.distance};d.light_color.set(b.color);break;default:d={light_type:a,light_color:new Float32Array(3),light_energy:b.fg},d.light_color.set(b.color)}return d?d:null};a.get_light_type=c;a.set_light_params=function(a,c){if(k.is_lamp(a)){var d=a.Db,e=h.get_active(),f=!1;"number"==typeof c.light_energy&&b.set_light_energy(d,c.light_energy);"object"==typeof c.light_color&&b.set_light_color(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.tU(d,c.light_spot_blend),f=!0);"number"==typeof c.light_spot_size&&
(b.uU(d,c.light_spot_size),f=!0);"number"==typeof c.light_distance&&(b.sU(d,c.light_distance),f=!0);h.Ks(a,e);f&&h.yV(e)}else q.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return k.is_lamp(a)?a.Db.fg:(q.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(k.is_lamp(a)){var d=h.get_active();b.set_light_energy(a.Db,c);h.Ks(a,d)}else q.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,b){if(!k.is_lamp(a))return q.error("get_light_color(): Wrong object"),
null;b=b||new Float32Array(3);b.set(a.Db.color);return b};a.set_light_color=function(a,c){if(k.is_lamp(a)){var d=h.get_active();b.set_light_color(a.Db,c);h.Ks(a,d)}else q.error("set_light_color(): Wrong object")}};b4w.module.logic_nodes=function(a,t){var e=t("__logic_nodes");a.append_custom_callback=function(a,b){e.sM(a,b)};a.remove_custom_callback=function(a){e.AT(a)};a.run_entrypoint=function(a,b){e.UT(a,b)}};b4w.module.material=function(a,t){var e=t("__batch"),c=t("__config"),b=t("__geometry"),f=t("__objects"),k=t("__obj_util"),q=t("__print"),h=t("__shaders"),u=t("__util"),y=t("__scenes"),g=c.K;a.inherit_material=function(a,c,e,g){if(b.Cj(e)&&b.Cj(a)){var d=a.Xe.$k.indexOf(c);if(-1==d)q.error('inherit_material(): material "'+c+'" not found on the object "'+a.Ed+'".');else{var h=e.Xe.$k.indexOf(g);-1==h?q.error('inherit_material(): material "'+g+'" not found on the object "'+e.Ed+'".'):(0==e.pk.data.submeshes[h].shade_tangs.length&&
a.kc[d].ne&&q.warn('The target material "'+g+'" was exported without tangent shading data. However, the "'+c+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),f.inherit_material(a,c,e,g))}}else q.error('inherit_material(): both objects "'+a.Ed+'" and "'+e.Ed+'" must have the "Dynamic Geometry & Materials" flag enabled.')};a.get_materials_names=function(a){var b=[];if(!k.mb(a))return q.error('get_materials_names(): Object "'+
a.name+'" is not a dynamic MESH.'),b;a=a.O;for(var c=0;c<a.length;c++)for(var d=a[c].Y,e=0;e<d.length;e++)for(var f=0;f<d[e].Xb.length;f++)-1==b.indexOf(d[e].Xb[f])&&b.push(d[e].Xb[f]);return b};a.set_diffuse_color=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");d?d.vb?q.error("set_diffuse_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(d.ic.set(c),(a=e.hg(a,b,"MAIN"))&&a.ic.set(c)):q.error('set_diffuse_color(): Material "'+b+'" wasn\'t found on the object "'+
a.name+'".')}else q.error('set_diffuse_color(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_diffuse_color=function(a,b){var c=new Float32Array(4);if(!k.mb(a))return q.error('get_diffuse_color(): Object "'+a.name+'" is not a dynamic MESH.'),c;var d=e.ab(a,b,"MAIN");if(!d)return q.error('get_diffuse_color(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),c;if(d.vb)return q.error("get_diffuse_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),
c;c.set(d.ic);return c};a.set_diffuse_intensity=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_diffuse_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(d.ee=c,a=e.hg(a,b,"MAIN"))a.ee=c}else q.error('set_diffuse_intensity(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_diffuse_intensity(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_diffuse_intensity=function(a,b){if(!k.mb(a))return q.error('get_diffuse_intensity(): Object "'+
a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_diffuse_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.ee:(q.error('get_diffuse_intensity(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),0)};a.set_specular_color=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");d?d.vb?q.error("set_specular_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):
(d.me.set(c),(a=e.hg(a,b,"MAIN"))&&a.me.set(c)):q.error('set_specular_color(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_specular_color(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_specular_color=function(a,b){var c=new Float32Array(3);if(!k.mb(a))return q.error('get_specular_color(): Object "'+a.name+'" is not a dynamic MESH.'),c;var d=e.ab(a,b,"MAIN");if(!d)return q.error('get_specular_color(): Material "'+b+'" wasn\'t found on the object "'+a.name+
'".'),c;if(d.vb)return q.error("get_specular_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),c;c.set(d.me);return c};a.set_specular_color_factor=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_specular_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(d.ak=c,a=e.hg(a,b,"MAIN"))a.ak=c}else q.error('set_specular_color_factor(): Material "'+b+'" wasn\'t found on the object "'+
a.name+'".')}else q.error('set_specular_color_factor(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_specular_color_factor=function(a,b){if(!k.mb(a))return q.error('get_specular_color_factor(): Object "'+a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_specular_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.ak:(q.error('get_specular_color_factor(): Material "'+b+'" wasn\'t found on the object "'+
a.name+'".'),0)};a.set_specular_intensity=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");d?d.vb?q.error("set_specular_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(d.He[0]=c,(a=e.hg(a,b,"MAIN"))&&(a.He[0]=c)):q.error('set_specular_intensity(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_specular_intensity(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_specular_intensity=function(a,b){if(!k.mb(a))return q.error('get_specular_intensity(): Object "'+
a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_specular_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.He[0]:(q.error('get_specular_intensity(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),0)};a.check_specular_intensity=function(a,b){q.ia("check_specular_intensity() is deprecated, not needed anymore");var c=e.ab(a,b,"MAIN");return!(!c||!c.He[0])};a.set_specular_hardness=function(a,
b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");d?d.vb?q.error("set_specular_hardness(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead."):(d.He[1]=c,(a=e.hg(a,b,"MAIN"))&&(a.He[1]=c)):q.error('set_specular_hardness(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_specular_hardness(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_specular_hardness=function(a,b){if(!k.mb(a))return q.error('get_specular_hardness(): Object "'+a.name+
'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_specular_hardness(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.He[1]:(q.error('get_specular_hardness(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),0)};a.check_specular_hardness=function(a,b){q.ia("check_specular_hardness() is deprecated, not needed anymore");var c=e.ab(a,b,"MAIN");return!(!c||!c.He[1])};a.set_emit_factor=function(a,b,c){if(k.mb(a)){var d=
e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_emit_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(d.Ad=c,a=e.hg(a,b,"MAIN"))a.Ad=c}else q.error('set_emit_factor(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_emit_factor(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_emit_factor=function(a,b){if(!k.mb(a))return q.error('get_emit_factor(): Object "'+a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,
"MAIN");return c?c.vb?(q.error("get_emit_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.Ad:(q.error('get_emit_factor(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),0)};a.set_ambient_factor=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_ambient_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(d.xd=c,a=e.hg(a,b,"MAIN"))a.xd=c}else q.error('set_ambient_factor(): Material "'+
b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_ambient_factor(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_ambient_factor=function(a,b){if(!k.mb(a))return q.error('get_ambient_factor(): Object "'+a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_ambient_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.xd:(q.error('get_ambient_factor(): Material "'+b+'" wasn\'t found on the object "'+
a.name+'".'),0)};a.set_diffuse_color_factor=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_diffuse_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{if(d.ui=c,a=e.hg(a,b,"MAIN"))a.ui=c}else q.error('set_diffuse_color_factor(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_diffuse_color_factor(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_diffuse_color_factor=function(a,
b){if(!k.mb(a))return q.error('get_diffuse_color_factor(): Object "'+a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_diffuse_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):c.ui:(q.error('get_diffuse_color_factor(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),0)};a.set_alpha_factor=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_alpha_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");
else{if(d.Hg=c,a=e.hg(a,b,"MAIN"))a.Hg=c}else q.error('set_alpha_factor(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_alpha_factor(): Object "'+a.name+'" is not a dynamic MESH.')};a.get_alpha_factor=function(a,b){if(!k.mb(a))return q.error('get_alpha_factor(): Object "'+a.name+'" is not a dynamic MESH.'),0;var c=e.ab(a,b,"MAIN");return c?c.vb?(q.error("get_alpha_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):
c.Hg:(q.error('get_alpha_factor(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),0)};a.get_material_extended_params=function(a,b){if(!k.mb(a))return q.error('get_material_extended_params(): Object "'+a.name+'" is not a dynamic MESH.'),null;var c=e.ab(a,b,"MAIN");if(!c)return q.error('get_material_extended_params(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),null;if(c.vb)return q.error("get_material_extended_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),
null;var d={};d.reflect_factor=c.reflect_factor;d.fresnel=c.Dh[0];d.fresnel_factor=5*(1-c.Dh[1]);d.parallax_scale=c.parallax_scale;d.parallax_steps=parseFloat(e.hd(c,"PARALLAX_STEPS")[1]);return d};a.set_material_extended_params=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");if(d)if(d.vb)q.error("set_material_extended_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var f=[d];(d=e.hg(a,b,"MAIN"))&&f.push(d);for(a=0;a<f.length;a++)d=f[a],"number"==
typeof c.reflect_factor&&(d.reflect_factor=c.reflect_factor),"number"==typeof c.fresnel&&(d.Dh[0]=c.fresnel),"number"==typeof c.fresnel_factor&&(d.Dh[1]=1-c.fresnel_factor/5),"number"==typeof c.parallax_scale&&(d.parallax_scale=c.parallax_scale),"number"==typeof c.parallax_steps&&(e.xb(d,"PARALLAX_STEPS",h.W(c.parallax_steps)),e.Hc(d),y.GH(d))}else q.error('set_material_extended_params(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".')}else q.error('set_material_extended_params(): Object "'+
a.name+'" is not a dynamic MESH.')};a.get_water_material_params=function(a,b){if(!k.mb(a))return q.error('get_water_material_params(): Object "'+a.name+'" is not a dynamic MESH.'),null;var c=e.ab(a,b,"MAIN");if(!c||!c.Qf)return q.error('get_water_material_params(): Material "'+b+'" wasn\'t found on the object "'+a.name+"\" or it's not a water material."),null;if(c.vb)return q.error("get_water_material_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),
null;var d={};d.shore_smoothing=g.shore_smoothing&&c.wn&&!!parseFloat(e.hd(c,"SHORE_SMOOTHING")[1]);d.absorb_factor=parseFloat(e.hd(c,"ABSORB")[1]);d.foam_factor=c.foam_factor;d.shallow_water_col=new Float32Array(3);d.shore_water_col=new Float32Array(3);d.shallow_water_col_fac=0;d.shore_water_col_fac=0;g.bp&&(d.shallow_water_col.set(c.shallow_water_col),d.shore_water_col.set(c.shore_water_col),d.shallow_water_col_fac=c.shallow_water_col_fac,d.shore_water_col_fac=c.shore_water_col_fac);d.norm_uv_velocity=
c.Gl;d.water_dynamic=g.water_dynamic&&c.water_dynamic&&!!parseFloat(e.hd(c,"DYNAMIC")[1]);d.sss_strength=parseFloat(e.hd(c,"SSS_STRENGTH")[1]);d.sss_width=parseFloat(e.hd(c,"SSS_WIDTH")[1]);d.waves_height=parseFloat(e.hd(c,"WAVES_HEIGHT")[1]);d.waves_length=parseFloat(e.hd(c,"WAVES_LENGTH")[1]);d.dst_noise_scale0=parseFloat(e.hd(c,"DST_NOISE_SCALE_0")[1]);d.dst_noise_scale1=parseFloat(e.hd(c,"DST_NOISE_SCALE_1")[1]);d.dst_noise_freq0=parseFloat(e.hd(c,"DST_NOISE_FREQ_0")[1]);d.dst_noise_freq1=parseFloat(e.hd(c,
"DST_NOISE_FREQ_1")[1]);d.dir_min_shore_fac=parseFloat(e.hd(c,"DIR_MIN_SHR_FAC")[1]);d.dir_freq=parseFloat(e.hd(c,"DIR_FREQ")[1]);d.dir_noise_scale=parseFloat(e.hd(c,"DIR_NOISE_SCALE")[1]);d.dir_noise_freq=parseFloat(e.hd(c,"DIR_NOISE_FREQ")[1]);d.dir_min_noise_fac=parseFloat(e.hd(c,"DIR_MIN_NOISE_FAC")[1]);d.dst_min_fac=parseFloat(e.hd(c,"DST_MIN_FAC")[1]);d.waves_hor_fac=parseFloat(e.hd(c,"WAVES_HOR_FAC")[1]);return d};a.set_water_material_params=function(a,b,c){if(k.mb(a)){var d=e.ab(a,b,"MAIN");
if(d&&d.Qf)if(d.vb)q.error("set_water_material_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var f=[d];(d=e.hg(a,b,"MAIN"))&&f.push(d);for(a=0;a<f.length;a++)d=f[a],"boolean"==typeof c.shore_smoothing&&(g.shore_smoothing&&d.wn&&c.shore_smoothing?e.xb(d,"SHORE_SMOOTHING",1):e.xb(d,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=h.W(parseFloat(c.absorb_factor)),e.xb(d,"ABSORB",b)),"number"==typeof c.foam_factor&&g.io&&(d.foam_factor=
c.foam_factor),g.bp&&("object"==typeof c.shallow_water_col&&d.shallow_water_col.set(c.shallow_water_col),"number"==typeof c.shallow_water_col_fac&&(d.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&d.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(d.shore_water_col_fac=c.shore_water_col_fac)),"number"==typeof c.norm_uv_velocity&&(d.Gl=c.norm_uv_velocity),g.water_dynamic&&d.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?
e.xb(d,"DYNAMIC",1):e.xb(d,"DYNAMIC",0)),"number"==typeof c.sss_strength&&(b=h.W(parseFloat(c.sss_strength)),e.xb(d,"SSS_STRENGTH",b)),"number"==typeof c.sss_width&&(b=h.W(parseFloat(c.sss_width)),e.xb(d,"SSS_WIDTH",b)),"number"==typeof c.waves_height&&(b=h.W(parseFloat(c.waves_height)),e.xb(d,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=h.W(parseFloat(c.waves_length)),e.xb(d,"WAVES_LENGTH",b)),"number"==typeof c.dst_noise_scale0&&(b=h.W(parseFloat(c.dst_noise_scale0)),e.xb(d,"DST_NOISE_SCALE_0",
b)),"number"==typeof c.dst_noise_scale1&&(b=h.W(parseFloat(c.dst_noise_scale1)),e.xb(d,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=h.W(parseFloat(c.dst_noise_freq0)),e.xb(d,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=h.W(parseFloat(c.dst_noise_freq1)),e.xb(d,"DST_NOISE_FREQ_1",b)),"number"==typeof c.dir_min_shore_fac&&(b=h.W(parseFloat(c.dir_min_shore_fac)),e.xb(d,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=h.W(parseFloat(c.dir_freq)),e.xb(d,"DIR_FREQ",
b)),"number"==typeof c.dir_noise_scale&&(b=h.W(parseFloat(c.dir_noise_scale)),e.xb(d,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=h.W(parseFloat(c.dir_noise_freq)),e.xb(d,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=h.W(parseFloat(c.dir_min_noise_fac)),e.xb(d,"DIR_MIN_NOISE_FAC",b)),"number"==typeof c.dst_min_fac&&(b=h.W(parseFloat(c.dst_min_fac)),e.xb(d,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=h.W(parseFloat(c.waves_hor_fac)),e.xb(d,"WAVES_HOR_FAC",b))),
e.Hc(d),y.GH(d)}else q.error('set_water_material_params(): Material "'+b+'" wasn\'t found on the object "'+a.name+"\" or it's not a water material.")}else q.error('set_water_material_params(): Object "'+a.name+'" is not a dynamic MESH.')};a.set_line_params=function(a,b){if(k.is_line(a)){var c=e.$u(a);c?(u.ge(b.color)&&c.ic.set(b.color),u.ge(b.width)&&(c.Lm=b.width)):q.error("set_line_params(): Couldn't set line parameters!")}else q.error('set_line_params(): Object "'+a.name+'" is not a LINE object.')};
a.get_line_params=function(a){if(!k.is_line(a))return q.error('get_line_params(): Object "'+a.name+'" is not a LINE object.'),null;a=e.$u(a);return a?{color:new Float32Array(a.ic),width:a.Lm}:(q.error("get_line_params(): Couldn't get line parameters!"),null)};a.set_nodemat_value=function(a,b,c){var d=k.mb(a),g=k.is_world(a),h=g?f.jv(a):a.name;if(d||g){if(d){var l=b[0],p=1,r=e.Lu(a,l);if(!r){q.error('set_nodemat_value(): Material "'+l+'" wasn\'t found on the object "'+h+'".');return}}else if(g&&(d=
y.get_active(),l="",p=0,r=e.mr(a,d),!r)){q.error("set_nodemat_value(): Sky node material wasn't found on the world object \""+h+'".');return}p=f.or(r.Ff,b,p);null===p?q.error('set_nodemat_value(): Value node "'+b[b.length-1]+'" was not found in the object "'+h+'".'):f.set_nodemat_value(a,l,p,c)}else q.error('set_nodemat_value(): Object "'+h+'" is not a dynamic MESH or WORLD.')};a.get_nodemat_value=function(a,b){var c=k.mb(a),d=k.is_world(a),g=d?f.jv(a):a.name;if(!c&&!d)return q.error('get_nodemat_value(): Object "'+
g+'" is not a dynamic MESH or WORLD.'),0;if(c){var c=b[0],h=1,l=e.Lu(a,c);if(!l)return q.error('get_nodemat_value(): Material "'+c+'" wasn\'t found on the object "'+g+'".'),0}else if(d&&(l=y.get_active(),h=0,l=e.mr(a,l),!l))return q.error("get_nodemat_value(): Sky node material wasn't found on the world object \""+g+'".'),0;h=f.or(l.Ff,b,h);return null===h?(q.error('get_nodemat_value(): Value node "'+b[b.length-1]+'" was not found in the object "'+g+'".'),0):f.get_nodemat_value(l,h)};a.set_nodemat_rgb=
function(a,b,c,g,h){var d=k.mb(a),l=k.is_world(a),p=l?f.jv(a):a.name;if(d||l){if(d){var r=b[0],u=1,v=e.Lu(a,r);if(!v){q.error('set_nodemat_rgb(): Material "'+r+'" wasn\'t found on the object "'+p+'".');return}}else if(l&&(d=y.get_active(),r="",u=0,v=e.mr(a,d),!v)){q.error("set_nodemat_rgb(): Sky node material wasn't found on the world object \""+p+'".');return}u=f.nr(v.Ef,b,u);null===u?q.error('set_nodemat_rgb(): RGB node "'+b[b.length-1]+'" was not found in the object "'+p+'".'):f.set_nodemat_rgb(a,
r,u,c,g,h)}else q.error('set_nodemat_rgb(): Object "'+p+'" is not a dynamic MESH or WORLD.')};a.get_nodemat_rgb=function(a,b,c){var d=k.mb(a),g=k.is_world(a),h=g?f.jv(a):a.name;if(!d&&!g)return q.error('get_nodemat_rgb(): Object "'+h+'" is not a dynamic MESH or WORLD.'),null;if(d){var d=b[0],l=1,p=e.Lu(a,d);if(!p)return q.error('get_nodemat_rgb(): Material "'+d+'" wasn\'t found on the object "'+h+'".'),null}else if(g&&(p=y.get_active(),l=0,p=e.mr(a,p),!p))return q.error("get_nodemat_rgb(): Sky node material wasn't found on the world object \""+
h+'".'),null;a=f.nr(p.Ef,b,l);if(null===a)return q.error('get_nodemat_rgb(): RGB node "'+b[b.length-1]+'" was not found in the object "'+h+'".'),null;c||(c=new Float32Array(3));return f.get_nodemat_rgb(p,a,c)};a.is_node_material=function(a,b){if(!k.mb(a))return q.error('is_node_material(): Object "'+a.name+'" is not a dynamic MESH.'),!1;var c=e.ab(a,b,"MAIN");return c?c.vb:(q.error('is_node_material(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),!1)};a.is_water_material=function(a,
b){if(!k.mb(a))return q.error('is_water_material(): Object "'+a.name+'" is not a dynamic MESH.'),!1;var c=e.ab(a,b,"MAIN");return c?c.Qf&&!c.vb:(q.error('is_water_material(): Material "'+b+'" wasn\'t found on the object "'+a.name+'".'),!1)}};b4w.module.math=function(a,t){var e=t("__vec3"),c=t("__util"),b=t("__math"),f=new Float32Array(3);a.create_pline_from_points=function(a,c){var h=new Float32Array(6);b.set_pline_initial_point(h,a);e.subtract(c,a,f);b.set_pline_directional_vec(h,f);return h};a.create_pline_from_point_vec=function(a,c){var e=new Float32Array(6);b.set_pline_initial_point(e,a);b.set_pline_directional_vec(e,c);return e};a.create_pline=function(){return new Float32Array(6)};a.get_pline_directional_vec=b.get_pline_directional_vec;
a.get_pline_initial_point=b.get_pline_initial_point;a.set_pline_initial_point=b.set_pline_initial_point;a.set_pline_directional_vec=b.set_pline_directional_vec;a.line_plane_intersect=c.line_plane_intersect;a.calc_pline_point=b.calc_pline_point;a.point_plane_dist=b.point_plane_dist;a.linear_tween=b.linear_tween;a.ease_in_quad=b.ease_in_quad;a.ease_out_quad=b.ease_out_quad;a.ease_in_out_quad=b.ease_in_out_quad;a.ease_in_cubic=b.ease_in_cubic;a.ease_out_cubic=b.ease_out_cubic;a.ease_in_out_cubic=b.ease_in_out_cubic;
a.ease_in_quart=b.ease_in_quart;a.ease_out_quart=b.ease_out_quart;a.ease_in_out_quart=b.ease_in_out_quart;a.ease_in_quint=b.ease_in_quint;a.ease_out_quint=b.ease_out_quint;a.ease_in_out_quint=b.ease_in_out_quint;a.ease_in_sine=b.ease_in_sine;a.ease_out_sine=b.ease_out_sine;a.ease_in_out_sine=b.ease_in_out_sine;a.ease_in_expo=b.ease_in_expo;a.ease_out_expo=b.ease_out_expo;a.ease_in_out_expo=b.ease_in_out_expo;a.ease_in_circ=b.ease_in_circ;a.ease_out_circ=b.ease_out_circ;a.ease_in_out_circ=b.ease_in_out_circ;
a.ease_in_elastic=b.ease_in_elastic;a.ease_out_elastic=b.ease_out_elastic;a.ease_in_out_elastic=b.ease_in_out_elastic;a.ease_in_back=b.ease_in_back;a.ease_out_back=b.ease_out_back;a.ease_in_out_back=b.ease_in_out_back;a.ease_in_bounce=b.ease_in_bounce;a.ease_out_bounce=b.ease_out_bounce;a.ease_in_out_bounce=b.ease_in_out_bounce};b4w.module.particles=function(a,t){var e=t("__particles"),c=t("__print");a.set_size=function(a,f,k){e.cB(a,f)?e.set_size(a,f,k):c.error('set_size(): Object "'+a.name+'" has not a particle system named "'+f+'"')};a.set_normal_factor=function(a,f,k){e.cB(a,f)?e.set_normal_factor(a,f,k):c.error('set_normal_factor(): Object "'+a.name+'" has not a particle system named "'+f+'"')};a.set_factor=function(a,f,k){e.cB(a,f)?(k=Math.min(k,1),k=Math.max(k,0),e.set_factor(a,f,k)):c.error('set_factor(): Object "'+
a.name+'" has not a particle system named "'+f+'"')}};b4w.module.physics=function(a,t){function e(a,b,c,e){return k.vP(a,e[c[0]],e[c[1]],e[c[2]])}function c(a,b,c,e,d){b=Math.abs(a[2]-b[2]);return b<d&&q.RR(a,c,e)?b:Number.MAX_VALUE}var b=t("__physics"),f=t("__print"),k=t("__util"),q=t("__navmesh");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.va(a)?b.enable_simulation(a):f.ia("No physics for object "+a.name)};a.disable_simulation=function(a){b.va(a)?b.disable_simulation(a):f.ia("No physics for object "+a.name)};a.has_physics=
function(a){return b.va(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,c){b.va(a)?b.set_gravity(a,c):f.ia("No physics for object "+a.name)};a.set_transform=function(a,c,e){b.va(a)?b.set_transform(a,c,e):f.ia("No physics for object "+a.name)};a.sync_transform=function(a){b.va(a)?b.sync_transform(a):f.ia("No physics for object "+a.name)};a.apply_velocity=function(a,c,e,g){b.va(a)?
b.apply_velocity(a,c,e,g):f.ia("No physics for object "+a.name)};a.apply_velocity_world=function(a,c,e,g){b.va(a)?b.apply_velocity_world(a,c,e,g):f.ia("No physics for object "+a.name)};a.apply_force=function(a,c,e,g){b.va(a)?b.apply_force(a,c,e,g,!1):f.ia("No physics for object "+a.name)};a.apply_force_world=function(a,c,e,g){b.va(a)?b.apply_force(a,c,e,g,!0):f.ia("No physics for object "+a.name)};a.apply_torque=function(a,c,e,g){b.va(a)?b.apply_torque(a,c,e,g):f.ia("No physics for object "+a.name)};
a.set_angular_velocity=function(a,c,e,g){b.va(a)?b.set_angular_velocity(a,c,e,g):f.ia("No physics for object "+a.name)};a.vehicle_throttle=function(a,c){b.va(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||f.error("Wrong object"),b.vehicle_throttle(a,k.clamp(c,-1,1))):f.ia("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,c,e){if(b.va(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||f.error("Wrong object");c=k.clamp(c,0,1);var g=a.N.bo;-1==e||1==e?g=Math.max(-1,Math.min(g+e*
c,1)):!e&&0<=g?g=Math.max(0,g-c):!e&&0>g?g=Math.min(0,g+c):f.error("Wrong steering direction");b.vehicle_throttle(a,k.clamp(g,-1,1))}else f.ia("No physics for object "+a.name)};a.vehicle_steer=function(a,c){b.va(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||f.error("Wrong object"),b.vehicle_steer(a,k.clamp(c,-1,1))):f.ia("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,c,e){if(b.va(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||f.error("Wrong object");c=k.clamp(c,0,1);var g=
a.N.pp;-1==e||1==e?g=Math.max(-1,Math.min(g+e*c,1)):!e&&0<=g?g=Math.max(0,g-c):!e&&0>g?g=Math.min(0,g+c):f.error("Wrong steering direction");b.vehicle_steer(a,k.clamp(g,-1,1))}else f.ia("No physics for object "+a.name)};a.vehicle_brake=function(a,c){b.va(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||f.error("Wrong object"),b.vehicle_brake(a,k.clamp(c,0,1))):f.ia("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,c){if(b.va(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||f.error("Wrong object");
c=k.clamp(c,-1,1);var e=a.N.sq;b.vehicle_brake(a,k.clamp(e+e*c,0,1))}else f.ia("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.va(a))return f.ia("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.Nf.name;f.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.va(a))return f.ia("No physics for object "+
a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.N.bo;f.error("Wrong object");return null};a.get_vehicle_steering=function(a){if(!b.va(a))return f.ia("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.N.pp;f.error("Wrong object");return 0};a.get_vehicle_brake=function(a){if(!b.va(a))return f.ia("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.N.sq;f.error("Wrong object");return 0};a.get_vehicle_speed=
function(a){if(!b.va(a))return f.ia("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);f.error("Wrong object");return 0};a.is_character=function(a){return b.YF(a)};a.set_character_move_dir=function(a,c,e){b.va(a)?b.set_character_move_dir(a,c,e):f.ia("No physics for object "+a.name)};a.set_character_move_type=function(a,c){b.va(a)?b.set_character_move_type(a,c):f.ia("No physics for object "+a.name)};a.set_character_walk_velocity=function(a,
c){b.va(a)?b.set_character_walk_velocity(a,c):f.ia("No physics for object "+a.name)};a.set_character_run_velocity=function(a,c){b.va(a)?b.set_character_run_velocity(a,c):f.ia("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,c){b.va(a)?b.set_character_fly_velocity(a,c):f.ia("No physics for object "+a.name)};a.character_jump=function(a){b.va(a)?b.character_jump(a):f.ia("No physics for object "+a.name)};a.character_rotation_inc=function(a,c,e){b.va(a)?b.character_rotation_inc(a,
c,e):f.ia("No physics for object "+a.name)};a.set_character_rotation=function(a,c,e){b.va(a)?b.set_character_rotation(a,c,e):f.ia("No physics for object "+a.name)};a.set_character_rotation_v=function(a,c){b.va(a)?b.set_character_rotation_v(a,c):f.ia("No physics for object "+a.name)};a.set_character_rotation_h=function(a,c){b.va(a)?b.set_character_rotation_h(a,c):f.ia("No physics for object "+a.name)};a.append_collision_test=function(a,c,e,g){b.va(a)?b.append_collision_test(a,c||"ANY",e,g||!1):f.ia("No physics for object "+
a.name)};a.remove_collision_test=function(a,c,e){b.va(a)?b.remove_collision_test(a,c||"ANY",e):f.ia("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,c){b.va(a)?b.apply_collision_impulse_test(a,c):f.ia("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.va(a)?b.clear_collision_impulse_test(a):f.ia("No physics for object "+a.name)};a.append_ray_test=function(a,c,e,g,d,k){a=a||null;return null==a||b.va(a)?b.append_ray_test(a,c,e,g||"ANY",d,k||!1,
!1,!1,!1):(f.ia("No physics for object "+a.name),0)};a.append_ray_test_ext=function(a,c,e,g,d,k,p,q,t){a=a||null;return null==a||b.va(a)?b.append_ray_test(a,c,e,g||"ANY",d,k||!1,p||!1,q||!1,t||!1):(f.ia("No physics for object "+a.name),0)};a.remove_ray_test=function(a){b.vG(a)?b.remove_ray_test(a):f.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,c,e){b.vG(a)?b.change_ray_test_from_to(a,c,e):f.error("Wrong ray test ID")};a.apply_constraint=function(a,c,e,g,d,k,p,q,t,z){b.va(c)&&b.va(d)?
b.apply_constraint(a,c,e,g,d,k,p,q,t,z):f.error("Wrong objects")};a.clear_constraint=function(a){b.va(a)&&b.oR(a)?b.clear_constraint(a):f.error("Wrong object")};a.pull_to_constraint_pivot=function(a,c,e,g,d,k){b.va(a)&&b.va(g)?b.pull_to_constraint_pivot(a,c,e,g,d,k):f.error("Wrong objects")};a.navmesh_get_island=function(a,c,k){k||(k=e);if(b.va(a)){var g=a.L.Kr;return g?q.navmesh_get_island(g,c,k):(f.error(a.name+" is not a navigation mesh object"),null)}f.ia("No physics for object "+a.name)};a.navmesh_find_path=
function(a,k,t,g){if(b.va(a)){var d=a.L.Kr;if(!d)return f.error(a.name+" is not a navigation mesh object"),null;g=g||{};a={};a.do_not_pull_string=!!g.do_not_pull_string;a.distance_to_closest=g.distance_to_closest||e;a.distance_to_farthest=g.distance_to_farthest||c;a.island=g.island||0;a.allowed_distance=g.allowed_distance||Number.MAX_VALUE;a.return_normals=g.return_normals||!1;return q.navmesh_find_path(d,k,t,a)}f.ia("No physics for object "+a.name)}};b4w.module.rgb=function(a,t){var e=t("__util"),c=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,c,e){var b=new Float32Array(3);b[0]=a;b[1]=c;b[2]=e;return b};a.set=function(a,c,e,q){q[0]=a;q[1]=c;q[2]=e;return q};a.css_to_rgb=function(a,c,k,q){q=q||new Float32Array(3);q[0]=a/255;q[1]=c/255;q[2]=k/255;e.FI(q,q);return q};a.rgb_to_css=function(a){a=e.DA(a,c);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=function(a){function b(a){a=
Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=e.DA(a,c);return"#"+b(a[0])+b(a[1])+b(a[2])}};
b4w.module.rgba=function(a,t){var e=t("__util"),c=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,c,e,q){var b=new Float32Array(4);b[0]=a;b[1]=c;b[2]=e;b[3]=q;return b};a.set=function(a,c,e,q,h){h[0]=a;h[1]=c;h[2]=e;h[3]=q;return h};a.css_to_rgba=function(a,c,k,q,h){h=h||new Float32Array(4);h[0]=a/255;h[1]=c/255;h[2]=k/255;h[3]=q;e.FI(h,h);return h};a.rgba_to_css=function(a){var b=e.DA(a,c);return[Math.round(255*b[0]),Math.round(255*b[1]),
Math.round(255*b[2]),a[3]]}};b4w.module.scenes=function(a,t){function e(){var a=k.get_canvas();return u.pick_object(a.clientWidth/2,a.clientHeight/2)}function c(a){return y.mb(a)||y.is_empty(a)||y.is_line(a)||y.is_lamp(a)}var b=t("__batch"),f=t("__camera"),k=t("__container"),q=t("__data"),h=t("__graph"),u=t("__objects"),y=t("__obj_util"),g=t("__print"),d=t("__scenes"),r=t("__scenegraph"),p=t("__subscene"),M=t("__util");a.DATA_ID_ALL=u.DATA_ID_ALL;a.set_active=function(a){var b=d.lr();d.set_active(M.keysearch("name",a,b))};a.get_active=
function(){return d.La()?d.get_active().name:""};a.get_scenes=function(){for(var a=d.lr(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(d.La())return d.Jk(d.get_active());g.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=u.uc(u.zy,a,b|0,!0);if(c)return c;g.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=u.uc(u.yy,a,b,c|0))return a;g.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=
function(a,b){var c=u.uc(u.Ic,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_world_by_name=function(a,b){var c=u.get_world_by_name(a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_object_data_id=function(a){return y.get_object_data_id(a)};a.pick_object=function(a,b){var c=d.Fh();return c?(c=d.Pb(c,p.Eg))&&c.enable_hmd_stereo?(g.ia("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),e()):u.pick_object(a,b):(g.error("No active scene"),
null)};a.pick_center=e;a.outlining_is_enabled=function(a){return a&&a.v&&a.v.Yc};a.set_outline_intensity=function(a,b){a&&a.v&&a.v.Yc?u.set_outline_intensity(a,b):g.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.v&&a.v.Yc)return a.v.Nh;g.error("get_outline_intensity(): wrong object");return 0};a.apply_outline_anim=function(a,b,c,d){a&&a.v&&a.v.Yc?u.apply_outline_anim(a,b,c,d):g.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&
a.v&&a.v.Yc){var b=a.v.Ki;u.apply_outline_anim(a,b.al,b.bl,b.cl)}else g.error("apply_outline_anim_def(): wrong object")};a.clear_outline_anim=function(a){a&&a.v&&a.v.Yc?u.clear_outline_anim(a):g.error("clear_outline_anim(): wrong object")};a.set_outline_color=d.set_outline_color;a.get_outline_color=function(a){var b=d.get_active();if(b=d.Pb(b,p.Cn))return a=a||new Float32Array(3),a.set(b.Mh),a};a.set_hmd_params=function(a){d.La()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=
null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),d.set_hmd_params(a)):g.error("No active scene")};a.get_shadow_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active(),b=d.Pb(a,p.wd);if(!b)return null;var c=
a.J.Zc,e=d.Pb(a,p.Nb),f=d.Pb(a,p.Wf),h={};h.csm_resolution=c.csm_resolution;h.self_shadow_polygon_offset=b.self_shadow_polygon_offset;f&&(h.self_shadow_normal_offset=f.self_shadow_normal_offset);h.enable_csm=c.enable_csm;h.csm_num=c.csm_num;h.csm_first_cascade_border=c.csm_first_cascade_border;h.first_cascade_blur_radius=c.first_cascade_blur_radius;h.csm_last_cascade_border=c.csm_last_cascade_border;h.last_cascade_blur_radius=c.last_cascade_blur_radius;h.fade_last_cascade=c.fade_last_cascade;h.blend_between_cascades=
c.blend_between_cascades;c.enable_csm?(h.csm_borders=d.GQ(a,e.F),h.blur_radii=new Float32Array(c.csm_num),h.blur_radii.set(e.F.Uo.subarray(0,c.csm_num))):(h.csm_borders=null,h.blur_radii=null);return h};a.set_shadow_params=function(a){if(d.La()){var c=d.get_active();"number"==typeof a.self_shadow_polygon_offset&&h.ba(c.J.Aa,function(b,c){c.type==p.wd&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});for(var e=d.xg(c,[p.Wf]),k=0;k<e.length;k++){var q=e[k];"number"==typeof a.self_shadow_normal_offset&&
(q.self_shadow_normal_offset=a.self_shadow_normal_offset);"number"==typeof a.pcf_blur_radius&&(q.pcf_blur_radius=a.pcf_blur_radius)}e=d.xg(c,[p.bd]);for(k=0;k<e.length;k++){var r=e[k];"number"==typeof a.self_shadow_normal_offset&&(r.self_shadow_normal_offset=a.self_shadow_normal_offset);"number"==typeof a.pcf_blur_radius&&(r.pcf_blur_radius=a.pcf_blur_radius);r.Ka=!0}e=c.J.Zc;"number"==typeof a.csm_first_cascade_border&&(e.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&
(e.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(e.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(e.last_cascade_blur_radius=a.last_cascade_blur_radius);if(q){r=q.Xa;for(k=0;k<r.length;k++)for(var v=r[k].Ia,u=0;u<v.length;u++){var t=v[u];if(t.qg.Td){var n=t.ya;b.JD(n,e);b.Hc(n);p.Rc(q,t)}}q.Ka=!0}q=y.Da(c.bj,c).ha;for(k=0;k<q.length;k++)f.xC(q[k],e);d.JB(c)}else g.error("No active scene")};a.get_environment_colors=
function(){if(!d.La())return g.error("No active scene"),[];var a=d.get_active();return d.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(d.La()){var e=d.get_active(),f=d.Pb(e,p.Nb);d.set_environment_colors(e,a||0==a?parseFloat(a):f.gg,b||0==b?b:f.Ld,c||0==c?c:f.Yd)}else g.error("No active scene")};a.get_fog_color_density=function(a){if(!d.La())return g.error("No active scene"),!1;var b=d.get_active();return d.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(d.La()){var b=
d.get_active();d.set_fog_color_density(b,a)}else g.error("No active scene")};a.get_fog_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active(),b={};b.fog_intensity=d.PQ(a);b.fog_depth=d.NQ(a);b.fog_start=d.QQ(a);b.fog_height=d.OQ(a);return b};a.set_fog_params=function(a){if(d.La()){var b=d.get_active();"number"==typeof a.fog_intensity&&d.bI(b,a.fog_intensity);"number"==typeof a.fog_depth&&d.$H(b,a.fog_depth);"number"==typeof a.fog_start&&d.cI(b,a.fog_start);"number"==
typeof a.fog_height&&d.aI(b,a.fog_height)}else g.error("No active scene")};a.get_ssao_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.get_ssao_params(a)};a.set_ssao_params=function(a){if(d.La()){var c=d.get_active(),e=d.xg(c,[p.it]),c=d.xg(c,[p.Fy]);if(!e.length)return g.error("SSAO is not enabled on the scene"),0;for(var f=0;f<e.length;f++){var h=e[f],k=c[f],q=a,u=d.get_active(),t=h.Xa[0].Ia[0],n=t.ya,y=k.Xa[0].Ia[0],E=y.ya;if("quality"in q){var x=
q.quality;8===x||16===x||24===x||32===x?(h.fn=x,b.xb(n,"SSAO_QUALITY","SSAO_QUALITY_"+x),b.Hc(n),p.Rc(h,t)):g.error('set_ssao_params(): Wrong "quality" value.')}"use_hemisphere"in q&&(h.mp=q.use_hemisphere,b.xb(n,"SSAO_HEMISPHERE",q.use_hemisphere|0),b.Hc(n),p.Rc(h,t));"use_blur_depth"in q&&(k.jp=q.use_blur_depth,b.xb(E,"SSAO_BLUR_DEPTH",q.use_blur_depth|0),b.Hc(E),p.Rc(k,y),r.dm(u.J.Aa,k,E));"ssao_white"in q&&(h.ssao_white=q.ssao_white,b.xb(n,"SSAO_WHITE",q.ssao_white|0),b.Hc(n),p.Rc(h,t));"blur_discard_value"in
q&&(k.kp=q.blur_discard_value);"radius_increase"in q&&(h.op=q.radius_increase);"influence"in q&&(h.np=q.influence);"dist_factor"in q&&(h.lp=q.dist_factor);if("boolean"==typeof q.ssao_only){u=d.Pb(u,p.Nb);u.ssao_only=q.ssao_only;t=u.Xa;n=[];for(y=0;y<t.length;y++)for(E=t[y].Ia,x=0;x<E.length;x++){var J=E[x].ya;b.xb(J,"SSAO_ONLY",q.ssao_only|0);b.Hc(J);n.push(E[x])}for(y=0;y<n.length;y++)p.Rc(u,n[y])}h.Ka=!0;k.Ka=!0}}else g.error("No active scene")};a.get_color_correction_params=function(){if(!d.La())return g.error("No active scene"),
null;var a=d.get_active(),a=d.Pb(a,p.ty);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(d.La()){var b=d.get_active();if(b=d.Pb(b,p.ty))"brightness"in a&&(b.brightness=a.brightness),"contrast"in a&&(b.contrast=a.contrast),"exposure"in a&&(b.exposure=a.exposure),"saturation"in a&&(b.saturation=a.saturation),b.Ka=!0}else g.error("No active scene")};a.get_sky_params=function(){if(!d.La())return g.error("No active scene"),
!1;var a=d.get_active();return d.get_sky_params(a)};a.set_sky_params=function(a){if(d.La()){var b=d.get_active(),c=d.Pb(b,p.qe);c&&("color"in a&&c.pl.set(a.color),"rayleigh_brightness"in a&&(c.rayleigh_brightness=a.rayleigh_brightness),"mie_brightness"in a&&(c.mie_brightness=a.mie_brightness),"spot_brightness"in a&&(c.spot_brightness=a.spot_brightness),"scatter_strength"in a&&(c.scatter_strength=a.scatter_strength),"rayleigh_strength"in a&&(c.rayleigh_strength=a.rayleigh_strength),"mie_strength"in
a&&(c.mie_strength=a.mie_strength),"rayleigh_collection_power"in a&&(c.rayleigh_collection_power=a.rayleigh_collection_power),"mie_collection_power"in a&&(c.mie_collection_power=a.mie_collection_power),"mie_distribution"in a&&(c.mie_distribution=a.mie_distribution),c.Ka=!0,c.Jo=!0,d.fW(b,c))}else g.error("No active scene")};a.get_dof_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.Pb(a,p.Tp)?d.get_dof_params(a):null};a.set_dof_params=function(a){if(d.La()){var b=
d.get_active();d.set_dof_params(b,a)}else g.error("No active scene")};a.get_god_rays_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.Pb(a,p.Bn)?d.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(d.La()){var b=d.get_active();d.set_god_rays_params(b,a)}else g.error("No active scene")};a.get_bloom_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.Pb(a,p.Pp)?d.get_bloom_params(a):null};a.set_bloom_params=
function(a){if(d.La()){var b=d.get_active();d.set_bloom_params(b,a)}else g.error("No active scene")};a.get_glow_material_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.Pb(a,p.Up)?d.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(d.La()){var b=d.get_active();d.set_glow_material_params(b,a)}else g.error("No active scene")};a.get_wind_params=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.get_wind_params(a)};
a.set_wind_params=function(a){if(d.La()){var b=d.get_active();u.set_wind_params(b,a)}else g.error("No active scene")};a.get_water_surface_level=function(a,b){if(!d.La())return g.error("No active scene"),0;var c=d.get_active();return c.J.sd?d.get_water_surface_level(c,a,b):(g.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(d.La()){var b=d.get_active();d.set_water_params(b,a)}else g.error("No active scene")};a.get_water_mat_params=function(a){if(d.La()){var b=
d.get_active();d.get_water_mat_params(b,a)}else g.error("No active scene")};a.update_scene_materials_params=function(){if(d.La()){var a=d.get_active();d.pJ(a)}else g.error("No active scene")};a.hide_object=function(a,b){b=b||!1;c(a)?b?d.$l(a,!0):d.zq(a,!0):g.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,b){b=b||!1;c(a)?b?d.$l(a,!1):d.zq(a,!1):g.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(c(a))return d.is_hidden(a);g.error("show/hide is only supported for dynamic meshes/empties and lamps");
return!1};a.is_visible=function(a){return a.v.is_visible};a.check_object_by_name=function(a,b){return u.uc(u.zy,a,b|0,!0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return u.uc(u.yy,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return u.uc(u.Ic,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=d.get_active();a||(a="ALL");b||0===b||(b=u.DATA_ID_ALL);return u.QF(c,a,b)};a.get_object_name=function(a){return a?a.Ed:(g.error("Wrong object name"),"")};a.get_object_name_hierarchy=
function(a){if(!a)return g.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Ed),a=y.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(g.error("Wrong object"),"UNDEFINED")};a.get_object_children=function(a){return a.ue.slice(0)};a.get_first_character=function(){return u.get_first_character(d.get_active())};a.get_shore_dist=function(a,b){b||0===b||(b=1);if(!d.La())return g.error("No active scene"),0;var c=d.get_active();return d.get_shore_dist(c,a,b)};
a.get_cam_water_depth=function(){return d.get_cam_water_depth()};a.get_type_mesh_object=function(a){return y.is_mesh(a)?a.v.type:""};a.get_meta_tags=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.get_meta_tags(a)};a.get_custom_prop=function(){if(!d.La())return g.error("No active scene"),!1;var a=d.get_active();return d.get_custom_prop(a)};a.append_object=function(a,b){if(b)var c=d.lr(),c=M.keysearch("name",b,c);else c=d.get_active();d.append_object(c,a,!0)};
a.remove_object=function(a){y.mb(a)||y.is_empty(a)||y.is_line(a)?(u.Ro(a,a.v.Fv,!1,!1),q.yH(a),u.Ro(a,!0,!0,!0),u.remove_object(a)):g.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=d.get_active();if(b.timeline_markers&&a in b.timeline_markers)return d.marker_frame(b,a);g.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=d.get_active();return(a=d.Pb(a,p.bi))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:
null};a.set_mb_params=function(a){var b=d.get_active(),b=d.xg(b,[p.bi]);if(b.length)for(var c=0;c<b.length;c++){var e=b[c];"number"==typeof a.mb_decay_threshold&&(e.mb_decay_threshold=a.mb_decay_threshold);"number"==typeof a.mb_factor&&(e.mb_factor=a.mb_factor)}else g.error("The motion blur subscene doesn't exist.")};a.can_select_objects=function(){var a=d.get_active();return!!d.Pb(a,p.Ne)}};b4w.module.screen=function(a,t){function e(){}function c(){}function b(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullscreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}a=a||h.get_container();
b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.zB=a.zB||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.zB?a.zB():p.error("B4W App: request fullscreen method is not supported")}function f(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||
document.msExitFullscreen;"function"!=typeof a&&p.error("B4W App: exit fullscreen method is not supported");a.apply(document)}function k(a){var b=g.get_device_by_type_element(g.DEVICE_HMD);if(b&&!B){var c=g.get_value_param(b,g.HMD_WEBVR_TYPE);if(c&g.HMD_WEBVR1_1){var d=b.td,e=d.getEyeParameters("left"),d=d.getEyeParameters("right");h.resize(2*Math.max(e.renderWidth,d.renderWidth),Math.max(e.renderHeight,d.renderHeight),!1)}else e=h.get_canvas(),e=Math.max(2*e.height,e.width),h.resize(e,e/2,!1);e=
g.get_vector_param(b,g.PC,z);d=g.get_vector_param(b,g.QC,l);q.set_hmd_fov(a,e,d,!(c&g.HMD_WEBVR1_1));e={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};c&(g.HMD_NON_WEBVR|g.HMD_WEBVR_MOBILE|g.HMD_WEBVR_DESKTOP)&&(e.distortion_coefs=[b.distortion_coefs[0],b.distortion_coefs[1]],e.chromatic_aberration_coefs=[b.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]],b.xn||(b.di&&b.yi&&b.ei?e.base_line_factor=(b.di-
b.ei)/b.yi:b.ei||(e.base_line_factor=b.di/b.yi)),b.Gh&&b.Hl&&!b.xn&&(e.inter_lens_factor=b.Gh/b.Hl));w.enabled||M.mw(.5,1);M.set_hmd_params(e);if(b=g.get_value_param(b,g.HMD_EYE_DISTANCE))c=M.get_active(),a=r.Da(a,c).ha,q.set_eye_distance(a,b);M.CT();B=!0}}var q=t("__camera"),h=t("__container"),u=t("__config"),y=t("__hud"),g=t("__input"),d=t("__main"),r=t("__obj_util"),p=t("__print"),M=t("__scenes"),E=t("__vec4"),z=E.create(),l=E.create(),B=!1,w=u.im;a.draw_mixer_strip=y.draw_mixer_strip;a.plot_array=
y.plot_array;a.request_fullscreen=b;a.exit_fullscreen=f;a.check_fullscreen=g.check_fullscreen;a.request_fullscreen_hmd=function(a,c,d){if("HMD"!=!u.get("stereo")||"NONE"==u.get("stereo")&&u.get("is_mobile_device")){var f=g.get_device_by_type_element(g.DEVICE_HMD);if(f&&g.get_value_param(f,g.HMD_WEBVR_TYPE)&g.HMD_WEBVR1){var k=f.td;k&&!k.isPresenting&&(c=c||function(){},d=d||function(){},e=function(){k.isPresenting?c():(window.removeEventListener("vrdisplaypresentchange",e),d())},window.addEventListener("vrdisplaypresentchange",
e,!1),k.capabilities.canPresent?(a=h.get_canvas(),k.requestPresent([{source:a}]).then(function(){},function(){p.error("HMD fullscreen request failed.")})):p.error("HMD fullscreen request failed."))}else b(a,c,d)}};a.exit_fullscreen_hmd=function(){if("HMD"!=!u.get("stereo")||"NONE"==u.get("stereo")&&u.get("is_mobile_device")){var a=g.get_device_by_type_element(g.DEVICE_HMD);a&&g.get_value_param(a,g.HMD_WEBVR_TYPE)&g.HMD_WEBVR1?(a=a.td)&&a.isPresenting&&(a.exitPresent(),h.resize_to_container(!0)):f()}};
a.check_fullscreen_hmd=function(){var a=g.get_device_by_type_element(g.DEVICE_HMD),b=g.get_value_param(a,g.HMD_WEBVR_TYPE)&g.HMD_WEBVR1;return a&&(b&&a.td||!b&&g.check_fullscreen())?!0:!1};a.request_split_screen=function(a,b){var d=g.get_device_by_type_element(g.DEVICE_HMD);if(!d)return!1;if(B)return!0;c=b;if(M.La()){var e=M.Jk(M.get_active());e&&(d.tg?(k(e),a&&a()):(g.NT(d),d.gs=function(){k(e);a&&a()}))}};a.exit_split_screen=function(){var a=g.get_device_by_type_element(g.DEVICE_HMD);if(!B||!a||
!a.tg)return!1;M.set_hmd_params({enable_hmd_stereo:!1});B=!1;c&&c();M.DT();w.enabled||M.mw(2,1);h.resize_to_container(!0);return!0};a.shot=function(a,b){a=a||"image/png";d.canvas_data_url(function(b){var c=window.document.createElement("a");document.body.appendChild(c);c.style.display="none";c.href=b;c.download="screenshot."+a.split("/")[1];c.click();document.body.removeChild(c)},a,b||1,!0)}};b4w.module.sfx=function(a,t){var e=t("__obj_util"),c=t("__scenes"),b=t("__sfx"),f=t("__print");a.play=function(a,c,e){b.play(a,c||0,e||0)};a.play_def=function(a){b.play_def(a)};a.is_playing=function(a){return b.is_playing(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.WU(a)};a.resume=function(a){b.YU(a)};a.loop_stop=function(a,c,e){b.loop_stop(a,c||0,e||!1)};a.playrate=function(a,c){b.playrate(a,c)};a.get_playrate=function(a){return b.get_playrate(a)};a.cyclic=function(a,c){b.cyclic(a,c)};
a.is_cyclic=function(a){return b.is_cyclic(a)};a.listener_reset_speed=function(){b.listener_stride()};a.listener_stride=function(){b.listener_stride()};a.speaker_reset_speed=function(a){b.speaker_stride(a)};a.speaker_stride=function(a){b.speaker_stride(a)};a.get_volume=function(a){return a&&"object"===typeof a?b.get_volume(a):b.ZQ()};a.set_volume=function(a,c){a&&"object"===typeof a?b.set_volume(a,c):b.wU(c)};a.mute=function(a,c){a&&"object"===typeof a?b.mute(a,c):b.NS(c)};a.is_muted=function(a){return a&&
"object"===typeof a?b.is_muted(a):b.PR()};a.get_speaker_objects=function(){return b.get_speaker_objects().slice(0)};a.check_active_speakers=b.check_active_speakers;a.set_compressor_params=function(a){b.set_compressor_params(c.get_active(),a)};a.get_compressor_params=function(){return b.get_compressor_params(c.get_active())};a.duck=function(a,c,e){a&&"object"===typeof a?b.duck(a,c,e):b.zP(c,e)};a.unduck=function(a){a&&"object"===typeof a?b.unduck(a):b.xV()};a.apply_playlist=b.apply_playlist;a.clear_playlist=
b.clear_playlist;a.detect_audio_container=b.detect_audio_container;a.detect_video_container=b.detect_video_container;a.set_positional_params=b.set_positional_params;a.get_positional_params=b.get_positional_params;a.set_filter_params=b.set_filter_params;a.get_filter_params=b.get_filter_params;a.get_filter_freq_response=b.get_filter_freq_response;a.get_duration=function(a){return a&&e.is_speaker(a)?b.get_duration(a):(f.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker'),0)}};b4w.module.textures=function(a,t){var e=t("__print"),c=t("__scenes"),b=t("__textures"),f=t("__obj_util"),k=t("__util"),q=t("__assets");a.play_video=function(a,f){f||(f=0);var h=b.dA(a,f);h?c.get_active().b4w_use_nla&&b.DC(h)?e.error("NLA texture can't be controlled directly through API."):b.play_video(h):e.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,f){f||(f=0);var h=b.dA(a,f);h?c.get_active().b4w_use_nla&&b.DC(h)?e.error("NLA texture can't be controlled directly through API."):
b.pause_video(h):e.error('Texture with name "'+a+'" not found!')};a.reset_video=function(a,f){f||(f=0);var h=b.dA(a,f);h?c.get_active().b4w_use_nla&&b.DC(h)?e.error("NLA texture can't be controlled directly through API."):b.reset_video(h):e.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,c){if(f.is_mesh(a)){var h=b.CQ(a,c);if(h)return h;e.error("Couldn't find canvas texture with this name: "+c)}else e.error("Object must be type of mesh.");return null};a.update_canvas_ctx=
function(a,c){if(!f.is_mesh(a))return e.error("Object must be type of mesh."),!1;var h=b.iv(a,c);if(!h||"CANVAS"!=h.source)return e.error("Couldn't find canvas texture \""+c+'" in object "'+a.name+'".'),!1;b.iW(h);return!0};a.change_image=function(a,c,f,g){e.Bd("change_image","replace_image");g=g||function(){};var d=b.iv(a,c);if(d)if(d.Ci)e.error("Changing video textures is forbidden."),g(!1);else{var h=k.Ji(f);d.Mk==h?g(!0):q.enqueue([{id:f,type:q.AT_IMAGE_ELEMENT,url:f,request_method:"GET"}],function(e){e?
(b.change_image(a,d,c,e,f),g(!0)):g(!1)},null,null)}else e.error("Couldn't find texture \""+c+'" in object "'+a.name+'".'),g(!1)};a.replace_image=function(a,c,f,g){g=g||function(){};var d=b.iv(a,c);d?d.Ci?(e.error("Changing video textures is forbidden."),g(!1)):"src"in f?b.change_image(a,d,c,f,f.src):(e.error("Incorrect image."),g(!1)):(e.error("Couldn't find texture \""+c+'" in object "'+a.name+'".'),g(!1))};a.get_texture_names=function(a){if(f.is_mesh(a))return b.get_texture_names(a);e.error("Object must be type of mesh.");
return[]}};b4w.module.time=function(a,t){var e=t("__time");a.set_timeout=e.set_timeout;a.clear_timeout=e.clear_timeout;a.get_timeline=e.get_timeline;a.animate=e.animate;a.clear_animation=e.clear_animation};b4w.module.transform=function(a,t){var e=t("__boundings"),c=t("__obj_util"),b=t("__physics"),f=t("__print"),k=t("__quat"),q=t("__transform"),h=t("__tsr"),u=t("__util"),y=h.create(),g=new Float32Array(3),d=new Float32Array(4);a.set_translation=function(a,d,e,h){c.is_dynamic(a)?(g[0]=d,g[1]=e,g[2]=h,q.set_translation(a,g),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,d,e,h){c.is_dynamic(a)?(g[0]=d,g[1]=e,g[2]=h,q.set_translation_rel(a,
g),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,d){c.is_dynamic(a)?(q.set_translation(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,d){c.is_dynamic(a)?(q.set_translation_rel(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,d,e,k,t){c.is_dynamic(a)?(g[0]=d,g[1]=e,g[2]=k,d=h.get_trans_view(t.v.C),
t=h.get_quat_view(t.v.C),u.transform_vec3(g,1,t,d,g),q.set_translation(a,g),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));q.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));q.get_translation_rel(a,b);return b};a.set_rotation=function(a,e,g,h,k){c.is_dynamic(a)?(d[0]=e,d[1]=g,d[2]=h,d[3]=k,q.set_rotation(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_rotation_rel=function(a,e,g,h,k){c.is_dynamic(a)?(d[0]=e,d[1]=g,d[2]=h,d[3]=k,q.set_rotation_rel(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,d){c.is_dynamic(a)?(q.set_rotation(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,d){c.is_dynamic(a)?(q.set_rotation_rel(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.get_rotation_rel_v=function(a,b){if(c.is_dynamic(a))return q.get_rotation_rel(a,b),b;f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation=function(a,b){b||(b=new Float32Array(4));q.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));q.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,d,e,h){c.is_dynamic(a)?(g[0]=d,g[1]=e,g[2]=h,q.set_rotation_euler(a,g),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.get_rotation_euler=function(a,b){b||(b=new Float32Array(3));q.get_rotation_euler(a,b);return b};a.get_rotation_euler_rel=function(a,b){b||(b=new Float32Array(3));q.get_rotation_euler_rel(a,b);return b};a.set_rotation_euler_rel=function(a,d,e,h){c.is_dynamic(a)?(g[0]=d,g[1]=e,g[2]=h,q.set_rotation_euler_rel(a,g),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,d){c.is_dynamic(a)?(q.set_rotation_euler(a,
d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=function(a,d){c.is_dynamic(a)?(q.set_rotation_euler_rel(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,b){c.is_dynamic(a)?(q.set_scale(a,b),q.T(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,b){c.is_dynamic(a)?(q.set_scale_rel(a,b),q.T(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.get_scale=function(a){return q.get_scale(a)};a.get_scale_rel=function(a){return q.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)f.error("Wrong object: "+a.name);else{for(var d=0;d<a.ue.length;d++)if(!c.is_dynamic(a.ue[d])){f.error('Wrong object: "'+a.ue[d].name+'" is not dynamic.');return}q.set_translation(a,[0,0,0]);q.set_rotation(a,[0,0,0,1]);q.set_scale(a,1);q.T(a);b.sync_transform(a)}};a.get_object_size=function(a){return c.is_mesh(a)?q.get_object_size(a):(f.error("Wrong object: "+
a.name),0)};a.get_object_center=function(a,b,d){if(!c.is_mesh(a))return f.error("Wrong object: "+a.name),null;d||(d=new Float32Array(3));return q.get_object_center(a,b,d)};a.move_local=function(a,d,e,g){c.is_dynamic(a)?(q.move_local(a,d,e,g),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,e){if(c.is_dynamic(a)){var g=k.setAxisAngle(u.AXIS_X,e,d);q.EB(a,g);q.T(a);b.sync_transform(a)}else f.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.rotate_y_local=function(a,e){if(c.is_dynamic(a)){var g=k.setAxisAngle(u.AXIS_MY,e,d);q.EB(a,g);q.T(a);b.sync_transform(a)}else f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_z_local=function(a,e){if(c.is_dynamic(a)){var g=k.setAxisAngle(u.AXIS_Z,e,d);q.EB(a,g);q.T(a);b.sync_transform(a)}else f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return e.Vt(a.v.uh)};a.set_tsr=function(a,d){c.is_dynamic(a)?(q.set_tsr(a,d),q.T(a),b.sync_transform(a)):
f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,d){c.is_dynamic(a)?(q.set_tsr_rel(a,d),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));q.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));q.get_tsr_rel(a,b);return b};a.distance=function(a,b){return q.distance(a,b)};a.set_matrix=function(a,d){c.is_dynamic(a)?(h.from_mat4(d,y),q.set_tsr(a,y),q.T(a),b.sync_transform(a)):
f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_matrix_rel=function(a,d){c.is_dynamic(a)?(h.from_mat4(d,y),q.set_tsr_rel(a,y),q.T(a),b.sync_transform(a)):f.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));q.get_tsr(a,y);h.to_mat4(y,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));q.get_tsr_rel(a,y);h.to_mat4(y,b);return b}};b4w.module.tsr=function(a,t){var e=t("__mat4"),c=t("__tsr");a.create=c.create;a.from_values=c.from_values;a.copy=c.copy;a.identity=c.identity;a.set_sep=c.set_sep;a.set_trans=c.set_trans;a.set_scale=c.set_scale;a.set_transcale=c.set_transcale;a.set_quat=c.set_quat;a.get_trans_view=c.get_trans_view;a.get_scale=c.get_scale;a.get_quat_view=c.get_quat_view;a.invert=c.invert;a.to_mat4=function(a,f){f||(f=e.create());c.to_mat4(a,f);return f};a.from_mat4=c.from_mat4;a.multiply=c.multiply;a.transform_vec3=
c.transform_vec3;a.transform_vec3_inv=c.transform_vec3_inv;a.transform_vectors=c.transform_vectors;a.transform_dir_vectors=c.transform_dir_vectors;a.transform_dir_vec3=c.transform_dir_vec3;a.transform_tangents=c.transform_tangents;a.translate=c.translate;a.interpolate=function(a,e,k,q){q||(q=c.create());c.interpolate(a,e,k,q);return q}};b4w.module.util=function(a,t){var e=t("__compat"),c=t("__print"),b=t("__quat"),f=t("__tbn"),k=t("__util"),q=t("__vec3");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=k.XYX;a.YZY=k.YZY;a.ZXZ=k.ZXZ;a.XZX=k.XZX;a.YXY=k.YXY;a.ZYZ=k.ZYZ;a.XYZ=k.XYZ;a.YZX=k.YZX;a.ZXY=k.ZXY;a.XZY=k.XZY;a.YXZ=k.YXZ;a.ZYX=k.ZYX;a.f32=function(a){return k.f32(a||
0)};a.assert=k.assert;a.keyfind=k.keyfind;a.keysearch=k.keysearch;a.matrix_to_quat=function(a){return k.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return k.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,c,e){e||(e=b.create());return k.ordered_angles_to_quat(a,c,e)};a.quat_to_ordered_angles=function(a,b,c){c||(c=q.create());return k.quat_to_ordered_angles(a,b,c)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return k.quat_to_euler(a,b)};a.sign=k.sign;
a.clamp=k.clamp;a.quat_to_dir=k.quat_to_dir;a.ground_project_cam_quat=function(a,b){return k.quat_project(a,k.AXIS_MZ,k.AXIS_Z,k.AXIS_Y,b)};a.cam_quat_to_mesh_quat=function(a,b){return k.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,b,e,f,d){return 0!=q.dot(e,f)?(c.error("Wrong in-plane direction"),null):k.quat_project(a,b,e,f,d)};a.hash_code=k.hash_code;a.smooth=k.smooth;a.smooth_v=k.smooth_v;a.is_vector=k.is_vector;a.correct_cam_quat_up=k.correct_cam_quat_up;a.quat_to_angle_axis=k.quat_to_angle_axis;
a.random_from_array=k.random_from_array;a.horizontal_direction=k.horizontal_direction;a.angle_wrap_0_2pi=k.angle_wrap_0_2pi;a.angle_wrap_periodic=k.angle_wrap_periodic;a.smooth_step=k.smooth_step;a.lerp=k.lerp;a.deg_to_rad=k.deg_to_rad;a.rad_to_deg=k.rad_to_deg;a.dir_to_quat=k.dir_to_quat;a.is_ie11=e.is_ie11;a.gen_tbn_quats=f.get;a.trunc=k.trunc};b4w.module.version=function(a,t){var e=t("__version");a.version=e.version;a.version_str=e.version_str;a.type=e.type;a.date=e.date;a.date_str=e.date_str;a.get_build_version=e.get_build_version};b4w.module.objects=function(a,t){var e=t("__geometry"),c=t("__objects"),b=t("__batch"),f=t("__obj_util"),k=t("__print"),q=t("__scenes"),h=t("__util");a.get_meta_tags=function(a){if(a)return c.get_meta_tags(a)};a.get_custom_prop=function(a){if(a)return c.get_custom_prop(a)};a.copy=function(a,b,g){return f.is_mesh(a)?f.is_dynamic(a)?e.Cj(a)||e.check_shape_keys(a)||!g?-1==c.Ob(q.get_active(),"MESH",c.DATA_ID_ALL).indexOf(a)?(k.error('object "'+a.name+'" does not belong to the active scene.'),!1):c.copy(a,
b||"",g):(k.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),!1):(k.error('object "'+a.name+'" is not dynamic.'),!1):(k.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,e,g){k.Bd("set_nodemat_value","material.set_nodemat_value");if(f.mb(a)){var d=e[0],h=b.ab(a,d,"MAIN");if(null===h)return k.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;h=c.or(h.Ff,e,1);if(null===h)return k.error('Value node "'+e[e.length-1]+'" was not found in the object "'+
a.name+'".'),null;c.set_nodemat_value(a,d,h,g)}else k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,e){k.Bd("get_nodemat_value","material.get_nodemat_value");if(!f.mb(a))return k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),0;var g=e[0],d=b.ab(a,g,"MAIN");if(null===d)return k.error('Material "'+g+'" was not found in the object "'+a.name+'".'),0;g=c.or(d.Ff,e,1);return null===g?(k.error('Value node "'+
e[e.length-1]+'" was not found in the object "'+a.name+'".'),0):c.get_nodemat_value(d,g)};a.set_nodemat_rgb=function(a,e,g,d,h){k.Bd("set_nodemat_rgb","material.set_nodemat_rgb");if(f.mb(a)){var p=e[0],q=b.ab(a,p,"MAIN");null===q?k.error('Material "'+p+'" was not found in the object "'+a.name+'".'):(q=c.nr(q.Ef,e,1),null===q?k.error('RGB node "'+e[e.length-1]+'" was not found in the object "'+a.name+'".'):c.set_nodemat_rgb(a,p,q,g,d,h))}else k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};
a.get_nodemat_rgb=function(a,e,g){k.Bd("get_nodemat_rgb","material.get_nodemat_rgb");if(!f.mb(a))return k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var d=e[0],h=b.ab(a,d,"MAIN");if(null===h)return k.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;d=c.nr(h.Ef,e);if(null===d)return k.error('RGB node "'+e[e.length-1]+'" was not found in the object "'+a.name+'".'),null;g||(g=new Float32Array(3));return c.get_nodemat_rgb(h,d,g)};a.update_boundings=
function(a){f.is_mesh(a)?e.Cj(a)||e.check_shape_keys(a)?c.update_boundings(a):k.error('object "'+a.name+'" has not dynamic geometry.'):k.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=f.get_parent;a.get_dg_parent=f.get_dg_parent;a.is_mesh=f.is_mesh;a.is_armature=f.is_armature;a.is_speaker=f.is_speaker;a.is_camera=f.is_camera;a.is_lamp=f.is_lamp;a.is_empty=f.is_empty;a.is_line=f.is_line;a.is_world=f.is_world;a.get_selectable_objects=function(){return c.get_selectable_objects()};
a.get_outlining_objects=function(){return c.get_outlining_objects()};a.is_dynamic=f.is_dynamic;a.set_wind_bending_params=function(a,e){if(f.mb(a)){var g=a.v;if(g.Me){if("number"==typeof e.angle){var d=b.TJ(h.deg_to_rad(e.angle),g.ij,g.C[3]);g.Rf=d}"number"==typeof e.main_frequency&&(g.Sf=e.main_frequency);"number"==typeof e.detail_frequency&&(g.xf=e.detail_frequency);"number"==typeof e.detail_amplitude&&(g.wf=e.detail_amplitude);"number"==typeof e.branch_amplitude&&(g.qf=e.branch_amplitude);c.qU(a)}else k.error('The "'+
a.name+"\" object doesn't have wind bending parameters.")}else k.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_wind_bending_params=function(a){a=a.v;if(!a.Me)return null;var c={},e=h.rad_to_deg(b.HW(a.Rf,a.ij,a.C[3]));c.angle=e;c.main_frequency=a.Sf;c.detail_frequency=a.xf;c.detail_amplitude=a.wf;c.branch_amplitude=a.qf;return c};a.create_line=function(a){return c.create_line(a)};a.hide_all_by_data_id=function(a){a=c.get_all_objects("ALL",a);for(var b=0;b<
a.length;b++)q.$l(a[b],!0)};a.show_all_by_data_id=function(a){a=c.get_all_objects("ALL",a);for(var b=0;b<a.length;b++)q.$l(a[b],!1)}};b4w.module.main=function(a,t){function e(){}function c(){}function b(){}function f(){window.performance||(C.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(C.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});V.lI(0)}function k(a,b){for(var c=null,d=b?ca:Ca,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,ea)}catch(pa){}if(c)break}c&&z.rP(c);return c}function q(a,b,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();C.error("WebGL context lost");u()},!1);v.ug(e);var f=v.get_renderer_info();f&&C.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));R.ug(e);D.ug(e);O.ug(e);U.ug(e);l.ug(e);G.ug(e);w.KU(a);l.init(a,b);m.nI(a.width,a.height,1);H.init();F.init();c=d();g()}function h(){e=function(){}}function u(){y()||(aa=performance.now()/1E3,H.pause(),A.pause(),O.pause(),r.pause())}function y(){return X<aa}function g(){var a=
"HMD"===qa.stereo&&F.jR();a?a.requestAnimationFrame(g):za(g);var b=performance.now()/1E3;Z||(Z=b);var d=b-Z;if(!(d<1/qa.max_fps)){for(var f=V.get_timeline(),h=0;h<fa.length;h++)fa[h](f,d);y()||(X>Z&&(d-=X-Math.max(aa,Z)),V.lU(d),f+=d,V.lI(f),G.update(),M.update(),w.update(),h=d,w.is_primary_loaded()&&(n.reset(),ia.update(h),x.update(f,h),N.update(f,h),H.update(f,h),h&&p.update(h),w.is_primary_loaded()&&(A.update(f,h),w.is_primary_loaded()&&(F.update(f),B.update(f,h),w.is_primary_loaded()&&(r.update(!1),
J.update(f,h),ja.update(),e(h,f),w.is_primary_loaded()&&(m.update(f,h),r.sJ(),I.frame()))))),c(d));Z=b;a&&a.isPresenting&&a.submitFrame()}}function d(){var a=60,c=0,d=qa.sF,e=qa.aQ;return function(f){f<1/qa.max_fps||(a=na.smooth(1/f,a,f,d),f=A.RQ(),(c=(c+1)%e)||b(Math.round(a),f))}}var r=t("__anchors"),p=t("__animation"),M=t("__assets"),E=t("__config"),z=t("__compat"),l=t("__container"),B=t("__controls"),w=t("__data"),G=t("__debug"),v=t("__extensions"),D=t("__geometry"),F=t("__input"),n=t("__hud"),
N=t("__nla"),I=t("__main"),x=t("__logic_nodes"),J=t("__objects"),A=t("__physics"),C=t("__print"),R=t("__renderer"),m=t("__scenes"),H=t("__sfx"),U=t("__shaders"),O=t("__textures"),V=t("__time"),ia=t("__transform"),na=t("__util"),T=t("__version"),ja=t("__particles"),ea=E.context,qa=E.K,Z=0,aa=0,X=0,fa=[],Ca=["webgl","experimental-webgl"],ca=["webgl2","experimental-webgl2"],Y=null,za=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/qa.max_fps)}}();a.init=function(a,b){C.HU(qa.console_verbose);var c=T.version_str()+" "+T.type()+" ("+T.date_str()+")";C.log("%cINIT ENGINE","color: #00a",c);C.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;f();b?n.init(b):(E.K.show_hud_debug_info=!1,E.ea.hw=!1);z.FM();z.hz("Chrome")||z.hz("Firefox")||(qa.Hb=!1);c=k(a,qa.Hb);!c&&qa.Hb&&(qa.Hb=
!1,c=k(a,!1));if(!c)return null;C.log("%cINIT WEBGL "+(qa.Hb?"2":"1"),"color: #00a");Y=c;q(a,b,c);E.apply_quality();z.fI(c,!0);E.xU();U.oS();qa.zv&&(a.style["touch-action"]="none");C.log("%cSET PRECISION:","color: #00a",qa.precision);return c};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){e=a};a.clear_render_callback=function(){h()};a.pause=u;a.resume=function(){y()&&(X=performance.now()/1E3,H.resume(),A.resume(),O.play(!0),r.resume())};
a.is_paused=y;a.reset=function(){w.unload(0);w.reset();v.reset();R.reset();D.reset();O.OT();U.reset();G.reset();l.reset();w.reset();l.reset();V.reset();H.reset();X=aa=Z=0;b=function(){};c=function(){};e=function(){};fa.length=0;Y=null};a.canvas_data_url=function(a,b,c,d){I.canvas_data_url(a,b,c,d)};a.detect_mobile=function(){return z.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<fa.length;b++)if(fa[b]==a)return;fa.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<fa.length;b++)if(fa[b]==
a){fa.splice(b,1);break}};a.get_renderer_info=function(){var a=v.get_renderer_info();return a?{vendor:Y.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:Y.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.nla=function(a,t){var e=t("__nla"),c=t("__time"),b=t("__print"),f=t("__util");a.set_frame=function(a){a=f.clamp(a,e.get_frame_start(),e.get_frame_end());e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):e.set_frame(a,c.get_timeline())};a.get_frame=function(){return e.get_frame(c.get_timeline())};a.stop=function(){e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):e.$B()};a.play=function(a){e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):
e.xH(a)};a.is_play=function(){return e.is_play()};a.get_frame_start=function(){return e.get_frame_start()};a.get_frame_end=function(){return e.get_frame_end()};a.check_nla=function(){return e.check_nla()};a.check_logic_nodes=function(){return e.check_logic_nodes()};a.set_range=function(a,c){e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):(c=parseFloat(c)||e.get_frame_end(),a=parseFloat(a)||e.get_frame_end(),c=f.clamp(c,e.get_frame_start(),e.get_frame_end()),a=f.clamp(a,
e.get_frame_start(),c),e.set_range(a,c))};a.reset_range=function(){e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):e.reset_range()};a.set_cyclic=function(a){e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):e.set_cyclic(a)};a.clear_callback=function(){e.check_logic_nodes()?b.error("The active scene is using the Logic Editor."):e.clear_callback()}};b4w.module.app=function(a,t){function e(){var a=I.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=I.is_paused(),I.pause()):a||I.resume()},!1)}function c(){var a=0,b=v.get_container(),c=I.is_paused(),d=!0;I.append_loop_cb(function(){if(!(a%10)){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=I.is_paused()),I.pause(),d=!1):c||d||(I.resume(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);
f||(J.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!I.init(e,a))return c&&z("Browser could not initialize WebGL",
"For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",d),!1;a&&v.insert_to_container(a,"LAST");return!0}function f(a,b){a?(b&&(document.getElementById(b).style.display="block"),O=document.getElementById(a)):(O=document.createElement("div"),O.innerHTML=0,O.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",v.insert_to_container(O,
"JUST_AFTER_CANVAS"))}function k(a,b){var c=String(a);b&&(c+="/"+String(b));O.innerHTML=c}function q(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function h(a,b,c){var d=Math.max(B.hover_get_distance(a),1),e=R.get_rotation(a,fa);b=m.quat_to_dir(e,b,aa);b[2]=0;H.normalize(b,b);H.scale(b,d*c,b);c=R.get_translation(a,X);H.add(c,b,c);B.set_translation(a,c)}function u(a,b){var c=B.hover_get_vertical_limits(a,ca);if(c.up!=c.down){var d=B.get_camera_angles(a,
Z)[1],c=(c.down-d)/(c.down-c.up),d=B.hover_get_distance_limits(a,ca),c=Math.max(c,2/d.max);B.rotate_camera(a,0,c*b)}}function y(a,b,c,d){R.move_local(a,5*b,5*c,5*d)}function g(a,b,c){var d=B.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));R.move_local(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function d(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function r(a,b,c,e,f){f?(f=B.target_get_pivot(a,aa),a=B.get_translation(a),a=H.dist(f,a)+e,e=0<b?d(b,-c,a,e):d(-b,c/(1-c),
a,e)):e-=2*b*c;return e}function p(a,b,c,d,e,f){function k(a,b,c,d){if(1==c){B.get_velocities(a,F);var e=J?.003*F.trans:.003*F.rot;c=D.get_sensor_value(a,b,0);D.get_sensor_payload(a,b,0).gesture===D.PL_SINGLE_TOUCH_MOVE?(Ra+="X"==d?-c*e:0,Ob+="Y"==d?-c*e:0):D.get_sensor_payload(a,b,0).gesture===D.PL_MULTITOUCH_MOVE_PAN&&(a=J?.003*F.rot:7.5E-4*F.trans,Ib+="X"==d?-c*a:0,Ua+="Y"==d?-c*a:0)}}function l(a,b,c,d){if(1==c){c=D.get_sensor_value(a,b,1);B.get_velocities(a,F);if(J)e=.003*F.trans,f=7.5E-4*F.rot;
else var e=.003*F.rot,f=7.5E-4*F.trans;if(1===D.get_sensor_payload(a,b,0).which)ua+="X"==d?-c*e:0,Fa+="Y"==d?-c*e:0;else if(2===D.get_sensor_payload(a,b,0).which||3===D.get_sensor_payload(a,b,0).which)ra+="X"==d?-c*f:0,S+="Y"==d?-c*f:0}}function n(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function p(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function q(a){return a[0]&&(a[1]||-.1>a[2])}function v(a){return a[0]&&(a[1]||.1<a[2])}function t(a){return a[0]&&(a[1]||a[2]||a[3])}function w(a,b,c){if(1==c)switch(c=
D.get_sensor_value(a,b,0),B.get_velocities(a,F),b){case "FORWARD":E?P[0]=1:J?(b=B.get_camera_angles(a,Z)[1],b=Math.abs(b)>=Math.PI/4?m.AXIS_Y:m.AXIS_MZ,h(a,b,.5*F.trans*c)):z?g(a,-F.zoom,c):y(a,0,0,-F.trans*c);break;case "BACKWARD":E?P[0]=-1:J?(b=B.get_camera_angles(a,Z)[1],b=Math.abs(b)>=Math.PI/4?m.AXIS_MY:m.AXIS_Z,h(a,b,.5*F.trans*c)):z?g(a,F.zoom,c):y(a,0,0,F.trans*c);break;case "UP":J?u(a,30*-F.zoom*c):E||y(a,0,F.trans*c,0);break;case "DOWN":J?u(a,30*F.zoom*c):E||y(a,0,-F.trans*c,0);break;case "LEFT":E?
P[1]=1:J?h(a,m.AXIS_MX,.5*F.trans*c):y(a,-F.trans*c,0,0);break;case "RIGHT":E?P[1]=-1:J?h(a,m.AXIS_X,.5*F.trans*c):y(a,F.trans*c,0,0);break;case "ROT_LEFT":z?B.rotate_camera(a,.75*-F.rot*c,0):B.rotate_camera(a,.75*F.rot*c,0);break;case "ROT_RIGHT":z?B.rotate_camera(a,.75*F.rot*c,0):B.rotate_camera(a,.75*-F.rot*c,0);break;case "ROT_UP":z?B.rotate_camera(a,0,.75*-F.rot*c):B.rotate_camera(a,0,.75*F.rot*c);break;case "ROT_DOWN":z?B.rotate_camera(a,0,.75*F.rot*c):B.rotate_camera(a,0,.75*-F.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":E&&
(P[0]=0);break;case "LEFT":case "RIGHT":E&&(P[1]=0)}E&&(x.set_character_move_dir(E,P[0],P[1]),a=B.get_camera_angles_char(a,qa),x.set_character_rotation(E,a[0],a[1]))}V=a;ia=b;na=c;T=d;ja=e;ea=f;var A=C.get_active_camera();M(A);var z=!1,E=null,J=!1;switch(B.get_move_style(A)){case B.MS_TARGET_CONTROLS:z=!a;break;case B.MS_EYE_CONTROLS:E=C.get_first_character();break;case B.MS_STATIC:return;case B.MS_HOVER_CONTROLS:J=!0}var F=B.get_velocities(A,Ca);a=D.create_elapsed_sensor();if(x.has_simulated_physics(A)){var O=
D.create_collision_sensor(A,null,!0);D.create_sensor_manifold(A,"CAMERA_COLLISION",D.CT_POSITIVE,[O],null,function(a,b){var c=D.get_sensor_payload(a,b,0).coll_dist;if(0>c){var d=D.get_sensor_payload(a,b,0).coll_norm,e=aa;H.scale(d,-.25*c,e);c=R.get_translation(a,X);H.add(c,e,c);R.set_translation_v(a,c)}})}if(E){var O=R.get_translation(A),I=R.get_rotation(A),I=m.cam_quat_to_mesh_quat(I);O[2]-=.5;x.set_transform(E,O,I);G.append_stiff_trans(A,E,[0,0,.5]);var P=new Float32Array(2),L=!0;x.set_character_move_type(E,
x.CM_FLY);D.create_kb_sensor_manifold(A,"TOGGLE_CHAR_MOVE_TYPE",D.CT_SHOT,D.KEY_C,function(){L=!L;x.set_character_move_type(E,L?x.CM_FLY:x.CM_WALK)})}var Y,ba,Q,za,ya,oa,ca,fa,Aa,Ha,Ea,Na,Ja;f?O=I=Ha=Ea=Na=Ja=D.create_custom_sensor(0):(Ja=N.check_enable_gamepad_indices(),I=Ja.length?Ja[Ja.length-1]:0,O=D.create_gamepad_btn_sensor(N.GMPD_BUTTON_6,I),I=D.create_gamepad_btn_sensor(N.GMPD_BUTTON_7,I),Ha=D.create_gamepad_axis_sensor(N.GMPD_AXIS_0,Ja),Ea=D.create_gamepad_axis_sensor(N.GMPD_AXIS_1,Ja),Na=
D.create_gamepad_axis_sensor(N.GMPD_AXIS_2,Ja),Ja=D.create_gamepad_axis_sensor(N.GMPD_AXIS_3,Ja));b?b=Y=ba=Q=za=ya=oa=ca=fa=Aa=D.create_custom_sensor(0):(b=D.create_keyboard_sensor(D.KEY_W),Y=D.create_keyboard_sensor(D.KEY_S),ba=D.create_keyboard_sensor(D.KEY_A),Q=D.create_keyboard_sensor(D.KEY_D),za=D.create_keyboard_sensor(D.KEY_R),ya=D.create_keyboard_sensor(D.KEY_F),oa=D.create_keyboard_sensor(D.KEY_UP),ca=D.create_keyboard_sensor(D.KEY_DOWN),fa=D.create_keyboard_sensor(D.KEY_LEFT),Aa=D.create_keyboard_sensor(D.KEY_RIGHT));
J||(D.create_sensor_manifold(A,"FORWARD",D.CT_CONTINUOUS,[a,b,Ea],q,w),D.create_sensor_manifold(A,"BACKWARD",D.CT_CONTINUOUS,[a,Y,Ea],v,w));z?(D.create_sensor_manifold(A,"ROT_UP",D.CT_CONTINUOUS,[a,oa,za,Ja],n,w),D.create_sensor_manifold(A,"ROT_DOWN",D.CT_CONTINUOUS,[a,ca,ya,Ja],p,w),D.create_sensor_manifold(A,"ROT_LEFT",D.CT_CONTINUOUS,[a,fa,ba,Na],n,w),D.create_sensor_manifold(A,"ROT_RIGHT",D.CT_CONTINUOUS,[a,Aa,Q,Na],p,w)):J?(D.create_sensor_manifold(A,"LEFT",D.CT_CONTINUOUS,[a,fa,ba,Ha],n,w),
D.create_sensor_manifold(A,"RIGHT",D.CT_CONTINUOUS,[a,Aa,Q,Ha],p,w),D.create_sensor_manifold(A,"FORWARD",D.CT_CONTINUOUS,[a,oa,b,Ea],n,w),D.create_sensor_manifold(A,"BACKWARD",D.CT_CONTINUOUS,[a,ca,Y,Ea],p,w),D.create_sensor_manifold(A,"UP",D.CT_CONTINUOUS,[a,ya,Ja],v,w),D.create_sensor_manifold(A,"DOWN",D.CT_CONTINUOUS,[a,za,Ja],q,w)):(D.create_sensor_manifold(A,"UP",D.CT_CONTINUOUS,[a,za,O],t,w),D.create_sensor_manifold(A,"DOWN",D.CT_CONTINUOUS,[a,ya,I],t,w),D.create_sensor_manifold(A,"LEFT",D.CT_CONTINUOUS,
[a,ba,Ha],q,w),D.create_sensor_manifold(A,"RIGHT",D.CT_CONTINUOUS,[a,Q,Ha],v,w),D.create_sensor_manifold(A,"ROT_UP",D.CT_CONTINUOUS,[a,oa,Ja],q,w),D.create_sensor_manifold(A,"ROT_DOWN",D.CT_CONTINUOUS,[a,ca,Ja],v,w),D.create_sensor_manifold(A,"ROT_LEFT",D.CT_CONTINUOUS,[a,fa,Na],q,w),D.create_sensor_manifold(A,"ROT_RIGHT",D.CT_CONTINUOUS,[a,Aa,Na],v,w));if(!c){var Ma=0;c=D.create_mouse_wheel_sensor(d);var Ia=0;Ea=D.create_touch_zoom_sensor(d);D.create_sensor_manifold(A,"MOUSE_WHEEL",D.CT_LEVEL,[c],
null,function(a,b,c){1==c&&(b=D.get_sensor_value(a,b,0),B.get_velocities(a,F),z||J?Ma=r(a,b,F.zoom,Ma,z):(F.trans*=1+b*F.zoom,B.set_velocities(a,F)))});D.create_sensor_manifold(A,"TOUCH_ZOOM",D.CT_LEVEL,[Ea],null,function(a,b,c){1==c&&(c=D.get_sensor_value(a,b,0),B.get_velocities(a,F),D.get_sensor_payload(a,b,0)===D.PL_MULTITOUCH_MOVE_ZOOM&&(Ia=r(a,c,.03*F.zoom,Ia,z)))});D.create_sensor_manifold(A,"ZOOM_INTERPOL",D.CT_POSITIVE,[a],null,function(a,b){if(z||J)if(1E-5<Math.abs(Ma)||1E-5<Math.abs(Ia)){var c=
D.get_sensor_value(a,b,0),d=m.smooth(Ma,0,c,.1*U);Ma-=d;c=m.smooth(Ia,0,c,.15*U);Ia-=c;J?u(a,-(d+c)):(d=B.target_get_distance(a)+d+c,d=Math.max(d,.001),B.target_set_distance(a,d))}else Ia=Ma=0})}var ua=0,Fa=0,ra=0,S=0,Ya=0,ab=0;f||(f=function(a){B.get_velocities(a,F);Ya+=.002*F.trans},c=function(a){B.get_velocities(a,F);ab+=.05*F.zoom},Ea=function(a){B.get_velocities(a,F);Ya-=.002*F.trans},Ja=function(a){B.get_velocities(a,F);ab-=.05*F.zoom},z?(D.create_sensor_manifold(A,"GMPD_PAN_Y_POS",D.CT_CONTINUOUS,
[O],null,c),D.create_sensor_manifold(A,"GMPD_PAN_Y_NEG",D.CT_CONTINUOUS,[I],null,Ja),D.create_sensor_manifold(A,"GMPD_PAN_X_POS",D.CT_CONTINUOUS,[Ha],function(a){return-.1>a[0]},Ea),D.create_sensor_manifold(A,"GMPD_PAN_X_NEG",D.CT_CONTINUOUS,[Ha],function(a){return.1<a[0]},f)):J&&(D.create_sensor_manifold(A,"GMPD_PAN_X_POS",D.CT_CONTINUOUS,[Na],function(a){return-.1>a[0]},Ea),D.create_sensor_manifold(A,"GMPD_PAN_X_NEG",D.CT_CONTINUOUS,[Na],function(a){return.1<a[0]},f)));if(e){e=D.create_mouse_move_sensor("X",
window);f=D.create_mouse_move_sensor("Y",window);O=D.create_mouse_click_sensor(d);c=D.create_mouse_click_sensor(window);var Ga=!1,I=function(a){a[2]?Ga=!0:a[0]||(Ga=!1);return Ga&&a[0]};D.create_sensor_manifold(A,"MOUSE_X",D.CT_POSITIVE,[c,e,O],I,l,"X");D.create_sensor_manifold(A,"MOUSE_Y",D.CT_POSITIVE,[c,f,O],I,l,"Y");e=N.get_device_by_type_element(N.DEVICE_MOUSE,window);N.switch_prevent_default(e,!1)}else e=D.create_mouse_move_sensor("X",d),f=D.create_mouse_move_sensor("Y",d),O=D.create_mouse_click_sensor(d),
D.create_sensor_manifold(A,"MOUSE_X",D.CT_POSITIVE,[O,e],null,l,"X"),D.create_sensor_manifold(A,"MOUSE_Y",D.CT_POSITIVE,[O,f],null,l,"Y");var Ra=0,Ob=0,Ib=0,Ua=0;e=D.create_touch_move_sensor("X",d);d=D.create_touch_move_sensor("Y",d);D.create_sensor_manifold(A,"TOUCH_X",D.CT_POSITIVE,[e],null,k,"X");D.create_sensor_manifold(A,"TOUCH_Y",D.CT_POSITIVE,[d],null,k,"Y");D.create_sensor_manifold(A,"ROT_TRANS_INTERPOL",D.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(ua)||1E-5<Math.abs(Fa)||1E-5<Math.abs(Ra)||
1E-5<Math.abs(Ob)||1E-5<Math.abs(ra)||1E-5<Math.abs(S)||1E-5<Math.abs(Ib)||1E-5<Math.abs(Ua)||1E-5<Math.abs(Ya)||1E-5<Math.abs(ab)){var c=D.get_sensor_value(a,b,0),d=m.smooth(ua,0,c,.08*U),e=m.smooth(Fa,0,c,.08*U);ua-=d;Fa-=e;var f=m.smooth(Ra,0,c,.12*U),g=m.smooth(Ob,0,c,.12*U);Ra-=f;Ob-=g;var k=m.smooth(ra,0,c,.08*U),l=m.smooth(S,0,c,.08*U);ra-=k;S-=l;var n=m.smooth(Ib,0,c,.12*U),p=m.smooth(Ua,0,c,.12*U);Ib-=n;Ua-=p;var q=m.smooth(Ya,0,c,.08*U),c=m.smooth(ab,0,c,.08*U);Ya-=q;ab-=c;z?(B.rotate_camera(a,
d+f,e+g),e=B.target_get_distance(a),B.target_pan_pivot(a,e*(k+n+q),e*(l+p+c))):J?(d+f&&h(a,m.AXIS_X,.2*(d+f)),e+g&&(l=B.get_camera_angles(a,Z)[1],h(a,Math.abs(l)>Math.PI/4?m.AXIS_MY:m.AXIS_Z,.2*(e+g))),B.rotate_camera(a,k+n+q,0)):(B.rotate_camera(a,.5*(d+f),.5*(e+g)),E&&(k=B.get_camera_angles_char(a,qa),x.set_character_rotation(E,k[0],k[1])))}});D.create_kb_sensor_manifold(A,"DEC_STEREO_DIST",D.CT_SHOT,D.KEY_LEFT_SQ_BRACKET,function(a){var b=B.get_stereo_distance(a);B.set_stereo_distance(a,.9*b)});
D.create_kb_sensor_manifold(A,"INC_STEREO_DIST",D.CT_SHOT,D.KEY_RIGHT_SQ_BRACKET,function(a){var b=B.get_stereo_distance(a);B.set_stereo_distance(a,1.1*b)})}function M(a){var b=B.get_move_style(a),c=D.create_callback_sensor(function(){var c=B.get_move_style(a),d=c!=b;b=c;return d});D.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",D.CT_POSITIVE,[c],null,function(){E();p(V,ia,na,T,ja,ea)})}function E(){var a=C.get_active_camera();D.check_sensor_manifold(a,"TOGGLE_CHAR_MOVE_TYPE")&&C.get_first_character()&&
G.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),c=0;c<b.length;c++)D.remove_sensor_manifold(a,b[c])}function z(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText=
"z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function l(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&I.remove_loop_cb(f)}
var g=performance.now();I.append_loop_cb(f)}var B=t("camera"),w=t("config"),G=t("constraints"),v=t("container"),D=t("controls"),F=t("data"),n=t("debug"),N=t("input"),I=t("main"),x=t("physics"),J=t("print"),A=t("screen"),C=t("scenes"),R=t("transform"),m=t("util"),H=t("vec3"),U=1,O=null,V=!1,ia=!1,na=!1,T=null,ja=!1,ea=!1,qa=new Float32Array(2),Z=new Float32Array(2),aa=new Float32Array(3),X=new Float32Array(3),fa=new Float32Array(4),Ca={},ca={};a.init=function(a){function d(){var a=b(l,O,y,p),d=v.get_canvas();
if(a){var g=v.get_container();v.resize_to_container();C&&(f(q,u),I.set_fps_callback(k));A&&(e(),c());r&&I.append_loop_cb(function(){g.style.height=g.clientWidth/r+"px"});m&&I.append_loop_cb(function(){v.resize_to_container()});B&&I.append_loop_cb(function(){v.force_offsets_updating()});x&&w.reset_limits();E==w.P_AUTO?n.test_performance(function(a,b){0==a?(J.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),w.apply_quality(w.P_HIGH)):1.5>b?(J.log("QUALITY TEST RESULT: LOW ("+b.toFixed(1)+" GB/s)"),
w.apply_quality(w.P_LOW)):(J.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),w.apply_quality(w.P_HIGH));h(d,!0)}):h(d,!0)}else h(d,!1)}function g(a){a.keyCode==D.KEY_P&&(I.is_paused()?I.resume():I.pause())}function h(){}a=a||{};var m=!1,l=null,p=null,q=null,r=0,u=null,t=!0,x=!1,A=!0,y=!0,z=!1,C=!1,H=!1,B=!1,E=w.get("quality"),G;for(G in a)switch(G){case "canvas_container_id":l=a.canvas_container_id;break;case "callback":h=a.callback;break;case "autoresize":m=a.autoresize;break;case "show_hud_debug_info":H=
a.show_hud_debug_info;break;case "sfx_mix_mode":z=a.sfx_mix_mode;break;case "show_fps":C=a.show_fps;break;case "track_container_position":B=a.track_container_position;J.ia("track_container_position deprecated. Not needed anymore. Use the container.get_coords_target_space method.");break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":q=a.fps_elem_id;break;case "error_purge_elements":p=a.error_purge_elements;break;case "report_init_failure":y=a.report_init_failure;break;case "pause_invisible":A=
a.pause_invisible;break;case "key_pause_enabled":t=a.key_pause_enabled;break;case "force_container_ratio":r=a.force_container_ratio;break;case "min_capabilities":x=a.min_capabilities;break;case "quality":E=a.quality;break;default:w.set(G,a[G])}E!=w.P_AUTO&&w.set("quality",E);t&&document.addEventListener("keydown",g,!1);w.set("show_hud_debug_info",H);w.set("sfx_mix_mode",z);var O=H||z||null;"complete"==document.readyState?window.setTimeout(d,0):window.addEventListener("load",d,!1);window.addEventListener("unload",
function(){F.cleanup()},!1)};a.set_onclick=function(a,b){var c=q(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=q(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,b){var c=q(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=p;a.disable_camera_controls=E;a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,
b,c){if(1==c)switch(c=D.get_sensor_value(a,b,0),b){case "FORWARD":d?x.vehicle_throttle(a,1):R.move_local(a,0,-1*c,0);break;case "BACKWARD":d?x.vehicle_throttle(a,-1):R.move_local(a,0,1*c,0);break;case "LEFT":d?x.vehicle_steer(a,-1):R.move_local(a,1*c,0,0);break;case "RIGHT":d?x.vehicle_steer(a,1):R.move_local(a,-1*c,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&x.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&x.vehicle_steer(a,0)}}var d=x.is_vehicle_chassis(a)||x.is_vehicle_hull(a),
e=D.create_elapsed_sensor(),f=D.create_keyboard_sensor(D.KEY_W),g=D.create_keyboard_sensor(D.KEY_S),h=D.create_keyboard_sensor(D.KEY_A),k=D.create_keyboard_sensor(D.KEY_D),m=D.create_keyboard_sensor(D.KEY_UP),l=D.create_keyboard_sensor(D.KEY_DOWN),n=D.create_keyboard_sensor(D.KEY_LEFT),p=D.create_keyboard_sensor(D.KEY_RIGHT);D.create_sensor_manifold(a,"FORWARD",D.CT_CONTINUOUS,[e,f,m],b,c);D.create_sensor_manifold(a,"BACKWARD",D.CT_CONTINUOUS,[e,g,l],b,c);D.create_sensor_manifold(a,"LEFT",D.CT_CONTINUOUS,
[e,h,n],b,c);D.create_sensor_manifold(a,"RIGHT",D.CT_CONTINUOUS,[e,k,p],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)D.remove_sensor_manifold(a,b[c])};a.enable_debug_controls=function(){D.create_kb_sensor_manifold(null,"CAMERA_SHOT",D.CT_SHOT,D.KEY_K,function(){n.make_camera_frustum_shot()});D.create_kb_sensor_manifold(null,"LIGHT_SHOT",D.CT_SHOT,D.KEY_L,function(){n.make_light_frustum_shot()});D.create_kb_sensor_manifold(null,"TELEMETRY",
D.CT_SHOT,D.KEY_T,function(){n.plot_telemetry()})};a.request_fullscreen=function(a,b,c){J.Bd("request_fullscreen","screen.request_fullscreen");A.request_fullscreen(a,b,c)};a.exit_fullscreen=function(){J.Bd("exit_fullscreen","screen.exit_fullscreen");A.exit_fullscreen()};a.check_fullscreen=function(){J.Bd("check_fullscreen","screen.check_fullscreen");return A.check_fullscreen()};a.report_app_error=z;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;
for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var k=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==k[b])if(void 0!=k["webkit"+m])b="webkit"+m;else if(void 0!=k["ms"+m])b="ms"+m;else if(void 0!=k["moz"+m])b="moz"+m;else return;l(a,
c,d,e,function(e){a&&(k[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(k[b]=f+d+g,h())})}};a.attr_animate=function(a,b,c,d,e,f){a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},l(a,c,d,e,function(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,m=c.opt_suffix,l=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,
k,m,l):"attr"==c.type&&a.attr_animate(d,e,f,g,h,l)}};a.set_camera_smooth_factor=function(a){U=a};a.get_camera_smooth_factor=function(){return U}};b4w.module.camera_anim=function(a,t){function e(a,b,d,e,f){d=y.angle_wrap_0_2pi(b-d);d=Math.min(d,2*Math.PI-d);b=y.angle_wrap_0_2pi(e-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(d)||1E-6>2*Math.PI-Math.abs(d))d=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;c.is_eye_camera(a)?(f[0]=b,f[1]=d):(f[0]=d,f[1]=b);return f}var c=t("camera"),b=t("controls"),f=t("print"),k=t("scenes"),q=t("time"),h=t("transform"),u=t("tsr"),y=t("util"),g=t("vec3"),d=new Float32Array(2),r=new Float32Array(2),p=new Float32Array(3),
M=new Float32Array(3),E=new Float32Array(3),z=u.create(),l=u.create(),B=u.create(),w={},G=!1,v=!1,D=!1,F=!1;a.track_to_target=function(a,e,k,l,v,u,t,w){if(c.is_eye_camera(a)){if(y.is_vector(e))var m=e;else m=p,h.get_object_center(e,!1,m);k=k||1;l=l||2;v=v||1;u=u||1;var n=h.get_translation(a,M);e=g.subtract(m,n,E);var m=c.get_camera_angles(a,d),x=c.get_camera_angles_dir(e,r),A=x[0]-m[0],z=x[1]-m[1],C=Math.abs(Math.acos(Math.cos(A)*Math.cos(z))/k),B=g.length(e)*(1-1/l),D=function(a){return 6*a*(1-a)},
F=q.get_timeline(),G=0,J=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");t&&t()};k=b.create_timeline_sensor();l=b.create_elapsed_sensor();b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[k,l],null,function(d,e,f){c.is_eye_camera(d)?1==f&&(f=b.get_sensor_value(d,e,0)-F,e=b.get_sensor_value(d,e,1),f<C?(f=D(f/C),c.rotate_camera(a,f*A*e/C,f*z*e/C)):f<C+v?(G||(c.rotate_camera(a,x[0],x[1],!0),G++),f=D(f-C/v),e=f*B*e/v,h.move_local(d,0,0,-e)):f<C+v+u?1>=G&&(c.rotate_camera(a,x[0],x[1],
!0),c.eye_set_look_at(a,n),h.move_local(d,0,0,-B),w&&w(),G++):f<C+v+u+v?(2>=G&&(c.rotate_camera(a,x[0],x[1],!0),c.eye_set_look_at(a,n),h.move_local(d,0,0,-B),G++),f=D(f-C-v-u/v),e=f*B*e/v,h.move_local(d,0,0,e)):(c.rotate_camera(a,x[0],x[1],!0),c.eye_set_look_at(a,n),J())):J()})}else f.error("track_to_target(): Wrong camera object or camera move style")};a.auto_rotate=function(a,g,h){function l(f,g,h){if(1==h)if(h=c.get_move_style(f),h==c.MS_STATIC)n();else if(h!=c.MS_TARGET_CONTROLS&&h!=c.MS_EYE_CONTROLS||
!c.has_horizontal_rot_limits(f))q=null,g=b.get_sensor_value(f,g,0),c.rotate_camera(f,g*a,0);else{h=h==c.MS_EYE_CONTROLS?c.eye_get_horizontal_limits(f,w):c.target_get_horizontal_limits(f,w);if(null===q||h.left!=q.left||h.right!=q.right){q=q||{};q.left=h.left;q.right=h.right;v=Math.min(.2,y.angle_wrap_0_2pi(q.right-q.left)/2);h=p;var k=q,l=c.get_camera_angles(h,d)[0];h=e(h,l,k.left,k.right,r);m=a*Math.min(1,h[0]/.2,h[1]/.2)}g=b.get_sensor_value(f,g,0);h=c.get_camera_angles(f,d)[0];h=e(f,h,q.left,q.right,
r);h[1]>v&&h[0]>v?m=y.sign(m)*a:h[1]<v?m-=Math.pow(a,2)/.4*g:h[0]<v&&(m+=Math.pow(a,2)/.4*g);c.rotate_camera(f,g*m,0)}}function n(){b.remove_sensor_manifold(p,"AUTO_ROTATE");b.remove_sensor_manifold(p,"DISABLE_AUTO_ROTATE");g()}g=g||function(){};var p=k.get_active_camera();if(c.is_static_camera(p))f.error("auto_rotate(): Wrong camera move style");else{var q={},v=0,m=0;if(b.check_sensor_manifold(p,"AUTO_ROTATE"))n();else{var u=b.create_mouse_move_sensor("X"),t=b.create_mouse_move_sensor("Y"),z=b.create_mouse_click_sensor(),
B=b.create_touch_move_sensor(),D=b.create_touch_zoom_sensor(),E=b.create_elapsed_sensor();h=h?b.create_mouse_wheel_sensor():b.create_custom_sensor(0);b.create_sensor_manifold(p,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,[u,t,z,B,D,h],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},n);b.create_sensor_manifold(p,"AUTO_ROTATE",b.CT_CONTINUOUS,[E],function(a){return a[0]},l)}}};a.is_auto_rotate=function(){var a=k.get_active_camera();return b.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=
function(){var a=k.get_active_camera();return c.get_move_style(a)==c.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,d,e,k){if(c.get_move_style(a)!=c.MS_STATIC)f.error("move_camera_to_point(): wrong camera type");else if(!G)if(a)if(b){d=d||1;e=e||.01;var n=y.is_vector(a)?a:h.get_tsr(a,z),r=y.is_vector(b)?b:h.get_tsr(b,l);b=g.distance(u.get_trans_view(n),u.get_trans_view(r))/d;d=y.quat_to_dir(u.get_quat_view(n),y.AXIS_MZ,p);var v=y.quat_to_dir(u.get_quat_view(r),y.AXIS_MZ,M);d=Math.min(Math.abs(g.dot(d,
v)),1);e=1E3*Math.max(b,Math.acos(d)/e);G=!0;var m=q.animate(0,1,e,function(b){var c=u.interpolate(n,r,y.smooth_step(b),B);D?(q.clear_animation(m),G=D=!1):(h.set_tsr(a,c),1==b&&(G=!1,k&&k()))})}else f.error("move_camera_to_point(): you must specify the point object");else f.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,d,e,g){if(c.get_move_style(a)==c.MS_STATIC)f.error("rotate_camera(): not supported for STATIC cameras");else if(!v)if(a)if(b||d){v=
!0;var h=0,k=0,l=b?b:d,m=q.animate(0,l,e||1E3,function(e){F?(q.clear_animation(m),v=F=!1):(h-=e,k-=e,d&&b?c.rotate_camera(a,h,k):d?c.rotate_camera(a,0,k):b&&c.rotate_camera(a,h,0),k=h=e,e==l&&(v=!1,g&&g()))})}else f.error("rotate_camera(): you must specify the rotation angle");else f.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){D=!0};a.stop_cam_rotating=function(){F=!0};a.is_moving=function(){return G};a.is_rotating=function(){return v}};b4w.module.gp_conf=function(a,t){function e(){x.length=0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&x.push(a[b]);return x}function c(a){var b=M.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)p.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(z),M.set(a+"_gmpd_stngs",c,"b4w")}function b(a){R=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),k=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),q=document.createElement("div"),r=document.createElement("div"),v=document.createElement("div"),t=document.createElement("div"),x=document.createElement("div"),w=document.createElement("div"),y=document.createElement("div"),z=document.createElement("div"),H=document.createElement("div"),
B=document.createElement("div"),F=document.createElement("div"),G=document.createElement("div");D=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";g.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";h.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";k.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";m.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";q.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";r.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";v.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";y.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";z.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";H.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";B.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";F.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";G.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(F);b.appendChild(G);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(g);b.appendChild(c);h.appendChild(k);h.appendChild(m);h.appendChild(n);h.appendChild(q);b.appendChild(h);b.appendChild(r);b.appendChild(v);b.appendChild(t);b.appendChild(x);b.appendChild(w);b.appendChild(y);b.appendChild(z);a.appendChild(b);b.appendChild(H);b.appendChild(B);J.length=0;l.length=0;A.length=0;C.length=0;J.push(n,
m,q,k,w,y,H,z,t,x,r,v,d,f,g,e,B);l.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
A.push(r,r,v,v);C.push(F,G);for(a=0;a<J.length;a++)J[a].setAttribute("id","pad_btn_"+a),J[a].setAttribute("data-colorstate","B"),J[a].setAttribute("data-key",a),J[a].setAttribute("data-svgid",a);F.setAttribute("id","pad_left_axis");F.setAttribute("data-colorstate","GR");F.setAttribute("data-key",p.GMPD_AXIS_0);F.setAttribute("data-svgid",l.length);G.setAttribute("id","pad_right_axis");G.setAttribute("data-colorstate","GR");G.setAttribute("data-key",p.GMPD_AXIS_2);G.setAttribute("data-svgid",l.length+
1);l.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
u(J,E);u(C,"#e6e6e6")}function f(a){return[r.create_gamepad_btn_sensor(p.GMPD_BUTTON_0,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_1,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_2,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_3,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_4,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_5,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_6,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_7,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_8,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_9,
a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_10,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_11,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_12,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_13,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_14,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_15,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_16,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_17,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_18,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_19,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_20,
a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_21,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_22,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_23,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_24,a),r.create_gamepad_btn_sensor(p.GMPD_BUTTON_25,a)]}function k(a){return[r.create_gamepad_axis_sensor(p.GMPD_AXIS_0,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_1,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_2,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_3,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_4,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_5,
a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_6,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_7,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_8,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_9,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_10,a),r.create_gamepad_axis_sensor(p.GMPD_AXIS_11,a)]}function q(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function h(a){v.removeChild(D);D=null;switch(a){case "PAD":N.checked=!0;b(v);break;case "WHEEL":n.checked=!0;var c=v;R=!1;var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),k=document.createElement("div"),m=document.createElement("div"),q=document.createElement("div"),
r=document.createElement("div"),t=document.createElement("div"),x=document.createElement("div"),w=document.createElement("div"),y=document.createElement("div"),z=document.createElement("div"),B=document.createElement("div"),H=document.createElement("div"),F=document.createElement("div"),G=document.createElement("div"),I=document.createElement("div"),M=document.createElement("div"),W=document.createElement("div"),sa=document.createElement("div"),pa=document.createElement("div"),ga=document.createElement("div");
a=document.createElement("div");var va=document.createElement("div"),xa=document.createElement("div"),K=document.createElement("div"),Oa=document.createElement("div"),Qa=document.createElement("div");D=d;var wa="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";d.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";e.style.cssText=wa+"top: 132px;left: 331px;";f.style.cssText=wa+"top: 122px;left: 315px;";g.style.cssText=wa+"top: 122px;left: 347px;";h.style.cssText=wa+"top: 113px;left: 331px;";k.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";m.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";q.style.cssText=wa+"top: 107px;left: 141px;";r.style.cssText=wa+"top: 107px;left: 90px;";t.style.cssText=wa+"top: 185px;left: 321px;";x.style.cssText=wa+"top: 185px;left: 340px;";w.style.cssText=wa+"top: 179px;left: 358px;";y.style.cssText=wa+"top: 178px;left: 303px;";z.style.cssText=wa+"top: 210px;left: 299px;";B.style.cssText=wa+"top: 279px;left: 299px;";H.style.cssText=wa+"top: 210px;left: 321px;";F.style.cssText=wa+
"top: 279px;left: 321px;";G.style.cssText=wa+"top: 210px;left: 344px;";I.style.cssText=wa+"top: 278px;left: 344px;";M.style.cssText=wa+"top: 124px;left: 147px;";W.style.cssText=wa+"top: 138px;left: 133px;";sa.style.cssText=wa+"top: 124px;left: 82px;";pa.style.cssText=wa+"top: 138px;left: 96px;";ga.style.cssText=wa+"top: 278px;left: 367px;";wa="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=wa+"top: 291px;left: 50px;";va.style.cssText=wa+"top: 291px;left: 111px;";xa.style.cssText=wa+"top: 291px;left: 171px;";K.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";Oa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";Qa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";c.appendChild(d);d.appendChild(a);d.appendChild(va);d.appendChild(xa);d.appendChild(K);d.appendChild(Oa);d.appendChild(Qa);d.appendChild(e);d.appendChild(f);d.appendChild(g);d.appendChild(h);d.appendChild(k);d.appendChild(m);d.appendChild(q);d.appendChild(r);d.appendChild(t);d.appendChild(x);d.appendChild(w);d.appendChild(y);d.appendChild(z);d.appendChild(B);d.appendChild(H);d.appendChild(F);d.appendChild(G);d.appendChild(I);
d.appendChild(M);d.appendChild(W);d.appendChild(sa);d.appendChild(pa);d.appendChild(ga);J.length=0;l.length=0;A.length=0;C.length=0;J.push(e,f,g,h,k,m,q,r,t,x,w,y,z,B,H,F,G,I,M,W,sa,pa,ga);l.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
C.push(K,a,xa,va,Oa,Qa);for(c=0;c<J.length;c++)J[c].setAttribute("id","wheel_btn_"+c),J[c].setAttribute("data-colorstate","B"),J[c].setAttribute("data-key",c),J[c].setAttribute("data-svgid",c);for(c=0;c<C.length;c++)J[c].setAttribute("id","wheel_axis_"+c),J[c].setAttribute("data-colorstate","GR");K.setAttribute("data-key",p.GMPD_AXIS_0);K.setAttribute("data-svgid",l.length);a.setAttribute("data-key",p.GMPD_AXIS_1);a.setAttribute("data-svgid",l.length+1);xa.setAttribute("data-key",p.GMPD_AXIS_2);xa.setAttribute("data-svgid",
l.length+2);va.setAttribute("data-key",p.GMPD_AXIS_3);va.setAttribute("data-svgid",l.length+3);Oa.setAttribute("data-key",p.GMPD_AXIS_4);Oa.setAttribute("data-svgid",l.length+4);Qa.setAttribute("data-key",p.GMPD_AXIS_5);Qa.setAttribute("data-svgid",l.length+5);l.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
u(J,E);u(C,"#e6e6e6")}}function u(a,b){function c(a){a=a.target;if(!(0>B||"G"==a.getAttribute("data-colorstate")))if(G){if("R"==a.getAttribute("data-colorstate")&&(w=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",G=0),"B"==a.getAttribute("data-colorstate")||"GR"==a.getAttribute("data-colorstate")){var c=parseFloat(w.getAttribute("data-svgid"));w.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(l[c])+"')";w.setAttribute("data-colorstate",
a.getAttribute("data-colorstate"));w=a;c=parseFloat(a.getAttribute("data-svgid"));a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(l[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var c=parseFloat(a.getAttribute("data-svgid")),d="B"==a.getAttribute("data-colorstate")?1:2;G=d;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(l[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");document.getElementById("action_label").textContent=
1==d?"Now press the button on the device":"Now move the axis on the device";w=a}}for(var d=0;d<a.length;d++)p.add_click_listener(a[d],c)}function y(a){var b=document.createElement("label");b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function g(){var a=window.innerWidth,b=window.innerHeight;v.style.zoom=750>=
b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}var d=t("container"),r=t("controls"),p=t("input"),M=t("storage"),E=RegExp("#5276cf","g"),z={};z[p.GMPD_BUTTON_12]=p.GMPD_BUTTON_12;z[p.GMPD_BUTTON_13]=p.GMPD_BUTTON_13;z[p.GMPD_BUTTON_15]=p.GMPD_BUTTON_15;z[p.GMPD_BUTTON_14]=p.GMPD_BUTTON_14;z[p.GMPD_BUTTON_3]=p.GMPD_BUTTON_3;z[p.GMPD_BUTTON_0]=p.GMPD_BUTTON_0;z[p.GMPD_BUTTON_1]=p.GMPD_BUTTON_1;z[p.GMPD_BUTTON_2]=p.GMPD_BUTTON_2;z[p.GMPD_BUTTON_5]=p.GMPD_BUTTON_5;z[p.GMPD_BUTTON_7]=p.GMPD_BUTTON_7;
z[p.GMPD_BUTTON_4]=p.GMPD_BUTTON_4;z[p.GMPD_BUTTON_6]=p.GMPD_BUTTON_6;z[p.GMPD_BUTTON_8]=p.GMPD_BUTTON_8;z[p.GMPD_BUTTON_9]=p.GMPD_BUTTON_9;z[p.GMPD_BUTTON_10]=p.GMPD_BUTTON_10;z[p.GMPD_BUTTON_11]=p.GMPD_BUTTON_11;z[p.GMPD_BUTTON_16]=p.GMPD_BUTTON_16;var l=[],B=-1,w=null,G=0,v=null,D=null,F=null,n=null,N=null,I=null,x=[],J=[],A=[],C=[],R=!0,m={};m[p.GMPD_AXIS_0]=-2;m[p.GMPD_AXIS_1]=-2;m[p.GMPD_AXIS_2]=-2;m[p.GMPD_AXIS_3]=-2;m[p.GMPD_AXIS_4]=-2;m[p.GMPD_AXIS_5]=-2;m[p.GMPD_AXIS_6]=-2;m[p.GMPD_AXIS_7]=
-2;m[p.GMPD_AXIS_8]=-2;m[p.GMPD_AXIS_9]=-2;m[p.GMPD_AXIS_10]=-2;m[p.GMPD_AXIS_11]=-2;a.show=function(){var a=document.createElement("div");v=a;a.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
d.insert_to_container(a,"LAST");b(a);var u=document.createElement("div");u.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var t=document.createElement("div");t.innerHTML="Select a device";t.style.cssText="color: #fff;display: inline-block;";u.appendChild(t);for(t=0;4>t;t++){var x=f(t),z=function(){return!0},
D=function(a,b){if(b==B)for(var c=0;c<J.length;c++){var d=J[c],e=r.get_sensor_value(a,b,c),f=c;if(G)e=p.get_pressed_gmpd_btn(B),0<=e&&w&&1==G&&(d=w.getAttribute("data-key"),p.set_gamepad_key(B,d,e),f=M.get(B+"_gmpd_stngs","b4w")||"{}",f=JSON.parse(f),f[d]=e,M.set(B+"_gmpd_stngs",JSON.stringify(f),"b4w"),w=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",G=0);else{if(e&&"B"==d.getAttribute("data-colorstate")){var g=l[f];d.style.backgroundImage=
"url('data:image/svg+xml;base64,"+btoa(g.replace(E,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.getAttribute("data-colorstate")||(g=l[f],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(g)+"')",d.setAttribute("data-colorstate","B"))}}};r.create_sensor_manifold(null,t,r.CT_CONTINUOUS,x,z,D)}0<e().length&&(B=0);var T=[],t=document.createElement("div");t.style.cssText="margin-top: 20px;";for(x=0;4>x;x++)D=y(x),x==B&&(D.style.backgroundColor="green",F=D),c(x),t.appendChild(D),
D.setAttribute("data-device_type","PAD"),T.push(D),p.add_click_listener(D,function(a){var b=e();a=a.target;for(var d=0;d<b.length;d++)T[d]==a&&(B=d,F=a,c(B),h(a.getAttribute("data-device_type")))});u.appendChild(t);I=document.createElement("label");I.style.cssText="position: relative;display: block;color: white;";u.appendChild(I);t=document.createElement("div");t.style.cssText="margin-top: 20px;";x=q(t,"Pad");D=q(t,"Wheel");x.setAttribute("checked","true");x.onchange=function(){h("PAD");F&&F.setAttribute("data-device_type",
"PAD")};D.onchange=function(){h("WHEEL");F&&F.setAttribute("data-device_type","WHEEL")};x.setAttribute("id","test");N=x;n=D;x=document.createElement("label");x.style.cssText+="color: #fff;display: block;";t.appendChild(x);x.textContent="Click on the buttons & arrows to setup your controller";x.setAttribute("id","action_label");u.appendChild(t);a.appendChild(u);a=r.create_elapsed_sensor();r.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",r.CT_CONTINUOUS,[a],z,function(){var a=e(),b=a.length;-1==
B&&a.length&&(B=a[0].index,F=T[B]);for(var c=0;c<T.length;c++)c<b?(T[c].textContent=a[c].index,T[c]==F?(T[c].style.backgroundColor="green",I.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):T[c].style.backgroundColor="blue"):T[c].style.backgroundColor="black";b||(B=-1,I.textContent="")});for(t=0;4>t;t++)x=k(t),D=function(a,b){if(b=="AXES"+B){for(var c=0;c<A.length;c+=2){var d=A[c],e=a,f=b,g=c,h=20*r.get_sensor_value(e,f,g),e=20*r.get_sensor_value(e,f,g+1);d.style.transform="translate3d("+
h+"px, "+e+"px, 0px) rotate(0rad)"}if(R)for(c=0;12>c;c+=2){if(e=a,f=b,d=c,!(d+1>2*C.length)){h=r.get_sensor_value(e,f,d);e=r.get_sensor_value(e,f,d+1);if(-2<m[d]){var k=h-m[d],n=e-m[d+1],f=C[Math.floor(d/2)],g=f.getAttribute("data-svgid");G?2==G&&(k=p.get_moved_gmpd_axis(B),0<=k&&(k%2&&k--,G=0,f.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(l[g])+"')",f=parseFloat(w.getAttribute("data-key")),p.set_gamepad_key(B,f,k),p.set_gamepad_key(B,f+1,k+1),w=null,document.getElementById("action_label").textContent=
"Click on the buttons & arrows to setup your controller")):f.style.backgroundImage=k||n?"url('data:image/svg+xml;base64,"+btoa(l[g].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(l[g])+"')"}m[d]=h;m[d+1]=e}}else for(c=0;12>c;c++)(d=c,d>=C.length)||(h=r.get_sensor_value(a,b,d),-2<m[d]&&((g=h-m[d],e=C[d],f=e.getAttribute("data-svgid"),G)?2==G&&(g=p.get_moved_gmpd_axis(B),0<=g&&(G=0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(l[f])+"')",e=parseFloat(w.getAttribute("data-key")),
p.set_gamepad_key(B,e,g),w=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller")):e.style.backgroundImage=g?"url('data:image/svg+xml;base64,"+btoa(l[f].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(l[f])+"')"),m[d]=h)}},r.create_sensor_manifold(null,"AXES"+t,r.CT_CONTINUOUS,x,function(){return!0},D);g();window.addEventListener("resize",g)};a.hide=function(){G=0;B=-1;N=n=w=F=null;A.length=0;J.length=0;C.length=
0;d.get_container().removeChild(v);v=null;r.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)r.remove_sensor_manifold(null,a),r.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",g)};a.update=function(){for(var a=0;4>a;a++)c(a)}};b4w.module.gyroscope=function(a,t){function e(a){var e=b.create_gyro_angles_sensor(),f=b.create_gyro_quat_sensor(),t=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[e,f],null,function(a,e,f){if(0<f)if(c.is_eye_camera(a))e=b.get_sensor_payload(a,e,1),f=h.transformQuat(q.AXIS_MY,e,g),c.set_vertical_axis(a,f),k.set_rotation_v(a,e);else{y=b.get_sensor_payload(a,e,0);t&&(u[0]=y[0],u[1]=y[1],u[2]=y[2],t=!1);f=e=0;window.orientation||(e=y[1]-u[1],f=y[0]-u[0],y[1]>r&&y[1]<d&&(f=0));if(180==
window.orientation){e=y[1]-u[1];0>y[1]&&(e=-e);f=u[0]-y[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;y[1]>-d&&y[1]<-r&&(f=0)}if(-90==window.orientation){e=y[0]-u[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;f=u[1]-y[1];if(y[0]>p||y[0]<M)f=0}if(90==window.orientation){e=u[0]-y[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;f=y[1]-u[1];if(y[0]>p||y[0]<M)f=0}c.rotate_camera(a,f,e);u[0]=y[0];u[1]=y[1];u[2]=y[2]}})}var c=t("camera"),b=t("controls"),f=t("scenes"),k=t("transform"),q=t("util"),h=t("vec3"),u=new Float32Array(3),y=new Float32Array(3),
g=h.create(),d=q.deg_to_rad(110),r=q.deg_to_rad(70),p=q.deg_to_rad(70),M=-q.deg_to_rad(70);a.enable_camera_rotation=function(){var a=f.get_active_camera();e(a)};a.disable_camera_rotation=function(){var a=f.get_active_camera();b.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd_conf=function(a,t){function e(){if(!r.can_use_device(r.DEVICE_HMD))return!1;var a=r.get_device_by_type_element(r.DEVICE_HMD),a=r.get_value_param(a,r.HMD_WEBVR_TYPE);return a&(r.HMD_NON_WEBVR|r.HMD_WEBVR_MOBILE|r.HMD_WEBVR_DESKTOP)&&!(a&r.HMD_WEBVR1)}function c(a){a=a.target.value;var b=F[a],c;for(c in v)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c];v[c]=b[c]}}
function b(){d.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");k();h();z&&(z=!1,g.get_container().removeChild(l),document.head.removeChild(B),B=w=l=null)}function f(){k(!0);h();for(var a in v){var b=document.getElementById(a+"_slider");b&&(b.value=v[a]);if(b=document.getElementById(a+"_number"))b.value=v[a]}}function k(a){var b=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,c=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,d=0,e=0,f=0,g;a:{g=
N;var h=navigator.userAgent||navigator.vendor||window.opera;if(1==g.format&&g.devices&&g.devices.length)for(var k=0;k<g.devices.length;k++){var l=g.devices[k];if(l.rules&&("ios"==l.type&&D||"android"==l.type)){for(var n=!1,q=0;q<l.rules.length;q++){var r=l.rules[q];if(r.ua&&0<=h.indexOf(r.ua)||!r.ua&&r.res&&r.res[0]&&r.res[1]&&Math.min(b,c)==Math.min(r.res[0],r.res[1])&&Math.max(b,c)==Math.max(r.res[0],r.res[1])){n=!0;break}}if(n){g=k;break a}}}else p.error("DPDB isn't correct.");g=-1}-1!=g&&(f=N.devices[g],
e=f.dpi[1]||f.dpi,d=Math.round(25.4*b/(f.dpi[0]||f.dpi)),e=Math.round(25.4*c/e),f=Math.round(f.bw));b=M.get("hmd_conf","b4w");b=JSON.parse(b?b:"{}");a?(v.first_distortion=.34,v.second_distortion=.55,v.bevel_size=f||4,v.screen_width=d||110,v.screen_height=e||65,v.screen_lense=50,v.ipd=64,v.baseline=32):(v.first_distortion="first_distortion"in b?parseFloat(b.first_distortion):.34,v.second_distortion="second_distortion"in b?parseFloat(b.second_distortion):.55,v.bevel_size="bevel_size"in b?parseFloat(b.bevel_size):
f||4,v.screen_width="screen_width"in b?parseFloat(b.screen_width):d||110,v.screen_height="screen_height"in b?parseFloat(b.screen_height):e||65,v.screen_lense="screen_lense"in b?parseFloat(b.screen_lense):50,v.ipd="ipd"in b?parseFloat(b.ipd):64,v.baseline="baseline"in b?parseFloat(b.baseline):32);G=!0}function q(){M.set("hmd_conf",JSON.stringify(v),"b4w");b()}function h(){if(G){var a=r.get_device_by_type_element(r.DEVICE_HMD);a&&(r.set_config(a,r.HMD_DISTORTION,[v.first_distortion,v.second_distortion]),
r.get_value_param(a,r.HMD_WEBVR_TYPE)&(r.HMD_NON_WEBVR|r.HMD_WEBVR_MOBILE)&&(r.set_config(a,r.HMD_BEVEL_SIZE,.001*v.bevel_size),r.set_config(a,r.HMD_SCREEN_WIDTH,.001*v.screen_width),r.set_config(a,r.HMD_SCREEN_HEIGHT,.001*v.screen_height),r.set_config(a,r.HMD_SCREEN_LENS_DIST,.001*v.screen_lense),r.set_config(a,r.HMD_EYE_DISTANCE,.001*v.ipd),r.set_config(a,r.HMD_BASELINE_DIST,.001*v.baseline)));G=!1}}function u(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in v&&v[b]!=a.target.value&&
(G=!0,v[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function y(a,b,c){var d=document.createElement("button");d.onclick=a;d.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+
c+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";d.innerHTML=b;return d}var g=t("container"),d=t("controls"),r=t("input"),p=t("print"),M=t("storage"),E=t("util"),z=!1,l=null,B=null,w=null,G=!0,v={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},D=/iPad|iPhone|iPod/.test(navigator.platform),F={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",
type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},n=[{label:"Tray to lens-center distance.",xo:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",xo:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",
xo:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",xo:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",xo:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",xo:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];a.check=e;a.show=function(a){if(e()){var p=g.get_container();B=document.createElement("style");
B.innerHTML="."+a+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+a+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}";document.head.appendChild(B);if(!z){z=!0;k();var t=
r.get_device_by_type_element(r.DEVICE_MOUSE,p);r.switch_prevent_default(t,!1);t=r.get_device_by_type_element(r.DEVICE_TOUCH,p);r.switch_prevent_default(t,!1);l=document.createElement("div");l.className=a;p.appendChild(l);w=document.createElement("div");l.appendChild(w);w.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";a=M.get("hmd_conf","b4w");
a=JSON.parse(a?a:"{}").profile||"custom";p=document.createElement("div");t=document.createElement("label");t.innerHTML="Profile: ";t.className="text_label";t.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
p.appendChild(t);t=document.createElement("select");p.appendChild(t);t.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var A=r.get_device_by_type_element(r.DEVICE_HMD);if(A)for(var C in F)if(0==F[C].type||r.get_value_param(A,
r.HMD_WEBVR_TYPE)&(r.HMD_NON_WEBVR|r.HMD_WEBVR_MOBILE)&&1==F[C].type){var D=document.createElement("option");D.value=C;D.text=F[C].name;t.appendChild(D)}t.value=a;E.is_ie11()?t.onchange=c:t.oninput=c;w.appendChild(p);C=r.get_device_by_type_element(r.DEVICE_HMD);for(a=0;a<n.length;a++)if(r.get_value_param(C,r.HMD_WEBVR_TYPE)&(r.HMD_NON_WEBVR|r.HMD_WEBVR_MOBILE)||!n[a].xo){p=n[a];A=a;t=document.createElement("div");D=document.createElement("label");D.className="text_label";var m="8px";A%2&&(m="0");
D.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";D.textContent=p.label;t.appendChild(D);t.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+m+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";
for(A=0;A<p.inputs.length;A++){D=p.inputs[A];m=document.createElement("div");m.className="row";var H=document.createElement("input");H.className="input_slider";H.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;";H.setAttribute("id",D.id+"_slider");H.setAttribute("type","range");H.setAttribute("min","0.00");H.setAttribute("step",D.step);H.setAttribute("value",v[D.id]);
H.setAttribute("max",D.max);m.appendChild(H);var G=document.createElement("input");G.className="input_text";G.setAttribute("id",D.id+"_number");G.setAttribute("type","number");G.setAttribute("min","0.00");G.setAttribute("step",D.step);G.setAttribute("value",v[D.id]);G.setAttribute("max",D.max);m.appendChild(G);G.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
E.is_ie11()?(H.onchange=u,G.onchange=u):(H.oninput=u,G.oninput=u);t.appendChild(m)}w.appendChild(t)}C=document.createElement("div");a=y(q,"SAVE","4px");p=y(b,"CANCEL","4px");t=y(f,"RESET","0px");C.className="row";C.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;";C.appendChild(a);C.appendChild(p);C.appendChild(t);w.appendChild(C);C=d.create_timeline_sensor();d.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",d.CT_CONTINUOUS,[C],null,h)}}};a.hide=
b;a.reset=f;a.update=function(){k();h()};var N={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},
{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,
518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},
{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},
{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],
dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},
{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},
{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],
dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,
bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},
{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",
rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}};b4w.module.hmd=function(a,t){function e(){f.remove_sensor_manifold(null,"VR_CONTROLLERS")}function c(a,c){function e(c,e,k){if(0<k&&(k=h.get_active_camera())&&b.is_eye_camera(k)){var m=f.get_sensor_payload(c,e,1);c=f.get_sensor_payload(c,e,2);c=d.add(c,N,l);y.set_translation_v(k,c);if(m)if(1==a){var m=q.multiply(n,m,F),t=d.transformQuat(g.AXIS_MY,m,l);b.set_vertical_axis(k,t);y.set_rotation_v(k,m)}else if(2==a||3==a){c=y.get_rotation(k,v);c=q.invert(c,v);e=q.multiply(r,c,v);c=b.get_vertical_axis(k,
l);Math.abs(c[2])<Math.PI/4?t=d.cross(c,g.AXIS_MY,B):Math.abs(c[1])<Math.PI/4&&(t=d.cross(c,g.AXIS_Z,B));d.normalize(t,t);e=d.transformQuat(t,e,w);var u=d.dot(c,e);e=d.scaleAndAdd(e,c,-u,w);d.normalize(e,e);c=d.cross(c,t,l);t=Math.acos(g.clamp(d.dot(t,e),0,1));c=g.sign(d.dot(e,c));p+=t*c;t=q.setAxisAngle(g.AXIS_Z,-p,v);3==a?m=q.multiply(t,m,G):(c=g.quat_project(m,g.AXIS_MZ,g.AXIS_Z,g.AXIS_Y,D),c=q.invert(c,D),m=q.multiply(c,m,D),m=q.multiply(t,m,G));t=d.transformQuat(g.AXIS_MY,m,l);b.set_vertical_axis(k,
t);y.set_rotation_v(k,m);q.copy(m,r)}}}if(c){var k=h.get_active_camera();k&&u.request_split_screen(function(){b.is_eye_camera(k)||(M=b.is_target_camera(k),E=b.is_hover_camera(k),z=b.is_static_camera(k),b.eye_setup(k));var a=f.create_elapsed_sensor(),d=f.create_hmd_position_sensor();r=y.get_rotation(k,r);f.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",f.CT_CONTINUOUS,[a,c,d],null,e)})}}var b=t("camera"),f=t("controls"),k=t("input"),q=t("quat"),h=t("scenes"),u=t("screen"),y=t("transform"),g=t("util"),
d=t("vec3"),r=q.create(),p=0,M=!1,E=!1,z=!1,l=d.create(),B=d.create(),w=d.create(),G=q.create(),v=q.create(),D=q.create(),F=q.create(),n=q.create(),N=d.create(),I={pivot:d.create()};a.HMD_NONE_MOUSE_ALL_AXES=0;a.HMD_ALL_AXES_MOUSE_NONE=1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=3;a.enable_hmd=function(a){var b;if(b=k.get_device_by_type_element(k.DEVICE_HMD))b=k.get_value_param(b,k.HMD_WEBVR_TYPE)&(k.HMD_WEBVR_MOBILE|k.HMD_WEBVR_DESKTOP|k.HMD_WEBVR1)?f.create_hmd_quat_sensor():f.create_gyro_quat_sensor(),
c(a,b)};a.check_browser_support=function(){return!!k.can_use_device(k.DEVICE_HMD)};a.enable_controllers=function(a,b){e();if(a||b){var c=k.get_vr_controller_id(0),g=f.create_gamepad_position_sensor(c),c=f.create_gamepad_orientation_sensor(c),h=k.get_vr_controller_id(1),m=f.create_gamepad_position_sensor(h),h=f.create_gamepad_orientation_sensor(h);f.create_sensor_manifold(null,"VR_CONTROLLERS",f.CT_CONTINUOUS,[g,m,c,h],null,function(c,e){if(a){var g=f.get_sensor_payload(c,e,0),h=f.get_sensor_payload(c,
e,2);d.add(N,g,g);y.set_translation_v(a,g);y.set_rotation_v(a,h)}b&&(g=f.get_sensor_payload(c,e,1),h=f.get_sensor_payload(c,e,3),d.add(N,g,g),y.set_translation_v(b,g),y.set_rotation_v(b,h))})}};a.disable_controllers=e;a.disable_hmd=function(){if(f.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){f.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA");u.exit_split_screen();var a=h.get_active_camera();M?b.target_setup(a,I):E?b.hover_setup(a,I):z&&b.static_setup(a,I);b.set_vertical_axis(a,g.AXIS_Z);var c=
y.get_rotation(a,G);y.set_rotation_v(a,c)}};a.set_rotate_quat=function(a){q.copy(a,n)};a.get_rotate_quat=function(a){q.copy(n,a);return a};a.set_position=function(a){q.copy(a,N)};a.get_position=function(a){q.copy(N,a);return a}};b4w.module.fps=function(a,t){function e(){}function c(a,b,c){var d=v.get_active_camera();B.rotate_camera(d,b,c);b=B.get_camera_angles_char(d,aa);G.set_character_rotation(a,b[0],b[1])}function b(a,b,c,d){if(.01<Math.abs(U[0])||.01<Math.abs(U[1]))c=w.get_sensor_value(a,b,0),b=D.smooth(U[0],0,c,.2*O),c=D.smooth(U[1],0,c,.2*O),U[0]-=b,U[1]-=c,d(a,-b*V,-c*V)}function f(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function k(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function q(a,c){if(k(a)&&!F.detect_mobile()){var d=w.create_plock_mouse_sensor(a),f=T?T:w.create_plock_sensor(a);T=f;w.create_sensor_manifold(c,"FPS_PLOCK",w.CT_CONTINUOUS,[d,f],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=w.get_sensor_payload(a,b,0),e(a,-b.coords[0]*V,-b.coords[1]*V))});w.create_sensor_manifold(null,
"FPS_ACTIVATE_PLOCK",w.CT_TRIGGER,[f],function(a){return a[0]},function(b,c,d){0<d?ja.Hz&&ja.Hz(a):ja.Uq&&ja.Uq(a)})}else{if(F.detect_mobile())var d=w.create_touch_move_sensor("XY",a),f=w.create_touch_click_sensor(a),g=4;else{var d=w.create_mouse_move_sensor("XY",a),f=w.create_mouse_click_sensor(a),g=2,h=v.get_active_camera(),l=w.create_elapsed_sensor(),n=w.create_gamepad_axis_sensor(N.GMPD_AXIS_2),p=w.create_gamepad_axis_sensor(N.GMPD_AXIS_3);w.create_sensor_manifold(c,"FPS_CAM_ROT",w.CT_CONTINUOUS,
[l,n,p],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=w.get_sensor_value(a,b,0);c=w.get_sensor_value(a,b,1);b=w.get_sensor_value(a,b,2);d*=2.5;b=-(.05>Math.abs(b)?0:b)*d;c=-(.05>Math.abs(c)?0:c)*d;b=D.clamp(b,m,H);B.rotate_camera(h,c,b);c=B.get_camera_angles(h,aa);G.set_character_rotation(a,c[0]+Math.PI,0)}})}var q=0,r=0;w.create_sensor_manifold(null,"FPS_DRAG_PRESS",w.CT_SHOT,[f],function(a){return a[0]},function(a,b,c){1==c&&(a=w.get_sensor_payload(a,b,
0).coords,q=a[0],r=a[1])});w.create_sensor_manifold(null,"FPS_DRAG_MOVE",w.CT_CONTINUOUS,[d,f],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=w.get_sensor_payload(a,b,0).coords,U[0]+=(a[0]-q)*g,U[1]+=(a[1]-r)*g,q=a[0],r=a[1])});d=w.create_elapsed_sensor();w.create_sensor_manifold(c,"FPS_SMOOTH_DRAG",w.CT_CONTINUOUS,[d],null,b,e)}}function h(a,b){N.add_click_listener(a,function(){I.request_fullscreen_hmd(a,function(){w.check_sensor_manifolds(b,"FPS_PLOCK")&&w.remove_sensor_manifold(b,"FPS_PLOCK");
w.check_sensor_manifolds(null,"FPS_ACTIVATE_PLOCK")&&w.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK");w.check_sensor_manifolds(b,"FPS_CAM_ROT")&&w.remove_sensor_manifold(b,"FPS_CAM_ROT");w.check_sensor_manifolds(null,"FPS_DRAG_PRESS")&&w.remove_sensor_manifold(null,"FPS_DRAG_PRESS");w.check_sensor_manifolds(null,"FPS_DRAG_MOVE")&&w.remove_sensor_manifold(null,"FPS_DRAG_MOVE");w.check_sensor_manifolds(b,"FPS_SMOOTH_DRAG")&&w.remove_sensor_manifold(b,"FPS_SMOOTH_DRAG");C.enable_hmd(C.HMD_ALL_AXES_MOUSE_NONE);
u(b);Ca&&Ca()},function(){w.remove_sensor_manifold(b,"FPS_CHARECTER_VR_ROT");C.disable_hmd();q(a,b);ca&&ca()})})}function u(a){var b=w.create_elapsed_sensor(),c=v.get_active_camera();w.create_sensor_manifold(a,"FPS_CHARECTER_VR_ROT",w.CT_CONTINUOUS,[b],null,function(a){var b=B.get_camera_angles_char(c,aa)[0];G.set_character_rotation(a,b,0)})}function y(){var a=C.check_browser_support()&&!F.detect_mobile(),b=N.get_device_by_type_element(N.DEVICE_HMD);b&&(a=a&&N.get_value_param(b,N.HMD_WEBVR_TYPE)&
N.HMD_WEBVR1);return a}function g(a,b,c,d){function e(a){if(k()){4==m.Ck.id&&(a=0);a=0<a?1:a;var d=n+p;p=-(0>a?-1:a);a=q+r;var e=n+p;G.set_character_move_dir(b,a,e);c&&c(a,e);h(a,e);t&&d!=e&&t(a,e,0)}}function g(a){if(k()){a=0<a?1:a;var d=q+r;r=-(0>a?-1:a);a=q+r;var e=n+p;G.set_character_move_dir(b,a,e);c&&c(a,e);h(a,e);t&&d!=a&&t(a,e,0)}}function h(a,b){var c=m.Ck.id;a||b||4==c?0==c&&(0<v?E(m,2):E(m,1)):E(m,0)}function k(){return Z?(r=q=p=n=0,!1):!0}F.detect_mobile()&&f(a.parentElement?a.parentElement:
a);var m=z(b),n=0,p=0,q=0,r=0,v=-1,t=d.move_dir_cd;a=d.QM;var u=d.PT,x=d.$R,w=d.UR,y=d.VT,A=d.YP;l(1,d.ZP,function(a){if(k()){var d=q+r;q=a;a=q+r;var e=n+p;G.set_character_move_dir(b,a,e);c&&c(a,e);h(a,e);t&&d!=a&&t(a,e,0)}});l(1,a,g);l(1,u,e);l(1,x,function(a){if(k()){4==m.Ck.id&&(a=0);var d=n+p;n=a;a=q+r;var e=n+p;G.set_character_move_dir(b,a,e);c&&c(a,e);h(a,e);t&&d!=e&&t(a,e,0)}});l(1,w,function(a){k()&&0<a&&(G.character_jump(b),t&&t(q+r,n+p,1))});l(3,[N.GMPD_AXIS_0],e);l(3,[N.GMPD_AXIS_1],g);
l(1,y,function(a){v=a;Math.abs(q+r)+Math.abs(n+p)?(0<a?E(m,2):E(m,1),t&&t(q+r,n+p,0)):E(m,0)});l(1,A,function(a){0<a&&(a=na.Ck.id,1==a||0==a?E(m,3):E(m,1))})}function d(){na||(na={Z:[],Ck:null,lock:!1,ZR:null});return na}function r(a,b,c,d){a.Z.push({id:b,My:c,iE:d,hE:null,ez:null})}function p(a){for(var b=[],c=0;c<a.Z;c++){var d=a.Z[c].id;if(0<=b.indexOf(d))return!1;b.push(d)}for(c=0;c<a.Z;c++)for(var d=a.Z[c],e=0;e<d.My.length;e++)if(0>b.indexOf(d.My[e]))return!1;return!0}function M(a,b){for(var c=
null,d=0;d<a.Z.length;d++)if(a.Z[d].id==b){c=a.Z[d];break}return c}function E(a,b){a.ZR=b;if(!a.lock){var c=a.Ck,d=c.id;if(0<=c.My.indexOf(b)){var e=!0;c.hE&&(e=c.hE(d,b));e&&(a.Ck=M(a,b),c.iE&&c.iE(d,b),c.ez&&c.ez(d,b))}}}function z(a){function b(b,c){switch(c){case 0:case 1:G.set_character_move_type(a,G.CM_WALK);break;case 2:G.set_character_move_type(a,G.CM_RUN);break;case 3:G.set_character_move_type(a,G.CM_FLY);break;case 4:G.set_character_move_type(a,G.CM_CLIMB)}}var c=d();r(c,0,[1,3,2,4],b);
r(c,1,[2,3,4,0],b);r(c,2,[1,3,4,0],b);r(c,3,[1],b);r(c,4,[1,2,0],b);p(c);c.Ck=M(c,0);return na}function l(a,b,c){if(b.length){for(var d=[],e=0;e<b.length;e++)if("number"==typeof b[e])300>b[e]?d.push(w.create_keyboard_sensor(b[e])):326>b[e]?d.push(w.create_gamepad_btn_sensor(b[e],ea)):d.push(w.create_gamepad_axis_sensor(b[e]));else if("string"==typeof b[e]){var f=document.getElementById(b[e]);f?d.push(w.create_touch_click_sensor(f)):R.error("Couldn't find element with "+b[e]+" ID.")}b=function(){return!1};
e=w.CT_SHOT;f=function(){};switch(a){case 1:e=w.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0<d?c(1):c(0)};break;case 2:e=w.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0>d?c(1):c(0)};break;case 3:e=w.CT_CONTINUOUS,b=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},f=function(a,b,d,e){if(0<d)for(d=0;d<e;d++){var f=w.get_sensor_value(a,b,d);if(.05<Math.abs(f)){c(f);
break}}else c(0)}}w.create_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+ia.toString(),e,d,b,f,d.length);ia++}}var B=t("camera"),w=t("controls"),G=t("physics"),v=t("scenes"),D=t("util"),F=t("main"),n=t("container"),N=t("input"),I=t("screen"),x=t("transform"),J=t("constraints"),A=t("vec3"),C=t("hmd"),R=t("__print"),m=(-Math.PI+.1)/2,H=(Math.PI-.1)/2,U=new Float32Array(2),O=1,V=4E-4,ia=0,na=null,T=null,ja={Hz:null,Uq:null},ea=0,qa=4,Z=!1,aa=new Float32Array(2),X=new Float32Array(3),fa=new Float32Array(3),
Ca=null,ca=null;a.append_switch_vr_cbs=function(a){Ca=a};a.CS_STAY=0;a.CS_WALK=1;a.CS_RUN=2;a.CS_FLY=3;a.CS_CLIMB=4;a.AT_PRESSED=1;a.AT_RELEASED=2;a.AT_CONTINUOUS=3;a.bind_action=l;a.enable_fps_controls=function(a){a=a||{lock_camera:!0};var b=a.character||v.get_first_character();if(b){var d=a.element||n.get_canvas(),f=a.motion_cb||null;ea=a.gamepad_id||0;var k=a.forward_sens||[w.KEY_W,N.GMPD_BUTTON_12],m=a.backward_sens||[w.KEY_S,N.GMPD_BUTTON_13],l=a.right_sens||[w.KEY_D,N.GMPD_BUTTON_15],p=a.left_sens||
[w.KEY_A,N.GMPD_BUTTON_14],r=a.jump_sens||[w.KEY_SPACE,N.GMPD_BUTTON_1],t=a.AZ||[w.KEY_SHIFT,N.GMPD_BUTTON_7],u=a.fly_sens||[];F.detect_mobile()&&(k.push("B4W_DEFAULT_BTN_1"),m.push("B4W_DEFAULT_BTN_2"));k={ZP:k,QM:m,PT:l,$R:p,UR:r,VT:t,YP:u,move_dir_cd:a.move_dir_cd||null};e=a.rotation_cb||c;m="undefined"!=typeof a.lock_camera?a.lock_camera:!0;a=v.get_active_camera();m&&(m=x.get_translation(a,X),l=x.get_translation(b,fa),A.subtract(m,l,m),J.append_stiff_trans(a,b,m));a=B.get_camera_angles_char(a,
aa);G.set_character_rotation(b,a[0],a[1]);y()&&h(d,b);q(d,b);g(d,b,f,k)}};a.disable_fps_controls=function(a,b){a=a||v.get_first_character();b=b||n.get_container();if(a){for(var c=0;c<ia;c++)w.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+c.toString());var c=a,d=b;k(d)&&!F.detect_mobile()&&(ja.Uq&&ja.Uq(d),w.remove_sensor_manifold(c,"FPS_PLOCK"),w.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!k(b)||F.detect_mobile())w.remove_sensor_manifold(c,"FPS_CAM_ROT"),w.remove_sensor_manifold(c,
"FPS_DRAG_PRESS"),w.remove_sensor_manifold(c,"FPS_DRAG_MOVE"),w.remove_sensor_manifold(c,"FPS_SMOOTH_DRAG");c=a;y()&&w.remove_sensor_manifold(c,"FPS_CHARECTER_VR_ROT");c=b;if(F.detect_mobile()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),e=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);e&&c.removeChild(e)}}};a.set_state_change_cb=function(a,b){M(na,a).ez=b};a.set_cam_smooth_factor=function(a){w.set_plock_smooth_factor(a);O=a};a.get_cam_smooth_factor=function(){return O};a.set_cam_sensitivity=
function(a){V=a/2E5};a.get_cam_sensitivity=function(){return 2E5*V};a.set_plock_enable_cb=function(a){ja.Hz=a};a.set_plock_disable_cb=function(a){ja.Uq=a};a.get_character_state=function(){return na.Ck.id};a.add_new_state=function(){return qa++};a.add_state=function(a,b,c){var e=d();r(e,a,b,c);p(e)||R.error("Incorrect state machine.")};a.switch_state=function(a){var b=d();E(b,a)};a.lock_character=function(){d().lock=!0};a.unlock_character=function(){d().lock=!1};a.is_character_locked=function(){return d().lock};
a.set_rotation_cb=function(a){a?e=a:e=c};a.freeze_movements=function(){Z=!0};a.unfreeze_movements=function(){Z=!1}};b4w.module.mixer=function(a,t){function e(){l=z.length=0;B=c();w=new Float32Array(B.length);G=new Float32Array(B.length);var a=p.get_speaker_objects();if(a.length){z.push(b());for(var d=0;d<a.length;d++)z.push(k(a[d]));z.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function c(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=f("MASTER"),b=p.get_compressor_params();b&&(a.$.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.$.push(["KNEE",b.knee,0,40,40,!1]),a.$.push(["RATIO",b.ratio,1,20,20,!1]),a.$.push(["ATTACK",b.attack,0,1,1E3,!1]),a.$.push(["RELEASE",b.release,0,1,1E3,!1]));a.$.push(["VOLUME",p.get_volume(null),0,1,50,!1]);a.mute=p.is_muted(null)?1:0;a.ih=-1;return a}function f(a){return{id:a,$:[],Nl:0,mute:-1,ih:-1,oc:null}}function k(a){var b=f(d.get_object_name(a));b.mute=p.is_muted(a)?
1:0;b.ih=0;b.oc=a;return b}function q(a){if(a.oc){a.$.length=0;var b=p.get_positional_params(a.oc);b&&(a.$.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.$.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.$.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=p.get_filter_params(a.oc))a.$.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.$.push(["EQ_Q",b.Q,0,10,100,!1]),a.$.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.$.push(["VOLUME",p.get_volume(a.oc),0,1,50,!1]);M.clamp(a.Nl,0,a.$.length-1)}}function h(a){for(var b=
0;b<z.length;b++){var c=z[b];if(c!=a&&1==c.ih)return!0}return!1}function u(a){for(var b=0;b<z.length;b++){var c=z[b];c!=a&&0==c.mute&&0==c.ih&&p.mute(c.oc,!1)}}function y(){if(!z.length)return[0,-1];var a=8*Math.floor(l/8),b=a+7,a=M.clamp(a,0,z.length-1),b=M.clamp(b,0,z.length-1);return[a,b]}var g=t("controls"),d=t("scenes"),r=t("screen"),p=t("sfx"),M=t("__util"),E="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),z=[],l=0,B=null,w=null,G=null;a.enable_mixer_controls=
function(){function a(a,b,c){if(1==c){var d=g.get_sensor_value(a,b,0)?-1:1,e=z[l];if(e)switch(c=e.$[e.Nl],c[1]=c[5]?c[1]*Math.pow(c[3]/c[2],d/c[4]):c[1]+(c[3]-c[2])/c[4]*d,c[1]=M.clamp(c[1],c[2],c[3]),c[0]){case "VOLUME":"MASTER"!=e.id?p.set_volume(e.oc,c[1]):p.set_volume(null,c[1]);break;case "DIST_REF":d=p.get_positional_params(e.oc);d.dist_ref=c[1];p.set_positional_params(e.oc,d);break;case "ATTENUATION":d=p.get_positional_params(e.oc);d.attenuation=c[1];p.set_positional_params(e.oc,d);break;case "DIST_MAX":d=
p.get_positional_params(e.oc);d.dist_max=c[1];p.set_positional_params(e.oc,d);break;case "EQ_FREQ":d=p.get_filter_params(e.oc);d.freq=c[1];p.set_filter_params(e.oc,d);break;case "EQ_Q":d=p.get_filter_params(e.oc);d.Q=c[1];p.set_filter_params(e.oc,d);break;case "EQ_GAIN":d=p.get_filter_params(e.oc);d.gain=c[1];p.set_filter_params(e.oc,d);break;case "THRESHOLD":e=p.get_compressor_params();e.threshold=c[1];p.set_compressor_params(e);break;case "KNEE":e=p.get_compressor_params();e.knee=c[1];p.set_compressor_params(e);
break;case "RATIO":e=p.get_compressor_params();e.ratio=c[1];p.set_compressor_params(e);break;case "ATTACK":e=p.get_compressor_params();e.attack=c[1];p.set_compressor_params(e);break;case "RELEASE":e=p.get_compressor_params();e.release=c[1];p.set_compressor_params(e);break;default:M.I("Unknown strip param")}"INC_DEC"==b?g.reset_timer_sensor(a,b,2,.35):g.reset_timer_sensor(a,b,2,.05)}else g.reset_timer_sensor(a,b,2,10)}function b(a,b,c){if(1==c){c=g.get_sensor_value(a,b,0)?-1:1;if(z.length){1==c&&l<
z.length-1?l++:-1==c&&0<l&&l--;c=y();for(var d=c[0];d<=c[1];d++)q(z[d])}"SWITCH_STRIP"==b?g.reset_timer_sensor(a,b,2,.15+.3):g.reset_timer_sensor(a,b,2,.15)}else g.reset_timer_sensor(a,b,2,10)}e();var c=g.create_keyboard_sensor(g.KEY_NUM4),d=g.create_keyboard_sensor(g.KEY_NUM6),f=g.create_keyboard_sensor(g.KEY_NUM8),k=g.create_keyboard_sensor(g.KEY_NUM2),t=g.create_keyboard_sensor(g.KEY_ADD),E=g.create_keyboard_sensor(g.KEY_SUB),A=g.create_keyboard_sensor(g.KEY_NUM7),C=g.create_keyboard_sensor(g.KEY_NUM9),
R=g.create_timer_sensor(.15,!0),m=g.create_timer_sensor(.05,!0),c=[c,d,R];g.create_sensor_manifold(null,"SWITCH_STRIP",g.CT_TRIGGER,c,function(a){return a[0]||a[1]},b);g.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",g.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[2]},b);g.create_sensor_manifold(null,"SWITCH_PARAM",g.CT_SHOT,[f,k],function(a){return a[0]||a[1]},function(a,b){var c=g.get_sensor_value(a,b,0)?-1:1,d=z[l];d&&(1==c&&d.Nl<d.$.length-1?d.Nl++:-1==c&&0<d.Nl&&d.Nl--)});f=[E,t,m];g.create_sensor_manifold(null,
"INC_DEC",g.CT_TRIGGER,f,function(a){return a[0]||a[1]},a);g.create_sensor_manifold(null,"INC_DEC_HOLD",g.CT_SHOT,f,function(a){return(a[0]||a[1])&&a[2]},a);g.create_sensor_manifold(null,"MUTE_SOLO",g.CT_SHOT,[A,C],function(a){return a[0]||a[1]},function(a,b){if(g.get_sensor_value(a,b,0)){var c=z[l];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,p.mute(c.oc,!0),1==c.ih&&(c.ih=0,h(c)||u(c))):(c.mute=0,h(c)||p.mute(c.oc,!1)):0==c.mute?(c.mute=1,p.mute(null,!0)):(c.mute=0,p.mute(null,!1)))}else if((c=
z[l])&&0<=c.ih)if(0==c.ih){c.ih=1;p.mute(c.oc,!1);1==c.mute&&(c.mute=0);for(var d=0;d<z.length;d++){var e=z[d];e!=c&&0==e.mute&&0==e.ih&&p.mute(e.oc,!0)}}else c.ih=0,h(c)?p.mute(c.oc,!0):u(c)});A=g.create_elapsed_sensor();g.create_sensor_manifold(null,"MIXER_DRAW",g.CT_CONTINUOUS,[A],null,function(){if(z[l])for(var a=y(),b=a[0];b<=a[1];b++){var c=z[b];r.draw_mixer_strip(c.id,b==l,b%8,c.$,c.Nl,c.mute,c.ih);if(c.oc&&p.get_filter_params(c.oc)){p.get_filter_freq_response(c.oc,B,w,G);for(c=0;c<w.length;c++)w[c]=
20*Math.log(w[c])/Math.LN10;r.plot_array("EQ",b%8,w,20,2E4,-10,10)}}});A=g.create_timer_sensor(1,!0);g.create_sensor_manifold(null,"MIXER_UPDATE",g.CT_TRIGGER,[A],null,function(){for(var a=y(),b=a[0];b<=a[1];b++)q(z[b])})};a.disable_mixer_controls=function(){for(var a=0;E.length;a++)g.remove_sensor_manifold(null,E[a])}};b4w.module.npc_ai=function(a,t){function e(a,b){var c=b.destination,d=b.Qy,e=w;r.get_translation(b.collider,e);var f=0,g=e[2];c[2]=g;switch(b.type){case N:if(b.random&&b.jl){c[0]=(12*Math.random()-6)*b.speed+d[0];c[1]=-(12*Math.random()-6)*b.speed+d[1];var k=F,d=G,l=b.speed,t=b.rot_speed;r.get_rotation(b.collider,k);p.transformQuat(z.AXIS_MY,k,d);d[2]=0;p.normalize(d,d);k=.5*l/Math.sin(t/2);e=p.dist(c,e);e<2*k&&p.scaleAndAdd(c,d,2*k-e,c);b.jl=!1}b.fA&&(f=b.fA-g,e=b.speed*a,f>e?f=e:f<-e&&(f=-e));b.kk=
f;break;case I:case x:b.Lp?f=b.Lp:b.kk&&(f=b.kk,b.type==x&&(f*=a)),b.random&&b.jl&&(b.type==x?(b.speed=Math.random()+.1,e=b.WG-b.ZG):e=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=10*Math.random()-5+d[1],c[2]=g-(Math.random()*e-.5*e),b.jl=!1)}f&&(c[2]=g+f);var c=B,e=w,k=G,f=n,t=b.rig,d=b.collider,g=b.destination,u=b.speed,A=b.actions,E=h.get_current_anim_name(t);if(!h.is_play(t)||!A.idle||-1==A.idle.indexOf(E)){r.get_translation(d,c);var l=g[0]-c[0],J=g[1]-c[1],l=Math.sqrt(l*l+J*J);
if(l>2*u*a)b.state=20,z.horizontal_direction(g,c,k),A=b.rig,h.is_animated(A)&&(t=b.speed,u=h.get_frame(A),A=h.get_anim_length(A),t=A/24*(1-u/A)*t,.9>l/t&&p.scaleAndAdd(g,k,t-l,g)),l=F,t=v,r.get_rotation(b.collider,l),p.transformQuat(z.AXIS_MY,l,e),t[0]=e[0],t[1]=e[1],t[2]=0,p.normalize(t,t),u=p.dot(t,k),A=a/(Math.abs(Math.acos(u))/Math.PI)*b.rot_speed*b.FB,y.rotationTo(t,k,f),y.rotationTo(z.AXIS_MY,t,l),1<=Math.abs(u)?y.copy(l,f):(y.multiply(f,l,f),y.slerp(l,f,Math.min(A,1),f)),k=a,b.type!=I&&(k=
Math.max(k,1/60),l=D,t=F,y.setAxisAngle(z.AXIS_X,-Math.asin(-e[2]),t),y.setAxisAngle(z.AXIS_X,-Math.atan(b.kk/(b.speed*k)),l),y.slerp(t,l,k,l),y.multiply(f,l,f)),r.set_rotation_v(d,f),e=G,d=v,z.quat_to_dir(f,z.AXIS_MY,e),p.scale(e,b.speed*a,d),p.add(d,c,d),d[2]=b.type!=N?(g[2]-c[2])*a*.1+c[2]:g[2],r.set_translation_v(b.collider,d);else if(b.type==N)A.move?E&&-1!=A.move.indexOf(E)&&h.is_play(t)?b.state=20:(b.state=10,b.jl=!0):(b.state=10,b.jl=!0);else if(b.type==x||b.type==I)b.jl=!0;if(q(b)&&(c=b.rig,
!h.is_play(c))){f=null;switch(b.state){case 10:f=b.actions;f=f.idle?z.random_from_array(f.idle):null;break;case 20:f=h.get_current_anim_name(b.rig),e=g=b.actions,e.move_blends&&-1==e.move_blends.indexOf(f)&&e.move&&-1!=e.move.indexOf(f)&&.33<Math.random()?(g=b.actions,f=g.move_blends[g.move.indexOf(f)]):(e=b.actions,e.move&&(-1!=e.move.indexOf(f)||!e.move_blends&&!e.move_start||!e.move_start&&!f||e.move_blends&&-1!=e.move_blends.indexOf(f)||e.move_start&&-1!=e.move_start.indexOf(f))?(g=b.actions,
g.move_blends?(e=g.move_blends.indexOf(f),-1!=e?(f=e+1,f=f<g.move.length?f:0,f=g.move[f]):f=-1!=g.move.indexOf(f)?f:z.random_from_array(g.move)):f=z.random_from_array(g.move)):(e=b.actions,f=e.move_start&&-1==e.move_start.indexOf(f)&&e.move&&-1==e.move.indexOf(f)?z.random_from_array(g.move_start):null))}f&&(h.apply(c,f),h.set_behavior(c,h.AB_FINISH_RESET),h.set_frame(c,0),h.play(c))}}}function c(a,b,c,d){if(d)if(1==c)switch(d.type){case I:a:{for(c=0;3>c;c++){var e=u.get_sensor_payload(a,b,c).hit_fract;
if(e){b=e;break a}}b=void 0}b=100*b;d.kk=b<d.min_height?10:b>d.max_height?-10:0;break;case N:a=u.get_sensor_payload(a,b,0);d.fA=a.hit_pos[2];break;case x:a=u.get_sensor_payload(a,b,0),"CLOSE_GROUND"==b?(d.kk=100*a.hit_fract-1,d.kk=.1>d.kk?.05:0):"CLOSE_WATER"==b&&(d.Lp=100*a.hit_fract,d.Lp=d.Lp<d.ZG?-.02:d.Lp>d.WG?.02:0)}else d.kk=0}function b(){for(var a=0;a<l.length;a++){var b=l[a];f(b);k(b);h.get_current_anim_name(b.rig)&&h.play(b.rig)}}function f(a){var b=p.create(),d=a.collider;switch(a.type){case I:var e=
u.create_ray_sensor(d,b,[0,0,-100],"TERRAIN",!0,!0),f=u.create_ray_sensor(d,b,[0,0,-100],"STONE",!0,!0),b=u.create_ray_sensor(d,b,[0,0,-100],"WATER",!0,!0),e=[e,f,b];u.create_sensor_manifold(d,"CLOSE_GROUND",u.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},c,a);break;case N:e=u.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);e=[e];u.create_sensor_manifold(d,"CLOSE_GROUND",u.CT_CONTINUOUS,e,null,c,a);break;case x:e=u.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=u.create_ray_sensor(d,
b,[0,0,100],"WATER",!0,!0),e=[e],u.create_sensor_manifold(d,"CLOSE_WATER",u.CT_CONTINUOUS,[b],null,c,a),u.create_sensor_manifold(d,"CLOSE_GROUND",u.CT_CONTINUOUS,e,null,c,a)}}function k(a){var b=a.collider;if(a.type==N){var c=u.create_collision_sensor(b,"CONSTRUCTION",!1);u.create_sensor_manifold(b,"CONSTRUCTION_COLL",u.CT_CONTINUOUS,[c],null,function(b,c,d){1==d?(p.copy(a.Qy,a.destination),a.FB=4):a.FB=1})}}function q(a){var b=a.rig;if(!h.is_play(b))return!0;b=h.get_current_anim_name(b);if(!b)return!0;
var c=a.actions;switch(a.state){case 10:if(!c.idle)return!1;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.move_start&&-1!=c.move_start.indexOf(b)||c.move_blends&&-1!=c.move_blends.indexOf(b))return!1;break;default:return!1}return!0}var h=t("animation"),u=t("controls"),y=t("quat"),g=t("scenes"),d=t("time"),r=t("transform"),p=t("vec3"),M=t("physics"),E=t("print"),z=t("util"),l=[],B=new Float32Array(3),w=new Float32Array(3),G=new Float32Array(3),v=new Float32Array(3),D=new Float32Array(4),F=new Float32Array(4),
n=new Float32Array(4),N=a.NT_WALKING=10,I=a.NT_FLYING=20,x=a.NT_SWIMMING=30;a.new_event_track=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:N,state:10,actions:{},Qy:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],Ou:[],delay:[],random:!0,jl:!0,fA:0,kk:0,Lp:0,FB:1,speed:1,rot_speed:.1,max_height:0,min_height:0,WG:0,ZG:0};if("object"!=typeof a.obj)E.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)E.error("Can't create event track. Wrong rig object.");
else if("object"==typeof a.collider&&M.has_physics(a.collider)){b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;r.get_translation(a.collider,b.Qy);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);
if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.Ou[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=h.get_current_anim_name(b.rig),d;for(d in a)for(var e=a[d],f=0;f<e.length;f++)h.apply(b.rig,e[f]);c&&h.apply(b.rig,c);l.push(b)}else E.error("Can't create event track. Wrong collider object.")};a.enable_animation=function(){if(l.length){b();var a=u.create_elapsed_sensor();u.create_sensor_manifold(l[0].collider,"ELAPSED",u.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,
b,c){if(1==c)for(a=u.get_sensor_value(a,b,0),b=0;b<l.length;b++){c=l[b];var f=a;if(g.is_visible(c.obj))if(c.random)e(f,c);else{for(var h=d.get_timeline(),k=0;k<c.path.length;k++)if(!c.ended[k]){c.Ou[k]||(c.Ou[k]=!0,c.destination[0]=c.path[k][0],c.destination[1]=c.path[k][1],c.destination[2]=c.path[k][2],c.start[k]=h+c.delay[k]);if(h<c.start[k])break;e(f,c);c.ended[k]=c.jl;break}a:{for(f=0;f<c.path.length;f++)if(0==c.ended[f]){f=!1;break a}f=!0}if(f)for(f=0;f<c.path.length;f++)c.Ou[f]=!1,c.ended[f]=
!1}}})}};a.disable_animation=function(){if(!(0>=l.length))for(var a=0;a<l.length;a++){var b=l[a];u.check_sensor_manifolds(b.collider)&&u.remove_sensor_manifold(b.collider);h.is_play(b.rig)&&h.stop(b.rig)}}};b4w.module.mouse=function(a,t){function e(){1==n&&(n=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);d.remove_sensor_manifold(M.get_active_camera(),"SMOOTH_PL")}function c(a){2==n&&(n=0);a.removeEventListener("mousedown",f,!1);a.removeEventListener("mouseup",k,!1);a.removeEventListener("mousemove",b,!1);d.remove_sensor_manifold(M.get_active_camera(),"SMOOTH_DRAG")}function b(a){if(D()){if(I)var b=g.get_coords_target_space(a,
v);else b=v,b[0]=a.clientX,b[1]=a.clientY;G[0]+=2*(b[0]-B);G[1]+=2*(b[1]-w);B=b[0];w=b[1]}a.preventDefault()}function f(a){if(I)var c=g.get_coords_target_space(a,v);else c=v,c[0]=a.clientX,c[1]=a.clientY;B=c[0];w=c[1];a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function k(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function q(a,b,c,e){if(.01<Math.abs(G[0])||.01<Math.abs(G[1]))b=d.get_sensor_value(a,b,0),a=E.smooth(G[0],0,b,.1*l),b=E.smooth(G[1],
0,b,.1*l),G[0]-=a,G[1]-=b,e(4E-4*-a,4E-4*-b)}function h(a,b){var c=M.get_first_character(),d=M.get_active_camera();y.rotate_camera(d,a,b);c&&(d=y.get_camera_angles_char(d,v),r.set_character_rotation(c,d[0],d[1]))}function u(a){N?(a=g.get_coords_target_space(a,!1,v),a=M.pick_object(a[0],a[1])):a=M.pick_object(a.clientX,a.clientY);a?(M.outlining_is_enabled(a)&&M.set_outline_intensity(a,1),M.outlining_is_enabled(F)&&a!=F&&M.set_outline_intensity(F,0)):M.outlining_is_enabled(F)&&M.set_outline_intensity(F,
0);F=a}var y=t("camera"),g=t("container"),d=t("controls"),r=t("physics"),p=t("print"),M=t("scenes"),E=t("util"),z=t("main"),l=1,B=0,w=0,G=new Float32Array(2),v=new Float32Array(2),D=null,F=null,n=0,N=!1,I=!1;a.request_pointerlock=function(a,b,e,f,g,k){function l(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",f,!1);var g=M.get_active_camera();if(!d.check_sensor_manifold(g,"SMOOTH_PL")){var h=d.create_elapsed_sensor();
d.create_sensor_manifold(g,"SMOOTH_PL",d.CT_CONTINUOUS,[h],null,q,k)}b()}else a.removeEventListener("mousemove",f,!1),n=0,document.removeEventListener("pointerlockchange",l,!1),document.removeEventListener("webkitpointerlockchange",l,!1),document.removeEventListener("mozpointerlockchange",l,!1),e()}if(1!=n){n=1;b=b||function(){};e=e||function(){};k=k||h;g=g||function(){return!0};f=f||function(a){if(g()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?
(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;G[0]+=b;G[1]+=a}};document.addEventListener("pointerlockchange",l,!1);document.addEventListener("webkitpointerlockchange",l,!1);document.addEventListener("mozpointerlockchange",l,!1);var m=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof m?m.apply(a):p.error("Pointer lock is not available")}};a.exit_pointerlock=e;a.check_pointerlock=function(a){return"function"===
typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,c,g){2!=n&&(n=2,e(),D=b||function(){return!0},c=c||h,I=!!g,a.addEventListener("mousedown",f,!1),a.addEventListener("mouseup",k,!1),a=M.get_active_camera(),d.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=d.create_elapsed_sensor(),d.create_sensor_manifold(a,"SMOOTH_DRAG",d.CT_CONTINUOUS,[b],null,q,c)))};a.exit_mouse_drag=c;a.enable_mouse_hover_outline=function(a){N=!!a;z.detect_mobile()||
g.get_canvas().addEventListener("mousemove",u)};a.disable_mouse_hover_outline=function(){z.detect_mobile()||(g.get_canvas().removeEventListener("mousemove",u),F&&M.set_outline_intensity(F,0))};a.get_coords_x=function(a,b,c){return c?g.get_coords_target_space(a,b,v)[0]:"clientX"in a?a.clientX:(a="touchend"==a.type?a.changedTouches:b?a.targetTouches:a.touches)&&a[0]&&"clientX"in a[0]?a[0].clientX:-1};a.get_coords_y=function(a,b,c){return c?g.get_coords_target_space(a,b,v)[1]:"clientY"in a?a.clientY:
(a="touchend"==a.type?a.changedTouches:b?a.targetTouches:a.touches)&&a[0]&&"clientY"in a[0]?a[0].clientY:-1};a.set_plock_smooth_factor=function(a){l=a};a.get_plock_smooth_factor=function(){return l}};b4w.module.preloader=function(a,t){var e=t("container"),c,b,f,k,q,h,u,y,g=null;a.create_preloader=function(a){var d="#484848",g="#5276cf",h="rgba(150, 150, 150, 0.7)",q="#fff",t;for(t in a)switch(t){case "container_color":d=a.container_color;break;case "bar_color":g=a.bar_color;break;case "frame_color":h=a.frame_color;break;case "font_color":q=a.font_color}a=document.createElement("div");t=a.cloneNode(!1);var l=a.cloneNode(!1),u=a.cloneNode(!1),w=e.get_container();l.appendChild(t);l.appendChild(u);
a.appendChild(l);w.appendChild(a);a.style.cssText="background-color: "+d+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";l.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+h+";border: 2px solid "+h+";";t.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+g+";height: 100%;";u.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+
h+";color: "+q+";";c=t;b=u;f=a;k="DEFAULT"};a.create_simple_preloader=function(a){var d=null,e=null,h="#bf9221",t="#000",u;for(u in a)switch(u){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":t=a.bg_color;break;case "bar_color":h=a.bar_color}a=document.createElement("div");u=document.createElement("div");a.id="simple_preloader_container";var l=document.createElement("div"),y=document.createElement("div"),e=document.getElementById(e);
g=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+t+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";u.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";l.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+h+";border-radius: 0px;";y.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
u.appendChild(l);u.appendChild(y);a.appendChild(u);document.body.appendChild(a);k="SIMPLE";f=a;c=l;b=y;q=e};a.create_rotation_preloader=function(a){var c=null,d=null,e="rgba(0,0,0,0)",t="",u="",l="rgba(0,0,0,0)",y;for(y in a)switch(y){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":e=a.frame_bg_color;break;case "bg_color":l=a.bg_color;break;case "frame_class":t=a.frame_class;break;case "anim_elem_class":u=
a.anim_elem_class}a=document.createElement("div");y=document.createElement("div");var w=document.createElement("div"),G=document.createElement("div"),d=document.getElementById(d);g=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+l+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";y.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+e+";";w.style.cssText=
"position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";G.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";w.className=u;y.appendChild(w);y.className=t;y.appendChild(G);a.appendChild(y);g.appendChild(a);k="ROTATION";f=a;h=w;b=G;q=d};a.create_advanced_preloader=function(a){var d=a.preloader_width,d=d/(d-a.img_width),e=
document.getElementById(a.preloader_bar_id),h=document.getElementById(a.fill_band_id),t=document.getElementById(a.preloader_caption_id),z=document.getElementById(a.preloader_container_id),l=document.getElementById(a.background_container_id);g=document.getElementById(a.canvas_container_id);k="ADVANCED";c=e;u=h;y=d;b=t;f=z;q=l};a.update_preloader=function(a){b.innerHTML=a+"%";"SIMPLE"==k?c.style.width=a+"%":"ADVANCED"==k?(c.style.width=a/y+"%",u.style.width=100-a+"%"):"ROTATION"==k?h.style.transform=
"rotate("+a+"deg)":"DEFAULT"==k&&(c.style.width=a+"%");100==a&&(f.parentNode.removeChild(f),q&&q.parentNode.removeChild(q))}};b4w.module.storage=function(a,t){function e(a){return f[a?a:b]?JSON.parse(f[a?a:b]):{}}var c=t("__print"),b="b4w",f=null;a.init=function(a){a?"b4w"!==a?b=a:c.error("b4w prefix denied"):c.warn("Prefix should be a string. Last declared storage prefix will be used.")};a.set=function(a,c,h){var k=e(h);k[a]=String(c);f[h?h:b]=JSON.stringify(k)};a.cleanup=function(a){delete f[a?a:b]};a.get=function(a,b){var c=e(b);return c[a]?c[a]:""};a.debug=function(a){c.log(e(a?a:b))};try{f=window.localStorage;try{f.tmp=
null,delete f.tmp}catch(k){c.warn("localStorage quota is limited. Disabling localStorage"),f=null}}catch(k){c.warn("Applying chrome localStorage bug workaround"),f=null}f||(c.warn("localStorage is not available, initializing temporary storage"),f={})};b4w.module.screenshooter=function(a,t){var e=t("screen"),c=t("print");a.shot=function(a,f){c.Bd("shot","screen.shot");e.shot(a,f)}};
//# sourceMappingURL=/deploy/apps/common/b4w.min.js.map